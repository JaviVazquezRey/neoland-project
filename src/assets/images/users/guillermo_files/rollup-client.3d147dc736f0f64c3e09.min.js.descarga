(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[424,45,77,102,108,114,118,123,124,196,336,339,344],{101:function(e,t,i){var n=i(109)("keys");var a=i(91);e.exports=function(e){return n[e]||(n[e]=a(e))}},1051:function(e,t){(function(e){var t=function(){var t='<div class="colpick"><div class="colpick_color"><div class="colpick_color_overlay1"><div class="colpick_color_overlay2"><div class="colpick_selector_outer"></div></div></div></div><div class="colpick_hue"><div class="colpick_hue_arrs"><div class="colpick_hue_larr"></div><div class="colpick_hue_rarr"></div></div></div><div class="colpick_controls"><div class="colpick_color_state"><div class="colpick_new_color"></div><div class="colpick_current_color"></div></div><div class="colpick_color_fields"><div class="colpick_rgb_hsb"><div class="colpick_rgb"><div class="colpick_rgb_r colpick_field"><div class="colpick_field_letter">R</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_g colpick_field"><div class="colpick_field_letter">G</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_rgb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div></div><div class="colpick_hsb"><div class="colpick_hsb_h colpick_field"><div class="colpick_field_letter">H</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_s colpick_field"><div class="colpick_field_letter">S</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div><div class="colpick_hsb_b colpick_field"><div class="colpick_field_letter">B</div><input type="text" maxlength="3" size="3" /><div class="colpick_field_arrs"><div class="colpick_field_uarr"></div><div class="colpick_field_darr"></div></div></div></div></div><div class="colpick_hex_submit"><div class="colpick_hex_field"><div class="colpick_field_letter">#</div><input type="text" maxlength="6" size="6" /></div><div class="colpick_submit"></div></div></div></div></div>',n={showEvent:"click",onShow:function(){},onBeforeShow:function(){},onHide:function(){},onChange:function(){},onSubmit:function(){},colorScheme:"light",color:"3289c7",livePreview:true,flat:false,layout:"full",submit:1,submitText:"OK",height:156},o=function(t,i){var n=s(t),a=0;e(i).data("colpick").fields.eq(a).val(n.r).end().eq(a+1).val(n.g).end().eq(a+2).val(n.b).end()},c=function(t,i){var n=3;e(i).data("colpick").fields.eq(n).val(Math.round(t.h)).end().eq(n+1).val(Math.round(t.s)).end().eq(n+2).val(Math.round(t.b)).end()},d=function(t,i){e(i).data("colpick").fields.eq(6).val(l(t))},u=function(t,i){e(i).data("colpick").selector.css("backgroundColor","#"+l({h:t.h,s:100,b:100}));e(i).data("colpick").selectorIndic.css({left:parseInt(e(i).data("colpick").height*t.s/100,10),top:parseInt(e(i).data("colpick").height*(100-t.b)/100,10)})},_=function(t,i){e(i).data("colpick").hue.css("top",parseInt(e(i).data("colpick").height-e(i).data("colpick").height*t.h/360,10))},m=function(t,i){e(i).data("colpick").currentColor.css("backgroundColor","#"+l(t))},f=function(t,i){e(i).data("colpick").newColor.css("backgroundColor","#"+l(t))},h=function(t){var i=e(this).parents(".colpick"),n,m=0;if(this.parentNode.className.indexOf("_swatches")>0){n=a(e(t.target).data("swatch-color"));d(n,i.get(0));o(n,i.get(0));c(n,i.get(0))}else if(this.parentNode.className.indexOf("_hex")>0){i.data("colpick").color=n=a(U(this.value));o(n,i.get(0));c(n,i.get(0))}else if(this.parentNode.className.indexOf("_hsb")>0){i.data("colpick").color=n=B({h:parseInt(i.data("colpick").fields.eq(m+3).val(),10),s:parseInt(i.data("colpick").fields.eq(m+4).val(),10),b:parseInt(i.data("colpick").fields.eq(m+5).val(),10)});o(n,i.get(0));d(n,i.get(0))}else{i.data("colpick").color=n=r(P({r:parseInt(i.data("colpick").fields.eq(m).val(),10),g:parseInt(i.data("colpick").fields.eq(m+1).val(),10),b:parseInt(i.data("colpick").fields.eq(m+2).val(),10)}));d(n,i.get(0));c(n,i.get(0))}u(n,i.get(0));_(n,i.get(0));f(n,i.get(0));i.data("colpick").onChange.apply(i.parent(),[n,l(n),s(n),i.data("colpick").el,0])},p=function(t){e(this).parent().removeClass("colpick_focus")},g=function(){var t=e(this).parents(".colpick");t.data("colpick").fields.parent().removeClass("colpick_focus");e(this).parent().addClass("colpick_focus")},T=function(t){t.preventDefault?t.preventDefault():t.returnValue=false;var i=e(this).parent().find("input").focus(),n=e(this).parents(".colpick"),a={el:e(this).parent().addClass("colpick_slider"),max:this.parentNode.className.indexOf("_hsb_h")>0?360:this.parentNode.className.indexOf("_hsb")>0?100:255,y:t.pageY,field:i,val:parseInt(i.val(),10),preview:n.data("colpick").livePreview};e(document).mouseup(a,v);e(document).mousemove(a,S)},S=function(e){e.data.field.val(Math.max(0,Math.min(e.data.max,parseInt(e.data.val-e.pageY+e.data.y,10))));e.data.preview&&h.apply(e.data.field.get(0),[true]);return false},v=function(t){h.apply(t.data.field.get(0),[true]);t.data.el.removeClass("colpick_slider").find("input").focus();e(document).off("mouseup",v);e(document).off("mousemove",S);return false},b=function(t){t.preventDefault?t.preventDefault():t.returnValue=false;var i={cal:e(this).parent(),y:e(this).offset().top};e(document).on("mouseup touchend",i,y);e(document).on("mousemove touchmove",i,w);var n="touchstart"==t.type?t.originalEvent.changedTouches[0].pageY:t.pageY;h.apply(i.cal.data("colpick").fields.eq(3).val(parseInt(360*(i.cal.data("colpick").height-(n-i.y))/i.cal.data("colpick").height,10)).get(0),[i.cal.data("colpick").livePreview]);return false},w=function(e){var t="touchmove"==e.type?e.originalEvent.changedTouches[0].pageY:e.pageY;h.apply(e.data.cal.data("colpick").fields.eq(3).val(parseInt(360*(e.data.cal.data("colpick").height-Math.max(0,Math.min(e.data.cal.data("colpick").height,t-e.data.y)))/e.data.cal.data("colpick").height,10)).get(0),[e.data.preview]);return false},y=function(t){o(t.data.cal.data("colpick").color,t.data.cal.get(0));d(t.data.cal.data("colpick").color,t.data.cal.get(0));e(document).off("mouseup touchend",y);e(document).off("mousemove touchmove",w);return false},A=function(t){t.preventDefault?t.preventDefault():t.returnValue=false;var i={cal:e(this).parent(),pos:e(this).offset()};i.preview=i.cal.data("colpick").livePreview;e(document).on("mouseup touchend",i,C);e(document).on("mousemove touchmove",i,k);var n,a;if("touchstart"==t.type)pageX=t.originalEvent.changedTouches[0].pageX,a=t.originalEvent.changedTouches[0].pageY;else{pageX=t.pageX;a=t.pageY}var r=4;h.apply(i.cal.data("colpick").fields.eq(r+1).val(parseInt(100*(i.cal.data("colpick").height-(a-i.pos.top))/i.cal.data("colpick").height,10)).end().eq(r).val(parseInt(100*(pageX-i.pos.left)/i.cal.data("colpick").height,10)).get(0),[i.preview]);return false},k=function(e){var t,i;if("touchmove"==e.type)pageX=e.originalEvent.changedTouches[0].pageX,i=e.originalEvent.changedTouches[0].pageY;else{pageX=e.pageX;i=e.pageY}var n=4;h.apply(e.data.cal.data("colpick").fields.eq(n+1).val(parseInt(100*(e.data.cal.data("colpick").height-Math.max(0,Math.min(e.data.cal.data("colpick").height,i-e.data.pos.top)))/e.data.cal.data("colpick").height,10)).end().eq(n).val(parseInt(100*Math.max(0,Math.min(e.data.cal.data("colpick").height,pageX-e.data.pos.left))/e.data.cal.data("colpick").height,10)).get(0),[e.data.preview]);return false},C=function(t){o(t.data.cal.data("colpick").color,t.data.cal.get(0));d(t.data.cal.data("colpick").color,t.data.cal.get(0));e(document).off("mouseup touchend",C);e(document).off("mousemove touchmove",k);return false},x=function(t){var i=e(this).parents(".colpick");var n=i.data("colpick").color;i.data("colpick").origColor=n;m(n,i.get(0));i.data("colpick").onSubmit(n,l(n),s(n),i.data("colpick").el)},I=function(t){t&&t.stopPropagation();var i=e("#"+e(this).data("colpickId"));i.data("colpick").onBeforeShow.apply(this,[i.get(0)]);var n=e(this).offset();var a=n.top+this.offsetHeight;var r=n.left;var s=E();var o=i.width();r+o>s.l+s.w&&(r-=o);i.css({left:r+"px",top:a+"px"});false!=i.data("colpick").onShow.apply(this,[i.get(0)])&&i.addClass("visible");e("html").mousedown({cal:i},M);i.mousedown(function(e){e.stopPropagation()})},M=function(t){false!=t.data.cal.data("colpick").onHide.apply(this,[t.data.cal.get(0)])&&t.data.cal.removeClass("visible");e("html").off("mousedown",M)},E=function(){var e="CSS1Compat"==document.compatMode;return{l:window.pageXOffset||(e?document.documentElement.scrollLeft:document.body.scrollLeft),w:window.innerWidth||(e?document.documentElement.clientWidth:document.body.clientWidth)}},B=function(e){return{h:Math.min(360,Math.max(0,e.h)),s:Math.min(100,Math.max(0,e.s)),b:Math.min(100,Math.max(0,e.b))}},P=function(e){return{r:Math.min(255,Math.max(0,e.r)),g:Math.min(255,Math.max(0,e.g)),b:Math.min(255,Math.max(0,e.b))}},U=function(e){var t=6-e.length;if(t>0){var i=[];for(var n=0;n<t;n++)i.push("0");i.push(e);e=i.join("")}return e},D=function(){var t=e(this).parent();var i=t.data("colpick").origColor;t.data("colpick").color=i;o(i,t.get(0));d(i,t.get(0));c(i,t.get(0));u(i,t.get(0));_(i,t.get(0));f(i,t.get(0))};return{init:function(s){s=e.extend({},n,s||{});if("string"==typeof s.color)s.color=a(s.color);else if(void 0!=s.color.r&&void 0!=s.color.g&&void 0!=s.color.b)s.color=r(s.color);else{if(void 0==s.color.h||void 0==s.color.s||void 0==s.color.b)return this;s.color=B(s.color)}var l=t;if(s.swatches&&Array.isArray(s.swatches)){var S="",v;for(i=0;i<s.swatches.length;i++){v=s.swatches[i];/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(v)&&(S+='<div class="colpick_swatch" style="background-color: '+v+';" data-swatch-color="'+v+'"></div>')}if(S){S='<div class="colpick_swatches">'+S+"</div>";l=t.slice(0,-6)+S+"</div>"}}return this.each(function(){if(!e(this).data("colpickId")){var t=e.extend({},s);t.origColor=s.color;var i="collorpicker_"+parseInt(1e3*Math.random());e(this).data("colpickId",i);var n=e(l).attr("id",i);n.addClass("colpick_"+t.layout+(t.submit?"":" colpick_"+t.layout+"_ns"));"light"!=t.colorScheme&&n.addClass("colpick_"+t.colorScheme);n.find("div.colpick_submit").html(t.submitText).click(x);t.fields=n.find("input").change(h).blur(p).focus(g);n.find("div.colpick_field_arrs").mousedown(T).end().find("div.colpick_current_color").click(D);t.swatches=n.find(".colpick_swatch").click(h);t.selector=n.find("div.colpick_color").on("mousedown touchstart",A);t.selectorIndic=t.selector.find("div.colpick_selector_outer");t.el=this;t.hue=n.find("div.colpick_hue_arrs");huebar=t.hue.parent();var a=navigator.userAgent.toLowerCase();var r="Microsoft Internet Explorer"===navigator.appName;var S=r?parseFloat(a.match(/msie ([0-9]{1,}[\.0-9]{0,})/)[1]):0;var v=r&&S<10;var w=["#ff0000","#ff0080","#ff00ff","#8000ff","#0000ff","#0080ff","#00ffff","#00ff80","#00ff00","#80ff00","#ffff00","#ff8000","#ff0000"];if(v){var y,k;for(y=0;y<=11;y++){k=e("<div></div>").attr("style","height:8.333333%; filter:progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr="+w[y]+", endColorstr="+w[y+1]+'); -ms-filter: "progid:DXImageTransform.Microsoft.gradient(GradientType=0,startColorstr='+w[y]+", endColorstr="+w[y+1]+')";');huebar.append(k)}}else{stopList=w.join(",");huebar.attr("style","background:-webkit-linear-gradient(top,"+stopList+"); background: -o-linear-gradient(top,"+stopList+"); background: -ms-linear-gradient(top,"+stopList+"); background:-moz-linear-gradient(top,"+stopList+"); -webkit-linear-gradient(top,"+stopList+"); background:linear-gradient(to bottom,"+stopList+"); ")}n.find("div.colpick_hue").on("mousedown touchstart",b);t.newColor=n.find("div.colpick_new_color");t.currentColor=n.find("div.colpick_current_color");n.data("colpick",t);o(t.color,n.get(0));c(t.color,n.get(0));d(t.color,n.get(0));_(t.color,n.get(0));u(t.color,n.get(0));m(t.color,n.get(0));f(t.color,n.get(0));if(t.flat){n.appendTo(this).show();var C={position:"relative"};C.display="flex";n.css(C)}else{n.appendTo(document.body);e(this).on(t.showEvent,I);n.css({position:"absolute"})}}})},showPicker:function(){return this.each(function(){e(this).data("colpickId")&&I.apply(this)})},hidePicker:function(){return this.each(function(){e(this).data("colpickId")&&e("#"+e(this).data("colpickId")).hide()})},setColor:function(t,i){i="undefined"===typeof i?1:i;if("string"==typeof t)t=a(t);else if(void 0!=t.r&&void 0!=t.g&&void 0!=t.b)t=r(t);else{if(void 0==t.h||void 0==t.s||void 0==t.b)return this;t=B(t)}return this.each(function(){if(e(this).data("colpickId")){var n=e("#"+e(this).data("colpickId"));n.data("colpick").color=t;n.data("colpick").origColor=t;o(t,n.get(0));c(t,n.get(0));d(t,n.get(0));_(t,n.get(0));u(t,n.get(0));f(t,n.get(0));n.data("colpick").onChange.apply(n.parent(),[t,l(t),s(t),n.data("colpick").el,1]);i&&m(t,n.get(0))}})}}}();var n=function(e){var e=parseInt(e.indexOf("#")>-1?e.substring(1):e,16);return{r:e>>16,g:(65280&e)>>8,b:255&e}};var a=function(e){return r(n(e))};var r=function(e){var t={h:0,s:0,b:0};var i=Math.min(e.r,e.g,e.b);var n=Math.max(e.r,e.g,e.b);var a=n-i;t.b=n;t.s=0!=n?255*a/n:0;0!=t.s?e.r==n?t.h=(e.g-e.b)/a:e.g==n?t.h=2+(e.b-e.r)/a:t.h=4+(e.r-e.g)/a:t.h=-1;t.h*=60;t.h<0&&(t.h+=360);t.s*=100/255;t.b*=100/255;return t};var s=function(e){var t={};var i=e.h;var n=255*e.s/100;var a=255*e.b/100;if(0==n)t.r=t.g=t.b=a;else{var r=a;var s=(255-n)*a/255;var o=i%60*(r-s)/60;360==i&&(i=0);if(i<60){t.r=r;t.b=s;t.g=s+o}else if(i<120){t.g=r;t.b=s;t.r=r-o}else if(i<180){t.g=r;t.r=s;t.b=s+o}else if(i<240){t.b=r;t.r=s;t.g=r-o}else if(i<300){t.b=r;t.g=s;t.r=s+o}else if(i<360){t.r=r;t.g=s;t.b=r-o}else{t.r=0;t.g=0;t.b=0}}return{r:Math.round(t.r),g:Math.round(t.g),b:Math.round(t.b)}};var o=function(t){var i=[t.r.toString(16),t.g.toString(16),t.b.toString(16)];e.each(i,function(e,t){1==t.length&&(i[e]="0"+t)});return i.join("")};var l=function(e){return o(s(e))};e.fn.extend({colpick:t.init,colpickHide:t.hidePicker,colpickShow:t.showPicker,colpickSetColor:t.setColor});e.extend({colpick:{rgbToHex:o,rgbToHsb:r,hsbToHex:l,hsbToRgb:s,hexToHsb:a,hexToRgb:n}})})(jQuery)},109:function(e,t,i){var n=i(46);var a="__core-js_shared__";var r=n[a]||(n[a]={});e.exports=function(e){return r[e]||(r[e]={})}},110:function(e,t){e.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},111:function(e,t){t.f={}.propertyIsEnumerable},114:function(e,t){var i={}.toString;e.exports=function(e){return i.call(e).slice(8,-1)}},115:function(e,t,i){var n=i(68);e.exports=function(e,t){if(!n(e))return e;var i,a;if(t&&"function"==typeof(i=e.toString)&&!n(a=i.call(e)))return a;if("function"==typeof(i=e.valueOf)&&!n(a=i.call(e)))return a;if(!t&&"function"==typeof(i=e.toString)&&!n(a=i.call(e)))return a;throw TypeError("Can't convert object to primitive value")}},119:function(e,t,i){var n=i(58).f;var a=i(60);var r=i(43)("toStringTag");e.exports=function(e,t,i){e&&!a(e=i?e:e.prototype,r)&&n(e,r,{configurable:true,value:t})}},120:function(e,t,i){var n=i(96);e.exports=function(e){return Object(n(e))}},125:function(e,t,i){"use strict";var n=i(208)(true);i(155)(String,"String",function(e){this._t=String(e);this._i=0},function(){var e=this._t;var t=this._i;var i;if(t>=e.length)return{value:void 0,done:true};i=n(e,t);this._i+=i.length;return{value:i,done:false}})},126:function(e,t,i){var n=i(68);var a=i(46).document;var r=n(a)&&n(a.createElement);e.exports=function(e){return r?a.createElement(e):{}}},127:function(e,t){e.exports=true},132:function(e,t){t.f=Object.getOwnPropertySymbols},133:function(e,t,i){var n=i(114);e.exports=Object("z").propertyIsEnumerable(0)?Object:function(e){return"String"==n(e)?e.split(""):Object(e)}},1356:function(e,t){(function(){TS.registerModule("files.media",{INLINE_VIDEO_CLASS_NAME:"inline_video",COUNT_LABEL_MOV_CANPLAY:"inline_mov_canplay",COUNT_LABEL_MOV_ERROR:"inline_mov_error",bindVideoElements:function t(i){var n=$(_.get(i,"container","body"));var a=_.get(i,"onCanplay",_.noop);var r=_.get(i,"onError",_.noop);n[0].addEventListener("canplay",function(t){var i=$(t.target);if(i.hasClass(TS.files.media.INLINE_VIDEO_CLASS_NAME)){e(i,TS.files.media.COUNT_LABEL_MOV_CANPLAY);a(i)}},true);n[0].addEventListener("error",function(t){var i=$(t.target);if(i.hasClass(TS.files.media.INLINE_VIDEO_CLASS_NAME)){e(i,TS.files.media.COUNT_LABEL_MOV_ERROR);r(i)}},true);n[0].addEventListener("play",function(e){var t=$(e.target);var i=t.closest("ts-message");var n=""+i.data("ts");var a=i.data("model-ob-id");var r=i.data("member-id");var s=i.data("app-id");var o=i.data("bot-id");var l=i.find(".msg_inline_video_new_window_button");var c=l.data("referer-original-href");var d=c||l.attr("href");var u={message_timestamp:n,channel_id:a,channel_type:a?a.charAt(0):"",member_id:r,app_id:s,bot_id:o,url:d||""};TS.interop.clog.track("MSG_VIDEO_PLAY",u)},true);n.find("."+TS.files.media.INLINE_VIDEO_CLASS_NAME).each(function(){var e=$(this);this.readyState>=HTMLVideoElement.HAVE_CURRENT_DATA?a(e):this.error&&r(e)})},test:function e(){return{_isSrcMov:t}}});var e=function e(i,n){t(i.attr("src"))&&TS.metrics.count(n)};var t=function e(t){return _.isString(t)&&"mov"===_.last(t.split(".")).toLowerCase()}})()},136:function(e,t,i){e.exports=!i(56)&&!i(73)(function(){return 7!=Object.defineProperty(i(126)("div"),"a",{get:function(){return 7}}).a})},1360:function(e,t,i){(function(t){e.exports=t["TimezoneDetector"]=i(1361)}).call(this,i(49))},1361:function(e,t,i){"use strict";(function(i){window.timezones_list=function(e){var t=new TimezoneDetector;return t.getList(e)};window.timezones_guess=function(){var e=new TimezoneDetector;var t={};arguments.length>0&&(t.default=arguments[0]);var i=e.detect(t);return i.zoneId};(function(){var i=this;var n=i.TimezoneDetector;var a=function(){var e=this;e.getList=function(e){if("fr-FR"==e)return r;if("es-ES"==e)return s;if("de-DE"==e)return o;if("ja-JP"==e)return l;if("en-GB"==e)return c;if("es-LA"==e)return d;if("pt-BR"==e)return u;return a};e.detect=function(e){var n={zoneId:"America/Los_Angeles",method:"gave_up"};if(e&&e.default){n.zoneId=e.default;n.method="default"}n.intl=t();var r=n.intl.zoneId;if(r){for(var s=0;s<a.length;s++)if(a[s][1]==r){n.zoneId=r;n.method="intlapi_exact";return n}if(_[r]){n.zoneId=_[r];n.method="intl_api_manual";return n}if(m[r]){n.zoneId=m[r];n.method="intl_api_equivalent";return n}if(f[r]){n.zoneId=f[r];n.method="intl_api_fallback";return n}}n.probe=i();if(n.probe.zoneId){n.zoneId=n.probe.zoneId;n.method="date_probe";return n}return n};var t=function(){var e={zoneId:null,hasIntl:false,hasDateTime:false,hasOptions:false};try{if("undefined"===typeof Intl)return e;e.hasIntl=true;if("undefined"===typeof Intl.DateTimeFormat)return e;var t=Intl.DateTimeFormat();if("undefined"===typeof t)return e;e.hasDateTime=true;if("undefined"===typeof t.resolvedOptions)return e;e.hasOptions=true;e.zoneId=t.resolvedOptions().timeZone}catch(t){return e}return e};var i=function(){var e=[];e.push(-1*new Date(Date.UTC(2008,10,27,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2010,4,30,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2001,10,28,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2002,4,7,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2004,10,3,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2011,11,7,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2012,11,10,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2015,9,22,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2015,11,2,0,0,0,0)).getTimezoneOffset());e.push(-1*new Date(Date.UTC(2016,3,27,0,0,0,0)).getTimezoneOffset());for(var t=1;t<=e.length;t++){var i=e.slice(0,t).join(":");if(n[i])return{zoneId:n[i],probeKey:i,fullKey:e.join(":")}}return{zoneId:null,fullKey:e.join(":")}};var n={"-660:-660:-660:-660:-660:-660":"Pacific/Midway","-540":"America/Adak","-600":"Pacific/Honolulu","-570":"Pacific/Marquesas","-480:-480":"America/Anchorage","-480:-420":"America/Tijuana","-420:-420:-420:-480":"America/Los_Angeles","-420:-420:-420:-420":"America/Phoenix","-420:-360":"America/Chihuahua","-360:-360:-360:-420":"America/Denver","-360:-360:-360:-360":"America/Regina","-300:-300:-300:-360":"America/Chicago","-300:-360":"Pacific/Easter","-360:-300:-360:-360:-300:-360:-360:-300:-360":"America/Mexico_City","-300:-300:-300:-300:-300:-300:-300:-300":"America/Bogota","-360:-300:-360:-360:-300:-360:-360:-300:-300":"America/Cancun","-240:-240:-240:-300:-240:-300:-300:-240:-300":"America/New_York","-300:-300:-300:-300:-300:-300:-300:-240":"America/Port-au-Prince","-300:-240":"America/Havana","-240:-240:-300":"America/Indiana/Indianapolis","-180:-240:-180:-180":"America/Asuncion","-180:-180:-180:-240":"America/Halifax","-270":"America/Caracas","-180:-240:-180:-240:-240:-180:-180:-240":"America/Cuiaba","-240:-240:-240:-240":"America/Manaus","-180:-240:-180:-240:-240:-180:-180:-180":"America/Santiago","-240:-240:-240:-300:-240:-300:-300:-240:-240":"America/Grand_Turk","-150":"America/St_Johns","-180:-180:-120:-180:-180:-180":"America/Fortaleza","-120:-180:-120":"America/Sao_Paulo","-180:-180:-180:-180":"America/Cayenne","-120:-180:-180:-180:-180":"America/Buenos_Aires","-180:-120":"America/Godthab","-120:-180:-180:-180:-120":"America/Montevideo","-120:-120:-120":"America/Miquelon","-180:-180:-120:-180:-180:-120":"America/Bahia","-120:-120:-60":"America/Noronha","-60:0":"Atlantic/Azores","-60:-60":"Atlantic/Cape_Verde","0:0:0:0:0:0:0:60":"Africa/Casablanca","0:60":"Europe/London","0:0:0:0:0:0:0:0":"Africa/Monrovia","60:120":"Europe/Amsterdam","60:60":"Africa/Algiers","120:60":"Africa/Windhoek","180:180:120:180:180":"Asia/Amman","120:180:180":"Europe/Athens","120:180:120:180:180:120:120:180:120":"Asia/Beirut","120:180:120:120:120:120:120:120":"Africa/Cairo","180:180:120:180:120":"Asia/Damascus","120:180:120:120:120:120:120:180":"Asia/Gaza","120:120:120:120:120:120:120":"Africa/Harare","120:180:120:180:120":"Asia/Jerusalem","120:180:120:180:180:180:180:120":"Europe/Kaliningrad","120:120:120:120:120:120:60":"Africa/Tripoli","180:180:180:240":"Asia/Baghdad","120:180:120:180:180:120:120:180:180":"Asia/Istanbul","180:180:180:180":"Asia/Kuwait","120:180:120:180:180:180:180:180":"Europe/Minsk","180:240:180:240:240:240:240:180:180:180":"Europe/Moscow",210:"Asia/Tehran","240:240:240:240":"Asia/Muscat","180:240:180:240:240:240:240:180:180:240":"Europe/Astrakhan","240:300:240:300:300:240:240:300":"Asia/Baku","240:240:240:300:300":"Europe/Samara","300:240":"Indian/Mauritius","240:240:240:300:240":"Asia/Tbilisi","240:300:240:300:300:240:240:240":"Asia/Yerevan",270:"Asia/Kabul","300:300":"Asia/Tashkent","300:360":"Asia/Yekaterinburg","360:300":"Asia/Karachi","330:330:330":"Asia/Kolkata","330:330:360":"Asia/Colombo",345:"Asia/Katmandu","360:360:360:420":"Asia/Almaty","360:360:360:360":"Asia/Dhaka",390:"Asia/Rangoon","360:420:360:420:420:420:420:360:360:360":"Asia/Novosibirsk","420:420:420:420":"Asia/Bangkok","360:420:360:420:420:420:420:360:360:420":"Asia/Barnaul","420:420:420:480":"Asia/Hovd","420:480":"Asia/Krasnoyarsk","360:420:420":"Asia/Tomsk","480:480:480:480":"Asia/Chongqing","480:540":"Asia/Irkutsk","540:480":"Australia/Perth","480:480:480:540":"Asia/Ulaanbaatar","540:540:540:540:540:540:540:510":"Asia/Pyongyang",585:"Australia/Eucla","540:600:540:600:600:600:600:480":"Asia/Chita","540:540:540:540:540:540:540:540":"Asia/Tokyo","540:600:540:600:600:600:600:540":"Asia/Yakutsk",630:"Australia/Adelaide",570:"Australia/Darwin","600:600:600:600:600:600:600:600":"Australia/Brisbane","660:600:660:600:600":"Australia/Canberra","660:600:660:600:660":"Australia/Hobart","600:660:600:660:660:660:660:600:600:600":"Asia/Vladivostok","660:630":"Australia/Lord_Howe","600:600:600:600:600:600:600:660":"Pacific/Bougainville","660:720:660:720:720:720:720:660":"Asia/Srednekolymsk","660:720:660:720:720:720:720:600":"Asia/Magadan",690:"Pacific/Norfolk","600:660:600:660:660:660:660:600:600:660":"Asia/Sakhalin","660:660":"Pacific/Guadalcanal","720:720:720:780":"Asia/Anadyr","780:720":"Pacific/Auckland","720:720:720:720":"Pacific/Fiji",825:"Pacific/Chatham","780:780":"Pacific/Tongatapu","-660:-660:-660:-660:-660:-600":"Pacific/Apia",840:"Pacific/Kiritimati"};var a=[["(UTC-11:00) Midway Island, American Samoa","Pacific/Midway"],["(UTC-10:00) Aleutian Islands","America/Adak"],["(UTC-10:00) Hawaii","Pacific/Honolulu"],["(UTC-09:30) Marquesas Islands","Pacific/Marquesas"],["(UTC-09:00) Alaska","America/Anchorage"],["(UTC-08:00) Baja California","America/Tijuana"],["(UTC-08:00) Pacific Time (US and Canada)","America/Los_Angeles"],["(UTC-07:00) Arizona","America/Phoenix"],["(UTC-07:00) Chihuahua, La Paz, Mazatlan","America/Chihuahua"],["(UTC-07:00) Mountain Time (US and Canada)","America/Denver"],["(UTC-06:00) Central America","America/Belize"],["(UTC-06:00) Central Time (US and Canada)","America/Chicago"],["(UTC-06:00) Easter Island","Pacific/Easter"],["(UTC-06:00) Guadalajara, Mexico City, Monterrey","America/Mexico_City"],["(UTC-06:00) Saskatchewan","America/Regina"],["(UTC-05:00) Bogota, Lima, Quito","America/Bogota"],["(UTC-05:00) Chetumal","America/Cancun"],["(UTC-05:00) Eastern Time (US and Canada)","America/New_York"],["(UTC-05:00) Haiti","America/Port-au-Prince"],["(UTC-05:00) Havana","America/Havana"],["(UTC-05:00) Indiana (East)","America/Indiana/Indianapolis"],["(UTC-04:00) Asuncion","America/Asuncion"],["(UTC-04:00) Atlantic Time (Canada)","America/Halifax"],["(UTC-04:00) Caracas","America/Caracas"],["(UTC-04:00) Cuiaba","America/Cuiaba"],["(UTC-04:00) Georgetown, La Paz, Manaus, San Juan","America/Manaus"],["(UTC-04:00) Santiago","America/Santiago"],["(UTC-04:00) Turks and Caicos","America/Grand_Turk"],["(UTC-03:30) Newfoundland","America/St_Johns"],["(UTC-03:00) Araguaina","America/Fortaleza"],["(UTC-03:00) Brasilia","America/Sao_Paulo"],["(UTC-03:00) Cayenne, Fortaleza","America/Cayenne"],["(UTC-03:00) City of Buenos Aires","America/Buenos_Aires"],["(UTC-03:00) Greenland","America/Godthab"],["(UTC-03:00) Montevideo","America/Montevideo"],["(UTC-03:00) Saint Pierre and Miquelon","America/Miquelon"],["(UTC-03:00) Salvador","America/Bahia"],["(UTC-02:00) Fernando de Noronha","America/Noronha"],["(UTC-01:00) Azores","Atlantic/Azores"],["(UTC-01:00) Cabo Verde Islands","Atlantic/Cape_Verde"],["(UTC) Casablanca","Africa/Casablanca"],["(UTC) Dublin, Edinburgh, Lisbon, London","Europe/London"],["(UTC) Monrovia, Reykjavik","Africa/Monrovia"],["(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna","Europe/Amsterdam"],["(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague","Europe/Belgrade"],["(UTC+01:00) Brussels, Copenhagen, Madrid, Paris","Europe/Brussels"],["(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb","Europe/Warsaw"],["(UTC+01:00) West Central Africa","Africa/Algiers"],["(UTC+01:00) Windhoek","Africa/Windhoek"],["(UTC+02:00) Amman","Asia/Amman"],["(UTC+02:00) Athens, Bucharest","Europe/Athens"],["(UTC+02:00) Beirut","Asia/Beirut"],["(UTC+02:00) Cairo","Africa/Cairo"],["(UTC+02:00) Damascus","Asia/Damascus"],["(UTC+02:00) Gaza, Hebron","Asia/Gaza"],["(UTC+02:00) Harare, Pretoria","Africa/Harare"],["(UTC+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius","Europe/Helsinki"],["(UTC+02:00) Jerusalem","Asia/Jerusalem"],["(UTC+02:00) Kaliningrad","Europe/Kaliningrad"],["(UTC+02:00) Tripoli","Africa/Tripoli"],["(UTC+03:00) Baghdad","Asia/Baghdad"],["(UTC+03:00) Istanbul","Asia/Istanbul"],["(UTC+03:00) Kuwait, Riyadh","Asia/Kuwait"],["(UTC+03:00) Minsk","Europe/Minsk"],["(UTC+03:00) Moscow, St. Petersburg, Volgograd","Europe/Moscow"],["(UTC+03:00) Nairobi","Africa/Nairobi"],["(UTC+03:30) Tehran","Asia/Tehran"],["(UTC+04:00) Abu Dhabi, Muscat","Asia/Muscat"],["(UTC+04:00) Astrakhan, Ulyanovsk","Europe/Astrakhan"],["(UTC+04:00) Baku","Asia/Baku"],["(UTC+04:00) Izhevsk, Samara","Europe/Samara"],["(UTC+04:00) Port Louis","Indian/Mauritius"],["(UTC+04:00) Tbilisi","Asia/Tbilisi"],["(UTC+04:00) Yerevan","Asia/Yerevan"],["(UTC+04:30) Kabul","Asia/Kabul"],["(UTC+05:00) Tashkent, Ashgabat","Asia/Tashkent"],["(UTC+05:00) Ekaterinburg","Asia/Yekaterinburg"],["(UTC+05:00) Islamabad, Karachi","Asia/Karachi"],["(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi","Asia/Kolkata"],["(UTC+05:30) Sri Jayawardenepura","Asia/Colombo"],["(UTC+05:45) Kathmandu","Asia/Katmandu"],["(UTC+06:00) Astana","Asia/Almaty"],["(UTC+06:00) Dhaka","Asia/Dhaka"],["(UTC+06:30) Yangon (Rangoon)","Asia/Rangoon"],["(UTC+07:00) Novosibirsk","Asia/Novosibirsk"],["(UTC+07:00) Bangkok, Hanoi, Jakarta","Asia/Bangkok"],["(UTC+07:00) Barnaul, Gorno-Altaysk","Asia/Barnaul"],["(UTC+07:00) Hovd","Asia/Hovd"],["(UTC+07:00) Krasnoyarsk","Asia/Krasnoyarsk"],["(UTC+07:00) Tomsk","Asia/Tomsk"],["(UTC+08:00) Beijing, Chongqing, Hong Kong SAR, Urumqi","Asia/Chongqing"],["(UTC+08:00) Irkutsk","Asia/Irkutsk"],["(UTC+08:00) Kuala Lumpur, Singapore","Asia/Kuala_Lumpur"],["(UTC+08:00) Perth","Australia/Perth"],["(UTC+08:00) Taipei","Asia/Taipei"],["(UTC+08:00) Ulaanbaatar","Asia/Ulaanbaatar"],["(UTC+08:30) Pyongyang","Asia/Pyongyang"],["(UTC+08:45) Eucla","Australia/Eucla"],["(UTC+09:00) Chita","Asia/Chita"],["(UTC+09:00) Osaka, Sapporo, Tokyo","Asia/Tokyo"],["(UTC+09:00) Seoul","Asia/Seoul"],["(UTC+09:00) Yakutsk","Asia/Yakutsk"],["(UTC+09:30) Adelaide","Australia/Adelaide"],["(UTC+09:30) Darwin","Australia/Darwin"],["(UTC+10:00) Brisbane","Australia/Brisbane"],["(UTC+10:00) Canberra, Melbourne, Sydney","Australia/Canberra"],["(UTC+10:00) Guam, Port Moresby","Pacific/Guam"],["(UTC+10:00) Hobart","Australia/Hobart"],["(UTC+10:00) Vladivostok","Asia/Vladivostok"],["(UTC+10:30) Lord Howe Island","Australia/Lord_Howe"],["(UTC+11:00) Bougainville Island","Pacific/Bougainville"],["(UTC+11:00) Chokirdakh","Asia/Srednekolymsk"],["(UTC+11:00) Magadan","Asia/Magadan"],["(UTC+11:00) Norfolk Island","Pacific/Norfolk"],["(UTC+11:00) Sakhalin","Asia/Sakhalin"],["(UTC+11:00) Solomon Islands, New Caledonia","Pacific/Guadalcanal"],["(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky","Asia/Anadyr"],["(UTC+12:00) Auckland, Wellington","Pacific/Auckland"],["(UTC+12:00) Fiji Islands","Pacific/Fiji"],["(UTC+12:45) Chatham Islands","Pacific/Chatham"],["(UTC+13:00) Nuku'alofa","Pacific/Tongatapu"],["(UTC+13:00) Samoa","Pacific/Apia"],["(UTC+14:00) Kiritimati Island","Pacific/Kiritimati"]];var r=[["(UTC-11:00) \xceles Midway, Samoa am\xe9ricaines, \xeele Jarvis, r\xe9cif Kingman et atoll Palmyra","Pacific/Midway"],["(UTC-10:00) \xceles Al\xe9outiennes","America/Adak"],["(UTC-10:00) Hawaii","Pacific/Honolulu"],["(UTC-09:30) \xceles Marquises","Pacific/Marquesas"],["(UTC-09:00) Alaska","America/Anchorage"],["(UTC-08:00) Basse Californie","America/Tijuana"],["(UTC-08:00) Pacifique (\xc9.-U. et Canada)","America/Los_Angeles"],["(UTC-07:00) Arizona","America/Phoenix"],["(UTC-07:00) Chihuahua, La Paz, Mazatlan","America/Chihuahua"],["(UTC-07:00) Montagnes Rocheuses (\xc9.-U. et Canada)","America/Denver"],["(UTC-06:00) Am\xe9rique centrale","America/Belize"],["(UTC-06:00) Centre (\xc9.-U. et Canada)","America/Chicago"],["(UTC-06:00) \xcele de P\xe2ques","Pacific/Easter"],["(UTC-06:00) Guadalajara, Mexico, Monterrey","America/Mexico_City"],["(UTC-06:00) Saskatchewan","America/Regina"],["(UTC-05:00) Bogota, Lima, Quito, Rio Branco","America/Bogota"],["(UTC-05:00) Chetumal","America/Cancun"],["(UTC-05:00) Est (\xc9.-U. et Canada)","America/New_York"],["(UTC-05:00) Ha\xefti","America/Port-au-Prince"],["(UTC-05:00) Havane (La)","America/Havana"],["(UTC-05:00) Indiana (Est)","America/Indiana/Indianapolis"],["(UTC-04:00) Asunci\xf3n","America/Asuncion"],["(UTC-04:00) Heure Atlantique (Canada)","America/Halifax"],["(UTC-04:00) Caracas","America/Caracas"],["(UTC-04:00) Cuiaba","America/Cuiaba"],["(UTC-04:00) Georgetown, La Paz, Manaus, San Juan","America/Manaus"],["(UTC-04:00) Santiago","America/Santiago"],["(UTC-04:00) \xceles Turques-et-Ca\xefques","America/Grand_Turk"],["(UTC-03:30) Terre-Neuve-et-Labrador","America/St_Johns"],["(UTC-03:00) Aragua\xedna","America/Fortaleza"],["(UTC-03:00) Brasilia","America/Sao_Paulo"],["(UTC-03:00) Cayenne, Fortaleza","America/Cayenne"],["(UTC-03:00) Buenos Aires","America/Buenos_Aires"],["(UTC-03:00) Groenland","America/Godthab"],["(UTC-03:00) Montevideo","America/Montevideo"],["(UTC-03:00) Saint-Pierre-et-Miquelon","America/Miquelon"],["(UTC-03:00) Salvador","America/Bahia"],["(UTC-02:00) Fernando de Noronha","America/Noronha"],["(UTC-01:00) Les A\xe7ores","Atlantic/Azores"],["(UTC-01:00) \xceles du Cap-Vert","Atlantic/Cape_Verde"],["(UTC) Casablanca","Africa/Casablanca"],["(UTC) Dublin, \xc9dimbourg, Lisbonne, Londres","Europe/London"],["(UTC) Monrovia, Reykjavik","Africa/Monrovia"],["(UTC+01:00) Amsterdam, Berlin, Berne, Rome, Stockholm, Vienne","Europe/Amsterdam"],["(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague","Europe/Belgrade"],["(UTC+01:00) Bruxelles, Copenhague, Madrid, Paris","Europe/Brussels"],["(UTC+01:00) Sarajevo, Skopje, Varsovie, Zagreb","Europe/Warsaw"],["(UTC+01:00) Afrique centrale - Ouest","Africa/Algiers"],["(UTC+01:00) Windhoek","Africa/Windhoek"],["(UTC+02:00) Amman","Asia/Amman"],["(UTC+02:00) Ath\xe8nes, Bucarest","Europe/Athens"],["(UTC+02:00) Beyrouth","Asia/Beirut"],["(UTC+02:00) Le Caire","Africa/Cairo"],["(UTC+02:00) Damas","Asia/Damascus"],["(UTC+02:00) Gaza, H\xe9bron","Asia/Gaza"],["(UTC+02:00) Harare, Pretoria","Africa/Harare"],["(UTC+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius","Europe/Helsinki"],["(UTC+02:00) J\xe9rusalem","Asia/Jerusalem"],["(UTC+02:00) Kaliningrad","Europe/Kaliningrad"],["(UTC+02:00) Tripoli","Africa/Tripoli"],["(UTC+03:00) Bagdad","Asia/Baghdad"],["(UTC+03:00) Istanbul","Asia/Istanbul"],["(UTC+03:00) Kowe\xeft, Riyad","Asia/Kuwait"],["(UTC+03:00) Minsk","Europe/Minsk"],["(UTC+03:00) Moscou, Saint-P\xe9tersbourg, Volgograd","Europe/Moscow"],["(UTC+03:00) Nairobi","Africa/Nairobi"],["(UTC+03:30) T\xe9h\xe9ran","Asia/Tehran"],["(UTC+04:00) Abu Dhabi, Muscat","Asia/Muscat"],["(UTC+04:00) Astrakhan, Oulianovsk","Europe/Astrakhan"],["(UTC+04:00) Bakou","Asia/Baku"],["(UTC+04:00) Izhevsk, Samara","Europe/Samara"],["(UTC+04:00) Port Louis","Indian/Mauritius"],["(UTC+04:00) Tbilissi","Asia/Tbilisi"],["(UTC+04:00) Erevan","Asia/Yerevan"],["(UTC+04:30) Kaboul","Asia/Kabul"],["(UTC+05:00) Achgabat, Tachkent","Asia/Tashkent"],["(UTC+05:00) Iekaterinbourg","Asia/Yekaterinburg"],["(UTC+05:00) Islamabad, Karachi","Asia/Karachi"],["(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi","Asia/Kolkata"],["(UTC+05:30) Sri Jayawardenepura","Asia/Colombo"],["(UTC+05:45) Katmandou","Asia/Katmandu"],["(UTC+06:00) Astana","Asia/Almaty"],["(UTC+06:00) Dhaka","Asia/Dhaka"],["(UTC+06:30) Rangoon","Asia/Rangoon"],["(UTC+07:00) Novosibirsk","Asia/Novosibirsk"],["(UTC+07:00) Bangkok, Hanoi, Djakarta","Asia/Bangkok"],["(UTC+07:00) Barnaoul, Gorno-Alta\xefsk","Asia/Barnaul"],["(UTC+07:00) Hovd","Asia/Hovd"],["(UTC+07:00) Krasno\xefarsk","Asia/Krasnoyarsk"],["(UTC+07:00) Tomsk","Asia/Tomsk"],["(UTC+08:00) Beijing, Chongqing, Hong Kong, Urumqi","Asia/Chongqing"],["(UTC+08:00) Irkoutsk","Asia/Irkutsk"],["(UTC+08:00) Kuala Lumpur, Singapour","Asia/Kuala_Lumpur"],["(UTC+08:00) Perth","Australia/Perth"],["(UTC+08:00) Taipei","Asia/Taipei"],["(UTC+08:00) Oulan-Bator","Asia/Ulaanbaatar"],["(UTC+08:30) Pyongyang","Asia/Pyongyang"],["(UTC+08:45) Eucla","Australia/Eucla"],["(UTC+09:00) Chita","Asia/Chita"],["(UTC+09:00) Osaka, Sapporo, Tokyo","Asia/Tokyo"],["(UTC+09:00) S\xe9oul","Asia/Seoul"],["(UTC+09:00) Iakoutsk","Asia/Yakutsk"],["(UTC+09:30) Ad\xe9la\xefde","Australia/Adelaide"],["(UTC+09:30) Darwin","Australia/Darwin"],["(UTC+10:00) Brisbane","Australia/Brisbane"],["(UTC+10:00) Canberra, Melbourne, Sydney","Australia/Canberra"],["(UTC+10:00) Guam, Port Moresby","Pacific/Guam"],["(UTC+10:00) Hobart","Australia/Hobart"],["(UTC+10:00) Vladivostok","Asia/Vladivostok"],["(UTC+10:30) \xcele Lord Howe","Australia/Lord_Howe"],["(UTC+11:00) \xcele Bougainville","Pacific/Bougainville"],["(UTC+11:00) Chokurdakh","Asia/Srednekolymsk"],["(UTC+11:00) Magadan","Asia/Magadan"],["(UTC+11:00) \xcele Norfolk","Pacific/Norfolk"],["(UTC+11:00) Sakhaline","Asia/Sakhalin"],["(UTC+11:00) \xceles Salomon, Nouvelle-Cal\xe9donie","Pacific/Guadalcanal"],["(UTC+12:00) Anadyr, Petropavlovsk-Kamtchatski","Asia/Anadyr"],["(UTC+12:00) Auckland, Wellington","Pacific/Auckland"],["(UTC+12:00) Fidji","Pacific/Fiji"],["(UTC+12:45) \xceles Chatham","Pacific/Chatham"],["(UTC+13:00) Nuku\u2019alofa","Pacific/Tongatapu"],["(UTC+13:00) Samoa","Pacific/Apia"],["(UTC+14:00) Kiritimati, \xcele","Pacific/Kiritimati"]];var s=[["(UTC-11:00) Islas Midway, Samoa Americana","Pacific/Midway"],["(UTC-10:00) Islas Aleutianas","America/Adak"],["(UTC-10:00) Hawai","Pacific/Honolulu"],["(UTC-09:30) Islas Marquesas","Pacific/Marquesas"],["(UTC-09:00) Alaska","America/Anchorage"],["(UTC-08:00) Baja California","America/Tijuana"],["(UTC-08:00) Hora del Pac\xedfico (EE.UU. y Canad\xe1)","America/Los_Angeles"],["(UTC-07:00) Arizona","America/Phoenix"],["(UTC-07:00) Chihuahua, La Paz, Mazatl\xe1n","America/Chihuahua"],["(UTC-07:00) Hora de las Monta\xf1as Rocosas (EE.UU. y Canad\xe1)","America/Denver"],["(UTC-06:00) Am\xe9rica Central","America/Belize"],["(UTC-06:00) Hora central (EE.UU. y Canad\xe1)","America/Chicago"],["(UTC-06:00) Isla de Pascua","Pacific/Easter"],["(UTC-06:00) Guadalajara, Ciudad de M\xe9xico, Monterrey","America/Mexico_City"],["(UTC-06:00) Saskatchewan","America/Regina"],["(UTC-05:00) Bogot\xe1, Lima, Quito, Rio Branco","America/Bogota"],["(UTC-05:00) Chetumal","America/Cancun"],["(UTC-05:00) Hora del este (EE.UU. y Canad\xe1)","America/New_York"],["(UTC-05:00) Hait\xed","America/Port-au-Prince"],["(UTC-05:00) La Habana","America/Havana"],["(UTC-05:00) Indiana (este)","America/Indiana/Indianapolis"],["(UTC-04:00) Asunci\xf3n","America/Asuncion"],["(UTC-04:00) Hora del Atl\xe1ntico (Canad\xe1)","America/Halifax"],["(UTC-04:00) Caracas","America/Caracas"],["(UTC-04:00) Cuiab\xe1","America/Cuiaba"],["(UTC-04:00) Georgetown, La Paz, Manaos, San Juan","America/Manaus"],["(UTC-04:00) Santiago","America/Santiago"],["(UTC-04:00) Islas Turcas y Caicos","America/Grand_Turk"],["(UTC-03:30) Terranova","America/St_Johns"],["(UTC-03:00) Aragua\xedna","America/Fortaleza"],["(UTC-03:00) Brasilia","America/Sao_Paulo"],["(UTC-03:00) Cayena, Fortaleza","America/Cayenne"],["(UTC-03:00) Ciudad de Buenos Aires","America/Buenos_Aires"],["(UTC-03:00) Groenlandia","America/Godthab"],["(UTC-03:00) Montevideo","America/Montevideo"],["(UTC-03:00) San Pedro y Miquel\xf3n","America/Miquelon"],["(UTC-03:00) Salvador","America/Bahia"],["(UTC-02:00) Fernando de Noronha","America/Noronha"],["(UTC-01:00) Azores","Atlantic/Azores"],["(UTC-01:00) Cabo Verde","Atlantic/Cape_Verde"],["(UTC) Casablanca","Africa/Casablanca"],["(UTC) Dubl\xedn, Edimburgo, Lisboa, Londres","Europe/London"],["(UTC) Monrovia, Reikiavik","Africa/Monrovia"],["(UTC+01:00) Amsterdam, Berl\xedn, Berna, Roma, Estocolmo, Viena","Europe/Amsterdam"],["(UTC+01:00) Belgrado, Bratislava, Budapest, Liubliana, Praga","Europe/Belgrade"],["(UTC+01:00) Bruselas, Copenhague, Madrid, Par\xeds","Europe/Brussels"],["(UTC+01:00) Sarajevo, Skopie, Varsovia, Zagreb","Europe/Warsaw"],["(UTC+01:00) \xc1frica Central Occidental","Africa/Algiers"],["(UTC+01:00) Windhoek","Africa/Windhoek"],["(UTC+02:00) Amm\xe1n","Asia/Amman"],["(UTC+02:00) Atenas, Bucarest","Europe/Athens"],["(UTC+02:00) Beirut","Asia/Beirut"],["(UTC+02:00) El Cairo","Africa/Cairo"],["(UTC+02:00) Damasco","Asia/Damascus"],["(UTC+02:00) Gaza, Hebr\xf3n","Asia/Gaza"],["(UTC+02:00) Harare, Pretoria","Africa/Harare"],["(UTC+02:00) Helsinki, Kiev, Riga, Sof\xeda, Tallin, Vilna","Europe/Helsinki"],["(UTC+02:00) Jerusal\xe9n","Asia/Jerusalem"],["(UTC+02:00) Kaliningrado","Europe/Kaliningrad"],["(UTC+02:00) Tr\xedpoli","Africa/Tripoli"],["(UTC+03:00) Bagdad","Asia/Baghdad"],["(UTC+03:00) Estambul","Asia/Istanbul"],["(UTC+03:00) Kuwait, Riad","Asia/Kuwait"],["(UTC+03:00) Minsk","Europe/Minsk"],["(UTC+03:00) Mosc\xfa, San Petersburgo, Volgogrado","Europe/Moscow"],["(UTC+03:00) Nairobi","Africa/Nairobi"],["(UTC+03:30) Teher\xe1n","Asia/Tehran"],["(UTC+04:00) Abu Dabi, Mascate","Asia/Muscat"],["(UTC+04:00) Astrakhan, Ulyanovsk","Europe/Astrakhan"],["(UTC+04:00) Bak\xfa","Asia/Baku"],["(UTC+04:00) Izhevsk, Samara","Europe/Samara"],["(UTC+04:00) Port Louis","Indian/Mauritius"],["(UTC+04:00) Tiflis","Asia/Tbilisi"],["(UTC+04:00) Erev\xe1n","Asia/Yerevan"],["(UTC+04:30) Kabul","Asia/Kabul"],["(UTC+05:00) Asjabad, Tashkent","Asia/Tashkent"],["(UTC+05:00) Ekaterimburgo","Asia/Yekaterinburg"],["(UTC+05:00) Islamabad, Karachi","Asia/Karachi"],["(UTC+05:30) Chennai, Kolkata (Calcuta), Mumbai, Nueva Delhi","Asia/Kolkata"],["(UTC+05:30) Sri Jayawardenepura","Asia/Colombo"],["(UTC+05:45) Katmand\xfa","Asia/Katmandu"],["(UTC+06:00) Astan\xe1","Asia/Almaty"],["(UTC+06:00) Dacca","Asia/Dhaka"],["(UTC+06:30) Rang\xfan","Asia/Rangoon"],["(UTC+07:00) Novosibirsk","Asia/Novosibirsk"],["(UTC+07:00) Bangkok, Han\xf3i, Yakarta","Asia/Bangkok"],["(UTC+07:00) Barnaul, Gorno-Altaysk","Asia/Barnaul"],["(UTC+07:00) Hovd","Asia/Hovd"],["(UTC+07:00) Krasnoyarsk","Asia/Krasnoyarsk"],["(UTC+07:00) Tomsk","Asia/Tomsk"],["(UTC+08:00) Pek\xedn, Chongqing, Hong Kong, Urumqi","Asia/Chongqing"],["(UTC+08:00) Irkutsk","Asia/Irkutsk"],["(UTC+08:00) Kuala Lumpur, Singapur","Asia/Kuala_Lumpur"],["(UTC+08:00) Perth","Australia/Perth"],["(UTC+08:00) Taip\xe9i","Asia/Taipei"],["(UTC+08:00) Ul\xe1n Bator","Asia/Ulaanbaatar"],["(UTC+08:30) Pyongyang","Asia/Pyongyang"],["(UTC+08:45) Eucla","Australia/Eucla"],["(UTC+09:00) Chita","Asia/Chita"],["(UTC+09:00) Osaka, Sapporo, Tokio","Asia/Tokyo"],["(UTC+09:00) Se\xfal","Asia/Seoul"],["(UTC+09:00) Yakutsk","Asia/Yakutsk"],["(UTC+09:30) Adelaida","Australia/Adelaide"],["(UTC+09:30) Darwin","Australia/Darwin"],["(UTC+10:00) Brisbane","Australia/Brisbane"],["(UTC+10:00) Canberra, Melbourne, S\xeddney","Australia/Canberra"],["(UTC+10:00) Guam, Port Moresby","Pacific/Guam"],["(UTC+10:00) Hobart","Australia/Hobart"],["(UTC+10:00) Vladivostok","Asia/Vladivostok"],["(UTC+10:30) Isla Lord Howe","Australia/Lord_Howe"],["(UTC+11:00) Isla Bougainville","Pacific/Bougainville"],["(UTC+11:00) Chokurdakh","Asia/Srednekolymsk"],["(UTC+11:00) Magad\xe1n","Asia/Magadan"],["(UTC+11:00) Isla Norfolk","Pacific/Norfolk"],["(UTC+11:00) Sajal\xedn","Asia/Sakhalin"],["(UTC+11:00) Islas Salom\xf3n, Nueva Caledonia","Pacific/Guadalcanal"],["(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky","Asia/Anadyr"],["(UTC+12:00) Auckland, Wellington","Pacific/Auckland"],["(UTC+12:00) Fiyi","Pacific/Fiji"],["(UTC+12:45) Islas Chatham","Pacific/Chatham"],["(UTC+13:00) Nuku'alofa","Pacific/Tongatapu"],["(UTC+13:00) Samoa","Pacific/Apia"],["(UTC+14:00) Isla Kiritimati","Pacific/Kiritimati"]];var o=[["(UTC-11:00) Midwayinseln, Amerikanisch-Samoa","Pacific/Midway"],["(UTC-10:00) Aleuten-Inseln","America/Adak"],["(UTC-10:00) Hawaii","Pacific/Honolulu"],["(UTC-09:30) Marquesas-Inseln","Pacific/Marquesas"],["(UTC-09:00) Alaska","America/Anchorage"],["(UTC-08:00) Niederkalifornien","America/Tijuana"],["(UTC-08:00) Pacific Zeit (USA & Kanada)","America/Los_Angeles"],["(UTC-07:00) Arizona","America/Phoenix"],["(UTC-07:00) Chihuahua, La Paz, Mazatlan","America/Chihuahua"],["(UTC-07:00) Mountain Zeit (USA & Kanada)","America/Denver"],["(UTC-06:00) Mittelamerika","America/Belize"],["(UTC-06:00) Central Zeit (USA & Kanada)","America/Chicago"],["(UTC-06:00) Osterinsel","Pacific/Easter"],["(UTC-06:00) Guadalajara, Mexiko-Stadt, Monterrey","America/Mexico_City"],["(UTC-06:00) Saskatchewan","America/Regina"],["(UTC-05:00) Bogot\xe1, Lima, Quito, Rio Branco","America/Bogota"],["(UTC-05:00) Chetumal","America/Cancun"],["(UTC-05:00) Eastern Zeit (USA & Kanada)","America/New_York"],["(UTC-05:00) Haiti","America/Port-au-Prince"],["(UTC-05:00) Havanna","America/Havana"],["(UTC-05:00) Indiana (Ost)","America/Indiana/Indianapolis"],["(UTC-04:00) Asuncion","America/Asuncion"],["(UTC-04:00) Atlantic (Kanada)","America/Halifax"],["(UTC-04:00) Caracas","America/Caracas"],["(UTC-04:00) Cuiaba","America/Cuiaba"],["(UTC-04:00) Georgetown, La Paz, Manaus, San Juan","America/Manaus"],["(UTC-04:00) Santiago","America/Santiago"],["(UTC-04:00) Turks- und Caicosinseln","America/Grand_Turk"],["(UTC-03:30) Neufundland","America/St_Johns"],["(UTC-03:00) Aragua\xedna","America/Fortaleza"],["(UTC-03:00) Brasilia","America/Sao_Paulo"],["(UTC-03:00) Cayenne, Fortaleza","America/Cayenne"],["(UTC-03:00) Buenos Aires","America/Buenos_Aires"],["(UTC-03:00) Gr\xf6nland","America/Godthab"],["(UTC-03:00) Montevideo","America/Montevideo"],["(UTC-03:00) St. Pierre und Miquelon","America/Miquelon"],["(UTC-03:00) Salvador","America/Bahia"],["(UTC-02:00) Fernando de Noronha","America/Noronha"],["(UTC-01:00) Azoren","Atlantic/Azores"],["(UTC-01:00) Cabo Verde","Atlantic/Cape_Verde"],["(UTC) Casablanca","Africa/Casablanca"],["(UTC) Dublin, Edinburgh, Lissabon, London","Europe/London"],["(UTC) Monrovia, Reykjavik","Africa/Monrovia"],["(UTC+01:00) Amsterdam, Berlin, Bern, Rom, Stockholm, Wien","Europe/Amsterdam"],["(UTC+01:00) Belgrad, Bratislava (Pressburg), Budapest, Ljubljana, Prag","Europe/Belgrade"],["(UTC+01:00) Br\xfcssel, Kopenhagen, Madrid, Paris","Europe/Brussels"],["(UTC+01:00) Sarajevo, Skopje, Warschau, Zagreb","Europe/Warsaw"],["(UTC+01:00) West-Zentralafrika","Africa/Algiers"],["(UTC+01:00) Windhuk","Africa/Windhoek"],["(UTC+02:00) Amman","Asia/Amman"],["(UTC+02:00) Athen, Bukarest","Europe/Athens"],["(UTC+02:00) Beirut","Asia/Beirut"],["(UTC+02:00) Kairo","Africa/Cairo"],["(UTC+02:00) Damaskus","Asia/Damascus"],["(UTC+02:00) Gaza, Hebron","Asia/Gaza"],["(UTC+02:00) Harare, Pretoria","Africa/Harare"],["(UTC+02:00) Helsinki, Kiew, Riga, Sofia, Tallinn, Wilna","Europe/Helsinki"],["(UTC+02:00) Jerusalem","Asia/Jerusalem"],["(UTC+02:00) Kaliningrad","Europe/Kaliningrad"],["(UTC+02:00) Tripolis","Africa/Tripoli"],["(UTC+03:00) Bagdad","Asia/Baghdad"],["(UTC+03:00) Istanbul","Asia/Istanbul"],["(UTC+03:00) Kuwait, Riad","Asia/Kuwait"],["(UTC+03:00) Minsk","Europe/Minsk"],["(UTC+03:00) Moskau (Moskwa), St. Petersburg, Wolgograd","Europe/Moscow"],["(UTC+03:00) Nairobi","Africa/Nairobi"],["(UTC+03:30) Teheran","Asia/Tehran"],["(UTC+04:00) Abu Dhabi, Muskat","Asia/Muscat"],["(UTC+04:00) Astrachan, Uljanowsk","Europe/Astrakhan"],["(UTC+04:00) Baku","Asia/Baku"],["(UTC+04:00) Ischewsk, Samara","Europe/Samara"],["(UTC+04:00) Port Louis","Indian/Mauritius"],["(UTC+04:00) Tiflis","Asia/Tbilisi"],["(UTC+04:00) Eriwan","Asia/Yerevan"],["(UTC+04:30) Kabul","Asia/Kabul"],["(UTC+05:00) Aschgabat, Taschkent","Asia/Tashkent"],["(UTC+05:00) Jekaterinburg","Asia/Yekaterinburg"],["(UTC+05:00) Islamabad, Karatschi","Asia/Karachi"],["(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi","Asia/Kolkata"],["(UTC+05:30) Sri Jayawardenepura","Asia/Colombo"],["(UTC+05:45) Katmandu","Asia/Katmandu"],["(UTC+06:00) Astana","Asia/Almaty"],["(UTC+06:00) Dakka","Asia/Dhaka"],["(UTC+06:30) Yangon (Rangun)","Asia/Rangoon"],["(UTC+07:00) Nowosibirsk","Asia/Novosibirsk"],["(UTC+07:00) Bangkok, Hanoi, Jakarta","Asia/Bangkok"],["(UTC+07:00) Barnaul, Gorno-Altaisk","Asia/Barnaul"],["(UTC+07:00) Hovd","Asia/Hovd"],["(UTC+07:00) Krasnojarsk","Asia/Krasnoyarsk"],["(UTC+07:00) Tomsk","Asia/Tomsk"],["(UTC+08:00) Peking, Chongqing, Hongkong (SAR), Urumchi","Asia/Chongqing"],["(UTC+08:00) Irkutsk","Asia/Irkutsk"],["(UTC+08:00) Kuala Lumpur, Singapur","Asia/Kuala_Lumpur"],["(UTC+08:00) Perth","Australia/Perth"],["(UTC+08:00) Taipeh","Asia/Taipei"],["(UTC+08:00) Ulan-Bator","Asia/Ulaanbaatar"],["(UTC+08:30) Pj\xf6ngjang","Asia/Pyongyang"],["(UTC+08:45) Eucla","Australia/Eucla"],["(UTC+09:00) Chita","Asia/Chita"],["(UTC+09:00) Osaka, Sapporo, Tokio","Asia/Tokyo"],["(UTC+09:00) Seoul","Asia/Seoul"],["(UTC+09:00) Jakutsk","Asia/Yakutsk"],["(UTC+09:30) Adelaide","Australia/Adelaide"],["(UTC+09:30) Darwin","Australia/Darwin"],["(UTC+10:00) Brisbane","Australia/Brisbane"],["(UTC+10:00) Canberra, Melbourne, Sydney","Australia/Canberra"],["(UTC+10:00) Guam, Port Moresby","Pacific/Guam"],["(UTC+10:00) Hobart","Australia/Hobart"],["(UTC+10:00) Wladiwostok","Asia/Vladivostok"],["(UTC+10:30) Lord-Howe-Insel","Australia/Lord_Howe"],["(UTC+11:00) Bougainville-Insel","Pacific/Bougainville"],["(UTC+11:00) Tschokurdach","Asia/Srednekolymsk"],["(UTC+11:00) Magadan","Asia/Magadan"],["(UTC+11:00) Norfolkinsel","Pacific/Norfolk"],["(UTC+11:00) Sachalin","Asia/Sakhalin"],["(UTC+11:00) Salomonen, Neu-Kaledonien","Pacific/Guadalcanal"],["(UTC+12:00) Anadyr, Petropawlowsk-Kamtschatski","Asia/Anadyr"],["(UTC+12:00) Auckland, Wellington","Pacific/Auckland"],["(UTC+12:00) Fidschi","Pacific/Fiji"],["(UTC+12:45) Chatham-Inseln","Pacific/Chatham"],["(UTC+13:00) Nuku'alofa","Pacific/Tongatapu"],["(UTC+13:00) Samoa","Pacific/Apia"],["(UTC+14:00) Insel Kiritimati","Pacific/Kiritimati"]];var l=[["(UTC-11:00) \u30df\u30c3\u30c9\u30a6\u30a7\u30fc\u5cf6\u30fb\u30b5\u30e2\u30a2\u5cf6","Pacific/Midway"],["(UTC-10:00) \u30a2\u30ea\u30e5\u30fc\u30b7\u30e3\u30f3\u8af8\u5cf6","America/Adak"],["(UTC-10:00) \u30cf\u30ef\u30a4","Pacific/Honolulu"],["(UTC-09:30) \u30de\u30eb\u30ad\u30fc\u30ba\u8af8\u5cf6","Pacific/Marquesas"],["(UTC-09:00) \u30a2\u30e9\u30b9\u30ab","America/Anchorage"],["(UTC-08:00) \u30d0\u30cf\u30ab\u30ea\u30d5\u30a9\u30eb\u30cb\u30a2","America/Tijuana"],["(UTC-08:00) \u592a\u5e73\u6d0b\u6a19\u6e96\u6642 (\u7c73\u56fd\u304a\u3088\u3073\u30ab\u30ca\u30c0)","America/Los_Angeles"],["(UTC-07:00) \u30a2\u30ea\u30be\u30ca","America/Phoenix"],["(UTC-07:00) \u30c1\u30ef\u30ef\u3001\u30e9\u30d1\u30b9\u3001\u30de\u30b5\u30c8\u30e9\u30f3","America/Chihuahua"],["(UTC-07:00) \u5c71\u5cb3\u6a19\u6e96\u6642 (\u7c73\u56fd\u304a\u3088\u3073\u30ab\u30ca\u30c0)","America/Denver"],["(UTC-06:00) \u4e2d\u592e\u30a2\u30e1\u30ea\u30ab","America/Belize"],["(UTC-06:00) \u4e2d\u90e8\u6a19\u6e96\u6642 (\u7c73\u56fd\u304a\u3088\u3073\u30ab\u30ca\u30c0)","America/Chicago"],["(UTC-06:00) \u30a4\u30fc\u30b9\u30bf\u30fc\u5cf6","Pacific/Easter"],["(UTC-06:00) \u30b0\u30a2\u30c0\u30e9\u30cf\u30e9\u3001\u30e1\u30ad\u30b7\u30b3\u30b7\u30c6\u30a3\u3001\u30e2\u30f3\u30c6\u30ec\u30fc","America/Mexico_City"],["(UTC-06:00) \u30b5\u30b9\u30ab\u30c1\u30e5\u30ef\u30f3","America/Regina"],["(UTC-05:00) \u30dc\u30b4\u30bf\u3001\u30ea\u30de\u3001\u30ad\u30c8\u3001\u30ea\u30aa \u30d6\u30e9\u30f3\u30b3","America/Bogota"],["(UTC-05:00) \u30c1\u30a7\u30c8\u30a5\u30de\u30eb","America/Cancun"],["(UTC-05:00) \u6771\u90e8\u6a19\u6e96\u6642 (\u7c73\u56fd\u304a\u3088\u3073\u30ab\u30ca\u30c0)","America/New_York"],["(UTC-05:00) \u30cf\u30a4\u30c1","America/Port-au-Prince"],["(UTC-05:00) \u30cf\u30d0\u30ca","America/Havana"],["(UTC-05:00) \u30a4\u30f3\u30c7\u30a3\u30a2\u30ca\u6771\u90e8","America/Indiana/Indianapolis"],["(UTC-04:00) \u30a2\u30b9\u30f3\u30b7\u30aa\u30f3","America/Asuncion"],["(UTC-04:00) \u5927\u897f\u6d0b\u6a19\u6e96\u6642 (\u30ab\u30ca\u30c0)","America/Halifax"],["(UTC-04:00) \u30ab\u30e9\u30ab\u30b9","America/Caracas"],["(UTC-04:00) \u30af\u30a4\u30a2\u30d0","America/Cuiaba"],["(UTC-04:00) \u30b8\u30e7\u30fc\u30b8\u30bf\u30a6\u30f3\u3001\u30e9\u30d1\u30b9\u3001\u30de\u30ca\u30a6\u30b9\u3001\u30b5\u30f3\u30d5\u30a1\u30f3","America/Manaus"],["(UTC-04:00) \u30b5\u30f3\u30c6\u30a3\u30a2\u30b4","America/Santiago"],["(UTC-04:00) \u30bf\u30fc\u30af\u30b9\u30fb\u30ab\u30a4\u30b3\u30b9\u8af8\u5cf6","America/Grand_Turk"],["(UTC-03:30) \u30cb\u30e5\u30fc\u30d5\u30a1\u30f3\u30c9\u30e9\u30f3\u30c9","America/St_Johns"],["(UTC-03:00) \u30a2\u30e9\u30b0\u30a1\u30a4\u30ca","America/Fortaleza"],["(UTC-03:00) \u30d6\u30e9\u30b8\u30ea\u30a2","America/Sao_Paulo"],["(UTC-03:00) \u30ab\u30a4\u30a8\u30f3\u30cc\u3001\u30d5\u30a9\u30eb\u30bf\u30ec\u30b6","America/Cayenne"],["(UTC-03:00) \u30d6\u30a8\u30ce\u30b9\u30a2\u30a4\u30ec\u30b9","America/Buenos_Aires"],["(UTC-03:00) \u30b0\u30ea\u30fc\u30f3\u30e9\u30f3\u30c9","America/Godthab"],["(UTC-03:00) \u30e2\u30f3\u30c6\u30d3\u30c7\u30aa","America/Montevideo"],["(UTC-03:00) \u30b5\u30f3\u30d4\u30a8\u30fc\u30eb\u30fb\u30df\u30af\u30ed\u30f3","America/Miquelon"],["(UTC-03:00) \u30b5\u30eb\u30d0\u30c9\u30eb","America/Bahia"],["(UTC-02:00) \u30d5\u30a7\u30eb\u30ca\u30f3\u30c9\u30fb\u30c7\u30fb\u30ce\u30ed\u30fc\u30cb\u30e3\u5cf6","America/Noronha"],["(UTC-01:00) \u30a2\u30be\u30ec\u30b9\u8af8\u5cf6","Atlantic/Azores"],["(UTC-01:00) \u30ab\u30fc\u30dc\u30d9\u30eb\u30c7\u8af8\u5cf6","Atlantic/Cape_Verde"],["(UTC) \u30ab\u30b5\u30d6\u30e9\u30f3\u30ab","Africa/Casablanca"],["(UTC) \u30c0\u30d6\u30ea\u30f3\u3001\u30a8\u30b8\u30f3\u30d0\u30e9\u3001\u30ea\u30b9\u30dc\u30f3\u3001\u30ed\u30f3\u30c9\u30f3","Europe/London"],["(UTC) \u30e2\u30ed\u30f3\u30d3\u30a2\u3001\u30ec\u30a4\u30ad\u30e3\u30d3\u30af","Africa/Monrovia"],["(UTC+01:00) \u30a2\u30e0\u30b9\u30c6\u30eb\u30c0\u30e0\u3001\u30d9\u30eb\u30ea\u30f3\u3001\u30d9\u30eb\u30f3\u3001\u30ed\u30fc\u30de\u3001\u30b9\u30c8\u30c3\u30af\u30db\u30eb\u30e0\u3001\u30a6\u30a3\u30fc\u30f3","Europe/Amsterdam"],["(UTC+01:00) \u30d9\u30aa\u30b0\u30e9\u30fc\u30c9\u3001\u30d6\u30e9\u30c1\u30b9\u30e9\u30d0\u3001\u30d6\u30c0\u30da\u30b9\u30c8\u3001\u30ea\u30e5\u30d6\u30ea\u30e3\u30ca\u3001\u30d7\u30e9\u30cf","Europe/Belgrade"],["(UTC+01:00) \u30d6\u30ea\u30e5\u30c3\u30bb\u30eb\u3001\u30b3\u30da\u30f3\u30cf\u30fc\u30b2\u30f3\u3001\u30de\u30c9\u30ea\u30fc\u30c9\u3001\u30d1\u30ea","Europe/Brussels"],["(UTC+01:00) \u30b5\u30e9\u30a8\u30dc\u3001\u30b9\u30b3\u30d4\u30a8\u3001\u30ef\u30eb\u30b7\u30e3\u30ef\u3001\u30b6\u30b0\u30ec\u30d6","Europe/Warsaw"],["(UTC+01:00) \u897f\u4e2d\u592e\u30a2\u30d5\u30ea\u30ab","Africa/Algiers"],["(UTC+01:00) \u30a6\u30a3\u30f3\u30c8\u30d5\u30c3\u30c8","Africa/Windhoek"],["(UTC+02:00) \u30a2\u30f3\u30de\u30f3","Asia/Amman"],["(UTC+02:00) \u30a2\u30c6\u30cd\u3001\u30d6\u30ab\u30ec\u30b9\u30c8","Europe/Athens"],["(UTC+02:00) \u30d9\u30a4\u30eb\u30fc\u30c8","Asia/Beirut"],["(UTC+02:00) \u30ab\u30a4\u30ed","Africa/Cairo"],["(UTC+02:00) \u30c0\u30de\u30b9\u30ab\u30b9","Asia/Damascus"],["(UTC+02:00) \u30ac\u30b6\u3001\u30d8\u30d6\u30ed\u30f3","Asia/Gaza"],["(UTC+02:00) \u30cf\u30e9\u30fc\u30ec\u3001\u30d7\u30ec\u30c8\u30ea\u30a2","Africa/Harare"],["(UTC+02:00) \u30d8\u30eb\u30b7\u30f3\u30ad\u3001\u30ad\u30a8\u30d5\u3001\u30ea\u30ac\u3001\u30bd\u30d5\u30a3\u30a2\u3001\u30bf\u30ea\u30f3\u3001\u30d3\u30ea\u30cb\u30e5\u30b9","Europe/Helsinki"],["(UTC+02:00) \u30a8\u30eb\u30b5\u30ec\u30e0","Asia/Jerusalem"],["(UTC+02:00) \u30ab\u30ea\u30fc\u30cb\u30f3\u30b0\u30e9\u30fc\u30c9","Europe/Kaliningrad"],["(UTC+02:00) \u30c8\u30ea\u30dd\u30ea","Africa/Tripoli"],["(UTC+03:00) \u30d0\u30b0\u30c0\u30c3\u30c9","Asia/Baghdad"],["(UTC+03:00) \u30a4\u30b9\u30bf\u30f3\u30d6\u30fc\u30eb","Asia/Istanbul"],["(UTC+03:00) \u30af\u30a6\u30a7\u30fc\u30c8\u3001\u30ea\u30e4\u30c9","Asia/Kuwait"],["(UTC+03:00) \u30df\u30f3\u30b9\u30af","Europe/Minsk"],["(UTC+03:00) \u30e2\u30b9\u30af\u30ef\u3001\u30b5\u30f3\u30af\u30c8\u30da\u30c6\u30eb\u30d6\u30eb\u30af\u3001\u30dc\u30eb\u30b4\u30b0\u30e9\u30fc\u30c9","Europe/Moscow"],["(UTC+03:00) \u30ca\u30a4\u30ed\u30d3","Africa/Nairobi"],["(UTC+03:30) \u30c6\u30d8\u30e9\u30f3","Asia/Tehran"],["(UTC+04:00) \u30a2\u30d6\u30c0\u30d3\u3001\u30de\u30b9\u30ab\u30c3\u30c8","Asia/Muscat"],["(UTC+04:00) \u30a2\u30b9\u30c8\u30e9\u30cf\u30f3\u3001\u30a6\u30ea\u30e4\u30ce\u30d5\u30b9\u30af","Europe/Astrakhan"],["(UTC+04:00) \u30d0\u30af","Asia/Baku"],["(UTC+04:00) \u30a4\u30b8\u30a7\u30d5\u30b9\u30af\u3001\u30b5\u30de\u30fc\u30e9","Europe/Samara"],["(UTC+04:00) \u30dd\u30fc\u30c8\u30eb\u30a4\u30b9","Indian/Mauritius"],["(UTC+04:00) \u30c8\u30d3\u30ea\u30b7","Asia/Tbilisi"],["(UTC+04:00) \u30a8\u30ec\u30d0\u30f3","Asia/Yerevan"],["(UTC+04:30) \u30ab\u30d6\u30fc\u30eb","Asia/Kabul"],["(UTC+05:00) \u30a2\u30b7\u30cf\u30d0\u30fc\u30c9\u3001\u30bf\u30b7\u30b1\u30f3\u30c8","Asia/Tashkent"],["(UTC+05:00) \u30a8\u30ab\u30c6\u30ea\u30f3\u30d6\u30eb\u30af","Asia/Yekaterinburg"],["(UTC+05:00) \u30a4\u30b9\u30e9\u30de\u30d0\u30fc\u30c9\u3001\u30ab\u30e9\u30c1","Asia/Karachi"],["(UTC+05:30) \u30c1\u30a7\u30f3\u30de\u30a4\u3001\u30b3\u30eb\u30ab\u30bf\u3001\u30e0\u30f3\u30d0\u30a4\u3001\u30cb\u30e5\u30fc\u30c7\u30ea\u30fc","Asia/Kolkata"],["(UTC+05:30) \u30b9\u30ea\u30b8\u30e3\u30e4\u30ef\u30eb\u30c0\u30ca\u30d7\u30e9\u30b3\u30c3\u30c6","Asia/Colombo"],["(UTC+05:45) \u30ab\u30c8\u30de\u30f3\u30ba","Asia/Katmandu"],["(UTC+06:00) \u30a2\u30b9\u30bf\u30ca","Asia/Almaty"],["(UTC+06:00) \u30c0\u30c3\u30ab","Asia/Dhaka"],["(UTC+06:30) \u30e4\u30f3\u30b4\u30f3 (\u30e9\u30f3\u30b0\u30fc\u30f3)","Asia/Rangoon"],["(UTC+07:00) \u30ce\u30dc\u30b7\u30d3\u30eb\u30b9\u30af","Asia/Novosibirsk"],["(UTC+07:00) \u30d0\u30f3\u30b3\u30af\u3001\u30cf\u30ce\u30a4\u3001\u30b8\u30e3\u30ab\u30eb\u30bf","Asia/Bangkok"],["(UTC+07:00) \u30d0\u30a6\u30ca\u30a6\u30eb\u3001\u30b4\u30eb\u30ce\u30fb\u30a2\u30eb\u30bf\u30a4\u30b9\u30af","Asia/Barnaul"],["(UTC+07:00) \u30db\u30d6\u30c9","Asia/Hovd"],["(UTC+07:00) \u30af\u30e9\u30b9\u30ce\u30e4\u30eb\u30b9\u30af","Asia/Krasnoyarsk"],["(UTC+07:00) \u30c8\u30e0\u30b9\u30af","Asia/Tomsk"],["(UTC+08:00) \u5317\u4eac\u3001\u91cd\u6176\u3001\u9999\u6e2f\u7279\u5225\u884c\u653f\u533a\u3001\u30a6\u30eb\u30e0\u30c1","Asia/Chongqing"],["(UTC+08:00) \u30a4\u30eb\u30af\u30fc\u30c4\u30af","Asia/Irkutsk"],["(UTC+08:00) \u30af\u30a2\u30e9\u30eb\u30f3\u30d7\u30fc\u30eb\u3001\u30b7\u30f3\u30ac\u30dd\u30fc\u30eb","Asia/Kuala_Lumpur"],["(UTC+08:00) \u30d1\u30fc\u30b9","Australia/Perth"],["(UTC+08:00) \u53f0\u5317","Asia/Taipei"],["(UTC+08:00) \u30a6\u30e9\u30f3\u30d0\u30fc\u30c8\u30eb","Asia/Ulaanbaatar"],["(UTC+08:30) \u5e73\u58cc","Asia/Pyongyang"],["(UTC+08:45) \u30e6\u30fc\u30af\u30e9","Australia/Eucla"],["(UTC+09:00) \u30c1\u30bf","Asia/Chita"],["(UTC+09:00) \u5927\u962a\u3001\u672d\u5e4c\u3001\u6771\u4eac","Asia/Tokyo"],["(UTC+09:00) \u30bd\u30a6\u30eb","Asia/Seoul"],["(UTC+09:00) \u30e4\u30c4\u30fc\u30c4\u30af","Asia/Yakutsk"],["(UTC+09:30) \u30a2\u30c7\u30ec\u30fc\u30c9","Australia/Adelaide"],["(UTC+09:30) \u30c0\u30fc\u30a6\u30a3\u30f3","Australia/Darwin"],["(UTC+10:00) \u30d6\u30ea\u30ba\u30d9\u30f3","Australia/Brisbane"],["(UTC+10:00) \u30ad\u30e3\u30f3\u30d9\u30e9\u3001\u30e1\u30eb\u30dc\u30eb\u30f3\u3001\u30b7\u30c9\u30cb\u30fc","Australia/Canberra"],["(UTC+10:00) \u30b0\u30a2\u30e0\u3001\u30dd\u30fc\u30c8\u30e2\u30ec\u30b9\u30d3\u30fc","Pacific/Guam"],["(UTC+10:00) \u30db\u30d0\u30fc\u30c8","Australia/Hobart"],["(UTC+10:00) \u30a6\u30e9\u30b8\u30aa\u30b9\u30c8\u30af","Asia/Vladivostok"],["(UTC+10:30) \u30ed\u30fc\u30c9\u30cf\u30a6\u5cf6","Australia/Lord_Howe"],["(UTC+11:00) \u30d6\u30fc\u30b2\u30f3\u30d3\u30eb\u5cf6","Pacific/Bougainville"],["(UTC+11:00) \u30c1\u30e7\u30af\u30eb\u30c0\u30d5","Asia/Srednekolymsk"],["(UTC+11:00) \u30de\u30ac\u30c0\u30f3","Asia/Magadan"],["(UTC+11:00) \u30ce\u30fc\u30d5\u30a9\u30fc\u30af\u5cf6","Pacific/Norfolk"],["(UTC+11:00) \u30b5\u30cf\u30ea\u30f3","Asia/Sakhalin"],["(UTC+11:00) \u30bd\u30ed\u30e2\u30f3\u8af8\u5cf6\u3001\u30cb\u30e5\u30fc\u30ab\u30ec\u30c9\u30cb\u30a2","Pacific/Guadalcanal"],["(UTC+12:00) \u30a2\u30ca\u30c7\u30a3\u30ea\u3001\u30da\u30c8\u30ed\u30d1\u30d6\u30ed\u30b9\u30af\u30fb\u30ab\u30e0\u30c1\u30e3\u30c4\u30ad\u30fc","Asia/Anadyr"],["(UTC+12:00) \u30aa\u30fc\u30af\u30e9\u30f3\u30c9\u3001\u30a6\u30a7\u30ea\u30f3\u30c8\u30f3","Pacific/Auckland"],["(UTC+12:00) \u30d5\u30a3\u30b8\u30fc","Pacific/Fiji"],["(UTC+12:45) \u30c1\u30e3\u30bf\u30e0\u8af8\u5cf6","Pacific/Chatham"],["(UTC+13:00) \u30cc\u30af\u30a2\u30ed\u30d5\u30a1","Pacific/Tongatapu"],["(UTC+13:00) \u30b5\u30e2\u30a2","Pacific/Apia"],["(UTC+14:00) \u30af\u30ea\u30b9\u30de\u30b9\u5cf6","Pacific/Kiritimati"]];var c=[["(UTC-11:00) Midway Island, American Samoa","Pacific/Midway"],["(UTC-10:00) Aleutian Islands","America/Adak"],["(UTC-10:00) Hawaii","Pacific/Honolulu"],["(UTC-09:30) Marquesas Islands","Pacific/Marquesas"],["(UTC-09:00) Alaska","America/Anchorage"],["(UTC-08:00) Baja California","America/Tijuana"],["(UTC-08:00) Pacific Time (US and Canada)","America/Los_Angeles"],["(UTC-07:00) Arizona","America/Phoenix"],["(UTC-07:00) Chihuahua, La Paz, Mazatl\xe1n","America/Chihuahua"],["(UTC-07:00) Mountain Time (US and Canada)","America/Denver"],["(UTC-06:00) Central America","America/Belize"],["(UTC-06:00) Central Time (US and Canada)","America/Chicago"],["(UTC-06:00) Easter Island","Pacific/Easter"],["(UTC-06:00) Guadalajara, Mexico City, Monterrey","America/Mexico_City"],["(UTC-06:00) Saskatchewan","America/Regina"],["(UTC-05:00) Bogot\xe1, Lima, Quito","America/Bogota"],["(UTC-05:00) Chetumal","America/Cancun"],["(UTC-05:00) Eastern Time (US and Canada)","America/New_York"],["(UTC-05:00) Haiti","America/Port-au-Prince"],["(UTC-05:00) Havana","America/Havana"],["(UTC-05:00) Indiana (East)","America/Indiana/Indianapolis"],["(UTC-05:00) Turks and Caicos","America/Grand_Turk"],["(UTC-04:00) Asunci\xf3n","America/Asuncion"],["(UTC-04:00) Atlantic Time (Canada)","America/Halifax"],["(UTC-04:00) Caracas","America/Caracas"],["(UTC-04:00) Cuiab\xe1","America/Cuiaba"],["(UTC-04:00) Georgetown, La Paz, Manaus, San Juan","America/Manaus"],["(UTC-04:00) Santiago","America/Santiago"],["(UTC-03:30) Newfoundland","America/St_Johns"],["(UTC-03:00) Aragua\xedna","America/Fortaleza"],["(UTC-03:00) Bras\xedlia","America/Sao_Paulo"],["(UTC-03:00) Cayenne, Fortaleza","America/Cayenne"],["(UTC-03:00) City of Buenos Aires","America/Buenos_Aires"],["(UTC-03:00) Greenland","America/Godthab"],["(UTC-03:00) Montevideo","America/Montevideo"],["(UTC-03:00) Saint Pierre and Miquelon","America/Miquelon"],["(UTC-03:00) Salvador","America/Bahia"],["(UTC-02:00) Fernando de Noronha","America/Noronha"],["(UTC-01:00) Azores","Atlantic/Azores"],["(UTC-01:00) Cabo Verde Islands","Atlantic/Cape_Verde"],["(UTC) Casablanca","Africa/Casablanca"],["(UTC) Dublin, Edinburgh, Lisbon, London","Europe/London"],["(UTC) Monrovia, Reykjav\xedk","Africa/Monrovia"],["(UTC+01:00) Amsterdam, Berlin, Bern, Rome, Stockholm, Vienna","Europe/Amsterdam"],["(UTC+01:00) Belgrade, Bratislava, Budapest, Ljubljana, Prague","Europe/Belgrade"],["(UTC+01:00) Brussels, Copenhagen, Madrid, Paris","Europe/Brussels"],["(UTC+01:00) Sarajevo, Skopje, Warsaw, Zagreb","Europe/Warsaw"],["(UTC+01:00) West Central Africa","Africa/Algiers"],["(UTC+01:00) Windhoek","Africa/Windhoek"],["(UTC+02:00) Amman","Asia/Amman"],["(UTC+02:00) Athens, Bucharest","Europe/Athens"],["(UTC+02:00) Beirut","Asia/Beirut"],["(UTC+02:00) Cairo","Africa/Cairo"],["(UTC+02:00) Damascus","Asia/Damascus"],["(UTC+02:00) Gaza, Hebron","Asia/Gaza"],["(UTC+02:00) Harare, Pretoria","Africa/Harare"],["(UTC+02:00) Helsinki, Kiev, Riga, Sofia, Tallinn, Vilnius","Europe/Helsinki"],["(UTC+02:00) Jerusalem","Asia/Jerusalem"],["(UTC+02:00) Kaliningrad","Europe/Kaliningrad"],["(UTC+02:00) Tripoli","Africa/Tripoli"],["(UTC+03:00) Baghdad","Asia/Baghdad"],["(UTC+03:00) Istanbul","Asia/Istanbul"],["(UTC+03:00) Kuwait, Riyadh","Asia/Kuwait"],["(UTC+03:00) Minsk","Europe/Minsk"],["(UTC+03:00) Moscow, St. Petersburg, Volgograd","Europe/Moscow"],["(UTC+03:00) Nairobi","Africa/Nairobi"],["(UTC+03:30) Tehran","Asia/Tehran"],["(UTC+04:00) Abu Dhabi, Muscat","Asia/Muscat"],["(UTC+04:00) Astrakhan, Ulyanovsk","Europe/Astrakhan"],["(UTC+04:00) Baku","Asia/Baku"],["(UTC+04:00) Izhevsk, Samara","Europe/Samara"],["(UTC+04:00) Port Louis","Indian/Mauritius"],["(UTC+04:00) Tbilisi","Asia/Tbilisi"],["(UTC+04:00) Yerevan","Asia/Yerevan"],["(UTC+04:30) Kabul","Asia/Kabul"],["(UTC+05:00) Tashkent, Ashgabat","Asia/Tashkent"],["(UTC+05:00) Ekaterinburg","Asia/Yekaterinburg"],["(UTC+05:00) Islamabad, Karachi","Asia/Karachi"],["(UTC+05:30) Chennai, Kolkata, Mumbai, New Delhi","Asia/Kolkata"],["(UTC+05:30) Sri Jayawardenepura","Asia/Colombo"],["(UTC+05:45) Kathmandu","Asia/Katmandu"],["(UTC+06:00) Astana","Asia/Almaty"],["(UTC+06:00) Dhaka","Asia/Dhaka"],["(UTC+06:30) Yangon (Rangoon)","Asia/Rangoon"],["(UTC+07:00) Novosibirsk","Asia/Novosibirsk"],["(UTC+07:00) Bangkok, Hanoi, Jakarta","Asia/Bangkok"],["(UTC+07:00) Barnaul, Gorno-Altaysk","Asia/Barnaul"],["(UTC+07:00) Hovd","Asia/Hovd"],["(UTC+07:00) Krasnoyarsk","Asia/Krasnoyarsk"],["(UTC+07:00) Tomsk","Asia/Tomsk"],["(UTC+08:00) Beijing, Chongqing, Hong Kong SAR, \xdcr\xfcmqi","Asia/Chongqing"],["(UTC+08:00) Irkutsk","Asia/Irkutsk"],["(UTC+08:00) Kuala Lumpur, Singapore","Asia/Kuala_Lumpur"],["(UTC+08:00) Perth","Australia/Perth"],["(UTC+08:00) Taipei","Asia/Taipei"],["(UTC+08:00) Ulaanbaatar","Asia/Ulaanbaatar"],["(UTC+08:45) Eucla","Australia/Eucla"],["(UTC+09:00) Chita","Asia/Chita"],["(UTC+09:00) Osaka, Sapporo, Tokyo","Asia/Tokyo"],["(UTC+09:00) Pyongyang","Asia/Pyongyang"],["(UTC+09:00) Seoul","Asia/Seoul"],["(UTC+09:00) Yakutsk","Asia/Yakutsk"],["(UTC+09:30) Adelaide","Australia/Adelaide"],["(UTC+09:30) Darwin","Australia/Darwin"],["(UTC+10:00) Brisbane","Australia/Brisbane"],["(UTC+10:00) Canberra, Melbourne, Sydney","Australia/Canberra"],["(UTC+10:00) Guam, Port Moresby","Pacific/Guam"],["(UTC+10:00) Hobart","Australia/Hobart"],["(UTC+10:00) Vladivostok","Asia/Vladivostok"],["(UTC+10:30) Lord Howe Island","Australia/Lord_Howe"],["(UTC+11:00) Bougainville Island","Pacific/Bougainville"],["(UTC+11:00) Chokurdakh","Asia/Srednekolymsk"],["(UTC+11:00) Magadan","Asia/Magadan"],["(UTC+11:00) Norfolk Island","Pacific/Norfolk"],["(UTC+11:00) Sakhalin","Asia/Sakhalin"],["(UTC+11:00) Solomon Islands, New Caledonia","Pacific/Guadalcanal"],["(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky","Asia/Anadyr"],["(UTC+12:00) Auckland, Wellington","Pacific/Auckland"],["(UTC+12:00) Fiji Islands","Pacific/Fiji"],["(UTC+12:45) Chatham Islands","Pacific/Chatham"],["(UTC+13:00) Nuku'alofa","Pacific/Tongatapu"],["(UTC+13:00) Samoa","Pacific/Apia"],["(UTC+14:00) Kiritimati Island","Pacific/Kiritimati"]];var d=[["(UTC-11:00) Isla Midway, Samoa Americana","Pacific/Midway"],["(UTC-10:00) Islas Aleutianas","America/Adak"],["(UTC-10:00) Haw\xe1i","Pacific/Honolulu"],["(UTC-09:30) Islas Marquesas","Pacific/Marquesas"],["(UTC-09:00) Alaska","America/Anchorage"],["(UTC-08:00) Baja California","America/Tijuana"],["(UTC-08:00) Hora del Pac\xedfico (EE.UU. y Canad\xe1)","America/Los_Angeles"],["(UTC-07:00) Arizona","America/Phoenix"],["(UTC-07:00) Chihuahua, La Paz, Mazatl\xe1n","America/Chihuahua"],["(UTC-07:00) Hora de las Monta\xf1as Rocosas (EE.UU. y Canad\xe1)","America/Denver"],["(UTC-06:00) Am\xe9rica Central","America/Belize"],["(UTC-06:00) Hora central (EE.UU. y Canad\xe1)","America/Chicago"],["(UTC-06:00) Isla de Pascua","Pacific/Easter"],["(UTC-06:00) Guadalajara, Ciudad de M\xe9xico, Monterrey","America/Mexico_City"],["(UTC-06:00) Saskatchewan","America/Regina"],["(UTC-05:00) Bogot\xe1, Lima, Quito","America/Bogota"],["(UTC-05:00) Chetumal","America/Cancun"],["(UTC-05:00) Hora del este (EE.UU. y Canad\xe1)","America/New_York"],["(UTC-05:00) Hait\xed","America/Port-au-Prince"],["(UTC-05:00) La Habana","America/Havana"],["(UTC-05:00) Indiana (este)","America/Indiana/Indianapolis"],["(UTC-05:00) Islas Turcas y Caicos","America/Grand_Turk"],["(UTC-04:00) Asunci\xf3n","America/Asuncion"],["(UTC-04:00) Hora del Atl\xe1ntico (Canad\xe1)","America/Halifax"],["(UTC-04:00) Caracas","America/Caracas"],["(UTC-04:00) Cuiab\xe1","America/Cuiaba"],["(UTC-04:00) Georgetown, La Paz, Manaos, San Juan","America/Manaus"],["(UTC-04:00) Santiago","America/Santiago"],["(UTC-03:30) Terranova","America/St_Johns"],["(UTC-03:00) Aragua\xedna","America/Fortaleza"],["(UTC-03:00) Brasilia","America/Sao_Paulo"],["(UTC-03:00) Cayena, Fortaleza","America/Cayenne"],["(UTC-03:00) Ciudad de Buenos Aires","America/Buenos_Aires"],["(UTC-03:00) Groenlandia","America/Godthab"],["(UTC-03:00) Montevideo","America/Montevideo"],["(UTC-03:00) San Pedro y Miquel\xf3n","America/Miquelon"],["(UTC-03:00) Salvador","America/Bahia"],["(UTC-02:00) Fernando de Noronha","America/Noronha"],["(UTC-01:00) Azores","Atlantic/Azores"],["(UTC-01:00) Islas de Cabo Verde","Atlantic/Cape_Verde"],["(UTC) Casablanca","Africa/Casablanca"],["(UTC) Dubl\xedn, Edimburgo, Lisboa, Londres","Europe/London"],["(UTC) Monrovia, Reikiavik","Africa/Monrovia"],["(UTC+01:00) \xc1msterdam, Berl\xedn, Berna, Roma, Estocolmo, Viena","Europe/Amsterdam"],["(UTC+01:00) Belgrado, Bratislava, Budapest, Liubliana, Praga","Europe/Belgrade"],["(UTC+01:00) Bruselas, Copenhague, Madrid, Par\xeds","Europe/Brussels"],["(UTC+01:00) Sarajevo, Skopie, Varsovia, Zagreb","Europe/Warsaw"],["(UTC+01:00) \xc1frica Central Occidental","Africa/Algiers"],["(UTC+01:00) Windhoek","Africa/Windhoek"],["(UTC+02:00) Amm\xe1n","Asia/Amman"],["(UTC+02:00) Atenas, Bucarest","Europe/Athens"],["(UTC+02:00) Beirut","Asia/Beirut"],["(UTC+02:00) El Cairo","Africa/Cairo"],["(UTC+02:00) Damasco","Asia/Damascus"],["(UTC+02:00) Gaza, Hebr\xf3n","Asia/Gaza"],["(UTC+02:00) Harare, Pretoria","Africa/Harare"],["(UTC+02:00) Helsinki, Kiev, Riga, Sof\xeda, Tallin, Vilna","Europe/Helsinki"],["(UTC+02:00) Jerusal\xe9n","Asia/Jerusalem"],["(UTC+02:00) Kaliningrado","Europe/Kaliningrad"],["(UTC+02:00) Tr\xedpoli","Africa/Tripoli"],["(UTC+03:00) Bagdad","Asia/Baghdad"],["(UTC+03:00) Estambul","Asia/Istanbul"],["(UTC+03:00) Kuwait, Riad","Asia/Kuwait"],["(UTC+03:00) Minsk","Europe/Minsk"],["(UTC+03:00) Mosc\xfa, San Petersburgo, Volgogrado","Europe/Moscow"],["(UTC+03:00) Nairobi","Africa/Nairobi"],["(UTC+03:30) Teher\xe1n","Asia/Tehran"],["(UTC+04:00) Abu Dabi, Mascate","Asia/Muscat"],["(UTC+04:00) Astrac\xe1n, Uli\xe1novsk","Europe/Astrakhan"],["(UTC+04:00) Bak\xfa","Asia/Baku"],["(UTC+04:00) Izhevsk, Samara","Europe/Samara"],["(UTC+04:00) Port Louis","Indian/Mauritius"],["(UTC+04:00) Tiflis","Asia/Tbilisi"],["(UTC+04:00) Erev\xe1n","Asia/Yerevan"],["(UTC+04:30) Kabul","Asia/Kabul"],["(UTC+05:00) Taskent, Asjabad","Asia/Tashkent"],["(UTC+05:00) Ekaterimburgo","Asia/Yekaterinburg"],["(UTC+05:00) Islamabad, Karachi","Asia/Karachi"],["(UTC+05:30) Chennai, Kolkata (Calcuta), Mumbai (Bombay), Nueva Delhi","Asia/Kolkata"],["(UTC+05:30) Sri Jayawardenepura","Asia/Colombo"],["(UTC+05:45) Katmand\xfa","Asia/Katmandu"],["(UTC+06:00) Astan\xe1","Asia/Almaty"],["(UTC+06:00) Dacca","Asia/Dhaka"],["(UTC+06:30) Yang\xf3n (Rang\xfan)","Asia/Rangoon"],["(UTC+07:00) Novosibirsk","Asia/Novosibirsk"],["(UTC+07:00) Bangkok, Han\xf3i, Yakarta","Asia/Bangkok"],["(UTC+07:00) Barnaul, Gorno-Altaisk","Asia/Barnaul"],["(UTC+07:00) Hovd","Asia/Hovd"],["(UTC+07:00) Krasnoiarsk","Asia/Krasnoyarsk"],["(UTC+07:00) Tomsk","Asia/Tomsk"],["(UTC+08:00) Beijing (Pek\xedn), Chongqing, RAE de Hong Kong, Urumqi","Asia/Chongqing"],["(UTC+08:00) Irkutsk","Asia/Irkutsk"],["(UTC+08:00) Kuala Lumpur, Singapur","Asia/Kuala_Lumpur"],["(UTC+08:00) Perth","Australia/Perth"],["(UTC+08:00) Taip\xe9i","Asia/Taipei"],["(UTC+08:00) Ul\xe1n Bator","Asia/Ulaanbaatar"],["(UTC+08:45) Eucla","Australia/Eucla"],["(UTC+09:00) Chita","Asia/Chita"],["(UTC+09:00) Osaka, Sapporo, Tokio","Asia/Tokyo"],["(UTC+09:00) Pyongyang","Asia/Pyongyang"],["(UTC+09:00) Se\xfal","Asia/Seoul"],["(UTC+09:00) Yakutsk","Asia/Yakutsk"],["(UTC+09:30) Adelaida","Australia/Adelaide"],["(UTC+09:30) Darwin","Australia/Darwin"],["(UTC+10:00) Brisbane","Australia/Brisbane"],["(UTC+10:00) Canberra, Melbourne, S\xeddney","Australia/Canberra"],["(UTC+10:00) Guam, Port Moresby","Pacific/Guam"],["(UTC+10:00) Hobart","Australia/Hobart"],["(UTC+10:00) Vladivostok","Asia/Vladivostok"],["(UTC+10:30) Isla Lord Howe","Australia/Lord_Howe"],["(UTC+11:00) Isla Bougainville","Pacific/Bougainville"],["(UTC+11:00) Chokurdakh","Asia/Srednekolymsk"],["(UTC+11:00) Magad\xe1n","Asia/Magadan"],["(UTC+11:00) Isla Norfolk","Pacific/Norfolk"],["(UTC+11:00) Sajal\xedn","Asia/Sakhalin"],["(UTC+11:00) Islas Salom\xf3n, Nueva Caledonia","Pacific/Guadalcanal"],["(UTC+12:00) An\xe1dyr, Petrop\xe1vlovsk-Kamchatski","Asia/Anadyr"],["(UTC+12:00) Auckland, Wellington","Pacific/Auckland"],["(UTC+12:00) Fiyi","Pacific/Fiji"],["(UTC+12:45) Islas Chatham","Pacific/Chatham"],["(UTC+13:00) Nuku'alofa","Pacific/Tongatapu"],["(UTC+13:00) Samoa","Pacific/Apia"],["(UTC+14:00) Isla Kiritimati","Pacific/Kiritimati"]];var u=[["(UTC-11:00) Ilhas Midway, Samoa Americana","Pacific/Midway"],["(UTC-10:00) Ilhas Aleutas","America/Adak"],["(UTC-10:00) Hava\xed","Pacific/Honolulu"],["(UTC-09:30) Ilhas Marquesas","Pacific/Marquesas"],["(UTC-09:00) Alasca","America/Anchorage"],["(UTC-08:00) Baixa California","America/Tijuana"],["(UTC-08:00) Hora do Pac\xedfico (EUA e Canad\xe1)","America/Los_Angeles"],["(UTC-07:00) Arizona","America/Phoenix"],["(UTC-07:00) Chihuahua, La Paz, Mazatlan","America/Chihuahua"],["(UTC-07:00) Hora das Montanhas (EUA e Canad\xe1)","America/Denver"],["(UTC-06:00) Am\xe9rica Central","America/Belize"],["(UTC-06:00) Hora Central (EUA e Canad\xe1)","America/Chicago"],["(UTC-06:00) Ilha da P\xe1scoa","Pacific/Easter"],["(UTC-06:00) Guadalajara, Cidade do M\xe9xico, Monterrey","America/Mexico_City"],["(UTC-06:00) Saskatchewan","America/Regina"],["(UTC-05:00) Bogot\xe1, Lima, Quito","America/Bogota"],["(UTC-05:00) Chetumal","America/Cancun"],["(UTC-05:00) Hora do Leste (EUA e Canad\xe1)","America/New_York"],["(UTC-05:00) Haiti","America/Port-au-Prince"],["(UTC-05:00) Havana","America/Havana"],["(UTC-05:00) Indiana (Leste)","America/Indiana/Indianapolis"],["(UTC-05:00) Turcos e Caicos","America/Grand_Turk"],["(UTC-04:00) Assun\xe7\xe3o","America/Asuncion"],["(UTC-04:00) Hora do Atl\xe2ntico (Canad\xe1)","America/Halifax"],["(UTC-04:00) Caracas","America/Caracas"],["(UTC-04:00) Cuiab\xe1","America/Cuiaba"],["(UTC-04:00) Georgetown, La Paz, Manaus, San Juan","America/Manaus"],["(UTC-04:00) Santiago","America/Santiago"],["(UTC-03:30) Terra Nova","America/St_Johns"],["(UTC-03:00) Aragua\xedna","America/Fortaleza"],["(UTC-03:00) Bras\xedlia","America/Sao_Paulo"],["(UTC-03:00) Cayenne, Fortaleza","America/Cayenne"],["(UTC-03:00) Buenos Aires","America/Buenos_Aires"],["(UTC-03:00) Groenl\xe2ndia","America/Godthab"],["(UTC-03:00) Montevideo","America/Montevideo"],["(UTC-03:00) S\xe3o Pedro e Miquelon","America/Miquelon"],["(UTC-03:00) Salvador","America/Bahia"],["(UTC-02:00) Fernando de Noronha","America/Noronha"],["(UTC-01:00) A\xe7ores","Atlantic/Azores"],["(UTC-01:00) Ilhas Cabo Verde","Atlantic/Cape_Verde"],["(UTC) Casablanca","Africa/Casablanca"],["(UTC) Dublin, Edimburgo, Lisboa, Londres","Europe/London"],["(UTC) Monr\xf3via, Reykjavik","Africa/Monrovia"],["(UTC+01:00) Amsterd\xe3, Berlim, Berna, Roma, Estocolmo, Viena","Europe/Amsterdam"],["(UTC+01:00) Belgrado, Bratislava, Budapeste, Liubliana, Praga","Europe/Belgrade"],["(UTC+01:00) Bruxelas, Copenhague, Madri, Paris","Europe/Brussels"],["(UTC+01:00) Sarajevo, Skopje, Vars\xf3via, Zagreb","Europe/Warsaw"],["(UTC+01:00) Centro-oeste da \xc1frica","Africa/Algiers"],["(UTC+01:00) Windhoek","Africa/Windhoek"],["(UTC+02:00) Am\xe3","Asia/Amman"],["(UTC+02:00) Atenas, Bucareste","Europe/Athens"],["(UTC+02:00) Beirute","Asia/Beirut"],["(UTC+02:00) Cairo","Africa/Cairo"],["(UTC+02:00) Damasco","Asia/Damascus"],["(UTC+02:00) Gaza, Hebron","Asia/Gaza"],["(UTC+02:00) Harare, Pret\xf3ria","Africa/Harare"],["(UTC+02:00) Helsinque, Kiev, Riga, Sofia, Tallinn, Vilnius","Europe/Helsinki"],["(UTC+02:00) Jerusal\xe9m","Asia/Jerusalem"],["(UTC+02:00) Kaliningrado","Europe/Kaliningrad"],["(UTC+02:00) Tr\xedpoli","Africa/Tripoli"],["(UTC+03:00) Bagd\xe1","Asia/Baghdad"],["(UTC+03:00) Istambul","Asia/Istanbul"],["(UTC+03:00) Kuwait, Riad","Asia/Kuwait"],["(UTC+03:00) Minsk","Europe/Minsk"],["(UTC+03:00) Moscou, S\xe3o Petersburgo, Volgogrado","Europe/Moscow"],["(UTC+03:00) Nair\xf3bi","Africa/Nairobi"],["(UTC+03:30) Teer\xe3","Asia/Tehran"],["(UTC+04:00) Abu Dhabi, Mascate","Asia/Muscat"],["(UTC+04:00) Astrakhan, Ulyanovsk","Europe/Astrakhan"],["(UTC+04:00) Baku","Asia/Baku"],["(UTC+04:00) Izhevsk, Samara","Europe/Samara"],["(UTC+04:00) Port Louis","Indian/Mauritius"],["(UTC+04:00) Tbilisi","Asia/Tbilisi"],["(UTC+04:00) Ierevan","Asia/Yerevan"],["(UTC+04:30) Cabul","Asia/Kabul"],["(UTC+05:00) Tashkent, Ashgabat","Asia/Tashkent"],["(UTC+05:00) Ecaterimburgo","Asia/Yekaterinburg"],["(UTC+05:00) Islamabad, Carachi","Asia/Karachi"],["(UTC+05:30) Chennai, Calcut\xe1, Mumbai, Nova D\xe9li","Asia/Kolkata"],["(UTC+05:30) Sri Jayawardenepura","Asia/Colombo"],["(UTC+05:45) Catmandu","Asia/Katmandu"],["(UTC+06:00) Astana","Asia/Almaty"],["(UTC+06:00) Dacca","Asia/Dhaka"],["(UTC+06:30) Yangon (Rangoon)","Asia/Rangoon"],["(UTC+07:00) Novosibirsk","Asia/Novosibirsk"],["(UTC+07:00) Bangcoc, Han\xf3i, Jacarta","Asia/Bangkok"],["(UTC+07:00) Barnaul, Gorno-Altaysk","Asia/Barnaul"],["(UTC+07:00) Hovd","Asia/Hovd"],["(UTC+07:00) Krasnoyarsk","Asia/Krasnoyarsk"],["(UTC+07:00) Tomsk","Asia/Tomsk"],["(UTC+08:00) Pequim, Chongqing, RAE de Hong Kong, Urumqi","Asia/Chongqing"],["(UTC+08:00) Irkutsk","Asia/Irkutsk"],["(UTC+08:00) Kuala Lumpur, Cingapura","Asia/Kuala_Lumpur"],["(UTC+08:00) Perth","Australia/Perth"],["(UTC+08:00) Taip\xe9","Asia/Taipei"],["(UTC+08:00) Ulan Bator","Asia/Ulaanbaatar"],["(UTC+08:45) Eucla","Australia/Eucla"],["(UTC+09:00) Chita","Asia/Chita"],["(UTC+09:00) Osaka, Sapporo, T\xf3quio","Asia/Tokyo"],["(UTC+09:00) Pyongyang","Asia/Pyongyang"],["(UTC+09:00) Seul","Asia/Seoul"],["(UTC+09:00) Yakutsk","Asia/Yakutsk"],["(UTC+09:30) Adelaide","Australia/Adelaide"],["(UTC+09:30) Darwin","Australia/Darwin"],["(UTC+10:00) Brisbane","Australia/Brisbane"],["(UTC+10:00) Canberra, Melbourne, Sydney","Australia/Canberra"],["(UTC+10:00) Guam, Port Moresby","Pacific/Guam"],["(UTC+10:00) Hobart","Australia/Hobart"],["(UTC+10:00) Vladivostok","Asia/Vladivostok"],["(UTC+10:30) Ilha Lord Howe","Australia/Lord_Howe"],["(UTC+11:00) Ilha Bougainville","Pacific/Bougainville"],["(UTC+11:00) Chokurdakh","Asia/Srednekolymsk"],["(UTC+11:00) Magad\xe3","Asia/Magadan"],["(UTC+11:00) Ilha Norfolk","Pacific/Norfolk"],["(UTC+11:00) Sakhalin","Asia/Sakhalin"],["(UTC+11:00) Ilhas Salom\xe3o, Nova Caled\xf4nia","Pacific/Guadalcanal"],["(UTC+12:00) Anadyr, Petropavlovsk-Kamchatsky","Asia/Anadyr"],["(UTC+12:00) Auckland, Wellington","Pacific/Auckland"],["(UTC+12:00) Ilhas Fiji","Pacific/Fiji"],["(UTC+12:45) Ilhas Chatham","Pacific/Chatham"],["(UTC+13:00) Nuku'alofa","Pacific/Tongatapu"],["(UTC+13:00) Samoa","Pacific/Apia"],["(UTC+14:00) Ilha de Kiritimati","Pacific/Kiritimati"]];var _={"America/Guatemala":"America/Belize","America/Indianapolis":"America/Indiana/Indianapolis","America/La_Paz":"America/Manaus",UTC:"Africa/Monrovia","Atlantic/Reykjavik":"Africa/Monrovia","Europe/Berlin":"Europe/Amsterdam","Europe/Budapest":"Europe/Belgrade","Europe/Paris":"Europe/Brussels","Africa/Lagos":"Africa/Algiers","Europe/Bucharest":"Europe/Athens","Africa/Johannesburg":"Africa/Harare","Europe/Kiev":"Europe/Helsinki","Europe/Istanbul":"Asia/Istanbul","Asia/Riyadh":"Asia/Kuwait","Asia/Dubai":"Asia/Muscat","Asia/Calcutta":"Asia/Kolkata","Asia/Shanghai":"Asia/Chongqing","Asia/Singapore":"Asia/Kuala_Lumpur","Australia/Sydney":"Australia/Canberra","Pacific/Port_Moresby":"Pacific/Guam","Asia/Kamchatka":"Asia/Anadyr"};var m={"Africa/Abidjan":"Africa/Monrovia","Africa/Accra":"Africa/Monrovia","Africa/Addis_Ababa":"Europe/Moscow","Africa/Asmara":"Europe/Moscow","Africa/Asmera":"Europe/Moscow","Africa/Bamako":"Africa/Monrovia","Africa/Bangui":"Africa/Algiers","Africa/Banjul":"Africa/Monrovia","Africa/Bissau":"Africa/Monrovia","Africa/Blantyre":"Africa/Harare","Africa/Brazzaville":"Africa/Algiers","Africa/Bujumbura":"Africa/Harare","Africa/Ceuta":"Europe/Amsterdam","Africa/Conakry":"Africa/Monrovia","Africa/Dakar":"Africa/Monrovia","Africa/Dar_es_Salaam":"Europe/Moscow","Africa/Djibouti":"Europe/Moscow","Africa/Douala":"Africa/Algiers","Africa/El_Aaiun":"Africa/Casablanca","Africa/Freetown":"Africa/Monrovia","Africa/Gaborone":"Africa/Harare","Africa/Johannesburg":"Africa/Harare","Africa/Juba":"Europe/Moscow","Africa/Kampala":"Europe/Moscow","Africa/Khartoum":"Europe/Moscow","Africa/Kigali":"Africa/Harare","Africa/Kinshasa":"Africa/Algiers","Africa/Lagos":"Africa/Algiers","Africa/Libreville":"Africa/Algiers","Africa/Lome":"Africa/Monrovia","Africa/Luanda":"Africa/Algiers","Africa/Lubumbashi":"Africa/Harare","Africa/Lusaka":"Africa/Harare","Africa/Malabo":"Africa/Algiers","Africa/Maputo":"Africa/Harare","Africa/Maseru":"Africa/Harare","Africa/Mbabane":"Africa/Harare","Africa/Mogadishu":"Europe/Moscow","Africa/Ndjamena":"Africa/Algiers","Africa/Niamey":"Africa/Algiers","Africa/Nouakchott":"Africa/Monrovia","Africa/Ouagadougou":"Africa/Monrovia","Africa/Porto-Novo":"Africa/Algiers","Africa/Sao_Tome":"Africa/Monrovia","Africa/Timbuktu":"Africa/Monrovia","Africa/Tunis":"Africa/Algiers","America/Anguilla":"America/Manaus","America/Antigua":"America/Manaus","America/Araguaina":"America/Buenos_Aires","America/Argentina/Buenos_Aires":"America/Buenos_Aires","America/Argentina/Catamarca":"America/Buenos_Aires","America/Argentina/ComodRivadavia":"America/Buenos_Aires","America/Argentina/Cordoba":"America/Buenos_Aires","America/Argentina/Jujuy":"America/Buenos_Aires","America/Argentina/La_Rioja":"America/Buenos_Aires","America/Argentina/Mendoza":"America/Buenos_Aires","America/Argentina/Rio_Gallegos":"America/Buenos_Aires","America/Argentina/Salta":"America/Buenos_Aires","America/Argentina/San_Juan":"America/Buenos_Aires","America/Argentina/San_Luis":"America/Buenos_Aires","America/Argentina/Tucuman":"America/Buenos_Aires","America/Argentina/Ushuaia":"America/Buenos_Aires","America/Aruba":"America/Manaus","America/Atikokan":"America/Bogota","America/Atka":"America/Adak","America/Bahia_Banderas":"America/Mexico_City","America/Barbados":"America/Manaus","America/Belem":"America/Buenos_Aires","America/Blanc-Sablon":"America/Manaus","America/Boa_Vista":"America/Manaus","America/Boise":"America/Denver","America/Cambridge_Bay":"America/Denver","America/Campo_Grande":"America/Cuiaba","America/Catamarca":"America/Buenos_Aires","America/Cayman":"America/Bogota","America/Coral_Harbour":"America/Bogota","America/Cordoba":"America/Buenos_Aires","America/Costa_Rica":"America/Regina","America/Creston":"America/Phoenix","America/Curacao":"America/Manaus","America/Danmarkshavn":"Africa/Monrovia","America/Dawson":"America/Los_Angeles","America/Dawson_Creek":"America/Phoenix","America/Detroit":"America/New_York","America/Dominica":"America/Manaus","America/Edmonton":"America/Denver","America/Eirunepe":"America/Bogota","America/El_Salvador":"America/Regina","America/Ensenada":"America/Los_Angeles","America/Fort_Wayne":"America/New_York","America/Glace_Bay":"America/Halifax","America/Goose_Bay":"America/Halifax","America/Grenada":"America/Manaus","America/Guadeloupe":"America/Manaus","America/Guatemala":"America/Regina","America/Guayaquil":"America/Bogota","America/Guyana":"America/Manaus","America/Hermosillo":"America/Phoenix","America/Indiana/Knox":"America/Chicago","America/Indiana/Marengo":"America/New_York","America/Indiana/Petersburg":"America/New_York","America/Indiana/Tell_City":"America/Chicago","America/Indiana/Vevay":"America/New_York","America/Indiana/Vincennes":"America/New_York","America/Indiana/Winamac":"America/New_York","America/Indianapolis":"America/New_York","America/Inuvik":"America/Denver","America/Iqaluit":"America/New_York","America/Jamaica":"America/Bogota","America/Jujuy":"America/Buenos_Aires","America/Juneau":"America/Anchorage","America/Kentucky/Louisville":"America/New_York","America/Kentucky/Monticello":"America/New_York","America/Knox_IN":"America/Chicago","America/Kralendijk":"America/Manaus","America/La_Paz":"America/Manaus","America/Lima":"America/Bogota","America/Louisville":"America/New_York","America/Lower_Princes":"America/Manaus","America/Maceio":"America/Buenos_Aires","America/Managua":"America/Regina","America/Marigot":"America/Manaus","America/Martinique":"America/Manaus","America/Matamoros":"America/Chicago","America/Mazatlan":"America/Chihuahua","America/Mendoza":"America/Buenos_Aires","America/Menominee":"America/Chicago","America/Merida":"America/Mexico_City","America/Moncton":"America/Halifax","America/Monterrey":"America/Mexico_City","America/Montreal":"America/New_York","America/Montserrat":"America/Manaus","America/Nassau":"America/New_York","America/Nipigon":"America/New_York","America/Nome":"America/Anchorage","America/North_Dakota/Beulah":"America/Chicago","America/North_Dakota/Center":"America/Chicago","America/North_Dakota/New_Salem":"America/Chicago","America/Ojinaga":"America/Denver","America/Panama":"America/Bogota","America/Pangnirtung":"America/New_York","America/Paramaribo":"America/Buenos_Aires","America/Port_of_Spain":"America/Manaus","America/Porto_Acre":"America/Bogota","America/Porto_Velho":"America/Manaus","America/Puerto_Rico":"America/Manaus","America/Rainy_River":"America/Chicago","America/Rankin_Inlet":"America/Chicago","America/Recife":"America/Buenos_Aires","America/Resolute":"America/Chicago","America/Rio_Branco":"America/Bogota","America/Rosario":"America/Buenos_Aires","America/Santa_Isabel":"America/Los_Angeles","America/Santarem":"America/Buenos_Aires","America/Santo_Domingo":"America/Manaus","America/Scoresbysund":"Atlantic/Azores","America/Shiprock":"America/Denver","America/Sitka":"America/Anchorage","America/St_Barthelemy":"America/Manaus","America/St_Kitts":"America/Manaus","America/St_Lucia":"America/Manaus","America/St_Thomas":"America/Manaus","America/St_Vincent":"America/Manaus","America/Swift_Current":"America/Regina","America/Tegucigalpa":"America/Regina","America/Thule":"America/Halifax","America/Thunder_Bay":"America/New_York","America/Toronto":"America/New_York","America/Tortola":"America/Manaus","America/Vancouver":"America/Los_Angeles","America/Virgin":"America/Manaus","America/Whitehorse":"America/Los_Angeles","America/Winnipeg":"America/Chicago","America/Yakutat":"America/Anchorage","America/Yellowknife":"America/Denver","Antarctica/Casey":"Asia/Chongqing","Antarctica/Davis":"Asia/Bangkok","Antarctica/DumontDUrville":"Australia/Brisbane","Antarctica/Macquarie":"Pacific/Bougainville","Antarctica/Mawson":"Asia/Tashkent","Antarctica/McMurdo":"Pacific/Auckland","Antarctica/Palmer":"America/Santiago","Antarctica/Rothera":"America/Buenos_Aires","Antarctica/South_Pole":"Pacific/Auckland","Antarctica/Syowa":"Europe/Moscow","Antarctica/Vostok":"Asia/Dhaka","Arctic/Longyearbyen":"Europe/Amsterdam","Asia/Aden":"Europe/Moscow","Asia/Aqtau":"Asia/Tashkent","Asia/Aqtobe":"Asia/Tashkent","Asia/Ashgabat":"Asia/Tashkent","Asia/Ashkhabad":"Asia/Tashkent","Asia/Bahrain":"Europe/Moscow","Asia/Bishkek":"Asia/Dhaka","Asia/Brunei":"Asia/Chongqing","Asia/Calcutta":"Asia/Kolkata","Asia/Choibalsan":"Asia/Ulaanbaatar","Asia/Chungking":"Asia/Chongqing","Asia/Dacca":"Asia/Dhaka","Asia/Dili":"Asia/Tokyo","Asia/Dubai":"Asia/Muscat","Asia/Dushanbe":"Asia/Tashkent","Asia/Harbin":"Asia/Chongqing","Asia/Hebron":"Asia/Gaza","Asia/Ho_Chi_Minh":"Asia/Bangkok","Asia/Hong_Kong":"Asia/Chongqing","Asia/Jakarta":"Asia/Bangkok","Asia/Jayapura":"Asia/Tokyo","Asia/Kamchatka":"Asia/Anadyr","Asia/Kashgar":"Asia/Dhaka","Asia/Kathmandu":"Asia/Katmandu","Asia/Khandyga":"Asia/Tokyo","Asia/Kuching":"Asia/Chongqing","Asia/Macao":"Asia/Chongqing","Asia/Macau":"Asia/Chongqing","Asia/Makassar":"Asia/Chongqing","Asia/Manila":"Asia/Chongqing","Asia/Nicosia":"Europe/Athens","Asia/Novokuznetsk":"Asia/Bangkok","Asia/Omsk":"Asia/Dhaka","Asia/Oral":"Asia/Tashkent","Asia/Phnom_Penh":"Asia/Bangkok","Asia/Pontianak":"Asia/Bangkok","Asia/Qatar":"Europe/Moscow","Asia/Qyzylorda":"Asia/Dhaka","Asia/Riyadh":"Europe/Moscow","Asia/Saigon":"Asia/Bangkok","Asia/Samarkand":"Asia/Tashkent","Asia/Shanghai":"Asia/Chongqing","Asia/Singapore":"Asia/Chongqing","Asia/Tel_Aviv":"Asia/Jerusalem","Asia/Thimbu":"Asia/Dhaka","Asia/Thimphu":"Asia/Dhaka","Asia/Ujung_Pandang":"Asia/Chongqing","Asia/Ulan_Bator":"Asia/Ulaanbaatar","Asia/Urumqi":"Asia/Dhaka","Asia/Ust-Nera":"Australia/Brisbane","Asia/Vientiane":"Asia/Bangkok","Atlantic/Bermuda":"America/Halifax","Atlantic/Canary":"Europe/London","Atlantic/Faeroe":"Europe/London","Atlantic/Faroe":"Europe/London","Atlantic/Jan_Mayen":"Europe/Amsterdam","Atlantic/Madeira":"Europe/London","Atlantic/Reykjavik":"Africa/Monrovia","Atlantic/South_Georgia":"America/Noronha","Atlantic/St_Helena":"Africa/Monrovia","Atlantic/Stanley":"America/Buenos_Aires","Australia/ACT":"Australia/Canberra","Australia/Broken_Hill":"Australia/Adelaide","Australia/Currie":"Australia/Canberra","Australia/LHI":"Australia/Lord_Howe","Australia/Lindeman":"Australia/Brisbane","Australia/Melbourne":"Australia/Canberra","Australia/NSW":"Australia/Canberra","Australia/North":"Australia/Darwin","Australia/Queensland":"Australia/Brisbane","Australia/South":"Australia/Adelaide","Australia/Sydney":"Australia/Canberra","Australia/Tasmania":"Australia/Canberra","Australia/Victoria":"Australia/Canberra","Australia/West":"Asia/Chongqing","Australia/Yancowinna":"Australia/Adelaide","Brazil/Acre":"America/Bogota","Brazil/DeNoronha":"America/Noronha","Brazil/East":"America/Sao_Paulo","Brazil/West":"America/Manaus",CET:"Europe/Amsterdam",CST6CDT:"America/Chicago","Canada/Atlantic":"America/Halifax","Canada/Central":"America/Chicago","Canada/East-Saskatchewan":"America/Regina","Canada/Eastern":"America/New_York","Canada/Mountain":"America/Denver","Canada/Newfoundland":"America/St_Johns","Canada/Pacific":"America/Los_Angeles","Canada/Saskatchewan":"America/Regina","Canada/Yukon":"America/Los_Angeles","Chile/Continental":"America/Santiago","Chile/EasterIsland":"Pacific/Easter",Cuba:"America/Havana",EET:"Europe/Athens",EST:"America/New_York",EST5EDT:"America/New_York",Egypt:"Africa/Cairo",Eire:"Europe/London","Etc/GMT":"Africa/Monrovia","Etc/GMT+0":"Africa/Monrovia","Etc/GMT+1":"Atlantic/Cape_Verde","Etc/GMT+10":"Pacific/Honolulu","Etc/GMT+11":"Pacific/Midway","Etc/GMT+2":"America/Noronha","Etc/GMT+3":"America/Buenos_Aires","Etc/GMT+4":"America/Manaus","Etc/GMT+5":"America/Bogota","Etc/GMT+6":"America/Regina","Etc/GMT+7":"America/Phoenix","Etc/GMT-0":"Africa/Monrovia","Etc/GMT-1":"Africa/Algiers","Etc/GMT-10":"Australia/Brisbane","Etc/GMT-11":"Pacific/Bougainville","Etc/GMT-12":"Asia/Anadyr","Etc/GMT-13":"Pacific/Tongatapu","Etc/GMT-14":"Pacific/Kiritimati","Etc/GMT-2":"Africa/Harare","Etc/GMT-3":"Europe/Moscow","Etc/GMT-4":"Asia/Muscat","Etc/GMT-5":"Asia/Tashkent","Etc/GMT-6":"Asia/Dhaka","Etc/GMT-7":"Asia/Bangkok","Etc/GMT-8":"Asia/Chongqing","Etc/GMT-9":"Asia/Tokyo","Etc/GMT0":"Africa/Monrovia","Etc/Greenwich":"Africa/Monrovia","Etc/UCT":"Africa/Monrovia","Etc/UTC":"Africa/Monrovia","Etc/Universal":"Africa/Monrovia","Etc/Zulu":"Africa/Monrovia","Europe/Andorra":"Europe/Amsterdam","Europe/Belfast":"Europe/London","Europe/Berlin":"Europe/Amsterdam","Europe/Bratislava":"Europe/Amsterdam","Europe/Bucharest":"Europe/Athens","Europe/Budapest":"Europe/Amsterdam","Europe/Busingen":"Europe/Amsterdam","Europe/Copenhagen":"Europe/Amsterdam","Europe/Dublin":"Europe/London","Europe/Gibraltar":"Europe/Amsterdam","Europe/Guernsey":"Europe/London","Europe/Isle_of_Man":"Europe/London","Europe/Istanbul":"Asia/Istanbul","Europe/Jersey":"Europe/London","Europe/Kiev":"Europe/Athens","Europe/Kirov":"Europe/Moscow","Europe/Lisbon":"Europe/London","Europe/Ljubljana":"Europe/Amsterdam","Europe/Luxembourg":"Europe/Amsterdam","Europe/Madrid":"Europe/Amsterdam","Europe/Malta":"Europe/Amsterdam","Europe/Mariehamn":"Europe/Athens","Europe/Monaco":"Europe/Amsterdam","Europe/Nicosia":"Europe/Athens","Europe/Oslo":"Europe/Amsterdam","Europe/Paris":"Europe/Amsterdam","Europe/Podgorica":"Europe/Amsterdam","Europe/Prague":"Europe/Amsterdam","Europe/Riga":"Europe/Athens","Europe/Rome":"Europe/Amsterdam","Europe/San_Marino":"Europe/Amsterdam","Europe/Sarajevo":"Europe/Amsterdam","Europe/Simferopol":"Europe/Moscow","Europe/Skopje":"Europe/Amsterdam","Europe/Sofia":"Europe/Athens","Europe/Stockholm":"Europe/Amsterdam","Europe/Tallinn":"Europe/Athens","Europe/Tirane":"Europe/Amsterdam","Europe/Ulyanovsk":"Europe/Astrakhan","Europe/Uzhgorod":"Europe/Athens","Europe/Vaduz":"Europe/Amsterdam","Europe/Vatican":"Europe/Amsterdam","Europe/Vienna":"Europe/Amsterdam","Europe/Vilnius":"Europe/Athens","Europe/Volgograd":"Europe/Moscow","Europe/Zagreb":"Europe/Amsterdam","Europe/Zaporozhye":"Europe/Athens","Europe/Zurich":"Europe/Amsterdam",Factory:"Africa/Monrovia",GB:"Europe/London","GB-Eire":"Europe/London",GMT:"Africa/Monrovia","GMT+0":"Africa/Monrovia","GMT-0":"Africa/Monrovia",GMT0:"Africa/Monrovia",Greenwich:"Africa/Monrovia",HST:"Pacific/Honolulu",Hongkong:"Asia/Chongqing",Iceland:"Africa/Monrovia","Indian/Antananarivo":"Europe/Moscow","Indian/Chagos":"Asia/Dhaka","Indian/Christmas":"Asia/Bangkok","Indian/Cocos":"Asia/Rangoon","Indian/Comoro":"Europe/Moscow","Indian/Kerguelen":"Asia/Tashkent","Indian/Mahe":"Asia/Muscat","Indian/Maldives":"Asia/Tashkent","Indian/Mayotte":"Europe/Moscow","Indian/Reunion":"Asia/Muscat",Iran:"Asia/Tehran",Israel:"Asia/Jerusalem",Jamaica:"America/Bogota",Japan:"Asia/Tokyo",Kwajalein:"Asia/Anadyr",Libya:"Africa/Harare",MET:"Europe/Amsterdam",MST:"America/Denver",MST7MDT:"America/Denver","Mexico/BajaNorte":"America/Los_Angeles","Mexico/BajaSur":"America/Chihuahua","Mexico/General":"America/Mexico_City",NZ:"Pacific/Auckland","NZ-CHAT":"Pacific/Chatham",Navajo:"America/Denver",PRC:"Asia/Chongqing",PST8PDT:"America/Los_Angeles","Pacific/Chuuk":"Australia/Brisbane","Pacific/Efate":"Pacific/Bougainville","Pacific/Enderbury":"Pacific/Tongatapu","Pacific/Fakaofo":"Pacific/Tongatapu","Pacific/Funafuti":"Asia/Anadyr","Pacific/Galapagos":"America/Regina","Pacific/Johnston":"Pacific/Honolulu","Pacific/Kosrae":"Pacific/Bougainville","Pacific/Kwajalein":"Asia/Anadyr","Pacific/Majuro":"Asia/Anadyr","Pacific/Nauru":"Asia/Anadyr","Pacific/Niue":"Pacific/Midway","Pacific/Noumea":"Pacific/Bougainville","Pacific/Pago_Pago":"Pacific/Midway","Pacific/Palau":"Asia/Tokyo","Pacific/Pohnpei":"Pacific/Bougainville","Pacific/Ponape":"Pacific/Bougainville","Pacific/Port_Moresby":"Australia/Brisbane","Pacific/Rarotonga":"Pacific/Honolulu","Pacific/Saipan":"Australia/Brisbane","Pacific/Samoa":"Pacific/Midway","Pacific/Tahiti":"Pacific/Honolulu","Pacific/Tarawa":"Asia/Anadyr","Pacific/Truk":"Australia/Brisbane","Pacific/Wake":"Asia/Anadyr","Pacific/Wallis":"Asia/Anadyr","Pacific/Yap":"Australia/Brisbane",Poland:"Europe/Amsterdam",Portugal:"Europe/London",ROC:"Asia/Chongqing",ROK:"Asia/Tokyo",Singapore:"Asia/Chongqing",Turkey:"Asia/Istanbul",UCT:"Africa/Monrovia","US/Alaska":"America/Anchorage","US/Aleutian":"America/Adak","US/Arizona":"America/Phoenix","US/Central":"America/Chicago","US/East-Indiana":"America/New_York","US/Eastern":"America/New_York","US/Hawaii":"Pacific/Honolulu","US/Indiana-Starke":"America/Chicago","US/Michigan":"America/New_York","US/Mountain":"America/Denver","US/Pacific":"America/Los_Angeles","US/Pacific-New":"America/Los_Angeles","US/Samoa":"Pacific/Midway",UTC:"Africa/Monrovia",Universal:"Africa/Monrovia","W-SU":"Europe/Moscow",WET:"Europe/Amsterdam",Zulu:"Africa/Monrovia"};var f={"America/Fort_Nelson":"America/Denver"};return e};true;"undefined"!==typeof e&&e.exports&&(t=e.exports=a);t.TimezoneDetector=a}).call(function(){return this||("undefined"!==typeof window?window:i)}())}).call(this,i(49))},1364:function(e,t){(function(){TS.registerModule("coachmark",{$coachmark:null,context:null,is_showing:false,is_small:false,reject_on_off_target_click:false,onStart:function e(){},start:function a(r,s,o){if(!r)return;TS.coachmark.is_showing&&TS.coachmark.end();TS.coachmark.$coachmark||t(r,s);i(r);var l=TS.coachmark.$coachmark;if(!$("#"+r.coachmark_el_id).length){TS.error(["Cannot show coachmark ",r.id," because there is no element ",r.coachmark_el_id,""].join('"'));l.addClass("hidden");return}o=o||{};TS.coachmark.clean();TS.coachmark.context=r;TS.model.coachmark_is_showing=true;TS.coachmark.is_showing=true;TS.coachmark.reject_on_off_target_click=_.get(o,"reject_on_off_target_click",false);l.removeClass("hidden");l.css("left","").css("right","").css("top","").css("bottom","").css("height","auto").css("width","auto");$("#coachmark_callout").css("left","").css("right","").css("top","").css("bottom","");l.addClass(r.coachmark_el_id);$("#"+r.coachmark_el_id).removeClass("hidden");r.reject||$("#coachmark_footer > .coachmark_footer_text").addClass("hidden");$(window.document).bind("keydown",TS.coachmark.onKeyDown);r.has_close_btn?$("#coachmark_bg").on("click",function(){TS.coachmark.end();n()}):$("html").bind("mousedown",TS.coachmark.onMouseDown);r.disable_scrolling&&$("#client-ui").addClass("disable_scrolling");l.css("opacity",1);if(r.place&&r.placeSmall){l.addClass("small_coachmark");TS.coachmark.is_small=true}e();$(window).on("resize.coachmark_placement",e);if(TS.coachmark.context.ui_click){$(".coachmark_got_it").removeClass("hidden");$(".coachmark_next_tip").addClass("hidden")}TS.coachmark.context.no_bg_on_small||TS.coachmark.context.no_bg||$("#coachmark_bg").removeClass("hidden")},placeRightOf:function e(t,i,n,a,r){if(!TS.coachmark.context||!TS.coachmark.$coachmark)return;i=i||0;n=n||0;a=a||0;var s=TS.coachmark.$coachmark;var o=30;var l=18;var c;c=r?{top:0,left:0}:t.offset();s.css("top",c.top+i);s.css("left",c.left+t.width()+n);r||TS.coachmark.keepInBounds();var d=s.dimensions_rect();r?$("#coachmark_callout").css("top",l+a).css("left",-10):$("#coachmark_callout").css("top",Math.round(_.clamp(c.top-d.top+(t.height()-o)/2+a,l,d.height-(l+o)))).css("left",-10)},placeBelowOf:function e(t,i,n,a,r){if(!TS.coachmark.context||!TS.coachmark.$coachmark)return;i=i||0;n=n||0;a=a||0;var s=TS.coachmark.$coachmark;var o=30;var l=18;var c;c=r?{top:0,left:0}:t.offset();s.css("top",c.top+t.height()+i);s.css("left",c.left+n);r||TS.coachmark.keepInBounds();var d=s.dimensions_rect();r?$("#coachmark_callout").css("left",l+a).css("top",-10):$("#coachmark_callout").css("left",Math.round(_.clamp(c.left-d.left+(t.width()-o)/2+a,l,d.width-(l+o)))).css("top",-10)},placeAboveOf:function e(t,i,n,a,r){if(!TS.coachmark.context||!TS.coachmark.$coachmark)return;i=i||0;n=n||0;a=a||0;var s=TS.coachmark.$coachmark;var o=30;var l=18;var c;c=r?{top:0,left:0}:t.offset();s.css("top",c.top-o-s.height()+i);s.css("left",c.left+n);r||TS.coachmark.keepInBounds();var d=s.dimensions_rect();r?$("#coachmark_callout").css("left",l+a).css("bottom",-10):$("#coachmark_callout").css("left",Math.round(_.clamp(c.left-d.left+(t.width()-o)/2+a,l,d.width-(l+o)))).css("bottom",-10)},placeLeftOf:function e(t,i,n,a,r){if(!TS.coachmark.context||!TS.coachmark.$coachmark)return;i=i||0;n=n||0;a=a||0;var s=TS.coachmark.$coachmark;var o=30;var l=18;var c;c=r?{top:0,left:0}:t.offset();s.css("top",c.top+i);s.css("left",c.left-s.width()+n);r||TS.coachmark.keepInBounds();var d=s.dimensions_rect();r?$("#coachmark_callout").css("top",l+a).css("right",-10):$("#coachmark_callout").css("top",Math.round(_.clamp(c.top-d.top+(t.height()-o)/2+a,l,d.height-(l+o)))).css("right",-10)},keepInBounds:function e(){if(!TS.coachmark.context||!TS.coachmark.$coachmark)return;var t=TS.coachmark.$coachmark;var i=TS.coachmark.context;var n=4;var a=t.dimensions_rect();var r={top:0+n,right:$(window).width()-n,bottom:$(window).height()-n,left:0+n};i.place||t.css("left","").css("right","").css("top","").css("bottom","");if(TS.utility.doesRectContainRect(r,a))return;a.left<r.left?t.css("left",r.left):a.right>r.right&&t.css("left",Math.max(r.left,r.right-a.width));a.top<r.top?t.css("top",r.top):a.bottom>r.bottom&&t.css("top",Math.max(r.top,r.bottom-a.height))},clean:function e(){$("#coachmark_footer > .coachmark_footer_text").removeClass("hidden");TS.coachmark.context&&TS.coachmark.$coachmark.removeClass(TS.coachmark.context.coachmark_el_id).removeClass("small_coachmark");TS.coachmark.is_small=false;TS.coachmark.context=null},reject:function e(t){var i=TS.coachmark.context;i&&i.reject&&i.reject();TS.coachmark.end();n();TS.newxp&&TS.interop.clog.track("GROWTH_ONBOARDING",{action:"skip_tutorial_step",step:TS.newxp.getCurrentStepName()});t&&t.stopPropagation()},resolve:function e(t){var i=TS.coachmark.context;i&&i.resolve&&i.resolve();TS.coachmark.end();t&&t.stopPropagation()},expand:function t(i){var n=TS.coachmark.$coachmark;var a=n.find("#coachmark_interior");if(TS.coachmark.is_small){TS.coachmark.is_small=false;a.css("opacity",0);n.removeClass("small_coachmark");e();$("#coachmark_bg").removeClass("hidden");window.setTimeout(function(){a.css("opacity",1)},100)}i&&i.stopPropagation()},end:function e(){TS.model.coachmark_is_showing=false;TS.coachmark.is_showing=false;var t=TS.coachmark.$coachmark;t.css("opacity",0);TS.coachmark.$coachmark.find(".coachmark_div").remove();TS.coachmark.clean();t.addClass("hidden");$("#coachmark_bg").addClass("hidden");$("#client-ui").removeClass("disable_scrolling");TS.coachmark.$coachmark.remove();TS.coachmark.$coachmark=null;$(window.document).off("keydown",TS.coachmark.onKeyDown);$("html").off("mousedown",TS.coachmark.onMouseDown);$(window).off("resize.coachmark_placement");$("#coachmark_bg").off("click",TS.coachmark.end)},onKeyDown:function e(t){t.which==TS.utility.keymap.esc?TS.coachmark.reject(t):t.which!=TS.utility.keymap.enter||TS.coachmark.context.enter_does_not_dismiss||(TS.coachmark.is_small?TS.coachmark.expand(t):TS.coachmark.resolve(t))},onMouseDown:function e(t){TS.coachmark.is_small?TS.coachmark.expand(t):$(t.target).closest("#coachmark").length||(TS.coachmark.reject_on_off_target_click?TS.coachmark.reject(t):TS.coachmark.resolve(t))},onClickInvite:function e(t){if($(t.target).is("#coachmark_bg"))return TS.coachmark.resolve(t);TS.ui.admin_invites.canInvite()&&TS.ui.admin_invites.start();return TS.coachmark.resolve(t)}});var e=function e(){var t=TS.coachmark.context;t.placeSmall&&TS.coachmark.is_small?t.placeSmall():t.place?t.place():TS.coachmark.keepInBounds()};var t=function e(t,i){var n;n=i?$("."+t.inline_wrapper_el_class):$("#client-ui");!n.length&&TS.calls&&(n=$("#calls_conference_content"));n.append(TS.templates.coachmark({has_close_btn:t.has_close_btn,no_footer:t.no_footer}));TS.coachmark.$coachmark=$("#coachmark");var a=TS.coachmark.$coachmark;a.css("opacity",0);a.on("click",".coachmark_skip_link",TS.coachmark.reject);a.on("click",".coachmark_got_it",TS.coachmark.resolve);a.on("click",".coachmark_next_tip",TS.coachmark.resolve);a.on("click",".coachmark_ok",TS.coachmark.resolve);a.on("click",".coachmark_close_btn",TS.coachmark.reject)};var i=function e(t){if(!TS.coachmark.$coachmark)return;t.content&&TS.coachmark.$coachmark.find("#coachmark_interior").prepend(t.content());t.buttonText?TS.coachmark.$coachmark.find(".coachmark_next_tip").text(t.buttonText()):TS.coachmark.$coachmark.find(".coachmark_next_tip").text(TS.interop.i18n.t("Next Tip","coachmarks")());t.footer&&TS.coachmark.$coachmark.find("#coachmark_footer").html(t.footer())};var n=function e(){TS.prefs.getPref("lessons_enabled")&&TS.lessons.inOnboarding()&&TS.lessons.coachmark_closed_sig.dispatch(true)}})()},137:function(e,t,i){var n=i(60);var a=i(66);var r=i(182)(false);var s=i(101)("IE_PROTO");e.exports=function(e,t){var i=a(e);var o=0;var l=[];var c;for(c in i)c!=s&&n(i,c)&&l.push(c);while(t.length>o)n(i,c=t[o++])&&(~r(l,c)||l.push(c));return l}},1409:function(e,t,i){(function(t){e.exports=t["EXIF"]=i(1955)}).call(this,i(49))},146:function(e,t,i){var n=i(181);e.exports=function(e,t,i){n(e);if(void 0===t)return e;switch(i){case 1:return function(i){return e.call(t,i)};case 2:return function(i,n){return e.call(t,i,n)};case 3:return function(i,n,a){return e.call(t,i,n,a)}}return function(){return e.apply(t,arguments)}}},148:function(e,t,i){i(220);var n=i(46);var a=i(64);var r=i(80);var s=i(43)("toStringTag");var o="CSSRuleList,CSSStyleDeclaration,CSSValueList,ClientRectList,DOMRectList,DOMStringList,DOMTokenList,DataTransferItemList,FileList,HTMLAllCollection,HTMLCollection,HTMLFormElement,HTMLSelectElement,MediaList,MimeTypeArray,NamedNodeMap,NodeList,PaintRequestList,Plugin,PluginArray,SVGLengthList,SVGNumberList,SVGPathSegList,SVGPointList,SVGStringList,SVGTransformList,SourceBufferList,StyleSheetList,TextTrackCueList,TextTrackList,TouchList".split(",");for(var l=0;l<o.length;l++){var c=o[l];var d=n[c];var u=d&&d.prototype;u&&!u[s]&&a(u,s,c);r[c]=r.Array}},154:function(e,t,i){var n=i(95);var a=Math.min;e.exports=function(e){return e>0?a(n(e),9007199254740991):0}},155:function(e,t,i){"use strict";var n=i(127);var a=i(86);var r=i(168);var s=i(64);var o=i(60);var l=i(80);var c=i(209);var d=i(119);var u=i(205);var _=i(43)("iterator");var m=!([].keys&&"next"in[].keys());var f="@@iterator";var h="keys";var p="values";var g=function(){return this};e.exports=function(e,t,i,T,S,v,b){c(i,t,T);var w=function(e){if(!m&&e in C)return C[e];switch(e){case h:return function t(){return new i(this,e)};case p:return function t(){return new i(this,e)}}return function t(){return new i(this,e)}};var y=t+" Iterator";var A=S==p;var k=false;var C=e.prototype;var x=C[_]||C[f]||S&&C[S];var I=!m&&x||w(S);var M=S?A?w("entries"):I:void 0;var E="Array"==t&&C.entries||x;var B,P,U;if(E){U=u(E.call(new e));if(U!==Object.prototype&&U.next){d(U,y,true);n||o(U,_)||s(U,_,g)}}if(A&&x&&x.name!==p){k=true;I=function e(){return x.call(this)}}n&&!b||!m&&!k&&C[_]||s(C,_,I);l[t]=I;l[y]=g;if(S){B={values:A?I:w(p),keys:v?I:w(h),entries:M};if(b)for(P in B)P in C||r(C,P,B[P]);else a(a.P+a.F*(m||k),t,B)}return B}},156:function(e,t,i){t.f=i(43)},157:function(e,t,i){var n=i(46);var a=i(52);var r=i(127);var s=i(156);var o=i(58).f;e.exports=function(e){var t=a.Symbol||(a.Symbol=r?{}:n.Symbol||{});"_"==e.charAt(0)||e in t||o(t,e,{value:s.f(e)})}},163:function(e,t,i){var n=i(71);var a=i(204);var r=i(110);var s=i(101)("IE_PROTO");var o=function(){};var l="prototype";var c=function(){var e=i(126)("iframe");var t=r.length;var n="<";var a=">";var s;e.style.display="none";i(210).appendChild(e);e.src="javascript:";s=e.contentWindow.document;s.open();s.write(n+"script"+a+"document.F=Object"+n+"/script"+a);s.close();c=s.F;while(t--)delete c[l][r[t]];return c()};e.exports=Object.create||function e(t,i){var r;if(null!==t){o[l]=n(t);r=new o;o[l]=null;r[s]=t}else r=c();return void 0===i?r:a(r,i)}},168:function(e,t,i){e.exports=i(64)},181:function(e,t){e.exports=function(e){if("function"!=typeof e)throw TypeError(e+" is not a function!");return e}},182:function(e,t,i){var n=i(66);var a=i(154);var r=i(183);e.exports=function(e){return function(t,i,s){var o=n(t);var l=a(o.length);var c=r(s,l);var d;if(e&&i!=i)while(l>c){d=o[c++];if(d!=d)return true}else for(;l>c;c++)if((e||c in o)&&o[c]===i)return e||c||0;return!e&&-1}}},183:function(e,t,i){var n=i(95);var a=Math.max;var r=Math.min;e.exports=function(e,t){e=n(e);return e<0?a(e+t,0):r(e,t)}},191:function(e,t,i){var n=i(137);var a=i(110).concat("length","prototype");t.f=Object.getOwnPropertyNames||function e(t){return n(t,a)}},192:function(e,t,i){var n=i(114);var a=i(43)("toStringTag");var r="Arguments"==n(function(){return arguments}());var s=function(e,t){try{return e[t]}catch(e){}};e.exports=function(e){var t,i,o;return void 0===e?"Undefined":null===e?"Null":"string"==typeof(i=s(t=Object(e),a))?i:r?n(t):"Object"==(o=n(t))&&"function"==typeof t.callee?"Arguments":o}},1955:function(e,t,i){var a,r;(function(){var i=false;var s=this;var o=function(e){if(e instanceof o)return e;if(!(this instanceof o))return new o(e);this.EXIFwrapped=e};true;"undefined"!==typeof e&&e.exports&&(t=e.exports=o);t.EXIF=o;var l=o.Tags={36864:"ExifVersion",40960:"FlashpixVersion",40961:"ColorSpace",40962:"PixelXDimension",40963:"PixelYDimension",37121:"ComponentsConfiguration",37122:"CompressedBitsPerPixel",37500:"MakerNote",37510:"UserComment",40964:"RelatedSoundFile",36867:"DateTimeOriginal",36868:"DateTimeDigitized",37520:"SubsecTime",37521:"SubsecTimeOriginal",37522:"SubsecTimeDigitized",33434:"ExposureTime",33437:"FNumber",34850:"ExposureProgram",34852:"SpectralSensitivity",34855:"ISOSpeedRatings",34856:"OECF",37377:"ShutterSpeedValue",37378:"ApertureValue",37379:"BrightnessValue",37380:"ExposureBias",37381:"MaxApertureValue",37382:"SubjectDistance",37383:"MeteringMode",37384:"LightSource",37385:"Flash",37396:"SubjectArea",37386:"FocalLength",41483:"FlashEnergy",41484:"SpatialFrequencyResponse",41486:"FocalPlaneXResolution",41487:"FocalPlaneYResolution",41488:"FocalPlaneResolutionUnit",41492:"SubjectLocation",41493:"ExposureIndex",41495:"SensingMethod",41728:"FileSource",41729:"SceneType",41730:"CFAPattern",41985:"CustomRendered",41986:"ExposureMode",41987:"WhiteBalance",41988:"DigitalZoomRation",41989:"FocalLengthIn35mmFilm",41990:"SceneCaptureType",41991:"GainControl",41992:"Contrast",41993:"Saturation",41994:"Sharpness",41995:"DeviceSettingDescription",41996:"SubjectDistanceRange",40965:"InteroperabilityIFDPointer",42016:"ImageUniqueID"};var c=o.TiffTags={256:"ImageWidth",257:"ImageHeight",34665:"ExifIFDPointer",34853:"GPSInfoIFDPointer",40965:"InteroperabilityIFDPointer",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",274:"Orientation",277:"SamplesPerPixel",284:"PlanarConfiguration",530:"YCbCrSubSampling",531:"YCbCrPositioning",282:"XResolution",283:"YResolution",296:"ResolutionUnit",273:"StripOffsets",278:"RowsPerStrip",279:"StripByteCounts",513:"JPEGInterchangeFormat",514:"JPEGInterchangeFormatLength",301:"TransferFunction",318:"WhitePoint",319:"PrimaryChromaticities",529:"YCbCrCoefficients",532:"ReferenceBlackWhite",306:"DateTime",270:"ImageDescription",271:"Make",272:"Model",305:"Software",315:"Artist",33432:"Copyright"};var d=o.GPSTags={0:"GPSVersionID",1:"GPSLatitudeRef",2:"GPSLatitude",3:"GPSLongitudeRef",4:"GPSLongitude",5:"GPSAltitudeRef",6:"GPSAltitude",7:"GPSTimeStamp",8:"GPSSatellites",9:"GPSStatus",10:"GPSMeasureMode",11:"GPSDOP",12:"GPSSpeedRef",13:"GPSSpeed",14:"GPSTrackRef",15:"GPSTrack",16:"GPSImgDirectionRef",17:"GPSImgDirection",18:"GPSMapDatum",19:"GPSDestLatitudeRef",20:"GPSDestLatitude",21:"GPSDestLongitudeRef",22:"GPSDestLongitude",23:"GPSDestBearingRef",24:"GPSDestBearing",25:"GPSDestDistanceRef",26:"GPSDestDistance",27:"GPSProcessingMethod",28:"GPSAreaInformation",29:"GPSDateStamp",30:"GPSDifferential"};var u=o.IFD1Tags={256:"ImageWidth",257:"ImageHeight",258:"BitsPerSample",259:"Compression",262:"PhotometricInterpretation",273:"StripOffsets",274:"Orientation",277:"SamplesPerPixel",278:"RowsPerStrip",279:"StripByteCounts",282:"XResolution",283:"YResolution",284:"PlanarConfiguration",296:"ResolutionUnit",513:"JpegIFOffset",514:"JpegIFByteCount",529:"YCbCrCoefficients",530:"YCbCrSubSampling",531:"YCbCrPositioning",532:"ReferenceBlackWhite"};var _=o.StringValues={ExposureProgram:{0:"Not defined",1:"Manual",2:"Normal program",3:"Aperture priority",4:"Shutter priority",5:"Creative program",6:"Action program",7:"Portrait mode",8:"Landscape mode"},MeteringMode:{0:"Unknown",1:"Average",2:"CenterWeightedAverage",3:"Spot",4:"MultiSpot",5:"Pattern",6:"Partial",255:"Other"},LightSource:{0:"Unknown",1:"Daylight",2:"Fluorescent",3:"Tungsten (incandescent light)",4:"Flash",9:"Fine weather",10:"Cloudy weather",11:"Shade",12:"Daylight fluorescent (D 5700 - 7100K)",13:"Day white fluorescent (N 4600 - 5400K)",14:"Cool white fluorescent (W 3900 - 4500K)",15:"White fluorescent (WW 3200 - 3700K)",17:"Standard light A",18:"Standard light B",19:"Standard light C",20:"D55",21:"D65",22:"D75",23:"D50",24:"ISO studio tungsten",255:"Other"},Flash:{0:"Flash did not fire",1:"Flash fired",5:"Strobe return light not detected",7:"Strobe return light detected",9:"Flash fired, compulsory flash mode",13:"Flash fired, compulsory flash mode, return light not detected",15:"Flash fired, compulsory flash mode, return light detected",16:"Flash did not fire, compulsory flash mode",24:"Flash did not fire, auto mode",25:"Flash fired, auto mode",29:"Flash fired, auto mode, return light not detected",31:"Flash fired, auto mode, return light detected",32:"No flash function",65:"Flash fired, red-eye reduction mode",69:"Flash fired, red-eye reduction mode, return light not detected",71:"Flash fired, red-eye reduction mode, return light detected",73:"Flash fired, compulsory flash mode, red-eye reduction mode",77:"Flash fired, compulsory flash mode, red-eye reduction mode, return light not detected",79:"Flash fired, compulsory flash mode, red-eye reduction mode, return light detected",89:"Flash fired, auto mode, red-eye reduction mode",93:"Flash fired, auto mode, return light not detected, red-eye reduction mode",95:"Flash fired, auto mode, return light detected, red-eye reduction mode"},SensingMethod:{1:"Not defined",2:"One-chip color area sensor",3:"Two-chip color area sensor",4:"Three-chip color area sensor",5:"Color sequential area sensor",7:"Trilinear sensor",8:"Color sequential linear sensor"},SceneCaptureType:{0:"Standard",1:"Landscape",2:"Portrait",3:"Night scene"},SceneType:{1:"Directly photographed"},CustomRendered:{0:"Normal process",1:"Custom process"},WhiteBalance:{0:"Auto white balance",1:"Manual white balance"},GainControl:{0:"None",1:"Low gain up",2:"High gain up",3:"Low gain down",4:"High gain down"},Contrast:{0:"Normal",1:"Soft",2:"Hard"},Saturation:{0:"Normal",1:"Low saturation",2:"High saturation"},Sharpness:{0:"Normal",1:"Soft",2:"Hard"},SubjectDistanceRange:{0:"Unknown",1:"Macro",2:"Close view",3:"Distant view"},FileSource:{3:"DSC"},Components:{0:"",1:"Y",2:"Cb",3:"Cr",4:"R",5:"G",6:"B"}};function m(e,t,i){e.addEventListener?e.addEventListener(t,i,false):e.attachEvent&&e.attachEvent("on"+t,i)}function f(e){return!!e.exifdata}function h(e,t){t=t||e.match(/^data\:([^\;]+)\;base64,/im)[1]||"";e=e.replace(/^data\:([^\;]+)\;base64,/gim,"");var i=atob(e);var n=i.length;var a=new ArrayBuffer(n);var r=new Uint8Array(a);for(var s=0;s<n;s++)r[s]=i.charCodeAt(s);return a}function p(e,t){var i=new XMLHttpRequest;i.open("GET",e,true);i.responseType="blob";i.onload=function(e){200!=this.status&&0!==this.status||t(this.response)};i.send()}function g(e,t){function n(i){var n=T(i);e.exifdata=n||{};var a=S(i);e.iptcdata=a||{};if(o.isXmpEnabled){var r=I(i);e.xmpdata=r||{}}t&&t.call(e)}if(e.src)if(/^data\:/i.test(e.src)){var a=h(e.src);n(a)}else if(/^blob\:/i.test(e.src)){var r=new FileReader;r.onload=function(e){n(e.target.result)};p(e.src,function(e){r.readAsArrayBuffer(e)})}else{var s=new XMLHttpRequest;s.onload=function(){if(200!=this.status&&0!==this.status)throw"Could not load image";n(s.response);s=null};s.open("GET",e.src,true);s.responseType="arraybuffer";s.send(null)}else if(self.FileReader&&(e instanceof self.Blob||e instanceof self.File)){var r=new FileReader;r.onload=function(e){i&&console.log("Got file of length "+e.target.result.byteLength);n(e.target.result)};r.readAsArrayBuffer(e)}}function T(e){var t=new DataView(e);i&&console.log("Got file of length "+e.byteLength);if(255!=t.getUint8(0)||216!=t.getUint8(1)){i&&console.log("Not a valid JPEG");return false}var n=2,a=e.byteLength,r;while(n<a){if(255!=t.getUint8(n)){i&&console.log("Not a valid marker at offset "+n+", found: "+t.getUint8(n));return false}r=t.getUint8(n+1);i&&console.log(r);if(225==r){i&&console.log("Found 0xFFE1 marker");return x(t,n+4,t.getUint16(n+2)-2)}n+=2+t.getUint16(n+2)}}function S(e){var t=new DataView(e);i&&console.log("Got file of length "+e.byteLength);if(255!=t.getUint8(0)||216!=t.getUint8(1)){i&&console.log("Not a valid JPEG");return false}var n=2,a=e.byteLength;var r=function(e,t){return 56===e.getUint8(t)&&66===e.getUint8(t+1)&&73===e.getUint8(t+2)&&77===e.getUint8(t+3)&&4===e.getUint8(t+4)&&4===e.getUint8(t+5)};while(n<a){if(r(t,n)){var s=t.getUint8(n+7);s%2!==0&&(s+=1);0===s&&(s=4);var o=n+8+s;var l=t.getUint16(n+6+s);return b(e,o,l)}n++}}var v={120:"caption",110:"credit",25:"keywords",55:"dateCreated",80:"byline",85:"bylineTitle",122:"captionWriter",105:"headline",116:"copyright",15:"category"};function b(e,t,i){var n=new DataView(e);var a={};var r,s,o,l,c;var d=t;while(d<t+i){if(28===n.getUint8(d)&&2===n.getUint8(d+1)){l=n.getUint8(d+2);if(l in v){o=n.getInt16(d+3);c=o+5;s=v[l];r=C(n,d+5,o);a.hasOwnProperty(s)?a[s]instanceof Array?a[s].push(r):a[s]=[a[s],r]:a[s]=r}}d++}return a}function w(e,t,n,a,r){var s=e.getUint16(n,!r),o={},l,c,d;for(d=0;d<s;d++){l=n+12*d+2;c=a[e.getUint16(l,!r)];!c&&i&&console.log("Unknown tag: "+e.getUint16(l,!r));o[c]=y(e,l,t,n,r)}return o}function y(e,t,i,n,a){var r=e.getUint16(t+2,!a),s=e.getUint32(t+4,!a),o=e.getUint32(t+8,!a)+i,l,c,d,u,_,m;switch(r){case 1:case 7:if(1==s)return e.getUint8(t+8,!a);l=s>4?o:t+8;c=[];for(u=0;u<s;u++)c[u]=e.getUint8(l+u);return c;case 2:l=s>4?o:t+8;return C(e,l,s-1);case 3:if(1==s)return e.getUint16(t+8,!a);l=s>2?o:t+8;c=[];for(u=0;u<s;u++)c[u]=e.getUint16(l+2*u,!a);return c;case 4:if(1==s)return e.getUint32(t+8,!a);c=[];for(u=0;u<s;u++)c[u]=e.getUint32(o+4*u,!a);return c;case 5:if(1==s){_=e.getUint32(o,!a);m=e.getUint32(o+4,!a);d=new Number(_/m);d.numerator=_;d.denominator=m;return d}c=[];for(u=0;u<s;u++){_=e.getUint32(o+8*u,!a);m=e.getUint32(o+4+8*u,!a);c[u]=new Number(_/m);c[u].numerator=_;c[u].denominator=m}return c;case 9:if(1==s)return e.getInt32(t+8,!a);c=[];for(u=0;u<s;u++)c[u]=e.getInt32(o+4*u,!a);return c;case 10:if(1==s)return e.getInt32(o,!a)/e.getInt32(o+4,!a);c=[];for(u=0;u<s;u++)c[u]=e.getInt32(o+8*u,!a)/e.getInt32(o+4+8*u,!a);return c}}function A(e,t,i){var n=e.getUint16(t,!i);return e.getUint32(t+2+12*n,!i)}function k(e,t,i,n){var a=A(e,t+i,n);if(!a)return{};if(a>e.byteLength)return{};var r=w(e,t,t+a,u,n);if(r["Compression"])switch(r["Compression"]){case 6:if(r.JpegIFOffset&&r.JpegIFByteCount){var s=t+r.JpegIFOffset;var o=r.JpegIFByteCount;r["blob"]=new Blob([new Uint8Array(e.buffer,s,o)],{type:"image/jpeg"})}break;case 1:console.log("Thumbnail image format is TIFF, which is not implemented.");break;default:console.log("Unknown thumbnail image format '%s'",r["Compression"])}else 2==r["PhotometricInterpretation"]&&console.log("Thumbnail image format is RGB, which is not implemented.");return r}function C(e,t,i){var a="";for(n=t;n<t+i;n++)a+=String.fromCharCode(e.getUint8(n));return a}function x(e,t){if("Exif"!=C(e,t,4)){i&&console.log("Not valid EXIF data! "+C(e,t,4));return false}var n,a,r,s,o,u=t+6;if(18761==e.getUint16(u))n=false;else{if(19789!=e.getUint16(u)){i&&console.log("Not valid TIFF data! (no 0x4949 or 0x4D4D)");return false}n=true}if(42!=e.getUint16(u+2,!n)){i&&console.log("Not valid TIFF data! (no 0x002A)");return false}var m=e.getUint32(u+4,!n);if(m<8){i&&console.log("Not valid TIFF data! (First offset less than 8)",e.getUint32(u+4,!n));return false}a=w(e,u,u+m,c,n);if(a.ExifIFDPointer){s=w(e,u,u+a.ExifIFDPointer,l,n);for(r in s){switch(r){case"LightSource":case"Flash":case"MeteringMode":case"ExposureProgram":case"SensingMethod":case"SceneCaptureType":case"SceneType":case"CustomRendered":case"WhiteBalance":case"GainControl":case"Contrast":case"Saturation":case"Sharpness":case"SubjectDistanceRange":case"FileSource":s[r]=_[r][s[r]];break;case"ExifVersion":case"FlashpixVersion":s[r]=String.fromCharCode(s[r][0],s[r][1],s[r][2],s[r][3]);break;case"ComponentsConfiguration":s[r]=_.Components[s[r][0]]+_.Components[s[r][1]]+_.Components[s[r][2]]+_.Components[s[r][3]];break}a[r]=s[r]}}if(a.GPSInfoIFDPointer){o=w(e,u,u+a.GPSInfoIFDPointer,d,n);for(r in o){switch(r){case"GPSVersionID":o[r]=o[r][0]+"."+o[r][1]+"."+o[r][2]+"."+o[r][3];break}a[r]=o[r]}}a["thumbnail"]=k(e,u,m,n);return a}function I(e){if(!("DOMParser"in self))return;var t=new DataView(e);i&&console.log("Got file of length "+e.byteLength);if(255!=t.getUint8(0)||216!=t.getUint8(1)){i&&console.log("Not a valid JPEG");return false}var n=2,a=e.byteLength,r=new DOMParser;while(n<a-4){if("http"==C(t,n,4)){var s=n-1;var o=t.getUint16(n-2)-1;var l=C(t,s,o);var c=l.indexOf("xmpmeta>")+8;l=l.substring(l.indexOf("<x:xmpmeta"),c);var d=l.indexOf("x:xmpmeta")+10;l=l.slice(0,d)+'xmlns:Iptc4xmpCore="http://iptc.org/std/Iptc4xmpCore/1.0/xmlns/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:tiff="http://ns.adobe.com/tiff/1.0/" xmlns:plus="http://schemas.android.com/apk/lib/com.google.android.gms.plus" xmlns:ext="http://www.gettyimages.com/xsltExtension/1.0" xmlns:exif="http://ns.adobe.com/exif/1.0/" xmlns:stEvt="http://ns.adobe.com/xap/1.0/sType/ResourceEvent#" xmlns:stRef="http://ns.adobe.com/xap/1.0/sType/ResourceRef#" xmlns:crs="http://ns.adobe.com/camera-raw-settings/1.0/" xmlns:xapGImg="http://ns.adobe.com/xap/1.0/g/img/" xmlns:Iptc4xmpExt="http://iptc.org/std/Iptc4xmpExt/2008-02-29/" '+l.slice(d);var u=r.parseFromString(l,"text/xml");return E(u)}n++}}function M(e){var t={};if(1==e.nodeType){if(e.attributes.length>0){t["@attributes"]={};for(var i=0;i<e.attributes.length;i++){var n=e.attributes.item(i);t["@attributes"][n.nodeName]=n.nodeValue}}}else if(3==e.nodeType)return e.nodeValue;if(e.hasChildNodes())for(var a=0;a<e.childNodes.length;a++){var r=e.childNodes.item(a);var s=r.nodeName;if(null==t[s])t[s]=M(r);else{if(null==t[s].push){var o=t[s];t[s]=[];t[s].push(o)}t[s].push(M(r))}}return t}function E(e){try{var t={};if(e.children.length>0)for(var i=0;i<e.children.length;i++){var n=e.children.item(i);var a=n.attributes;for(var r in a){var s=a[r];var o=s.nodeName;var l=s.nodeValue;void 0!==o&&(t[o]=l)}var c=n.nodeName;if("undefined"==typeof t[c])t[c]=M(n);else{if("undefined"==typeof t[c].push){var d=t[c];t[c]=[];t[c].push(d)}t[c].push(M(n))}}else t=e.textContent;return t}catch(e){console.log(e.message)}}o.enableXmp=function(){o.isXmpEnabled=true};o.disableXmp=function(){o.isXmpEnabled=false};o.getData=function(e,t){if((self.Image&&e instanceof self.Image||self.HTMLImageElement&&e instanceof self.HTMLImageElement)&&!e.complete)return false;f(e)?t&&t.call(e):g(e,t);return true};o.getTag=function(e,t){if(!f(e))return;return e.exifdata[t]};o.getIptcTag=function(e,t){if(!f(e))return;return e.iptcdata[t]};o.getAllTags=function(e){if(!f(e))return{};var t,i=e.exifdata,n={};for(t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);return n};o.getAllIptcTags=function(e){if(!f(e))return{};var t,i=e.iptcdata,n={};for(t in i)i.hasOwnProperty(t)&&(n[t]=i[t]);return n};o.pretty=function(e){if(!f(e))return"";var t,i=e.exifdata,n="";for(t in i)i.hasOwnProperty(t)&&("object"==typeof i[t]?i[t]instanceof Number?n+=t+" : "+i[t]+" ["+i[t].numerator+"/"+i[t].denominator+"]\r\n":n+=t+" : ["+i[t].length+" values]\r\n":n+=t+" : "+i[t]+"\r\n");return n};o.readFromBinaryFile=function(e){return T(e)};true;!(a=[],r=function(){return o}.apply(t,a),void 0!==r&&(e.exports=r))}).call(this)},1981:function(e,t){(function(){TS.registerModule("magic_login",{onStart:function e(){},make:function e(t,i){n(t,i)},execute:function e(t){a(t)}});var e;var t;var i;var n=function n(a,s){e=s.app_uri;t=s.browser_uri;i=s.fall_back_to_browser;e?a.attr("href",e):e=a.attr("href");i&&t&&r(a)};var a=function n(a){e=a.app_uri;t=a.browser_uri;i=a.fall_back_to_browser;c()};var r=function e(t){t.on("click",function(e){c(e)})};var s=function i(){window.navigator.msLaunchUri(e,function(){},function(){window.location.href=t})};var o=function i(n){n&&n.preventDefault();var a=5e3;var r=window.setTimeout(function(){window.location.href=t},a);window.addEventListener("blur",function(){clearTimeout(r)});var s=document.createElement("iframe");s.className="hidden";s.src=e;document.body.appendChild(s)};var l=function i(n){n&&n.preventDefault();var a=5e3;var r=window.setTimeout(function(){window.location.href=t},a);window.addEventListener("blur",function(){clearTimeout(r)});window.location.href=e};var c=function i(n){bowser&&(bowser.firefox||bowser.safari)?o(n):bowser&&(bowser.msie||bowser.msedge)&&"undefined"!==typeof window.navigator.msLaunchUri&&e.indexOf("://")>0?s(n):bowser&&bowser.chromeBook?window.location.href=t:l(n)}})()},1982:function(e,t){(function(){TS.registerModule("menu.date",{onStart:function e(){},startWithExpirationPresets:function i(r){e=r.date_picker_args;t=r.onSelect;a();n(r)}});var e;var t;var i=5;var n=function e(t){var n=!!_.isUndefined(t.attach_to_target)||t.attach_to_target;TS.menu.start(t.event,false,{attach_to_target_at_full_width:n,onClose:t.onClose});if(n){var a=-1*TS.menu.$menu.outerHeight()-i;var r=t.$target.position().left-TS.menu.$menu.outerWidth()/2+t.$target.outerWidth()/2;TS.menu.$menu.css({top:Math.floor(a),left:Math.floor(r)})}else{var s=t.$target.outerWidth()/2*-1;var o=t.$target.outerHeight()+i;TS.menu.positionAt(t.$target,Math.floor(s),Math.floor(o))}};var a=function e(){TS.menu.buildIfNeeded();TS.menu.clean();TS.menu.$menu.addClass("expiration_date_picker");TS.menu.$menu_header.addClass("hidden").empty();TS.menu.$menu_items.html(TS.templates.menu_expiration_date_items());TS.menu.$menu_items.on("click.menu","li",o);TS.menu.$menu_footer.removeClass("hidden").html(TS.templates.menu_expiration_context())};var r=function t(){TS.menu.buildIfNeeded();TS.menu.clean();TS.menu.$menu.addClass("date_picker expiration_date_picker");TS.menu.$menu_header.addClass("hidden").empty();TS.menu.$menu_footer.addClass("hidden").empty();TS.menu.$menu_items.html(TS.templates.menu_expiration_date_picker());TS.menu.$menu_items.on("click.menu","li#date_picker_back_item",function(e){a();e.stopPropagation()});var i={onChange:s,onHide:l};_.assign(i,e);var n=TS.menu.$menu.find("#date_picker_container");TS.ui.date_picker.startExpirationDatePicker(n,i)};var s=function e(i){"string"===typeof i&&(i=parseInt(i,10));if(isNaN(i)){TS.warn("date_ts could not be parsed as a number.");return}t&&t(i);TS.menu.end()};var o=function e(t){if(TS.menu.isRedundantClick(t))return;var i=$(this).attr("data-expiration-option");if(!i){TS.warn("Selected an invalid expiration date menu item.");return}var n;switch(i){case"none":s(0);break;case"7days":n=c(7);s(n);break;case"30days":n=c(30);s(n);break;case"60days":n=c(60);s(n);break;case"custom":r();break;default:break}t.stopPropagation()};var l=function e(){var t=$("#date_picker_container");t.pickmeup&&_.defer(function(){t.pickmeup("destroy")})};var c=function e(t){if(!_.isNumber(t)){TS.error("num_days must be a number.");return}var i=new Date;i.setHours(23,59,59,0);i.setDate(i.getDate()+t);var n=i.getTime()/1e3;return n}})()},1984:function(e,t,i){"use strict";i.r(t);var n=i(67);var a=i.n(n);(function(){TS.registerModule("ui.admin_invites",{invites_sent_sig:new signals.Signal,emails_parsed_sig:new signals.Signal,started:false,onStart:function e(){E();TS.ui.admin_invites.invites_sent_sig.add(Le,TS.ui.admin_invites);TS.ui.admin_invites.emails_parsed_sig.add(Qe,TS.ui.admin_invites);TS.team.team_email_domain_changed_sig.add(te,TS.ui.admin_invites);TS.prefs.team_auth_mode_changed_sig.add(ve,TS.ui.admin_invites);TS.prefs.team_sso_auth_restrictions_changed_sig.add(ve,TS.ui.admin_invites);TS.prefs.team_invites_only_admins_changed_sig.add(TS.ui.admin_invites.maybeShowInviteLink,TS.ui.admin_invites);TS.web&&TS.web.login_sig.add(TS.ui.admin_invites.onLogin,TS.ui.admin_invites);TS.client&&TS.client.login_sig.add(TS.ui.admin_invites.onLogin,TS.ui.admin_invites);s=TS.storage.fetchInvitesState();$("body").on("click",'[data-action="admin_invites_modal"]',function(){if(TS.isPartiallyBooted())return;var e={};$(this).data("account-type")&&(e.account_type=$(this).data("account-type"));TS.menu&&TS.menu.$menu&&TS.menu.end();V(e)})},onLogin:function e(){te()},start:function e(t,i,n){if(TS.isPartiallyBooted())return;i&&i.persist&&i.persist();D().then(function(){Ye()&&V(t,i,n)})},switchToPicker:function e(){Ye()&&Ce()},maybeShowInviteLink:function e(){if(!TS.client)return;var t=false;var i=false;if(Ye()){m<26&&(t=true);m>=2&&(i=true)}$("#channel_list_invites_link").toggleClass("hidden",!t).toggleClass("dim",i)},populateInvites:function t(i){if(!Ye())return;if(!i)return;var n=s.reduce(function(e,t){e[t.email]=true;return e},{});i.forEach(function(e){if(!n[e.email]){n[e.email]=true;s.push(e)}});TS.storage.storeInvitesState(s);if(s.length&&TS.ui.fs_modal.is_showing){e.find(".admin_invite_row").remove();s.forEach(function(e){ue(e)})}},canInvite:function e(){return Ye()},updateCode:function e(){return D()},getLastInviteViewSelection:function e(){return p},goToPreviousInviteView:function t(){e.find("#admin_invites_switcher, #admin_invites_workflow, #invite_link_container").addClass("hidden");var i=TS.ui.admin_invites.getLastInviteViewSelection();Me(i)},userCanViewSharedInvitesModal:function e(){return P()},test:function e(){var t={_error_map:M,_getError:Ze};Object.defineProperty(t,"_getError",{get:function e(){return Ze},set:function e(t){Ze=t}});Object.defineProperty(t,"_error_map",{get:function e(){return M},set:function e(t){M=t}});return t}});var e;var t=0;var i=0;var n=[];var r=[];var s=[];var o=TS.utility.exampleEmailAddress();var l=o;var c="";var d="";var u;var m=0;var f=false;var h;var p="picker";var g;var T=null;var S=true;var v;var b="#admin_invites_show_date_picker";var w;var y;var A;var k;var C="INVITEMODAL";var x=C+"_ACTION";var I=3;var M={};var E=function e(){M={url_in_message:TS.interop.i18n.t("Sorry, but URLs are not allowed in the custom message. Please remove it and try again!","invite")(),invalid_email:TS.interop.i18n.t("That doesn\u2019t look like a valid email address!","invite")(),already_in_team:TS.interop.i18n.t("This person is already in your workspace.","invite")(),user_disabled:function e(){var t=TS.interop.i18n.t('This person is already in your workspace, but their account is deactivated. You can <a href="{url}#disabled">manage</a> their account.',"invite")({url:TS.utility.getTeamUrl()});return t},already_invited:TS.interop.i18n.t("This person has already been invited to your workspace.","invite")(),sent_recently:TS.interop.i18n.t("This person was recently invited. No need to invite them again just yet.","invite")(),invite_failed:TS.interop.i18n.t("Something went wrong with this invite :(","invite")(),ura_limit_reached:TS.interop.i18n.t("You\u2019ve reached your workspace limit for Single-channel Guests. You must invite more paid members first.","invite")(),user_limit_reached:TS.interop.i18n.t("You\u2019ve reached the maximum number of users for this workspace.","invite")(),not_allowed:TS.interop.i18n.t("You can\u2019t invite this type of account based on your current SSO settings.","invite")(),custom_message_not_allowed:TS.interop.i18n.t("Sorry, you can\u2019t add a custom message to this invite. Please remove it and try again!","invite")(),domain_mismatch:TS.interop.i18n.t("Your SSO settings prevent you from inviting people from this email domain.","invite")(),invite_limit_reached:TS.interop.i18n.t("Your workspace has exceeded the limit on invitations. After more people have accepted the ones your workspace has sent, you can send more. Revoking invitations will not lift the limit. Our Help Center has <a href='https://get.slack.help/hc/{locale}/articles/201330256?{hcTrackingToken}#invitation_limits'>more details on invitation limits</a>.","invite","077ba36b3323ba4ce03078ec53454a5773ada919")({locale:TS.interop.i18n.zdLocale(),hcTrackingToken:TS.utility.getHCAttributionQS()}),too_long:TS.interop.i18n.t("This person\u2019s name exceeds the 35-character limit.","invite")(),too_many_channels:TS.interop.i18n.t("This person is a Single-Channel Guest and can\u2019t be added to a second channel.","invite")(),org_user_is_disabled:TS.interop.i18n.t("This person has a deactivated account for your organization.","invite")(),org_user_is_disabled_but_present:TS.interop.i18n.t("This person is already in your workspace, but they have been deactivated by your organization. Contact an organization administrator to re-enable their account","invite")(),mismatch_with_pending_team_invite:function e(t){var i;switch(t.user_type){case"ultra_restricted":i=TS.interop.i18n.t("Single-Channel Guest","invite")();break;case"restricted":i=TS.interop.i18n.t("Multi-Channel Guest","invite")();break;default:i=TS.interop.i18n.t("full Member","invite")();break}return TS.interop.i18n.t("This person can\u2019t be invited, because they have already been invited as a {account_type} to your organization","invite")({account_type:i})},user_type_mismatch:function e(t){var i;var n;switch(t.issue){case"org_user_is_restricted":i=TS.interop.i18n.t("Multi-Channel Guest","invite")();break;case"org_user_is_ultra_restricted":i=TS.interop.i18n.t("Single-Channel Guest","invite")();break;case"org_user_not_restricted":case"org_user_not_ultra_restricted":i=TS.interop.i18n.t("full Member","invite")();break;default:break}n=_.isUndefined(i)?TS.interop.i18n.t("This person already has an account for your organization","invite")():TS.interop.i18n.t("This person already has a {account_type} account for your organization, so you can only invite them in that role.","invite")({account_type:i});return n}}};var B=function e(){return TS.model.user.is_admin};var P=function e(){return B()||Ye()&&h};var U=function e(){if(null!==T)return Promise.resolve();return TS.interop.api.call("users.admin.canGetSharedInvite").then(function(e){T=!!_.get(e,"data.can_get")}).catch(function(){T=false})};var D=function e(){return TS.interop.api.call("users.admin.listSharedInvites",{mode:"last_active"}).then(function(e){var t=e.data.invites;if(t&&t.length){var i=t[0];return F(i)}return F(null)},function(e){TS.error("could not create shared invite link: "+e)})};var F=function e(t){h=t;clearTimeout(g);if(!h)return Promise.resolve(false);var i=1e3*h.date_expire;var n=i-new Date;if(n<0){h=null;return Promise.resolve(false)}n>2147483647&&(n=2147483647);g=setTimeout(D,n);S=h.notifications_enabled;return Promise.resolve(h)};var O=function e(){return D().then(function(){if(!h)return;return TS.interop.api.call("users.admin.revokeSharedInvite",{code:h.code}).then(function(){F(null);return Promise.resolve(true)})})};var R=function t(){var i=e.find("#shared_invite_link_url");i.on("click",function(){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"share_link",action:"click",ui_element:"invite_link"}}})})};var N=function t(){var i;e.find("#invite_link_container").on("click",'[data-action="shared_invite_create_link"]',function(t){t.preventDefault();i=$(this);var n=e.find("#select_shared_invite_expiration");TS.ui.startButtonSpinner(i.get(0));n.attr("disabled","disabled");var a=_.toInteger(n.val());TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"share_link",action:"click",ui_element:"create_invite_link_button"}}});var r=function e(t,a){if(t)return F(a).then(function(e){return Ie({active_code:e})});n.removeAttr("disabled");TS.ui.stopButtonSpinner(i.get(0),false);F(null).then(function(){Ie({warning:"ratelimited"})}).finally(function(){return Promise.resolve(false)})};return TS.interop.api.call("users.admin.createSharedInvite",{expiration:a,max_signups:2e3,disable_email:true}).then(function(e){var t=e.data,i=e.args,n=e.request_id;var a=true;r(a,t,i,n);return{data:t,args:i,request_id:n}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;r(a,t,i,n);return{data:t,args:i,request_id:n}})})};var L=function t(){e.find("#invite_link_container").on("click","#select_shared_invite_expiration",function(){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"share_link",action:"click",ui_element:"expiration_period_menu"}}})})};var G=function e(t){var i=t||{};var n=h.date_expire;var a=K(n);var r={shared_invite_url:h.url,is_admin:i.is_admin,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team)};if(a){r.time_until_expiration_string=new Handlebars.SafeString(a);r.expiration_date=TS.interop.datetime.toCalendarDate(n);r.expiration_time=TS.interop.datetime.toTime(n,{do24hrTime:TS.utility.date.do24hrTime()})}return r};var H=function t(){e.find("#invite_link_container").on("click",'[data-action="disable_shared_link"]',function(){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"share_link",action:"click",ui_element:"disable_link"}}});return new Promise(function(e){TS.generic_dialog.start({title:TS.interop.i18n.t("Deactivate your invite link?","pages_admin")(),body:TS.interop.i18n.t("<p>The invite link for <b>{team_name}</b> will stop working. Please note that if you sent the link to anyone, they may not be able to join your workspace.</p>","pages_admin")({team_name:TS.interop.i18n.safeString(_.escape(TS.interop.rules.teams.getTeamDisplayName(TS.model.team)))}),go_button_class:"btn_danger ladda-button",go_button_text:TS.interop.i18n.t("Deactivate Link","pages_admin")(),onGo:function t(){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"deactivate_link",action:"click",ui_element:"deactivate_link_button"}}});e()},onCancel:function e(){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"deactivate_link",action:"click",ui_element:"cancel_button"}}})},onEnd:function e(){}})}).then(function(){return O().then(function(){TS.ui.admin_invites.goToPreviousInviteView();return Promise.resolve()},function(){TS.error("disable share invites link failed")})})})};var Q=function t(){e.find("#invite_link_container").on("click",'[data-action="copy_shared_link"]',function(){var e=$(this);j(e);TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"share_link",action:"click",ui_element:"copy_button"}}})})};var j=function e(t){var i=t.parent().find("input");var n=i.attr("data-invite-url");TS.clipboard.writeText(n);i.select();document.execCommand("copy");t.removeClass("hide_copy_btn_ts_tip");window.setTimeout(function(){t.addClass("hide_copy_btn_ts_tip")},2e3)};var K=function e(t){var i;var n=TS.interop.datetime.toDateObject(Date.now()/1e3);var a=TS.interop.datetime.distanceInDays(TS.interop.datetime.toDateObject(t),n);var r=a/7;if(a>30)return"";i=_.isInteger(r)?TS.interop.i18n.t("in {num_weeks, plural, =1{one week}other{{num_weeks} weeks}}","invite")({num_weeks:r}):TS.interop.i18n.t("in {num_days, plural, =1{one day}other{{num_days} days}}","invite")({num_days:a});return TS.interop.datetime.prettifyDateString(t,{fallbackString:i,uncapitalized:true})};var W=function e(){Y();N();H();Q();R();L();z()};var V=function e(t,i,n){if(TS.isPartiallyBooted())return;if(TS.ui.admin_invites.started)return;TS.ui.admin_invites.started=true;if(i&&i.target&&"channel_list_invites_link"===i.target.id||n){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"invite_people",action:"click",ui_element:"invite_people_button"}}});TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"share_link",action:"impression",ui_element:"share_invite_link_modal"},referring_ui_context:{step:"invite_people",ui_element:"invite_people_button"}},referring_event_id:"INAPP_INVITES"});TS.interop.clog.track("GROWTH_PRICING",{contexts:{ui_context:{step:"slack_menu",action:"impression",ui_element:"invite_people_button"}}})}var a;v=null;m=TS.members.getActiveMembersWithSelfAndNotSlackbot().length;if(!TS.model.team.plan&&m>=3){var r=TS.interop.experiments.getGroupForUser("invite_guest_awareness_v2");f="treatment"===r}qe()?t&&t.account_type&&(a=t.account_type):a="full";t&&t.initial_channel_id&&(u=t.initial_channel_id);U().then(function(){B()?D().then(function(){J(a)}):J(a)})};var z=function t(){e.find("#invite_link_container").on("change",'[data-action="toggle_notification_pref"]',function(){var e={code:h.code,notifications_enabled:this.checked};var t=TS.interop.api.call("users.admin.updateSharedInvite",e).then(function(){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"invite_people",action:"toggle",ui_element:"notification_preference"}}})}).catch(function(){});TS.ui.inline_saver.show({promise:t,target:"#notification_pref_copy"})})};var Y=function t(){e.find("#create_or_share_invite_link").on("click",function(e){e.preventDefault();TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"invite_people",action:"click",ui_element:"share_or_get_invite_link_trigger"}}});Ie();return false})};var q=function e(){return TS.model.user.is_admin&&TS.model.team.plan};var J=function e(t){var i=TS.templates.admin_invite_modal({can_add_ura:TS.model.can_add_ura,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team),team_in_org:TS.model.team.enterprise_id,hide_full_member_option:TS.utility.invites.hideFullMemberInviteOption(),team_signup_url:"https://"+TS.model.team.domain+".slack.com/signup",invites_limit:""===TS.model.team.plan&&TS.prefs.getTeamPref("invites_limit"),show_custom_message:TS.model.team.plan,is_paid_team:TS.model.team.plan,email_domains:TS.model.team.email_domain.split(","),is_our_app:TS.model.is_our_app,can_use_shared_invite_links:P(),footer_border:q(),team_should_see_invite_link:T,guest_is_in_treatment_group:f});var n={body_template_html:i,onShow:Z,onCancel:ee,clog_name:"INVITEMODAL",onEnd:X};TS.client&&TS.ui.a11y.saveCurrentFocus();TS.ui.fs_modal.start(n);t&&setTimeout(function(){Me(t)},0)};var Z=function t(){TS.ui.fs_modal.hideBackButton();e=$("#admin_invites_container");W();var i=e.find(".admin_invites_custom_message_container");var n=e.find("#admin_invites_alert");var a=e.find('button[data-action="api_send_invites"]');if(Je()){n.removeClass("hidden");TS.interop.clog.track("GROWTH_PRICING",{contexts:{ui_context:{step:"admin_invites",action:"impression",ui_element:"invite_modal_guest_alert"}}})}else n.addClass("hidden");var r=TS.interop.i18n.t("people","invites")();var o={noun:r,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team),bolded:true,full:true};var l=TS.templates.admin_invite_header_text(o);e.find("#admin_invites_header").html(l);e.find("#admin_invites_switcher").on("click",'[data-action="switch_type"]',function(e){var t=$(e.target);if(t.is("a"))return;var i=t.closest(".admin_invites_account_type_option");if(i.hasClass("disabled")||i.hasClass("locked"))return;Me($(this).data("account-type"))});e.find('[data-action="admin_invites_add_row"]').on("click",ue);e.find('a[data-action="admin_invites_switch_view"]').on("click",function(){xe($(this).data("view"))});e.find("#invite_rows").on("keydown",function(e){e.which===TS.utility.keymap.enter&&a.trigger("click")});a.on("click",function(e){e.preventDefault();Oe();Je()&&n.addClass("hidden")});e.find('button[data-action="api_parse_emails"]').on("click",function(e){e.preventDefault();Ge();$(this).find(".ladda-label").text(TS.interop.i18n.t("Processing email addresses ...","invite")())});ae();ie();e.find('a[data-action="admin_invites_show_custom_message"]').on("click",function(){me()});e.find('[data-action="admin_invites_hide_custom_message"]').on("click",function(){fe()}).hover(function(){i.addClass("delete_highlight")},function(){i.removeClass("delete_highlight")});e.find("#admin_invite_custom_message").on("input",he);e.find("#bulk_emails").css("overflow","hidden").autogrow();s=TS.storage.fetchInvitesState();s.length?TS.ui.admin_invites.populateInvites(s):ue();var c=e.find(".admin_invite_row").length;if(c<I){var d=I-c;_.times(d,ue)}};var X=function e(){TS.ui.admin_invites.started=false};var ee=function e(){t=0;i=0;s=r.length?[]:Fe();n=[];r=[];Se();k&&k();TS.storage.storeInvitesState(s);TS.client&&TS.ui.a11y.restorePreviousFocus()};var te=function e(){l=o};var ie=function e(){if(!TS.model.team.plan)return ne(false);TS.interop.api.callExpedited("users.admin.canAddUltraRestricted").then(function(e){ne(e.data.ok)},function(){ne(false)})};var ne=function e(t){if(""!==TS.model.team.plan){TS.model.can_add_ura=t;var i=$('.admin_invites_account_type_option[data-account-type="ultra_restricted"]');i.toggleClass("disabled",!TS.model.can_add_ura);if(!TS.model.can_add_ura){var n=$(".account_type_disabled_hover",i);n.removeClass("hidden")}}};var ae=function e(){y=document.getElementById("btn_connect_contacts");if(!y)return;y.addEventListener("click",re);A=TS.model.user.id+Date.now();TS.google_auth.getAuthLink(A).then(function(){TS.utility.disableElement(y,false)})};var re=function e(){TS.google_auth.getAuthLink(A).then(function(e){var t="menubar=yes,location=yes,resizable=yes,scrollbars=yes,status=yes,width=600,height=500";var i=window.open(e,"auth_window",t);se(i)})};var se=function e(t){k=TS.google_auth.pollForAuthStatus(A,oe,t).cancel};var oe=function t(i){k=null;if(i){var n=TS.interop.i18n.t("Google contacts connected","invite")();e.find(".btn_connect_contacts_text").text(n);y.removeEventListener("click",re);TS.interop.clog.track(x,{action:"google_auth_success",trigger:"user_allowed_access"});le()}};var le=function e(){var t={page:1,count:1e3};TS.google_auth.getContactList(A,t).then(function(e){var t=$("input.email_field").filter(function(){return!this.value});0===t.length&&ue();ce(e)})};var ce=function e(t){if(!t)return;w=w||t.items;$("input.email_field").lazyFilterSelect({approx_item_height:50,data:w,single:true,placeholder_text:TS.utility.exampleEmailAddress(),onReady:function e(){de(this)},filter:function e(t,i){i=i.toLowerCase();if(t.full_name)var n=t.full_name.toLowerCase();if(t.email)var a=t.email.toLowerCase();return n&&-1!==n.indexOf(i)||a&&-1!==a.indexOf(i)},noResultsTemplate:function e(t){var i=TS.interop.i18n.t("None of your Google contacts match <strong>{query}</strong>","invite")({query:TS.interop.i18n.safeString(_.escape(t))});return i},onItemAdded:function e(t){de(this,t);TS.interop.clog.track(x,{action:"add_google_email",trigger:"select_google_contact_from_dropdown"})},onInputFocus:function e(){$(".ts_tip_tip").remove();$(".lazy_filter_select").removeClass("ts_tip ts_tip_top ts_tip_float ts_tip_multiline ts_tip_delay_1000")},onInputBlur:function e(){de(this)},template:function e(t){var i=TS.templates.admin_invite_filter_select_contact({contact:t});return new Handlebars.SafeString(i)}}).addClass("hidden");if(void 0!==t.items){var i=TS.interop.i18n.t("Type here to search your Google contacts","invite")();var n='<span class="ts_tip_tip"><span class="ts_tip_multiline_inner">'+i+"</span></span>";var a=$("input.email_field").filter(function(){return!this.value}).first();a.lazyFilterSelect("container").addClass("ts_tip ts_tip_top ts_tip_float ts_tip_multiline ts_tip_delay_1000").append(n)}};var de=function e(t,i){var n=t.$container[0];var a=$(n).parents(".admin_invite_row");if(i){$(a).find("input[name*=real_name]").val(i.full_name);$(a).find("input[name*=email_address]").val(i.email)}else{var r=$(a).find("input.lfs_input").val();var s=$(a).find("input[name*=email_address]").val();if(r){$(a).find("input.email_field").lazyFilterSelect("clearValue");$(a).find("input[name*=email_address]").val(r)}else s&&$(a).find("input.lfs_input").val(s)}};var ue=function i(n){var a=true;0===e.find(".admin_invite_row").length?a=false:e.find(".admin_invite_row").first().find(".delete_row").removeClass("hidden");e.find("#invite_rows").append(TS.templates.admin_invite_row({index:t,show_delete_btn:a,placeholder_email_address:l}));var r=e.find("#invite_"+t);r.find('[data-action="admin_invites_delete_row"]').on("click",function(){ge(r)}).hover(function(){r.addClass("delete_highlight")},function(){r.removeClass("delete_highlight")});r.find('[name="email_address"]').focus();if(n){r.find('[name="email_address"]').val(n.email);r.find(".lfs_input_container input.lfs_input").val(n.email);if(n.real_name)r.find('[name="real_name"]').val(n.real_name);else if(n.first_name){var s=[n.first_name];n.last_name&&s.push(n.last_name);r.find('[name="real_name"]').val(s.join(" "))}}TS.google_auth.isAuthed(A)&&w&&ce(w);t+=1};var _e=function t(i,n){e.find("#invite_notice").toggleClass("alert_warning","alert_warning"===i).toggleClass("alert_info","alert_info"===i).toggleClass("alert_error","alert_error"===i).html(n).slideDown(100)};var me=function t(){e.find(".admin_invites_hide_custom_message").addClass("hidden");e.find(".admin_invites_show_custom_message").removeClass("hidden");he()};var fe=function t(){e.find(".admin_invites_hide_custom_message").removeClass("hidden");e.find(".admin_invites_show_custom_message").addClass("hidden");he()};var he=function t(){var i=e.find("#admin_invite_custom_message");var n=i.val().trim();var a=e.find(".admin_invites_show_custom_message");var r=!a.hasClass("hidden")&&!!i.data("validation")&&i.data("validation").includes("hasnourl")&&!!TS.interop.url.findUrlsInString(n).length;pe(r)};var pe=function t(i){e.find("#admin_invites_submit_btn").toggleClass("disabled",i)};var ge=function t(i){if(!i||!i.length)return;i.slideToggle(100,function(){i.remove();var t=$(".admin_invite_row").length;0===t?ue():1===t&&e.find(".admin_invite_row").first().find(".delete_row").addClass("hidden")})};var Te=function t(){var i=$("#account_type").val();var n;n="full"===i?TS.interop.i18n.t("Send Invitations","invite")():TS.interop.i18n.t("Invite Guests","invite")();e.find('button[data-action="api_send_invites"]').find(".ladda-label").text(n)};var Se=function e(){u=void 0};var ve=function t(){var i=e.find("#account_type").val();var n=false;var a="google"===TS.prefs.getTeamPref("auth_mode")||"saml"===TS.prefs.getTeamPref("auth_mode");var r=false;var s=TS.boot_data.page_needs_enterprise;var o="";if(s&&"full"===i||a&&0===TS.prefs.getTeamPref("sso_auth_restrictions")){r=true;var l=TS.redux.enterprise.getEnterprise();var c=TS.utility.enterprise.getProviderLabel(l,_.get(TS.model,"enterprise.sso_provider.label","single sign-on"));o=TS.interop.i18n.t("Only people with {account_type} accounts will be able to accept invitations.","invite")({account_type:c})}if("google"===TS.prefs.getTeamPref("auth_mode"))("full"!==i||0!==TS.prefs.getTeamPref("sso_auth_restrictions")&&1!==TS.prefs.getTeamPref("sso_auth_restrictions"))&&("restricted"!==i&&"ultra_restricted"!==i||0!==TS.prefs.getTeamPref("sso_auth_restrictions"))||(n=true);else if("saml"===TS.prefs.getTeamPref("auth_mode")&&(0===TS.prefs.getTeamPref("sso_auth_restrictions")||1===TS.prefs.getTeamPref("sso_auth_restrictions"))&&"full"===i&&!s){var d=TS.templates.admin_invite_switcher({can_add_ura:TS.model.can_add_ura,hide_full_member_option:TS.utility.invites.hideFullMemberInviteOption(),team_signup_url:"https://"+TS.model.team.domain+".slack.com/signup",team_in_org:TS.model.team.enterprise_id});$("#admin_invites_switcher").html(d);Ce()}(r||n)&&e.find(".invite_modal_footer_container").addClass("has_border");$("#google_auth_email_domain_notice").toggleClass("hidden",!n);$("#sso_signup_notice").html(o).toggleClass("hidden",!r)};var be=function t(i){var n;e.find('input[name="email_address"]').each(function(){$(this).val()==i&&(n=$(this).closest(".admin_invite_row"))});return n};var we=function e(t,i){_.isObject(i)||TS.error("_rowError did not receive an error object: ",i);var n=Ze(i);if(t){t.find("label.email").addClass("error").end().find(".error_msg").removeClass("hidden").html(n);"too_long"===i.error&&t.find("label").addClass("error");M[i.error]||t.find("label").addClass("error");t.find("input").on("keyup.admin_invite_error_fixed",function(){ye(t)})}};var ye=function e(t){if(t){t.find("label").removeClass("error").end().find(".error_msg").addClass("hidden");t.find("input").off(".admin_invite_error_fixed")}};var Ae=function t(){setTimeout(function(){Ladda.stopAll();e.find(".admin_invite_row").remove();n=[];r=[];v=null;Te();_.times(I,ue)},0)};var ke=function t(){setTimeout(function(){Ladda.stopAll();e.find('button[data-action="api_parse_emails"]').find(".ladda-label").text(TS.interop.i18n.t("Add Invitees","invite")());e.find("#bulk_emails").prop("disabled",false)},0)};var Ce=function t(){TS.ui.fs_modal.hideBackButton();e.find("#invite_link_container").addClass("hidden");e.find("#admin_invites_workflow").addClass("hidden");e.find("#invite_modal_admin_invite_container").addClass("hidden");var i=TS.interop.i18n.t("people","invites")();var n={noun:i,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team),bolded:false,full:true};var a=TS.templates.admin_invite_header_text(n);e.find("#admin_invites_header").html(a);e.find("#admin_invites_switcher").removeClass("hidden");e.find("#individual_invites").removeClass("hidden");Je()?e.find("#admin_invites_alert").removeClass("hidden"):e.find("#admin_invites_alert").addClass("hidden")};var xe=function t(i){e.find("#invite_link_container").addClass("hidden");e.find("#admin_invites_workflow").removeClass("hidden");if("individual"===i){var n=e.find(".admin_invite_row").length;if(n<I){var a=I-n;_.times(a,ue)}e.find("#individual_invites").removeClass("hidden");e.find("#bulk_invites, #bulk_notice").addClass("hidden");e.find("#bulk_emails").val("");e.find(".email_field").first().focus();e.find(".invite_modal_options_container").removeClass("hidden");ke()}else if("bulk"===i){e.find("#bulk_invites").removeClass("hidden");e.find("#individual_invites").addClass("hidden");e.find(".invite_modal_options_container").addClass("hidden");var r=e.find('button[data-action="api_parse_emails"]');if(!r.hasClass("ladda")){Ladda.bind('button[data-action="api_parse_emails"]');r.addClass("ladda")}r.find(".ladda-label").text(TS.interop.i18n.t("Add Invitees","invite")());var s=Fe();if(s){var o="";$.each(s,function(e,t){t.real_name&&(o+=t.real_name+" ");o+="<"+t.email+">, "});e.find("#bulk_emails").val(o).autogrow()}e.find("#bulk_emails").focus()}};var Ie=function t(i){if(P()){TS.ui.fs_modal.showBackButton();var n;var a={notifications_enabled:S};e.find("#individual_invites").addClass("hidden");e.find("#bulk_invites").addClass("hidden");e.find("#admin_invites_alert").addClass("hidden");var r={bolded:false,alternate:true};var s=TS.templates.admin_invite_header_text(r);e.find("#admin_invites_header").html(s);e.find("#admin_invites_subheader").text(TS.interop.i18n.t("Anyone can use this link to join {team_name} on Slack.","invite")({team_name:TS.interop.i18n.safeString(_.escape(TS.interop.rules.teams.getTeamDisplayName(TS.model.team)))})).removeClass("hidden");e.find("#invite_link_container").removeClass("hidden");if(h){var o=false;TS.model.user&&(o=TS.model.user.is_admin||ze());a=$.extend({},G({is_admin:o}),a);n=TS.templates.shared_invites_modal_share_link_body}else n=TS.templates.shared_invites_modal_admin_create_link_body;a.can_create_invite_links=B();a=$.extend({},a,i);e.find("#invite_link_container").html(n(a));if(a.warning){e.find("#select_shared_invite_expiration_warning").html(TS.templates.shared_invites_modal_warning({warning:a.warning}));var l=e.find('[data-action="shared_invite_create_link"]')[0];TS.utility.disableElement(l,true);TS.ui.stopButtonSpinner(l,false);setTimeout(function(){TS.utility.disableElement(l,false);e.find("#select_shared_invite_expiration_warning").html("")},6e5)}TS.ui.fs_modal.bindBackButton(TS.ui.admin_invites.goToPreviousInviteView)}return Promise.resolve()};var Me=function t(i){qe()?TS.ui.fs_modal.showBackButton():TS.ui.fs_modal.hideBackButton();var n=e.find("#create_or_share_invite_link_text");h?n.text(TS.interop.i18n.t("Share invite link","invite")):n.text(TS.interop.i18n.t("Get an invite link to share","invite"));var a=[];var r=_.partition(TS.interop.redux.models.channels.getUnarchivedPublicAndPrivateChannels(TS.redux.getState()),TS.interop.rules.channels.isPublicChannel);var s=r[0];var o=r[1];_.isArray(TS.prefs.getTeamPref("default_channels"))&&s.forEach(function(e){if(-1!==TS.prefs.getTeamPref("default_channels").indexOf(e.id)){e.is_default=true;a.push(e)}});var l=TS.interop.channels.getGeneralChannel();var c="";if(l){c=l.name;a.length||a.push(l)}var d={invite_type:i,public_channels:s,default_channels:a,general_name:c,private_channels:o,is_admin:TS.model.user.is_admin,initial_channel_id:u};p=i;var m=TS.model.team.plan!==("","enterprise");var f=TS.templates.admin_invite_channel_picker(d);var g=TS.interop.i18n.t("Members","invite")();if("restricted"===i){g=TS.interop.i18n.t("Multi-Channel Guests","invite")();e.find(".share_invite_link_container").addClass("hidden");e.find("#invite_restricted_view_pending").removeClass("hidden");e.find("#invite_member_view_pending").addClass("hidden")}else if("ultra_restricted"===i){g=TS.interop.i18n.t("Single-Channel Guests","invite")();e.find(".share_invite_link_container").addClass("hidden");e.find("#invite_restricted_view_pending").removeClass("hidden");e.find("#invite_member_view_pending").addClass("hidden")}else{e.find("#invite_restricted_view_pending").addClass("hidden");e.find("#invite_member_view_pending").removeClass("hidden");e.find(".share_invite_link_container").removeClass("hidden")}if(T){e.find("#invite_restricted_view_pending").addClass("hidden");e.find("#invite_member_view_pending").removeClass("hidden");e.find(".invite_modal_footer_container").addClass("has_border")}else{e.find("#invite_restricted_view_pending").removeClass("hidden");e.find("#invite_member_view_pending").addClass("hidden")}var S={noun:g,bolded:true};if(TS.model.team.plan)S.simple=true;else{S.team_name=TS.interop.rules.teams.getTeamDisplayName(TS.model.team);S.full=true}var v=TS.templates.admin_invite_header_text(S);e.find("#admin_invites_header").html(v);e.find("#admin_invites_channel_picker_container").html(f);e.find("#account_type").val(i);e.find("#admin_invites_switcher").addClass("hidden");e.find("#admin_invites_workflow").removeClass("hidden");e.find("#individual_invites").removeClass("hidden");e.find("#admin_invites_billing_notice").toggleClass("hidden",!(m&&"ultra_restricted"!==i));e.find("#admin_guide_to_billing_at_slack").toggleClass("hidden",!(m&&"ultra_restricted"!==i));e.find("#ura_warning").toggleClass("hidden","restricted"!==i&&"ultra_restricted"!==i);e.find("#invite_notice").hide();e.find(".admin_invites_guest_expiration_date_container").toggleClass("hidden","full"===i);e.find(b).on("click",De);var w="";"restricted"===i?w=TS.interop.i18n.t("These guests will only have access to messages and files in specified channels.","invite")():"ultra_restricted"===i&&(w=TS.interop.i18n.t("These guests will only have access to messages and files in a single channel.","invite")());e.find("#admin_invites_subheader").text(w).toggleClass("hidden","full"===i);e.find("#ultra_restricted_channel_picker").on("change",function(){Te();Se()});e.find(".email_field").first().focus();var y=e.find('button[data-action="api_send_invites"]');if(!y.hasClass("ladda")){Ladda.bind('button[data-action="api_send_invites"]');y.addClass("ladda")}Te();ve();var A="full"===i;e.find("#defaultchannelsmulti, #ultra_restricted_channel_picker").lazyFilterSelect(Ue(A)).addClass("hidden");if(qe()){TS.ui.fs_modal.bindBackButton(TS.ui.admin_invites.switchToPicker);TS.ui.fs_modal.showBackButton()}};var Ee=function e(t,i,n,a){var r=t&&t.id;return i&&_.includes(n,r)||r&&r===a};var Be=function e(t,i,n,a){var r=_(n).concat(a).compact().value();var s=r.length?TS.shared.ensureModelObsArePresent(r):Promise.resolve();var o={prefer_exact_match:false,frecency:false,allow_empty_query:true,prefer_channels_user_belongs_to:false,flat:true};var l={channels:{include_archived:false,exclude_required:i},groups:{include_archived:false},sort:!!t&&o};return s.then(function(){return TS.searcher.search(t,l)}).then(function(e){return t?e:TS.sorter.search(t,e,o)}).then(function(e){return _.partition(e,TS.interop.rules.channels.isPublicChannel)})};var Pe=function e(t){return function(e){var i=TS.prefs.getTeamPref("default_channels");_.isArray(i)||(i=[]);return Be(e,t,i,u).then(function(e){var n=a()(e,2),r=n[0],s=n[1];var o=[];if(r.length){var l=_.map(r,function(e){var n="0."+e.id;var a=Ee(e,t,i,u);return{model_ob:e,lfs_id:n,preselected:a}});o.push({label:TS.interop.i18n.t("Channels","invite")(),lfs_group:true,children:l})}if(s.length){var c=!!r.length;var d=_.map(s,function(e){var n=(c?1:0)+"."+e.id;var a=Ee(e,t,i,u);return{model_ob:e,lfs_id:n,preselected:a}});o.push({label:TS.interop.i18n.t("Private Channels","invite")(),lfs_group:true,children:d})}return{replace_all_items:true,all_items_fetched:true,items:o}})}};var Ue=function e(t){return{data_promise:Pe(t),template:function e(t){return new Handlebars.SafeString(TS.templates.admin_invite_channel_picker_option(t))},onItemRemoved:function e(t){t.value==u&&Se()}}};var De=function e(t){var i={event:t,$target:$(b),onSelect:$e,date_picker_args:{}};v&&(i.date_picker_args.selected_expiration_ts=v);TS.menu.date.startWithExpirationPresets(i)};var $e=function e(t){if(!_.isNumber(t)||t===v)return;var i;var n;if(0===t){v=null;i=TS.interop.i18n.t("By default, guest accounts stay active indefinitely.","invite")();n=TS.interop.i18n.t("Set a time limit","invite")()}else{v=t;i=TS.interop.i18n.t("These accounts will be deactivated on <strong>{date} at {time}</strong>.","invite")({date:TS.interop.datetime.formatDate(t,"{date}"),time:TS.interop.datetime.formatDate(t,"{time}")});n=TS.interop.i18n.t("Change","invite")()}$("#admin_invites_guest_expiration_copy").html(i);$(b).text(n)};var Fe=function t(){var i=[];var n;e.find(".admin_invite_row").each(function(){n=$.trim($(this).find('[name="email_address"]').val());var e=$.trim($(this).find('[name="real_name"]').val());if(n){var t={};t.email=n;e&&(t.real_name=e);i.push(t)}else $(".admin_invite_row").length>1&&ge($(this))});s=i;TS.storage.storeInvitesState(s);return i};var Oe=function t(){var n=false;e.find(".admin_invite_row").each(function(){var e=$.trim($(this).find('[name="email_address"]').val());if(e)if(TS.utility.email_regex.test(e))ye($(this));else{we($(this),{error:"invalid_email"});n=true}else $(".admin_invite_row").length>1&&ge($(this))});if(n){setTimeout(Ladda.stopAll,0);return}var a=Fe();if(a.length){if(a){var r=e.find("#account_type").val();var s=e.find(".admin_invites_show_custom_message");var o=e.find("#admin_invite_custom_message");var l;var c=TS.google_auth.isAuthed(A)?"contact":"manual";"full"===r||"restricted"===r?l=_(e.find("#defaultchannelsmulti").lazyFilterSelect("value")).map("model_ob.id").join(","):"ultra_restricted"===r&&(l=_(e.find("#ultra_restricted_channel_picker").lazyFilterSelect("value")).map("model_ob.id").join(","));d=s.hasClass("hidden")?"":o.val();i=a.length;$.each(a,function(e,t){var i={email:t.email,source:"invite_modal",mode:c};l&&(i.channels=l);d&&(i.extra_message=d);t.real_name&&(i.real_name=t.real_name);"restricted"!==r&&"ultra_restricted"!==r||!v||(i.expiration_ts=v);"restricted"===r?i.restricted=1:"ultra_restricted"===r&&(i.ultra_restricted=1);TS.interop.api.call("users.admin.invite",i).then(function(e){var t=e.data,i=e.args,n=e.request_id;var a=true;Re&&Re(a,t,i,n);return{data:t,args:i,request_id:n}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;Re&&Re(a,t,i,n);return{data:t,args:i,request_id:n}})})}}else{var u='<i class="ts_icon ts_icon_info_circle"></i> '+TS.interop.i18n.t("Add at least one email address before sending invitations.","invite")();_e("alert_info",u);setTimeout(Ladda.stopAll,0)}};var Re=function t(i,a,s){if(i){n.push({email:s.email,real_name:s.real_name});var o=be(s.email);ge(o)}else{var l;if("requires_channel"===a.error){setTimeout(Ladda.stopAll,0);e.find("#ra_channel_picker_header").highlightText();var c=TS.interop.i18n.t("Pick at least one channel before inviting Multi-Channel Guests.","invite")();l='<i class="ts_icon ts_icon_info_circle"></i> '+c;_e("alert_warning",l);return}if("requires_one_channel"===a.error){setTimeout(Ladda.stopAll,0);e.find("#ura_channel_picker_header").highlightText();var d=TS.interop.i18n.t("Pick a channel before inviting Single-Channel Guests.","invite")();l='<i class="ts_icon ts_icon_info_circle"></i> '+d;_e("alert_warning",l);return}var u=a.error;u=TS.ui.validation.maybeConvertNameErrorCode(u);if(TS.boot_data.page_needs_enterprise){var m=null!==TS.redux.members.getMemberByEmail(s.email);m&&"org_user_is_disabled"===u&&(u="org_user_is_disabled_but_present")}r.push({email:s.email,error:u,error_msg:Ze(_.extend({},a,{error:u}))})}Ne()};var Ne=function e(){i-=1;if(0===i){s=[];TS.storage.storeInvitesState(s);var t=function e(){setTimeout(Ladda.stopAll,0);TS.ui.admin_invites.invites_sent_sig.dispatch()};c=Ke(n);c?TS.interop.api.call("team.checkEmailDomains",{email_domains:c}).then(function(e){c=e.data.ok?e.data.email_domains:""},function(){c=""}).finally(t):t()}};var Le=function t(){var i=$("#account_type").val();var a;var s;if("full"===i){var o=TS.interop.i18n.t("{invites_length,plural,=1{{invites_length} Member}other{{invites_length} Members}}","invite")({invites_length:n.length});a="<strong>"+o+"</strong>"}else if("restricted"===i){var l=TS.interop.i18n.t("{invites_length,plural,=1{{invites_length} Multi-Channel Guest}other{{invites_length} Multi-Channel Guests}}","invite")({invites_length:n.length});a="<strong>"+l+"</strong>"}else if("ultra_restricted"===i){var u=TS.interop.i18n.t("{invites_length,plural,=1{{invites_length} Single-Channel Guest}other{{invites_length} Single-Channel Guests}}","invite")({invites_length:n.length});a="<strong>"+u+"</strong>"}!v||"restricted"!==i&&"ultra_restricted"!==i||(s=TS.interop.i18n.t("{invites_length,plural,=1{This account}other{These accounts}} will be deactivated on {date} at {time}.","invite")({invites_length:n.length,date:TS.interop.datetime.formatDate(v,"{date}"),time:TS.interop.datetime.formatDate(v,"{time}")}));var _={success_invites_html:a,success_invites:n,error_invites:r,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team),domains:c,paid_team:""!==TS.model.team.plan,is_admin:TS.model.user.is_admin,expiration_msg:s};TS.model.team.plan&&(_.custom_message=d);var m=TS.templates.admin_invite_summary(_);e.find("#invite_notice").slideUp(100);e.find("#admin_invites_workflow, #admin_invites_header, #admin_invites_subheader").addClass("hidden");e.find("#admin_invites_success").html(m).removeClass("hidden");function f(){Ae();$("#admin_invites_workflow, #admin_invites_success").toggleClass("hidden");Je()&&$("#admin_invites_alert").removeClass("hidden");$("#admin_invites_header, #admin_invites_subheader").removeClass("hidden");TS.ui.fs_modal.bindBackButton(TS.ui.admin_invites.switchToPicker)}e.find('button[data-action="admin_invites_reset"]').on("click",f);TS.ui.fs_modal.bindBackButton(f);e.find('button[data-action="admin_invites_try_again"]').on("click",function(){$.each(r,function(e,t){var i=be(t.email);we(i,t)});$("#admin_invites_workflow, #admin_invites_success").toggleClass("hidden");$("#admin_invites_header, #admin_invites_subheader").removeClass("hidden");TS.ui.fs_modal.bindBackButton(TS.ui.admin_invites.switchToPicker);n=[];r=[]});if(je()){var h=e.find('button[data-action="add_signup_domains"]').on("click",Ve);e.on("keyup","#invite_signup_domains",TS.ui.resetButtonSpinner.bind(Object.create(null),h.get(0)))}};var Ge=function t(){var i=$.trim($("#bulk_emails").val().replace(/[\u200B-\u200D\uFEFF]/g,""));e.find("#bulk_emails").prop("disabled",true);TS.interop.api.call("users.admin.parseEmails",{emails:i}).then(function(e){var t=e.data,i=e.args,n=e.request_id;var a=true;He&&He(a,t,i,n);return{data:t,args:i,request_id:n}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;He&&He(a,t,i,n);return{data:t,args:i,request_id:n}})};var He=function t(i,n){if(!i){TS.error("failed onEmailsParsed");var a=TS.interop.i18n.t("Oops! There was an error processing those emails. Please try again.","invite")();e.find("#bulk_notice").html('<i class="ts_icon ts_icon_warning"></i> '+a).removeClass("hidden");ke();return}if(0===n.emails.length){var r=TS.interop.i18n.t("We couldn\u2019t find any email addresses in that text. Please try again.","invite")();e.find("#bulk_notice").html('<i class="ts_icon ts_icon_warning"></i> '+r).removeClass("hidden");ke();return}TS.ui.admin_invites.emails_parsed_sig.dispatch(n.emails)};var Qe=function t(i){e.find(".admin_invite_row").remove();xe("individual");var n;if(1==i.length){var a=TS.interop.i18n.t("We found 1 email address to invite. We\u2019ve done our best to guess a name. See if it looks right, then press Invite.","invite")();n='<i class="ts_icon ts_icon_check_circle_o_large"></i> '+a}else{var r=TS.interop.i18n.t("We found {emails_length} email addresses to invite. We\u2019ve done our best to guess a name for each one. See if everything looks right, then press Invite.","invite")({emails_length:i.length});n='<i class="ts_icon ts_icon_check_circle_o_large"></i> '+r}_e("alert_info",n);e.find(".admin_invite_row").each(function(){var e=$.trim($(this).find('[name="email_address"]').val());e||ge($(this))});$.each(i,function(e,t){ue(t)});s=i;TS.storage.storeInvitesState(s)};var je=function e(){var t=$("#account_type").val();return"full"===t&&TS.model.user.is_owner&&"normal"===TS.prefs.getTeamPref("auth_mode")};var Ke=function e(t){if(!je())return"";var i=t.map(function(e){return e.email.split("@")[1]});if(TS.model.team.email_domain){var n=TS.model.team.email_domain.split(",").reduce(function(e,t){e[t]=true;return e},{});i=_.uniq(i.filter(function(e){return!n[e]}))}return i.join(", ")};var We=function e(t){if(!t)return t;var i=t.split(",").reduce(function(e,t){e[t]=true;return e},{});return Object.keys(i).join(",")};var Ve=function t(){TS.ui.startButtonSpinner(e.find('button[data-action="add_signup_domains"]').get(0));var i=e.find("#invite_signup_domains").val();TS.model.team.email_domain&&(i=[TS.model.team.email_domain,i].join(","));i=We(i);var n={prefs:JSON.stringify({signup_mode:"email",signup_domains:i})};TS.interop.api.call("team.prefs.set",n).then(function(t){TS.ui.stopButtonSpinner(e.find('button[data-action="add_signup_domains"]').get(0),true);TS.model.team.email_domain=t.data.prefs.signup_domains},function(t){TS.ui.stopButtonSpinner(e.find('button[data-action="add_signup_domains"]').get(0),false);var i=TS.interop.i18n.t("Sorry! Something went wrong. Please try again.","invite")();"signup_domains_missing"===t.data.error?i=TS.interop.i18n.t("Please enter a domain","invite")():"bad_domain"===t.data.error?i=TS.interop.i18n.t("Sorry! You can\u2019t use {response_data_domain}.","invite")({response_data_domain:t.data.domain}):"invalid_domain"===t.data.error?i=TS.interop.i18n.t("Hmm, this doesn\u2019t look like a domain! Check for typos?","invite")():"too_many_domains"===t.data.error&&(i=TS.interop.i18n.t("Sorry! You\u2019ve entered too many domains.","invite")());$("#invite_signup_domains").focus().tooltip({title:i,trigger:"manual"}).tooltip("show").on("blur",function(){$(this).tooltip("destroy")})})};var ze=function e(){return TS.permissions.members.canNonAdminInviteToWorkspace()};var Ye=function e(){return TS.permissions.members.canUserInviteToWorkspace()};var qe=function e(){if(TS.boot_data.page_needs_enterprise&&TS.model.team&&TS.model.user)return TS.interop.rules.teams.canOrgUserManageGuests(TS.model.team,TS.model.user);return f||TS.model.user.is_admin&&""!==TS.model.team.plan};var Je=function e(){return!f&&!TS.model.team.plan&&TS.model.user.is_admin};var Ze=function e(t){var i="";if(!t||!t.error)return"";if(!M[t.error])return TS.ui.validation.getErrorMessage(t.error,{maxlength:80});if(!M[t.error])return"";i=M[t.error];return _.isFunction(i)?i(t):i}})()},1986:function(e,t){(function(){TS.registerModule("ui.date_picker",{onStart:function e(){},start:function e(t,i){t.pickmeup(i)},startJumpToDatePicker:function e(t){var n=$("#channel_actions_toggle").attr("data-oldest-ts");if(n){var a=TS.interop.datetime.toDateObject(n);i(t,a)}else{var r=TS.shared.legacyGetActiveModelOb();var s={channel:r.id,oldest:283996800,count:1,ignore_replies:true,inclusive:1,include_pin_count:true,no_user_profile:true};TS.interop.api.callExpedited("conversations.history",s).then(function(e){var n;e.data.messages.length<1&&(n=TS.shared.legacyGetActiveModelOb().created);n=_(e.data.messages).map("ts").min();var a=TS.interop.datetime.toDateObject(n);i(t,a);return true}).catch(function(){i(t);return TS.warn("couldn\u2019t find messages in this channel :"+r.id)})}},startArchiveDatePicker:function e(t){var i=TS.shared.legacyGetActiveModelOb();var n=TS.interop.datetime.toDateObject(i.created);var a=Date.now();var r=a;boot_data.calendar_start&&(r=TS.interop.datetime.toDateObject(boot_data.calendar_start));boot_data.calendar_oldest&&(n=TS.interop.datetime.toDateObject(boot_data.calendar_oldest));TS.ui.date_picker.start(t,{first_day:window.moment.localeData().firstDayOfWeek()||0,hide_on_select:true,select_year:true,date:r,min:n,max:a,title_format:"ja-JP"===TS.interop.i18n.locale?"Y\u5e74B":"B Y",locale:{days:window.moment.weekdays(),daysShort:window.moment.weekdaysShort(),daysMin:window.moment.weekdaysMin(),months:window.moment.months(),monthsShort:window.moment.monthsShort()},change:function e(){r=$(this).pickmeup("get_date");var t=1e3*Date.parse(r);var n="/archives/"+i.id;window.location=n+"/s"+t}})},startExpirationDatePicker:function e(t,i){i=i||{};var a=new Date;var r=a.getTime();var s;var o;if(i.selected_expiration_ts)o=new Date(1e3*i.selected_expiration_ts);else{o=new Date;o.setDate(a.getDate()+n)}o.setHours(0,0,0,0);s=o.getTime();var l={first_day:window.moment.localeData().firstDayOfWeek()||0,select_year:false,min:r,date:s,format:"s",position:"top",flat:true,hide_on_select:true,title_format:"ja-JP"===TS.interop.i18n.locale?"Y\u5e74B":"B Y",locale:{days:window.moment.weekdays(),daysShort:window.moment.weekdaysShort(),daysMin:window.moment.weekdaysMin(),months:window.moment.months(),monthsShort:window.moment.monthsShort()}};i.class_name&&(l.class_name=i.class_name);i.onHide&&(l.hide=i.onHide);i.onChange&&(l.change=function(e){var t=new Date(1e3*e);t.setHours(23,59,59,0);var n=Math.floor(t.getTime()/1e3);i.onChange(n)});TS.ui.date_picker.start(t,l)},getOldestMsgTs:function e(){var t=$("#channel_actions_toggle").attr("data-oldest-ts");if(t)return;var i=TS.shared.legacyGetActiveModelOb();var n={channel:i.id,oldest:283996800,count:1,ignore_replies:true,inclusive:1,include_pin_count:true,no_user_profile:true};TS.interop.api.callExpedited("conversations.history",n).then(function(e){var t;if(e.data.messages.length<1)return;t=_(e.data.messages).map("ts").min();$("#channel_actions_toggle").attr("data-oldest-ts",t);return true}).catch(function(){return TS.warn("couldn\u2019t find messages in this channel :"+i.id)})}});var e=function e(t){var i=TS.shared.legacyGetActiveModelOb();TS.client.ui.tryToJump(i.id,""+Date.parse(t)/1e3)};var t=function e(t,i,n){n=n||1;if(n>100){if(t._archive_msgs&&t._archive_msgs.length>0)return t._archive_msgs[0];throw new Error("no_visible_message_found")}return new Promise(function(e,a){var r={channel:t.id,oldest:i,count:n,inclusive:1,ignore_replies:true,include_pin_count:true,no_user_profile:true};TS.interop.api.call("conversations.history",r).then(function(i){if(i&&i.data&&0!==i.data.messages.length){var n=i.data.messages;for(var r=n.length-1;r>=0;r-=1){var s=n[r];TS.interop.messages.isReply(s)||"pinned_item"===s.subtype||e(s.ts)}a(new Error("no_visible_message_found"))}else t._archive_msgs&&t._archive_msgs.length>0?e(t._archive_msgs[0]):a(new Error("api_call_failed"))})}).then(function(e){return e},function(a){if("no_visible_message_found"===a.message)return e(t,i,10*n);throw a})};var i=function t(i,n){n||(n=TS.interop.datetime.toDateObject(TS.shared.legacyGetActiveModelOb().created));var a=Date.now();var r=a;TS.ui.date_picker.start(i,{first_day:window.moment.localeData().firstDayOfWeek()||0,hide_on_select:true,select_year:false,flat:true,date:r,min:n,max:a,title_format:"ja-JP"===TS.interop.i18n.locale?"Y\u5e74B":"B Y",locale:{days:window.moment.weekdays(),daysShort:window.moment.weekdaysShort(),daysMin:window.moment.weekdaysMin(),months:window.moment.months(),monthsShort:window.moment.monthsShort()},change:function t(){r=$(this).pickmeup("get_date");e(r);TS.menu.$menu.css("opacity",0);TS.menu.end()},hide:function e(){window.setTimeout(function(){$(this).pickmeup&&$(this).pickmeup("destroy")}.bind(this),0)}});i.pickmeup("show")};var n=7})()},1987:function(e,t){(function(){TS.registerModule("ui.paste",{catcher_div:null,onStart:function e(){if(!window.Clipboard){TS.ui.paste.catcher_div=document.createElement("div");TS.ui.paste.catcher_div.setAttribute("tabindex","-1");TS.ui.paste.catcher_div.setAttribute("contenteditable","");TS.ui.paste.catcher_div.setAttribute("class","offscreen");TS.ui.paste.catcher_div.setAttribute("data-contenteditable-override","false");document.body.appendChild(TS.ui.paste.catcher_div)}var t=86;$(window.document).keydown(function(e){if(!TS.ui.paste.okToGo())return;if(TS.interop.utility.isCmdKey(e)&&e.which==t){if(!TS.ui.paste.catcher_div)return;if(e.altKey)return;TS.utility.isFocusOnInput()||TS.ui.paste.catcher_div.focus()}});$(window).bind("paste",TS.ui.paste.handler)},okToGo:function t(){if(TS.web)return true;if(TS.client&&!TS.client.ui.$msg_input)return false;if(TS.client&&!TS.client.ui.isUserAttentionOnChat())return false;if(e())return true;if(TS.model.unread_view_is_showing)return false;if(!TS.permissions.members.canPostInChannel(TS.shared.legacyGetActiveModelOb()))return false;if(!TS.utility.isFocusOnInput()||TS.client.ui.isMessageInputFocused())return true;return false},handler:function t(i){if(!TS.ui.paste.okToGo())return;i=i.originalEvent||i;var n=TS.model.shift_key_pressed;if(window.desktop&&window.desktop.app.getModifierKeys){var a=window.desktop.app.getModifierKeys();n=n||a&&a.shift}var r=e()||{},s=r.model_ob_id,o=r.thread_ts,l=r.input_proxy;if(TS.model.is_FF&&bowser.version<50||!i.clipboardData){var c=i.clipboardData&&i.clipboardData.types;var d;c&&_.includes(c,"text/plain")&&(d=i.clipboardData.getData("text"));setTimeout(TS.ui.paste.checkCatcher,0,n,d)}else{var u=TS.ui.paste.detectImageFromEvent(i);if(u){i.preventDefault();i.clipboardData.items?TS.client.ui.file_pasted_sig.dispatch(u,n,s,o,l):TS.ui.paste.startUploadFromMacSSBReadImage(u,n)}else!TS.model.is_FF&&i.clipboardData.items&&TS.client&&!TS.utility.isFocusOnInput()&&TS.utility.contenteditable.paste(TS.client.msg_input.$input,i)}},supportsUploadOnPaste:function e(){return!TS.model.is_IE},detectImageFromEvent:function e(t){var i;var n;var a=t.clipboardData.items;var r={};if(a){for(i=0;i<a.length;i+=1)a[i]&&(r[a[i].type]=true);for(i=0;i<a.length;i+=1)if(-1!==a[i].type.indexOf("image"))if(TS.model.is_mac&&r["text/plain"]&&r["text/html"]&&r["text/rtf"])TS.info("Ignoring pasted image data, likely from Office/Word for Mac.");else if(TS.model.is_win&&r["text/plain"]&&r["text/html"]&&r["image/png"])TS.info("Ignoring pasted image data from Windows, which should render as text");else{n=a[i].getAsFile();if(null!==n)return n}}else{TS.warn("no clipboardData.items");var s=t.clipboardData.types||[];for(i=0;i<s.length;i+=1)s[i]&&(r[s[i]]=true);var o=window.desktop;if(o&&o.clipboard&&o.clipboard.readImage&&!r["text/rtf"]&&o.clipboard.readImage())return o.clipboard.readImage()}return false},startUploadFromMacSSBReadImage:function e(t,i){var n=document.getElementById("converter_canvas");if(!n){$("body").append('<canvas id="converter_canvas" class="offscreen"></canvas>');n=document.getElementById("converter_canvas")}var a=n.getContext("2d");var r=new Image;r.src="data:image/tiff;base64,"+t;r.onload=function(){n.width=r.width;n.height=r.height;a.clearRect(0,0,n.width,n.height);a.drawImage(r,0,0);var e=TS.utility.base64StrFromDataURI(n.toDataURL("image/png"));TS.client.ui.file_pasted_sig.dispatch(e,i)}},checkCatcher:function e(t,i){var n=TS.ui.paste.catcher_div;if(!n)return;var a=n.childNodes[0];var r=TS.utility.contenteditable.value(TS.client.ui.$msg_input);var s=i;if(!s){s="textContent"in n?n.textContent:n.innerText;s=$.trim(s)}var o;var l;if(a)if("IMG"===a.tagName)TS.client.ui.file_pasted_sig.dispatch(TS.utility.base64StrFromDataURI(a.src),t);else{if(r){l=TS.client.ui.$msg_input.getCursorRange();var c=l.l;var d=l.s;var u=r.substr(0,d);var _=r.substr(d+c);o=u+s+_}else o=s;TS.client.msg_input.populate(o)}n.innerHTML="";l&&TS.client.ui.$msg_input.setCursorPosition(l.s+l.l+s.length)},getPlainTextFromClipboard:function e(t){if(t&&t.clipboardData)return t.clipboardData.getData("text/plain");if(window.clipboardData)return window.clipboardData.getData("Text");return null}});var e=function e(){if(!TS.boot_data.feature_file_threads)return null;if(TS.boot_data.feature_react_threads){var t=TS.utility.contenteditable.isActiveElement($("#convo_tab .p-threads_footer__input_container .p-message_input_field"));var i="convo"===TS.model.ui_state.flex_name&&TS.model.ui_state.flex_extra;if(t&&i){var n=TS.interop.rules.threads.decodeThreadKey(i),a=n.channelId,r=n.threadTs;var s=void 0;TS.boot_data.feature_react_threads&&(s=TS.interop.message_input_registry.getInputProxy({viewContext:"threads-flexpane",channelId:a,threadTs:r}));return{model_ob_id:a,thread_ts:r,input_proxy:s}}}else if(TS.ui.replies.isReplyInputFocused())return{model_ob_id:TS.ui.replies.activeConvoModelId(),thread_ts:TS.ui.replies.activeConvoThreadTs()};var o=TS.client.ui.threads.threadWithFocusedInput();if(o)return{model_ob_id:o.model_ob.id,thread_ts:o.root_msg.ts};return null}})()},1989:function(e,t){(function(){TS.registerModule("utility.window",{onStart:function t(){e=!!window.desktop},open:function t(r){r=_.defaults(r,i);r.width=m(r.width);r.height=f(r.height);r.x=r.x||d(r.width);r.y=r.y||u(r.width);return e?a(r):n(r)},alwaysOpenInBrowser:function t(i){var n=window.open(i);if(!e)try{n.focus()}catch(e){h()}},get:function t(i){if(e)return;return s(i)}});var e;var t={};var i={title:"",url:"about:blank",show:true,width:590,height:520,no_spinner:true,allowThirdPartyNavigation:true,try_window_open_in_ssb:false};var n=function e(t){var i=window.open(t.url,t.title,c(t));try{i.focus()}catch(e){h();return}return r(i)};var a=function e(t){if(t.try_window_open_in_ssb){var i=window.open(t.url,t.title,c(t));try{i.focus();return Date.now()}catch(e){TS.warn(e)}}return TS.client.windows.openWindow(t)};var r=function i(n){if(e||!l(n))return;o();var a=Date.now();t[a]=n;return a};var s=function e(i){o();return t[i]};var o=function e(){t=_.pickBy(t,function(e){return l(e)&&!e.closed})};var l=function e(t){return t===t.window};var c=function e(t){var i={left:t.x,top:t.y,width:t.width,height:t.height,menubar:0,toolbar:0};return _.toPairs(i).map(function(e){return e.join("=")}).join(",")};var d=function e(t){var i=window.screenX||window.screenLeft;var n=window.outerWidth||document.documentElement.offsetWidth;return i+(n-t)/2};var u=function e(t){var i=window.screenY||window.screenTop;var n=window.outerHeight||document.documentElement.offsetHeight;return i+(n-t)/2};var m=function e(t){var i=window.outerWidth||document.documentElement.offsetWidth;t>i&&(t=i);return t};var f=function e(t){var i=window.outerHeight||document.documentElement.offsetHeight;t>i&&(t=i);return t};var h=function e(){bowser&&bowser.name&&$("#allow_popups_banner_browser").text(bowser.name);TS.ui.banner.show("allow_popups")}})()},2003:function(e,t){(function(e){function t(){var e=new Date(this.toString()),t=28,i=e.getMonth();while(e.getMonth()==i){++t;e.setDate(t)}return t-1}e.addDays=function(e){this.setDate(this.getDate()+e)};e.addMonths=function(e){var i=this.getDate();this.setDate(1);this.setMonth(this.getMonth()+e);this.setDate(Math.min(i,t.apply(this)))};e.addYears=function(e){var i=this.getDate();this.setDate(1);this.setFullYear(this.getFullYear()+e);this.setDate(Math.min(i,t.apply(this)))};e.getDayOfYear=function(){var e=new Date(this.getFullYear(),this.getMonth(),this.getDate(),0,0,0);var t=new Date(this.getFullYear(),0,0,0,0,0);var i=e-t;return Math.floor(i/24*60*60*1e3)}})(Date.prototype);(function(e){var t=0;e.pickmeup=e.extend(e.pickmeup||{},{date:new Date,flat:false,first_day:1,default_date:true,prev:"&#9664;",next:"&#9654;",mode:"single",select_year:true,select_month:true,select_day:true,view:"days",calendars:1,format:"d-m-Y",position:"bottom",trigger_event:"click touchstart",class_name:"",separator:" - ",hide_on_select:false,min:null,max:null,render:function(){},change:function(){return true},before_show:function(){return true},show:function(){return true},hide:function(){return true},fill:function(){return true},locale:{days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"],daysShort:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sun"],daysMin:["Su","Mo","Tu","We","Th","Fr","Sa","Su"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],monthsShort:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]}});var i={years:"pmu-view-years",months:"pmu-view-months",days:"pmu-view-days"},n={wrapper:'<div class="pickmeup" />',head:function(e){var t="";for(var i=0;i<7;++i)t+="<div>"+e.day[i]+"</div>";return'<div class="pmu-instance"><nav><div class="pmu-prev pmu-button">'+e.prev+'</div><div class="pmu-month pmu-button" /><div class="pmu-next pmu-button">'+e.next+'</div></nav><nav class="pmu-day-of-week">'+t+"</nav></div>"},body:function(e,t){var i="";for(var n=0;n<e.length;++n){i+='<div class="'+e[n].class_name+' pmu-button">';-1!=e[n].class_name.indexOf("pmu-today")?i+='<span class="pmu-today-border">'+e[n].text+"</span>":i+=e[n].text;i+="</div>"}return'<div class="'+t+'">'+i+"</div>"}};function a(){var t=e(this).data("pickmeup-options"),i=this.pickmeup,a=Math.floor(t.calendars/2),r=t.date,o=t.current,l,c,d,u,_=(new Date).setHours(0,0,0,0).valueOf(),m,f,h,p;i.find(".pmu-instance > :not(nav)").remove();for(var g=0;g<t.calendars;g++){l=new Date(o);u=i.find(".pmu-instance").eq(g);if(i.hasClass("pmu-view-years")){l.addYears(12*(g-a));c=l.getFullYear()-6+" - "+(l.getFullYear()+5)}else if(i.hasClass("pmu-view-months")){l.addYears(g-a);c=l.getFullYear()}else if(i.hasClass("pmu-view-days")){l.addMonths(g-a);p=t.title_format||"B Y";c=s(l,p,t.locale)}if(!f&&t.max){h=new Date(l);t.select_day?h.addMonths(t.calendars-1):t.select_month?h.addYears(t.calendars-1):h.addYears(12*(t.calendars-1));if(h>t.max){--g;o.addMonths(-1);f=void 0;continue}}f=new Date(l);if(!m){m=new Date(l);m.setDate(1);m.addMonths(1);m.addDays(-1);if(t.min&&t.min>m){--g;o.addMonths(1);m=void 0;continue}}u.find(".pmu-month").text(c);d="";var T=function(e){return"range"==t.mode&&e>=new Date(r[0]).getFullYear()&&e<=new Date(r[1]).getFullYear()||"multiple"==t.mode&&-1!==r.reduce(function(e,t){e.push(new Date(t).getFullYear());return e},[]).indexOf(e)||new Date(r).getFullYear()==e};var S=function(e,i){var n=new Date(r[0]).getFullYear(),a=new Date(r[1]).getFullYear(),s=new Date(r[0]).getMonth(),o=new Date(r[1]).getMonth();return"range"==t.mode&&e>n&&e<a||"range"==t.mode&&e==n&&e<a&&i>=s||"range"==t.mode&&e>n&&e==a&&i<=o||"range"==t.mode&&e==n&&e==a&&i>=s&&i<=o||"multiple"==t.mode&&-1!==r.reduce(function(e,t){t=new Date(t);e.push(t.getFullYear()+"-"+t.getMonth());return e},[]).indexOf(e+"-"+i)||new Date(r).getFullYear()==e&&new Date(r).getMonth()==i};(function(){var e=[],i=l.getFullYear()-6,a=new Date(t.min).getFullYear(),r=new Date(t.max).getFullYear(),s;for(var o=0;o<12;++o){s={text:i+o,class_name:[]};t.min&&s.text<a||t.max&&s.text>r?s.class_name.push("pmu-disabled"):T(s.text)&&s.class_name.push("pmu-selected");s.class_name=s.class_name.join(" ");e.push(s)}d+=n.body(e,"pmu-years")})();(function(){var e=[],i=l.getFullYear(),a=new Date(t.min).getFullYear(),r=new Date(t.min).getMonth(),s=new Date(t.max).getFullYear(),o=new Date(t.max).getMonth(),c;for(var u=0;u<12;++u){c={text:t.locale.monthsShort[u],class_name:[]};t.min&&(i<a||u<r&&i==a)||t.max&&(i>s||u>o&&i>=s)?c.class_name.push("pmu-disabled"):S(i,u)&&c.class_name.push("pmu-selected");c.class_name=c.class_name.join(" ");e.push(c)}d+=n.body(e,"pmu-months")})();(function(){var i=[],a=l.getMonth(),r;(function(){l.setDate(1);var e=(l.getDay()-t.first_day)%7;l.addDays(-(e+(e<0?7:0)))})();for(var s=0;s<42;++s){r={text:l.getDate(),class_name:[]};a!=l.getMonth()&&r.class_name.push("pmu-not-in-month");0==l.getDay()?r.class_name.push("pmu-sunday"):6==l.getDay()&&r.class_name.push("pmu-saturday");var o=t.render(l)||{},c=l.valueOf(),u=t.min&&t.min>l||t.max&&t.max<l;o.disabled||u?r.class_name.push("pmu-disabled"):(o.selected||t.date==c||-1!==e.inArray(c,t.date)||"range"==t.mode&&c>=t.date[0]&&c<=t.date[1])&&r.class_name.push("pmu-selected");c==_&&r.class_name.push("pmu-today");o.class_name&&r.class_name.push(o.class_name);r.class_name=r.class_name.join(" ");i.push(r);l.addDays(1)}d+=n.body(i,"pmu-days")})();u.append(d)}m.setDate(1);f.setDate(1);f.addMonths(1);f.addDays(-1);i.find(".pmu-prev").css("visibility",t.min&&t.min>=m?"hidden":"visible");i.find(".pmu-next").css("visibility",t.max&&t.max<=f?"hidden":"visible");t.fill.apply(this)}function r(t,i,n,a){if(t.constructor==Date)return t;if(!t)return new Date;var s=t.split(n);if(s.length>1){s.forEach(function(t,s,o){o[s]=r(e.trim(t),i,n,a)});return s}var o=a.monthsShort.join(")(")+")("+a.months.join(")("),n=new RegExp("[^0-9a-zA-Z("+o+")]+"),l=t.split(n),c=i.split(n),d,u,_,m,f,h=new Date;for(var p=0;p<l.length;p++)switch(c[p]){case"b":u=a.monthsShort.indexOf(l[p]);break;case"B":u=a.months.indexOf(l[p]);break;case"d":case"e":d=parseInt(l[p],10);break;case"m":u=parseInt(l[p],10)-1;break;case"Y":case"y":_=parseInt(l[p],10);_+=_>100?0:_<29?2e3:1900;break;case"H":case"I":case"k":case"l":m=parseInt(l[p],10);break;case"P":case"p":/pm/i.test(l[p])&&m<12?m+=12:/am/i.test(l[p])&&m>=12&&(m-=12);break;case"M":f=parseInt(l[p],10);break}var g=new Date(void 0===_?h.getFullYear():_,void 0===u?h.getMonth():u,void 0===d?h.getDate():d,void 0===m?h.getHours():m,void 0===f?h.getMinutes():f,0);isNaN(1*g)&&(g=new Date);return g}function s(e,t,i){var n=e.getMonth();var a=e.getDate();var r=e.getFullYear();var s=e.getDay();var o={};var l=e.getHours();var c=l>=12;var d=c?l-12:l;var u=e.getDayOfYear();0==d&&(d=12);var _=e.getMinutes();var m=e.getSeconds();var f=t.split(""),h;for(var p=0;p<f.length;p++){h=f[p];switch(h){case"a":h=i.daysShort[s];break;case"A":h=i.days[s];break;case"b":h=i.monthsShort[n];break;case"B":h=i.months[n];break;case"C":h=1+Math.floor(r/100);break;case"d":h=a<10?"0"+a:a;break;case"e":h=a;break;case"H":h=l<10?"0"+l:l;break;case"I":h=d<10?"0"+d:d;break;case"j":h=u<100?u<10?"00"+u:"0"+u:u;break;case"k":h=l;break;case"l":h=d;break;case"m":h=n<9?"0"+(1+n):1+n;break;case"M":h=_<10?"0"+_:_;break;case"p":case"P":h=c?"PM":"AM";break;case"s":h=Math.floor(e.getTime()/1e3);break;case"S":h=m<10?"0"+m:m;break;case"u":h=s+1;break;case"w":h=s;break;case"y":h=(""+r).substr(2,2);break;case"Y":h=r;break}f[p]=h}return f.join("")}function o(){var t=e(this),i=t.data("pickmeup-options"),n=i.current,a;switch(i.mode){case"multiple":a=n.setHours(0,0,0,0).valueOf();-1!==e.inArray(a,i.date)?e.each(i.date,function(e,t){if(t==a){i.date.splice(e,1);return false}return true}):i.date.push(a);break;case"range":i.lastSel||(i.date[0]=n.setHours(0,0,0,0).valueOf());a=n.setHours(0,0,0,0).valueOf();if(a<=i.date[0]){i.date[1]=i.date[0];i.date[0]=a}else i.date[1]=a;i.lastSel=!i.lastSel;break;default:i.date=n.valueOf();break}var r=c(i);t.is("input")&&t.val("single"==i.mode?r[0]:r[0].join(i.separator));i.change.apply(this,r);if(i.hide_on_select&&("range"!=i.mode||!i.lastSel)){i.binded.hide();return false}}function l(t){var i=e(t.target);i.hasClass("pmu-button")||(i=i.closest(".pmu-button"));if(i.length){if(i.hasClass("pmu-disabled"))return false;var n=e(this),a=n.data("pickmeup-options"),r=i.parents(".pmu-instance").eq(0),s=r.parent(),o=e(".pmu-instance",s).index(r);if(i.parent().is("nav"))if(i.hasClass("pmu-month")){a.current.addMonths(o-Math.floor(a.calendars/2));if(s.hasClass("pmu-view-years")){"single"!=a.mode?a.current=new Date(a.date[a.date.length-1]):a.current=new Date(a.date);a.select_day?s.removeClass("pmu-view-years").addClass("pmu-view-days"):a.select_month&&s.removeClass("pmu-view-years").addClass("pmu-view-months")}else s.hasClass("pmu-view-months")?a.select_year?s.removeClass("pmu-view-months").addClass("pmu-view-years"):a.select_day&&s.removeClass("pmu-view-months").addClass("pmu-view-days"):s.hasClass("pmu-view-days")&&(a.select_month?s.removeClass("pmu-view-days").addClass("pmu-view-months"):a.select_year&&s.removeClass("pmu-view-days").addClass("pmu-view-years"))}else i.hasClass("pmu-prev")?a.binded.prev(false):a.binded.next(false);else if(!i.hasClass("pmu-disabled"))if(s.hasClass("pmu-view-years")){a.current.setFullYear(parseInt(i.text(),10));a.select_month?s.removeClass("pmu-view-years").addClass("pmu-view-months"):a.select_day?s.removeClass("pmu-view-years").addClass("pmu-view-days"):a.binded.update_date()}else if(s.hasClass("pmu-view-months")){a.current.setMonth(r.find(".pmu-months .pmu-button").index(i));a.current.setFullYear(parseInt(r.find(".pmu-month").text(),10));a.select_day?s.removeClass("pmu-view-months").addClass("pmu-view-days"):a.binded.update_date();a.current.addMonths(Math.floor(a.calendars/2)-o)}else{var l=parseInt(i.text(),10);a.current.addMonths(o-Math.floor(a.calendars/2));i.hasClass("pmu-not-in-month")&&a.current.addMonths(l>15?-1:1);a.current.setDate(l);a.binded.update_date()}a.binded.fill()}return false}function c(t){var i;if("single"==t.mode){i=new Date(t.date);return[s(i,t.format,t.locale),i]}i=[[],[]];e.each(t.date,function(e,n){var a=new Date(n);i[0].push(s(a,t.format,t.locale));i[1].push(a)});return i}function d(t){var i=this.pickmeup;if(t||!i.is(":visible")){var n=e(this),a=n.data("pickmeup-options"),s=n.offset(),o={l:document.documentElement.scrollLeft,t:document.documentElement.scrollTop,w:document.documentElement.clientWidth,h:document.documentElement.clientHeight},l=s.top,c=s.left;a.binded.fill();n.is("input")&&n.pickmeup("set_date",r(n.val(),a.format,a.separator,a.locale)).keydown(function(e){9==e.which&&n.pickmeup("hide")});a.before_show();switch(a.position){case"top":l-=i.outerHeight();break;case"left":c-=i.outerWidth();break;case"right":c+=this.offsetWidth;break;case"bottom":l+=this.offsetHeight;break}l+i.offsetHeight>o.t+o.h&&(l=s.top-i.offsetHeight);l<o.t&&(l=s.top+this.offsetHeight+i.offsetHeight);c+i.offsetWidth>o.l+o.w&&(c=s.left-i.offsetWidth);c<o.l&&(c=s.left+this.offsetWidth);if(false==a.show())return;i.css({display:"inline-block",top:l+"px",left:c+"px"});e(document).on("mousedown"+a.events_namespace,a.binded.hide).on("resize"+a.events_namespace,[true],a.binded.forced_show)}}function u(){d.call(this,true)}function _(t){if(!t||!t.target||t.target!=this&&!(16&this.pickmeup.get(0).compareDocumentPosition(t.target))){var i=this.pickmeup,n=e(this).data("pickmeup-options");if(false!=n.hide()){i.hide();e(document).off("mousedown",n.binded.hide).off("resize",n.binded.forced_show);n.date[1]=n.date[0];n.lastSel=false}}}function m(){var t=e(this).data("pickmeup-options");e(document).off("mousedown",t.binded.hide).off("resize",t.binded.forced_show);t.binded.forced_show()}function f(){var t=e(this).data("pickmeup-options");if("single"!=t.mode){t.date=[];t.lastSel=false;t.binded.fill()}}function h(t){"undefined"==typeof t&&(t=true);var i=this.pickmeup;var n=e(this).data("pickmeup-options");i.hasClass("pmu-view-years")?n.current.addYears(-12):i.hasClass("pmu-view-months")?n.current.addYears(-1):i.hasClass("pmu-view-days")&&n.current.addMonths(-1);t&&n.binded.fill()}function p(t){"undefined"==typeof t&&(t=true);var i=this.pickmeup;var n=e(this).data("pickmeup-options");i.hasClass("pmu-view-years")?n.current.addYears(12):i.hasClass("pmu-view-months")?n.current.addYears(1):i.hasClass("pmu-view-days")&&n.current.addMonths(1);t&&n.binded.fill()}function g(t){var i=e(this).data("pickmeup-options"),n=c(i);if("string"===typeof t){var a=n[1];return a.constructor==Date?s(a,t,i.locale):a.map(function(e){return s(e,t,i.locale)})}return n[t?0:1]}function T(t){var i=e(this).data("pickmeup-options");i.date=t;"string"===typeof i.date?i.date=r(i.date,i.format,i.separator,i.locale).setHours(0,0,0,0):i.date.constructor==Date&&i.date.setHours(0,0,0,0);if(!i.date){i.date=new Date;i.date.setHours(0,0,0,0)}if("single"!=i.mode)if(i.date.constructor!=Array){i.date=[i.date.valueOf()];"range"==i.mode&&i.default_date&&i.date.push(new Date(i.date[0]).setHours(0,0,0,0).valueOf())}else{for(var n=0;n<i.date.length;n++)i.date[n]=r(i.date[n],i.format,i.separator,i.locale).setHours(0,0,0,0).valueOf();"range"==i.mode&&(i.date[1]=new Date(i.date[1]).setHours(0,0,0,0).valueOf())}else i.date=i.date.constructor==Array?i.date[0].valueOf():i.date.valueOf();i.current=new Date("single"!=i.mode?i.date[0]:i.date);i.binded.fill()}function S(){var t=e(this),i=t.data("pickmeup-options");t.removeData("pickmeup-options");t.off(i.events_namespace);e(document).off(i.events_namespace);e(this.pickmeup).remove()}e.fn.pickmeup=function(s){if("string"===typeof s){var c,v=Array.prototype.slice.call(arguments,1);switch(s){case"hide":case"show":case"clear":case"update":case"prev":case"next":case"destroy":this.each(function(){c=e(this).data("pickmeup-options");c&&c.binded[s]()});break;case"get_date":c=this.data("pickmeup-options");return c?c.binded.get_date(v[0]):null;case"set_date":this.each(function(){c=e(this).data("pickmeup-options");c&&c.binded[s].apply(this,v)})}return this}return this.each(function(){var c=e(this);if(c.data("pickmeup-options"))return;var v,b,w=e.extend({},e.pickmeup,s||{});for(v in w){b=c.data("pmu-"+v);"undefined"!==typeof b&&(w[v]=b)}"days"!=w.view||w.select_day||(w.view="months");"months"!=w.view||w.select_month||(w.view="years");"years"!=w.view||w.select_year||(w.view="days");"days"!=w.view||w.select_day||(w.view="months");w.calendars=Math.max(1,parseInt(w.calendars,10)||1);w.mode=/single|multiple|range/.test(w.mode)?w.mode:"single";"string"===typeof w.min?w.min=r(w.min,w.format,w.separator,w.locale).setHours(0,0,0,0):w.min&&w.min.constructor==Date&&w.min.setHours(0,0,0,0);"string"===typeof w.max?w.max=r(w.max,w.format,w.separator,w.locale).setHours(0,0,0,0):w.max&&w.max.constructor==Date&&w.max.setHours(0,0,0,0);if(!w.select_day){if(w.min){w.min=new Date(w.min);w.min=w.min.valueOf()}if(w.max){w.max=new Date(w.max);w.max=w.max.valueOf()}}"string"===typeof w.date?w.date=r(w.date,w.format,w.separator,w.locale).setHours(0,0,0,0):w.date.constructor==Date&&w.date.setHours(0,0,0,0);if(!w.date){w.date=new Date;w.date.setHours(0,0,0,0)}if("single"!=w.mode){if(w.date.constructor!=Array){w.date=[w.date.valueOf()];"range"==w.mode&&w.default_date&&w.date.push(new Date(w.date[0]).setHours(0,0,0,0).valueOf())}else{for(v=0;v<w.date.length;v++)w.date[v]=r(w.date[v],w.format,w.separator,w.locale).setHours(0,0,0,0).valueOf();"range"==w.mode&&(w.date[1]=new Date(w.date[1]).setHours(0,0,0,0).valueOf())}w.current=new Date(w.date[0]);if(!w.select_day)for(v=0;v<w.date.length;++v){w.date[v]=new Date(w.date[v]);w.date[v].setDate(1);w.date[v]=w.date[v].valueOf();if("range"!=w.mode&&w.date.indexOf(w.date[v])!==v){w.date.splice(v,1),true;--v}}}else{w.date=w.date.valueOf();w.current=new Date(w.date);if(!w.select_day){w.date=new Date(w.date);w.date.setDate(1);w.date=w.date.valueOf()}}w.current.setDate(1);w.current.setHours(0,0,0,0);var y,A=e(n.wrapper);this.pickmeup=A;w.class_name&&A.addClass(w.class_name);var k="";for(v=0;v<w.calendars;v++){y=w.first_day;k+=n.head({prev:w.prev,next:w.next,day:[w.locale.daysMin[y++%7],w.locale.daysMin[y++%7],w.locale.daysMin[y++%7],w.locale.daysMin[y++%7],w.locale.daysMin[y++%7],w.locale.daysMin[y++%7],w.locale.daysMin[y++%7]]})}c.data("pickmeup-options",w);for(v in w)-1!=["render","change","before_show","show","hide"].indexOf(v)&&(w[v]=w[v].bind(this));w.binded={fill:a.bind(this),update_date:o.bind(this),click:l.bind(this),show:d.bind(this),forced_show:u.bind(this),hide:_.bind(this),update:m.bind(this),clear:f.bind(this),prev:h.bind(this),next:p.bind(this),get_date:g.bind(this),set_date:T.bind(this),destroy:S.bind(this)};w.events_namespace=".pickmeup-"+ ++t;A.on("click touchstart",w.binded.click).addClass(i[w.view]).append(k).on(e.support.selectstart?"selectstart":"mousedown",function(e){e.preventDefault()});w.binded.fill();if(w.flat)A.appendTo(this).css({position:"relative",display:"inline-block"});else{A.appendTo(document.body);var C=w.trigger_event.split(" ");for(v=0;v<C.length;++v)C[v]+=w.events_namespace;C=C.join(" ");c.on(C,w.binded.show)}})}})(jQuery)},2023:function(e,t){(function(){TS.registerModule("ui.shortcuts_dialog",{$div:null,showing:false,is_space:false,onStart:function e(){},onKeydown:function e(t){if(!TS.ui.shortcuts_dialog.showing)return;if(t.which==TS.utility.keymap.enter||t.which==TS.utility.keymap.esc){TS.ui.shortcuts_dialog.cancel();t.preventDefault()}70==t.which&&TS.interop.utility.isCmdKey(t)&&t.preventDefault()},start:function e(){TS.ui.shortcuts_dialog.is_space=TS.web&&TS.web.space;TS.tips.hideAll();TS.ui.shortcuts_dialog.$div||TS.ui.shortcuts_dialog.build();var t=TS.templates.shortcuts_dialog({meta_key:TS.model.is_mac?TS.interop.i18n.t("Option","keys")():TS.interop.i18n.t("Alt","keys")(),cmd_key:TS.model.is_mac?TS.interop.i18n.t("Cmd","keys")():TS.interop.i18n.t("Ctrl","keys")(),cmd_key_label:TS.model.is_mac?TS.interop.i18n.t("Command","keys")():TS.interop.i18n.t("Control","keys")(),can_show_a11y_keyboard_shortcuts:TS.boot_data.feature_a11y_keyboard_shortcuts,can_show_unread_view:TS.client&&TS.client.unread.isEnabled(),show_browse_dms_shortcut:true});TS.ui.shortcuts_dialog.is_space&&(t=TS.templates.shortcuts_spaces_dialog({clear_formatting:!TS.model.is_win,meta_key:TS.model.is_mac?TS.interop.i18n.t("Option","keys")():TS.interop.i18n.t("Alt","keys")(),cmd_key:TS.model.is_mac?TS.interop.i18n.t("Cmd","keys")():TS.interop.i18n.t("Ctrl","keys")(),cmd_key_label:TS.model.is_mac?TS.interop.i18n.t("Command","keys")():TS.interop.i18n.t("Control","keys")()}));var i=TS.ui.shortcuts_dialog.$div;i.html(t).modal("show").find(".dialog_cancel").click(TS.ui.shortcuts_dialog.cancel);TS.ui.shortcuts_dialog.is_space||TS.ui.a11y.saveCurrentFocusAndFocusOnElement(i)},cancel:function e(){TS.ui.shortcuts_dialog.$div.modal("hide")},end:function e(){TS.model.dialog_is_showing=false;TS.ui.shortcuts_dialog.showing=false;TS.ui.shortcuts_dialog.$div.empty();$(window.document).unbind("keydown",TS.ui.shortcuts_dialog.onKeydown);TS.ui.shortcuts_dialog.is_space||TS.ui.a11y.restorePreviousFocusAndCleanUpElement(TS.ui.shortcuts_dialog.$div);TS.tips.unhideAll()},build:function e(){var t;if(TS.ui.shortcuts_dialog.is_space){$("body").append('<div id="shortcuts_spaces_dialog" class="modal hide fade"></div>');TS.ui.shortcuts_dialog.$div=$("#shortcuts_spaces_dialog");t=TS.ui.shortcuts_dialog.$div}else{$("body").append('<div id="shortcuts_dialog" class="modal hide fade"></div>');TS.ui.shortcuts_dialog.$div=$("#shortcuts_dialog");t=TS.ui.shortcuts_dialog.$div}t.on("hidden",function(e){if(e.target!=this)return;TS.ui.shortcuts_dialog.end()});t.on("show",function(e){if(e.target!=this)return;TS.model.dialog_is_showing=true;TS.ui.shortcuts_dialog.showing=true});t.on("shown",function(e){if(e.target!=this)return;$(window.document).bind("keydown",TS.ui.shortcuts_dialog.onKeydown);TS.ui.shortcuts_dialog.height=t.outerHeight()+t.offset().top;TS.ui.shortcuts_dialog.width=t.outerWidth();TS.ui.shortcuts_dialog.toggleScrollbars();$(window).on("resize",TS.ui.shortcuts_dialog.toggleScrollbars)})},toggleScrollbars:function e(){if(!TS.ui.shortcuts_dialog.showing)return;var t=TS.ui.shortcuts_dialog.width>$(window).width();var i=TS.ui.shortcuts_dialog.height>$(window).height()||t;TS.ui.shortcuts_dialog.$div.toggleClass("single_column",t);TS.ui.shortcuts_dialog.$div.toggleClass("scroll_content",i)}})})()},2024:function(e,t){(function(){TS.registerModule("coachmarks",{coachmarks:{shared_channels_create:{id:"shared_channels_coachmark",coachmark_el_id:"shared_channels_coachmark_div",place:function e(){var t=$('[data-qa-channel-sidebar-section-heading="shared_channels"] .p-channel_sidebar__section_heading_plus').length?"shared_channels":"channels";TS.coachmark.placeRightOf($('[data-qa-channel-sidebar-section-heading="'+t+'"] .p-channel_sidebar__section_heading_plus'),-26,19,5)},content:function e(){return TS.templates.shared_channels_coachmark({show_create_button:true,without_animation:!TS.prefs.getPref("a11y_animations")})},resolve:function e(){TS.ui.share_channel_dialog.start({element:"shared_channels_coachmark_create_btn"})},no_footer:true},shared_channels_get_started:{id:"shared_channels_coachmark",coachmark_el_id:"shared_channels_coachmark_div",place:function e(){var t=$('[data-qa-channel-sidebar-section-heading="shared_channels"] .p-channel_sidebar__section_heading_plus').length?"shared_channels":"channels";TS.coachmark.placeRightOf($('[data-qa-channel-sidebar-section-heading="'+t+'"] .p-channel_sidebar__section_heading_plus'),-26,19,5)},content:function e(){return TS.templates.shared_channels_coachmark({without_animation:!TS.prefs.getPref("a11y_animations")})},resolve:function e(){TS.ui.shared_channels_open_beta_modal.showModal({show_create_button_only:true})},no_footer:true},channels:{id:"channels_coachmark",coachmark_el_id:"channels_coachmark_div",place:function e(){TS.coachmark.placeRightOf($('[data-qa-channel-sidebar-section-heading="channels"]'),-26,-5,5)},content:function e(){var t=TS.interop.redux.models.channels.getUnarchivedPublicAndPrivateChannelsUserIsIn(TS.redux.getState());var i=t.filter(TS.interop.rules.channels.isPrivateChannel);var n={in_single_private_channel:1===t.length&&1===i.length,in_single_public_channel:1===t.length&&!i.length,first_group_channel_name:i.length?i[0].name:"",first_listed_channel:t.length?t[0].name:""};return TS.templates.channels_coachmark(n)}},invites:{id:"invites_coachmark",coachmark_el_id:"invites_coachmark_div",place:function e(){TS.coachmark.placeRightOf($(".p-channel_sidebar__link--invites"),-26,-5,5)},content:function e(){return TS.templates.invites_coachmark()}},direct_messages:{id:"direct_messages_coachmark",coachmark_el_id:"direct_messages_coachmark_div",place:function e(){TS.coachmark.placeRightOf($('[data-qa-channel-sidebar-section-heading="ims"]'),-26,-5,5)},content:function e(){var t={channels_count:TS.interop.redux.models.channels.getPublicChannels(TS.redux.getState()).length,groups_count:TS.interop.redux.models.channels.getPrivateChannels(TS.redux.getState()).length};return TS.templates.direct_messages_coachmark(t)}},highlights_feedback:{id:"highlights_feedback_coachmark",coachmark_el_id:"highlights_feedback_coachmark_div",inline_wrapper_el_class:"highlights_feedback_to_coach",no_bg:true,has_close_btn:true,place:function e(){TS.coachmark.placeBelowOf($(".highlights_feedback_to_coach"),40,-330,340,true)},content:function e(){return TS.templates.highlights_feedback_coachmark()},buttonText:function e(){return TS.interop.i18n.t("Got it!","coachmarks")()}},recent_mentions:{id:"recent_mentions_coachmark",coachmark_el_id:"recent_mentions_coachmark_div",no_bg_on_small:true,place:function e(){TS.coachmark.placeBelowOf($("#recent_mentions_toggle"),25,-340,1)},placeSmall:function e(){TS.coachmark.placeBelowOf($("#recent_mentions_toggle"),25,-240,1)},content:function e(){return TS.templates.recent_mentions_coachmark()}},starred_items:{id:"starred_items_coachmark",coachmark_el_id:"starred_items_coachmark_div",no_bg_on_small:true,place:function e(){TS.coachmark.placeBelowOf($("#stars_toggle"),25,-340,3)},placeSmall:function e(){TS.coachmark.placeBelowOf($("#stars_toggle"),25,-220,8)},content:function e(){return TS.templates.starred_items_coachmark()}},unread_view:{id:"unread_view_coachmark",coachmark_el_id:"unread_view_coachmark_div",place:function e(){TS.coachmark.placeRightOf($(".p-channel_sidebar__link--all-unreads"),-16)},content:function e(){return TS.templates.unread_view_coachmark()}},calls_screen_share_window:{id:"calls_screen_share_window_coachmark",coachmark_el_id:"calls_screen_share_window_coachmark_div",place:function e(){TS.coachmark.placeAboveOf($("#screen"),0,-180,12)},buttonText:function e(){return TS.interop.i18n.t("Got It","coachmarks")()},content:function e(){return TS.templates.calls_screen_share_window_coachmark()},ui_click:true},calls_interactive_screen_share:{id:"calls_interactive_screen_share_coachmark",coachmark_el_id:"calls_interactive_screen_share_coachmark_div",place:function e(){TS.coachmark.placeBelowOf($(".call_icon"),17,-25,5)},buttonText:function e(){return TS.interop.i18n.t("Got It","coachmarks")()},content:function e(){return TS.templates.calls_interactive_screen_share_coachmark()}},gdrive:{id:"gdrive_coachmark",coachmark_el_id:"gdrive_coachmark_div",place:function e(){TS.coachmark.placeAboveOf($("#primary_file_button"),13,-6,0)},content:function e(){return TS.templates.gdrive_coachmark()}},intl_channel_names:{id:"intl_channel_names_coachmark",coachmark_el_id:"intl_channel_names_coachmark_div",place:function e(){TS.coachmark.placeBelowOf($(".title_input"),70,105,20)},buttonText:function e(){return TS.interop.i18n.t("Got it!","coachmarks")()},content:function e(){return TS.templates.intl_channel_names_coachmark()}}},onStart:function e(){}})})()},204:function(e,t,i){var n=i(58);var a=i(71);var r=i(98);e.exports=i(56)?Object.defineProperties:function e(t,i){a(t);var s=r(i);var o=s.length;var l=0;var c;while(o>l)n.f(t,c=s[l++],i[c]);return t}},205:function(e,t,i){var n=i(60);var a=i(120);var r=i(101)("IE_PROTO");var s=Object.prototype;e.exports=Object.getPrototypeOf||function(e){e=a(e);if(n(e,r))return e[r];if("function"==typeof e.constructor&&e instanceof e.constructor)return e.constructor.prototype;return e instanceof Object?s:null}},208:function(e,t,i){var n=i(95);var a=i(96);e.exports=function(e){return function(t,i){var r=String(a(t));var s=n(i);var o=r.length;var l,c;if(s<0||s>=o)return e?"":void 0;l=r.charCodeAt(s);return l<55296||l>56319||s+1===o||(c=r.charCodeAt(s+1))<56320||c>57343?e?r.charAt(s):l:e?r.slice(s,s+2):c-56320+(l-55296<<10)+65536}}},209:function(e,t,i){"use strict";var n=i(163);var a=i(83);var r=i(119);var s={};i(64)(s,i(43)("iterator"),function(){return this});e.exports=function(e,t,i){e.prototype=n(s,{next:a(1,i)});r(e,t+" Iterator")}},210:function(e,t,i){var n=i(46).document;e.exports=n&&n.documentElement},215:function(e,t,i){var n=i(192);var a=i(43)("iterator");var r=i(80);e.exports=i(52).getIteratorMethod=function(e){if(void 0!=e)return e[a]||e["@@iterator"]||r[n(e)]}},220:function(e,t,i){"use strict";var n=i(221);var a=i(222);var r=i(80);var s=i(66);e.exports=i(155)(Array,"Array",function(e,t){this._t=s(e);this._i=0;this._k=t},function(){var e=this._t;var t=this._k;var i=this._i++;if(!e||i>=e.length){this._t=void 0;return a(1)}if("keys"==t)return a(0,i);if("values"==t)return a(0,e[i]);return a(0,[i,e[i]])},"values");r.Arguments=r.Array;n("keys");n("values");n("entries")},221:function(e,t){e.exports=function(){}},222:function(e,t){e.exports=function(e,t){return{value:t,done:!!e}}},224:function(e,t,i){e.exports={default:i(248),__esModule:true}},24:function(e,t,i){"use strict";t.__esModule=true;var n=i(412);var a=r(n);function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e){if(Array.isArray(e)){for(var t=0,i=Array(e.length);t<e.length;t++)i[t]=e[t];return i}return(0,a.default)(e)}},248:function(e,t,i){i(249);e.exports=i(52).Object.assign},249:function(e,t,i){var n=i(86);n(n.S+n.F,"Object",{assign:i(250)})},250:function(e,t,i){"use strict";var n=i(98);var a=i(132);var r=i(111);var s=i(120);var o=i(133);var l=Object.assign;e.exports=!l||i(73)(function(){var e={};var t={};var i=Symbol();var n="abcdefghijklmnopqrst";e[i]=7;n.split("").forEach(function(e){t[e]=e});return 7!=l({},e)[i]||Object.keys(l({},t)).join("")!=n})?function e(t,i){var l=s(t);var c=arguments.length;var d=1;var u=a.f;var _=r.f;while(c>d){var m=o(arguments[d++]);var f=u?n(m).concat(u(m)):n(m);var h=f.length;var p=0;var g;while(h>p)_.call(m,g=f[p++])&&(l[g]=m[g])}return l}:l},2504:function(e,t){(function(){TS.registerModule("utility.password",{hasValidSyntax:function e(t){return i(t).is_valid},getErrorMessage:function t(i){return e[i]||""},validate:function e(i,n){return t(i,n)},test:function t(){var a={_ERROR_MESSAGES:e,_checkSyntax:i,_checkPasswordComplexity:n};Object.defineProperty(a,"_checkSyntax",{get:function e(){return i},set:function e(t){i=t}});Object.defineProperty(a,"_checkPasswordComplexity",{get:function e(){return n},set:function e(t){n=t}});return a}});var e={no_values:TS.interop.i18n.t("Please enter a password!","password")(),matches_username:TS.interop.i18n.t("That password is too similar to your username. Try something different?","password")(),matches_email:TS.interop.i18n.t("That password is too similar to your email address. Try something different?","password")(),too_short:TS.interop.i18n.t("Your password must be at least 6 characters long.","password")(),too_long:TS.interop.i18n.t("Your password can be at most 500 characters long.","password")(),numeric_sequence:TS.interop.i18n.t("Your password cannot solely contain sequences of letters or numbers.","password")(),alpha_sequence:TS.interop.i18n.t("Your password cannot solely contain sequences of letters or numbers.","password")(),adjacent:TS.interop.i18n.t("Your password cannot solely contain adjacent keys on a keyboard.","password")(),repeated:TS.interop.i18n.t("Your password cannot solely contain a repeated character.","password")(),common:TS.interop.i18n.t("That password is pretty common. Try something different?","password")()};var t=function e(t,a){var r=i(t);if(!r.is_valid)return Promise.resolve(r);return n(t,a)};var i=function e(t){var i;""===t?i="no_values":t.length<6?i="too_short":t.length>500&&(i="too_long");if(i)return{is_valid:false,error_key:i,error_message:TS.utility.password.getErrorMessage(i)};return{is_valid:true,error_key:"",error_message:""}};var n=function e(t,i){i=i||{};var n;var a=new Promise(function(e){n=e});var r={password:t};i.username&&(r.username=i.username);i.email&&(r.email=i.email);i.lead_id&&(r.lead_id=i.lead_id);TS.interop.api_unauthed.callSlackApiUnauthed("signup.checkPasswordComplexity",r,function(e,t){if(e)return n({is_valid:true,error_key:"",error_message:""});return n({is_valid:false,error_key:t.error,error_message:TS.utility.password.getErrorMessage(t.error)})});return a}})()},2574:function(e,t){!function(e){"use strict";e(function(){e.support.transition=function(){var e=function(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"},i;for(i in t)if(void 0!==e.style[i])return t[i]}();return e&&{end:e}}()})}(window.jQuery);!function(e){"use strict";var t=function(t,i){this.options=i;this.$element=e(t).delegate('[data-dismiss="modal"]',"click.dismiss.modal",e.proxy(this.hide,this));this.options.remote&&this.$element.find(".modal-body").load(this.options.remote)};t.prototype={constructor:t,toggle:function(){return this[this.isShown?"hide":"show"]()},show:function(){var t=this,i=e.Event("show");this.$element.trigger(i);if(this.isShown||i.isDefaultPrevented())return;this.isShown=true;this.escape();this.backdrop(function(){var i=e.support.transition&&t.$element.hasClass("fade");t.$element.parent().length||t.$element.appendTo(document.body);t.$element.show();i&&t.$element[0].offsetWidth;t.$element.addClass("in").attr("aria-hidden",false);t.enforceFocus();i?t.$element.one(e.support.transition.end,function(){t.$element.focus().trigger("shown")}):t.$element.focus().trigger("shown")})},hide:function(t){t&&t.preventDefault();var i=this;t=e.Event("hide");this.$element.trigger(t);if(!this.isShown||t.isDefaultPrevented())return;this.isShown=false;this.escape();e(document).off("focusin.modal");this.$element.removeClass("in").attr("aria-hidden",true);e.support.transition&&this.$element.hasClass("fade")?this.hideWithTransition():this.hideModal()},enforceFocus:function(){var t=this;e(document).on("focusin.modal",function(e){if("clipboardTextarea"===e.target.id)return;t.$element[0]===e.target||t.$element.has(e.target).length||t.$element.focus()})},escape:function(){var e=this;this.isShown&&this.options.keyboard?this.$element.on("keyup.dismiss.modal",function(t){27==t.which&&e.hide()}):this.isShown||this.$element.off("keyup.dismiss.modal")},hideWithTransition:function(){var t=this,i=setTimeout(function(){t.$element.off(e.support.transition.end);t.hideModal()},500);this.$element.one(e.support.transition.end,function(){clearTimeout(i);t.hideModal()})},hideModal:function(e){this.$element.hide().trigger("hidden");this.backdrop()},removeBackdrop:function(){this.$backdrop.remove();this.$backdrop=null},backdrop:function(t){var i=this,n=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var a=e.support.transition&&n;this.$backdrop=e('<div class="modal-backdrop '+n+'" />').appendTo(document.body);this.$backdrop.click("static"==this.options.backdrop?e.proxy(this.$element[0].focus,this.$element[0]):e.proxy(this.hide,this));a&&this.$backdrop[0].offsetWidth;this.$backdrop.addClass("in");a?this.afterBackdropTransitionEnd(t):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");e.support.transition&&this.$element.hasClass("fade")?this.afterBackdropTransitionEnd(e.proxy(this.removeBackdrop,this)):this.removeBackdrop()}else t&&t()},afterBackdropTransitionEnd:function(t){var i=setTimeout(e.proxy(function(){this.$backdrop.off(e.support.transition.end);t()},this),500);this.$backdrop.one(e.support.transition.end,function(){clearTimeout(i);t()})}};var i=e.fn.modal;e.fn.modal=function(i){return this.each(function(){var n=e(this),a=n.data("modal"),r=e.extend({},e.fn.modal.defaults,n.data(),"object"==typeof i&&i);a||n.data("modal",a=new t(this,r));"string"==typeof i?a[i]():r.show&&a.show()})};e.fn.modal.defaults={backdrop:true,keyboard:true,show:true};e.fn.modal.Constructor=t;e.fn.modal.noConflict=function(){e.fn.modal=i;return this};e(document).on("click.modal.data-api",'[data-toggle="modal"]',function(t){var i=e(this),n=i.attr("href");var a=i.attr("data-target")||n&&n.replace(/.*(?=#[^\s]+$)/,"");var r=e(document).find(a);var s=r.data("modal")?"toggle":e.extend({remote:!/#/.test(n)&&n},r.data(),i.data());t.preventDefault();r.modal(s).one("hide",function(){i.focus()})})}(window.jQuery);!function(e){"use strict";var t="[data-toggle=dropdown]",i=function(t){var i=e(t).on("click.dropdown.data-api",this.toggle);e("html").on("click.dropdown.data-api",function(){i.parent().removeClass("open")})};i.prototype={constructor:i,toggle:function(t){var i=e(this),r,s;if(i.is(".disabled, :disabled"))return;r=a(i);s=r.hasClass("open");n();s||r.toggleClass("open");i.focus();return false},keydown:function(t){var i,n,r,s,o,l;if(!/(38|40|27)/.test(t.keyCode))return;var c=e(t.target).closest("[role=menu]");if(c.attr("no-bootstrap"))return;i=e(this);t.preventDefault();t.stopPropagation();if(i.is(".disabled, :disabled"))return;s=a(i);o=s.hasClass("open");if(!o||o&&27==t.keyCode)return i.click();n=e("[role=menu] li:not(.divider):visible a",s);if(!n.length)return;l=n.index(n.filter(":focus"));38==t.keyCode&&l>0&&l--;40==t.keyCode&&l<n.length-1&&l++;~l||(l=0);n.eq(l).focus()}};function n(){e(t).each(function(){a(e(this)).removeClass("open")})}function a(t){var i=t.attr("data-target"),n;if(!i){i=t.attr("href");i=i&&/#/.test(i)&&i.replace(/.*(?=#[^\s]*$)/,"")}n=i&&e(document).find(i);n&&n.length||(n=t.parent());return n}var r=e.fn.dropdown;e.fn.dropdown=function(t){return this.each(function(){var n=e(this),a=n.data("dropdown");a||n.data("dropdown",a=new i(this));"string"==typeof t&&a[t].call(n)})};e.fn.dropdown.Constructor=i;e.fn.dropdown.noConflict=function(){e.fn.dropdown=r;return this};e(document).on("click.dropdown.data-api touchstart.dropdown.data-api",n).on("click.dropdown touchstart.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("touchstart.dropdown.data-api",".dropdown-menu",function(e){e.stopPropagation()}).on("click.dropdown.data-api touchstart.dropdown.data-api",t,i.prototype.toggle).on("keydown.dropdown.data-api touchstart.dropdown.data-api",t+", [role=menu]",i.prototype.keydown)}(window.jQuery);!function(e){"use strict";var t=function(t){this.element=e(t)};t.prototype={constructor:t,show:function(){var t=this.element,i=t.closest("ul:not(.dropdown-menu)"),n=t.attr("data-target"),a,r,s;if(!n){n=t.attr("href");n=n&&n.replace(/.*(?=#[^\s]*$)/,"")}if(t.parent("li").hasClass("active"))return;a=i.find(".active:last a")[0];s=e.Event("show",{relatedTarget:a});t.trigger(s);if(s.isDefaultPrevented())return;r=e(n);this.activate(t.parent("li"),i);this.activate(r,r.parent(),function(){t.trigger({type:"shown",relatedTarget:a})})},activate:function(t,i,n){var a=i.find("> .active"),r=n&&e.support.transition&&a.hasClass("fade");function s(){a.removeClass("active").find("> .dropdown-menu > .active").removeClass("active");t.addClass("active");if(r){t[0].offsetWidth;t.addClass("in")}else t.removeClass("fade");t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active");n&&n()}r?a.one(e.support.transition.end,s):s();a.removeClass("in")}};var i=e.fn.tab;e.fn.tab=function(i){return this.each(function(){var n=e(this),a=n.data("tab");a||n.data("tab",a=new t(this));"string"==typeof i&&a[i]()})};e.fn.tab.Constructor=t;e.fn.tab.noConflict=function(){e.fn.tab=i;return this};e(document).on("click.tab.data-api",'[data-toggle="tab"], [data-toggle="pill"]',function(t){t.preventDefault();e(this).tab("show")})}(window.jQuery);!function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=e.extend({},e.fn.button.defaults,i)};t.prototype.setState=function(e){var t="disabled",i=this.$element,n=i.data(),a=i.is("input")?"val":"html";e+="Text";n.resetText||i.data("resetText",i[a]());i[a](n[e]||this.options[e]);setTimeout(function(){"loadingText"==e?i.addClass(t).attr(t,t):i.removeClass(t).prop(t,false)},0)};t.prototype.toggle=function(){var e=this.$element.closest('[data-toggle="buttons-radio"]');e&&e.find(".active").removeClass("active");this.$element.toggleClass("active")};var i=e.fn.button;e.fn.button=function(i){return this.each(function(){var n=e(this),a=n.data("button"),r="object"==typeof i&&i;a||n.data("button",a=new t(this,r));"toggle"==i?a.toggle():i&&a.setState(i)})};e.fn.button.defaults={loadingText:"loading..."};e.fn.button.Constructor=t;e.fn.button.noConflict=function(){e.fn.button=i;return this};e(document).on("click.button.data-api","[data-toggle^=button]",function(t){var i=e(t.target);i.hasClass("btn")||(i=i.closest(".btn"));i.button("toggle")})}(window.jQuery);!function(e){"use strict";var t=function(t,i){this.$element=e(t);this.options=e.extend({},e.fn.typeahead.defaults,i);this.matcher=this.options.matcher||this.matcher;this.sorter=this.options.sorter||this.sorter;this.highlighter=this.options.highlighter||this.highlighter;this.updater=this.options.updater||this.updater;this.source=this.options.source;this.$menu=e(this.options.menu);this.shown=false;this.listen()};t.prototype={constructor:t,select:function(){var e=this.$menu.find(".active").attr("data-value");this.$element.val(this.updater(e)).change();return this.hide()},updater:function(e){return e},show:function(){var t=e.extend({},this.$element.position(),{height:this.$element[0].offsetHeight});this.$menu.insertAfter(this.$element).css({top:t.top+t.height,left:t.left}).show();this.shown=true;return this},hide:function(){this.$menu.hide();this.shown=false;return this},lookup:function(t){var i;this.query=this.$element.val();if(!this.query||this.query.length<this.options.minLength)return this.shown?this.hide():this;i=e.isFunction(this.source)?this.source(this.query,e.proxy(this.process,this)):this.source;return i?this.process(i):this},process:function(t){var i=this;t=e.grep(t,function(e){return i.matcher(e)});t=this.sorter(t);if(!t.length)return this.shown?this.hide():this;return this.render(t.slice(0,this.options.items)).show()},matcher:function(e){return~e.toLowerCase().indexOf(this.query.toLowerCase())},sorter:function(e){var t=[],i=[],n=[],a;while(a=e.shift())a.toLowerCase().indexOf(this.query.toLowerCase())?~a.indexOf(this.query)?i.push(a):n.push(a):t.push(a);return t.concat(i,n)},highlighter:function(e){var t=this.query.replace(/[\-\[\]{}()*+?.,\\\^$|#\s]/g,"\\$&");return e.replace(new RegExp("("+t+")","ig"),function(e,t){return"<strong>"+t+"</strong>"})},render:function(t){var i=this;t=e(t).map(function(t,n){t=e(i.options.item).attr("data-value",n);t.find("a").html(i.highlighter(n));return t[0]});t.first().addClass("active");this.$menu.html(t);return this},next:function(t){var i=this.$menu.find(".active").removeClass("active"),n=i.next();n.length||(n=e(this.$menu.find("li")[0]));n.addClass("active")},prev:function(e){var t=this.$menu.find(".active").removeClass("active"),i=t.prev();i.length||(i=this.$menu.find("li").last());i.addClass("active")},listen:function(){this.$element.on("blur",e.proxy(this.blur,this)).on("keypress",e.proxy(this.keypress,this)).on("keyup",e.proxy(this.keyup,this));this.eventSupported("keydown")&&this.$element.on("keydown",e.proxy(this.keydown,this));this.$menu.on("click",e.proxy(this.click,this)).on("mouseenter","li",e.proxy(this.mouseenter,this))},eventSupported:function(e){var t=e in this.$element;if(!t){this.$element.setAttribute(e,"return;");t="function"===typeof this.$element[e]}return t},move:function(e){if(!this.shown)return;switch(e.keyCode){case 9:case 13:case 27:e.preventDefault();break;case 38:e.preventDefault();this.prev();break;case 40:e.preventDefault();this.next();break}e.stopPropagation()},keydown:function(t){this.suppressKeyPressRepeat=~e.inArray(t.keyCode,[40,38,9,13,27]);this.move(t)},keypress:function(e){if(this.suppressKeyPressRepeat)return;this.move(e)},keyup:function(e){switch(e.keyCode){case 40:case 38:case 16:case 17:case 18:break;case 9:case 13:if(!this.shown)return;this.select();break;case 27:if(!this.shown)return;this.hide();break;default:this.lookup()}e.stopPropagation();e.preventDefault()},blur:function(e){var t=this;setTimeout(function(){t.hide()},150)},click:function(e){e.stopPropagation();e.preventDefault();this.select()},mouseenter:function(t){this.$menu.find(".active").removeClass("active");e(t.currentTarget).addClass("active")}};var i=e.fn.typeahead;e.fn.typeahead=function(i){return this.each(function(){var n=e(this),a=n.data("typeahead"),r="object"==typeof i&&i;a||n.data("typeahead",a=new t(this,r));"string"==typeof i&&a[i]()})};e.fn.typeahead.defaults={source:[],items:8,menu:'<ul class="typeahead dropdown-menu"></ul>',item:'<li><a href="#"></a></li>',minLength:1};e.fn.typeahead.Constructor=t;e.fn.typeahead.noConflict=function(){e.fn.typeahead=i;return this};e(document).on("focus.typeahead.data-api",'[data-provide="typeahead"]',function(t){var i=e(this);if(i.data("typeahead"))return;t.preventDefault();i.typeahead(i.data())})}(window.jQuery);!function(e){"use strict";var t=function(e,t){this.init("tooltip",e,t)};t.prototype={constructor:t,init:function(t,i,n){var a,r,s,o,l;this.type=t;this.$element=e(i);this.options=this.getOptions(n);this.enabled=true;s=this.options.trigger.split(" ");for(l=s.length;l--;){o=s[l];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){a="hover"==o?"mouseenter":"focus";r="hover"==o?"mouseleave":"blur";this.$element.on(a+"."+this.type,this.options.selector,e.proxy(this.enter,this));this.$element.on(r+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},getOptions:function(t){t=e.extend({},e.fn[this.type].defaults,this.$element.data(),t);t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay});return t},enter:function(t){var i=e(t.currentTarget)[this.type](this._options).data(this.type);if(!i.options.delay||!i.options.delay.show)return i.show();clearTimeout(this.timeout);i.hoverState="in";this.timeout=setTimeout(function(){"in"==i.hoverState&&i.show()},i.options.delay.show)},leave:function(t){var i=e(t.currentTarget)[this.type](this._options).data(this.type);this.timeout&&clearTimeout(this.timeout);if(!i.options.delay||!i.options.delay.hide)return i.hide();i.hoverState="out";this.timeout=setTimeout(function(){"out"==i.hoverState&&i.hide()},i.options.delay.hide)},show:function(){var t,i,n,a,r,s,o=e.Event("show");if(this.hasContent()&&this.enabled){this.$element.trigger(o);if(o.isDefaultPrevented())return;t=this.tip();this.setContent();this.options.animation&&t.addClass("fade");r="function"==typeof this.options.placement?this.options.placement.call(this,t[0],this.$element[0]):this.options.placement;t.detach().css({top:0,left:0,display:"block"});this.options.container?t.appendTo(this.options.container):t.insertAfter(this.$element);i=this.getPosition();n=t[0].offsetWidth;a=t[0].offsetHeight;switch(r){case"bottom":s={top:i.top+i.height,left:i.left+i.width/2-n/2};break;case"top":s={top:i.top-a,left:i.left+i.width/2-n/2};break;case"top-left":s={top:i.top-a,left:i.left+20-n/2};break;case"left":s={top:i.top+i.height/2-a/2,left:i.left-n};break;case"right":s={top:i.top+i.height/2-a/2,left:i.left+i.width};break}this.applyPlacement(s,r);this.$element.trigger("shown")}},applyPlacement:function(e,t){var i=this.tip(),n=i[0].offsetWidth,a=i[0].offsetHeight,r,s,o,l;i.offset(e).addClass(t).addClass("in");r=i[0].offsetWidth;s=i[0].offsetHeight;if(("top"==t||"top-left"==t)&&s!=a){e.top=e.top+a-s;l=true}if("bottom"==t||"top"==t||"top-left"==t){o=0;if(e.left<0){o=-2*e.left;e.left=0;i.offset(e);r=i[0].offsetWidth;s=i[0].offsetHeight}this.replaceArrow(o-n+r,r,"left")}else this.replaceArrow(s-a,s,"top");l&&i.offset(e)},replaceArrow:function(e,t,i){this.arrow().css(i,e?50*(1-e/t)+"%":"")},setContent:function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t).html(e.find(".tooltip-inner").html().replace(/\r/g,"<br>"));e.removeClass("fade in top bottom left right top-left")},hide:function(){var t=this,i=this.tip(),n=e.Event("hide");this.$element.trigger(n);if(n.isDefaultPrevented())return;i.removeClass("in");function a(){var t=setTimeout(function(){i.off(e.support.transition.end).detach()},500);i.one(e.support.transition.end,function(){clearTimeout(t);i.detach()})}e.support.transition&&this.$tip.hasClass("fade")?a():i.detach();this.$element.trigger("hidden");return this},fixTitle:function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},hasContent:function(){return this.getTitle()},getPosition:function(){var t=this.$element[0];return e.extend({},"function"==typeof t.getBoundingClientRect?t.getBoundingClientRect():{width:t.offsetWidth,height:t.offsetHeight},this.$element.offset())},getTitle:function(){var e,t=this.$element,i=this.options;e=t.attr("data-original-title")||("function"==typeof i.title?i.title.call(t[0]):i.title);return e},tip:function(){return this.$tip=this.$tip||e(this.options.template)},arrow:function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},validate:function(){if(!this.$element[0].parentNode){this.hide();this.$element=null;this.options=null}},enable:function(){this.enabled=true},disable:function(){this.enabled=false},toggleEnabled:function(){this.enabled=!this.enabled},toggle:function(t){var i=t?e(t.currentTarget)[this.type](this._options).data(this.type):this;i.tip().hasClass("in")?i.hide():i.show()},destroy:function(){this.hide().$element.off("."+this.type).removeData(this.type);clearTimeout(this.timeout)}};var i=e.fn.tooltip;e.fn.tooltip=function(i){return this.each(function(){var n=e(this),a=n.data("tooltip"),r="object"==typeof i&&i;a||n.data("tooltip",a=new t(this,r));"string"==typeof i&&a[i]()})};e.fn.tooltip.Constructor=t;e.fn.tooltip.defaults={animation:true,placement:"top",selector:false,template:'<div class="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:false,container:false};e.fn.tooltip.noConflict=function(){e.fn.tooltip=i;return this}}(window.jQuery)},261:function(e,t,i){var n=i(111);var a=i(83);var r=i(66);var s=i(115);var o=i(60);var l=i(136);var c=Object.getOwnPropertyDescriptor;t.f=i(56)?c:function e(t,i){t=r(t);i=s(i,true);if(l)try{return c(t,i)}catch(e){}if(o(t,i))return a(!n.f.call(t,i),t[i])}},275:function(e,t,i){e.exports={default:i(287),__esModule:true}},276:function(e,t,i){var n=i(91)("meta");var a=i(68);var r=i(60);var s=i(58).f;var o=0;var l=Object.isExtensible||function(){return true};var c=!i(73)(function(){return l(Object.preventExtensions({}))});var d=function(e){s(e,n,{value:{i:"O"+ ++o,w:{}}})};var u=function(e,t){if(!a(e))return"symbol"==typeof e?e:("string"==typeof e?"S":"P")+e;if(!r(e,n)){if(!l(e))return"F";if(!t)return"E";d(e)}return e[n].i};var _=function(e,t){if(!r(e,n)){if(!l(e))return true;if(!t)return false;d(e)}return e[n].w};var m=function(e){c&&f.NEED&&l(e)&&!r(e,n)&&d(e);return e};var f=e.exports={KEY:n,NEED:false,fastKey:u,getWeak:_,onFreeze:m}},277:function(e,t,i){var n=i(66);var a=i(191).f;var r={}.toString;var s="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];var o=function(e){try{return a(e)}catch(e){return s.slice()}};e.exports.f=function e(t){return s&&"[object Window]"==r.call(t)?o(t):a(n(t))}},287:function(e,t,i){i(125);i(148);e.exports=i(156).f("iterator")},288:function(e,t,i){e.exports={default:i(289),__esModule:true}},289:function(e,t,i){i(290);i(293);i(294);i(295);e.exports=i(52).Symbol},290:function(e,t,i){"use strict";var n=i(46);var a=i(60);var r=i(56);var s=i(86);var o=i(168);var l=i(276).KEY;var c=i(73);var d=i(109);var u=i(119);var _=i(91);var m=i(43);var f=i(156);var h=i(157);var p=i(291);var g=i(292);var T=i(71);var S=i(68);var v=i(66);var b=i(115);var w=i(83);var y=i(163);var A=i(277);var k=i(261);var C=i(58);var x=i(98);var I=k.f;var M=C.f;var E=A.f;var B=n.Symbol;var P=n.JSON;var U=P&&P.stringify;var D="prototype";var $=m("_hidden");var F=m("toPrimitive");var O={}.propertyIsEnumerable;var R=d("symbol-registry");var N=d("symbols");var L=d("op-symbols");var G=Object[D];var H="function"==typeof B;var Q=n.QObject;var j=!Q||!Q[D]||!Q[D].findChild;var K=r&&c(function(){return 7!=y(M({},"a",{get:function(){return M(this,"a",{value:7}).a}})).a})?function(e,t,i){var n=I(G,t);n&&delete G[t];M(e,t,i);n&&e!==G&&M(G,t,n)}:M;var W=function(e){var t=N[e]=y(B[D]);t._k=e;return t};var V=H&&"symbol"==typeof B.iterator?function(e){return"symbol"==typeof e}:function(e){return e instanceof B};var z=function e(t,i,n){t===G&&z(L,i,n);T(t);i=b(i,true);T(n);if(a(N,i)){if(n.enumerable){a(t,$)&&t[$][i]&&(t[$][i]=false);n=y(n,{enumerable:w(0,false)})}else{a(t,$)||M(t,$,w(1,{}));t[$][i]=true}return K(t,i,n)}return M(t,i,n)};var Y=function e(t,i){T(t);var n=p(i=v(i));var a=0;var r=n.length;var s;while(r>a)z(t,s=n[a++],i[s]);return t};var q=function e(t,i){return void 0===i?y(t):Y(y(t),i)};var J=function e(t){var i=O.call(this,t=b(t,true));if(this===G&&a(N,t)&&!a(L,t))return false;return!(i||!a(this,t)||!a(N,t)||a(this,$)&&this[$][t])||i};var Z=function e(t,i){t=v(t);i=b(i,true);if(t===G&&a(N,i)&&!a(L,i))return;var n=I(t,i);!n||!a(N,i)||a(t,$)&&t[$][i]||(n.enumerable=true);return n};var X=function e(t){var i=E(v(t));var n=[];var r=0;var s;while(i.length>r)a(N,s=i[r++])||s==$||s==l||n.push(s);return n};var ee=function e(t){var i=t===G;var n=E(i?L:v(t));var r=[];var s=0;var o;while(n.length>s)!a(N,o=n[s++])||i&&!a(G,o)||r.push(N[o]);return r};if(!H){B=function e(){if(this instanceof B)throw TypeError("Symbol is not a constructor!");var t=_(arguments.length>0?arguments[0]:void 0);var i=function(e){this===G&&i.call(L,e);a(this,$)&&a(this[$],t)&&(this[$][t]=false);K(this,t,w(1,e))};r&&j&&K(G,t,{configurable:true,set:i});return W(t)};o(B[D],"toString",function e(){return this._k});k.f=Z;C.f=z;i(191).f=A.f=X;i(111).f=J;i(132).f=ee;r&&!i(127)&&o(G,"propertyIsEnumerable",J,true);f.f=function(e){return W(m(e))}}s(s.G+s.W+s.F*!H,{Symbol:B});for(var te="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ie=0;te.length>ie;)m(te[ie++]);for(var ne=x(m.store),ae=0;ne.length>ae;)h(ne[ae++]);s(s.S+s.F*!H,"Symbol",{for:function(e){return a(R,e+="")?R[e]:R[e]=B(e)},keyFor:function e(t){if(!V(t))throw TypeError(t+" is not a symbol!");for(var i in R)if(R[i]===t)return i},useSetter:function(){j=true},useSimple:function(){j=false}});s(s.S+s.F*!H,"Object",{create:q,defineProperty:z,defineProperties:Y,getOwnPropertyDescriptor:Z,getOwnPropertyNames:X,getOwnPropertySymbols:ee});P&&s(s.S+s.F*(!H||c(function(){var e=B();return"[null]"!=U([e])||"{}"!=U({a:e})||"{}"!=U(Object(e))})),"JSON",{stringify:function e(t){var i=[t];var n=1;var a,r;while(arguments.length>n)i.push(arguments[n++]);r=a=i[1];if(!S(a)&&void 0===t||V(t))return;g(a)||(a=function(e,t){"function"==typeof r&&(t=r.call(this,e,t));if(!V(t))return t});i[1]=a;return U.apply(P,i)}});B[D][F]||i(64)(B[D],F,B[D].valueOf);u(B,"Symbol");u(Math,"Math",true);u(n.JSON,"JSON",true)},291:function(e,t,i){var n=i(98);var a=i(132);var r=i(111);e.exports=function(e){var t=n(e);var i=a.f;if(i){var s=i(e);var o=r.f;var l=0;var c;while(s.length>l)o.call(e,c=s[l++])&&t.push(c)}return t}},292:function(e,t,i){var n=i(114);e.exports=Array.isArray||function e(t){return"Array"==n(t)}},293:function(e,t){},294:function(e,t,i){i(157)("asyncIterator")},295:function(e,t,i){i(157)("observable")},296:function(e,t,i){e.exports={default:i(330),__esModule:true}},3:function(e,t,i){"use strict";t.__esModule=true;var n=i(224);var a=r(n);function r(e){return e&&e.__esModule?e:{default:e}}t.default=a.default||function(e){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var n in i)Object.prototype.hasOwnProperty.call(i,n)&&(e[n]=i[n])}return e}},3029:function(e,t){(function(){TS.registerModule("view",{file_list_heading:TS.interop.i18n.t("All File Types","view")(),file_list_lazyload:null,members_list_lazyload:null,user_groups_members_list_lazyload:null,member_stars_list_lazyload:null,last_attachment_max_width:null,has_mounted_lazy_user_groups_list:false,resize_sig:new signals.Signal,onStart:function e(){TS.view.rebuildMentionsImmediately=TS.view.rebuildMentions;TS.view.rebuildMentions=_.throttle(TS.view.rebuildMentions,1e3,{leading:false});TS.view.maybeRebuildUserGroupList=TS.utility.throttleFunc(TS.view.rebuildUserGroupList,1e3);TS.client.login_sig.add(TS.view.loggedIn,TS.view);TS.channels.read_only.list_updated_sig.add(TS.view.checkIfInputShouldBeDisabledAndPopulate);TS.user_groups.updated_sig.add(TS.view.userGroupUpdated,TS.view);TS.members.view.team_filter_changed_sig.add(function(){TS.view.maybeRebuildUserGroupList()},TS.view);TS.ui.window_unloaded_sig.add(TS.view.windowUnloaded,TS.view);TS.client.flexpane_display_switched_sig.add(TS.view.flexpaneDisplaySwitched,TS.view);TS.client.ui.file_dropped_sig.add(TS.view.filesDropped);TS.client.ui.file_pasted_sig.add(TS.view.filePasted);TS.team.team_profile_changed_sig.add(TS.view.teamProfileChanged,TS.view);TS.mentions.mentions_fetched_sig.add(TS.view.mentionsFetched,TS.view);TS.mentions.mention_changed_sig.add(TS.view.mentionChanged,TS.view);TS.mentions.mention_removed_sig.add(TS.view.mentionRemoved,TS.view);TS.mentions.mentions_being_fetched_sig.add(TS.view.mentionsBeingFetched,TS.view);TS.prefs.enable_unread_view_changed_sig.add(TS.view.resize);TS.prefs.team_disable_file_editing_changed_sig.add(TS.view.rebuildMsgFile);TS.view.members.unknown_resolution_rebuild_sig.add(TS.view.rebuildMentions);TS.view.channel.unknown_resolution_rebuild_sig.add(function(){TS.view.rebuildMentions();TS.model.overlay_is_showing&&TS.view.showInterstitialAfterChannelOrImShown()});TS.teams.changed_is_unknown_sig.add(d);TS.view.resizeManually("TS.view.onStart");$(window).resize(TS.view.onResize);if("0"!=TS.qs_args.new_scroll){var n="1"==TS.qs_args.debug_scroll;TS.environment.supports_custom_scrollbar||TS.client.ui.$msgs_scroller_div.monkeyScroll({debug:n,always_show:true,no_gutter:true});TS.environment.supports_custom_scrollbar||$(".flex_content_scroller").monkeyScroll({debug:n})}TS.view.ms.changeConnectionStatus("trouble");$("a.clear_unread_messages").tooltip({placement:"bottom",delay:{show:500,hide:150}});$(".channels_list_new_btn").tooltip({container:"body",delay:{show:400,hide:150}});$(".channel_list_header_label, #direct_messages_header, #apps_header").tooltip({placement:"top-left",container:"body",delay:{show:400,hide:150}});TS.view.cached_wh=0;TS.view.resizeManually("TS.view.onStart 2");var a=false;$(window).bind("scroll",function(){if(a)return;a=true;$(window).unbind("mouseup.scroll").bind("mouseup.scroll",function(){a=false;$(window).unbind("mouseup.scroll");$("body").scrollTop(0)})});TS.model.is_mac&&$("#drag_drop_mac_key").text(TS.interop.i18n.t("Command","view")());var r=10;t=TS.utility.enableFeatureForUser(r);$("#stars_scroller").on("click.fetchUserStarredItems",".flexpane_load_more_btn",function(){var e=$(this);e.data("ladda")||e.data("ladda",Ladda.create(this));e.data("ladda").start();TS.stars.fetchUserStarredItems().finally(function(){e.data("ladda").stop()})});i=!TS.environment.supports_custom_scrollbar;if(TS.boot_data.feature_incremental_unread_counts){var s=$("#favicon_mount_point");s.length&&TS.interop.mountFavicon(TS.boot_data.team_id,s[0]);var o=$("#document_title_mount_point");o.length&&TS.interop.mountDocumentTitle(TS.boot_data.team_id,o[0])}},was_at_bottom_at_first_resize_event:false,resize_tim:0,onResize:function e(){TS.view.triggering_resize||(TS.view.cached_wh=0);TS.model.ui.cached_file_preview_scroller_rect=null;TS.model.ui.cached_msgs_scroller_rect=null;TS.model.ui.cached_msgs_scroll_result=null;TS.model.ui.cached_search_scroller_rect=null;TS.model.ui.cached_archives_scroller_rect=null;TS.model.ui.cached_archive_scroll_result=null;TS.model.ui.cached_convo_scroller_rect=null;TS.model.ui.cached_unread_scroller_rect=null;TS.model.ui.cached_threads_scroller_rect=null;if(TS.view.resize_tim){clearTimeout(TS.view.resize_tim);TS.view.resize_tim=0}else i&&(TS.view.was_at_bottom_at_first_resize_event=TS.client.ui.areMsgsScrolledToBottom(50));TS.view.resize_tim=setTimeout(function(){clearTimeout(TS.view.resize_tim);TS.view.resize_tim=0;TS.view.should_reset_input&&TS.view.resetForInput();TS.view.resize(true);TS.view.should_reset_input=false},250);if(TS.view.triggering_resize)return;TS.view.resize(false,true)},team_menu_h:$("#team_menu").outerHeight(),cached_wh:0,last_msgs_div_width:0,last_input_height:0,last_input_container_height:0,msgs_scroller_y:-1,footer_outer_h:-1,triggering_resize:false,resizeManually:function e(t,i){if(!TS.model.ms_logged_in_once)return;t=t||"unspecified";TS.has_pri[o]&&TS.log(o,"======================================resizeManually ("+t+") starting");var n=Date.now();TS.view.resize(false,false,!!i);TS.has_pri[o]&&TS.log(o,"======================================resizeManually ("+t+") took "+(Date.now()-n)+"ms")},resetUI:function e(){TS.view.should_reset_input=true},resetForInput:function e(){TS.view.cached_wh=0;TS.view.last_input_height=0;TS.view.last_input_container_height=0;TS.view.msgs_scroller_y=-1;TS.view.footer_outer_h=-1},resizeForBanner:function e(t){TS.view.msgs_scroller_y=-1;TS.view.resizeManually(t);var i=$("html");i.height(i.height());TS.utility.rAF(function(){i.height("")})},resize:function e(i,n){if(t){var a="start_resize";TS.metrics.mark(a)}var r=Date.now();TS.has_pri[o]&&TS.log(o,r+" #1 cached_wh:"+TS.view.cached_wh+" TS.view.resize from_timer:"+i+" no_trigger:"+n+" "+(Date.now()-r)+"ms");r=Date.now();if(i)TS.view.was_at_bottom_at_first_resize_event=false;else if(!n){TS.view.triggering_resize=true;$(window).trigger("resize");TS.view.triggering_resize=false}TS.view.msgs_unscrollable&&TS.view.makeMsgsDivUnscrollable();TS.view.resize_sig.dispatch();TS.has_pri[o]&&TS.log(o,r+" #15 "+(Date.now()-r)+"ms");if(t){TS.metrics.measure("resize",a);TS.metrics.clearMarks(a)}},never_set:true,makeAttachmentWidthRule:function e(t){var i;var n;var a;var r;var s;r=-96;TS.prefs.prefs_loaded&&"dense"===TS.prefs.getPref("theme")&&(r=-144);i=t+r;s="\t\t\t#msgs_div div.dynamic_content_max_width {\t\t\t\tmax-width:"+i+"px;\t\t\t}\t\t";if(TS.view.last_attachment_max_width!==i){TS.view.last_attachment_max_width=i;n="dynamic_content_max_width_rule";a=$("#"+n);a.length?a.html(s):$('<style type="text/css" id="'+n+'">'+s+"</style>").appendTo("head")}},filesSelected:function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=i.model_ob_id,a=i.thread_ts,r=i.view_context;TS.client.ui.files.validateFiles(t,false,function(e){if(TS.boot_data.feature_file_threads){var t;TS.boot_data.feature_react_threads&&(t=TS.interop.message_input_registry.getInputProxy({viewContext:r,channelId:n,threadTs:a}));TS.redux.dispatch(TS.interop.redux.actions.openFileUploadDialog({files:e,initialChannelId:n||TS.model.active_cid,threadTs:a,inputProxy:t}))}else TS.ui.upload_dialog.startWithCommentFromChatInput(e)})},filePasted:function e(t,i,n,a,r){if("disable_all"===TS.prefs.getTeamPref("disable_file_uploads")){TS.generic_dialog.start({title:TS.interop.i18n.t("Upload failed","view")(),body:TS.interop.i18n.t("At the request of your administrator, file uploads have been disabled in this workspace.","view")(),show_cancel_button:false,onGo:function e(){TS.files.uploadOver(false)}});return}if(TS.client.ui.files.shouldEnforceFileLimits()){TS.client.ui.files.showOverFileLimitsModal(true);return}i?TS.boot_data.feature_file_threads?TS.files.justUploadTheseFileNow([t],n,a):TS.files.justUploadTheseFileNow([t]):TS.boot_data.feature_file_threads?TS.redux.dispatch(TS.interop.redux.actions.openFileUploadDialog({files:[t],initialChannelId:n||TS.model.active_cid,threadTs:a,fromPaste:true,inputProxy:r})):TS.ui.upload_dialog.startWithCommentFromChatInput([t])},filesDropped:function e(t,i,n,a,r){TS.ui.fs_modal.is_showing&&TS.ui.fs_modal.close();i?TS.boot_data.feature_file_threads?TS.files.justUploadTheseFileNow(t,n,a):TS.files.justUploadTheseFileNow(t):TS.boot_data.feature_file_threads?TS.redux.dispatch(TS.interop.redux.actions.openFileUploadDialog({files:t,initialChannelId:n||TS.model.active_cid,threadTs:a,inputProxy:r})):TS.ui.upload_dialog.startWithCommentFromChatInput(t)},switchedHelper:function e(){var t=TS.shared.legacyGetActiveModelOb();var i=TS.redux.channels.getEntityById(TS.model.last_active_cid);if(i){TS.utility.msgs.removeAllEphemeralMsgsByType("temp_slash_cmd_feedback",i.id);i._show_in_list_even_though_no_unreads=false;s(TS.model.last_active_cid)}TS.client.unread.isEnabled()&&TS.client.unread.destroyUnreadView();TS.client.threads.destroyThreadsView();TS.interop.apps.isAppSpaceEnabled()&&TS.client.ui.app_space.resetUI();TS.client.ui.search_in_react.primarySearchIsEnabled()&&TS.client.ui.search_in_react.stopPrimarySearch();TS.boot_data.feature_file_threads&&TS.client.ui.files.hideDropTargetModal();!TS.model.ui_state.flex_name&&TS.model.ui_state.details_tab_active&&TS.client.ui.flex.openFlexTab("details",true);var a=false;var r={};TS.redux.dispatch(TS.interop.redux.features.workspace.setPrimaryView({id:t.id,startTs:n,fromLegacy:true}));TS.client.ui.rebuildAllButMsgs(r,a);window.setTimeout(TS.view.focusMessageInput,0);TS.view.checkIfInputShouldBeDisabledAndPopulate();TS.utility.contenteditable.clearHistory(TS.client.ui.$msg_input);TS.view.showInterstitialAfterChannelOrImShown();TS.client.activeChannelIsHidden()||TS.environment.supports_custom_scrollbar||TS.ui.utility.updateClosestMonkeyScroller(TS.client.ui.$msgs_scroller_div)},legacyRemoveMsg:function e(t,i){TS.view.removeMessageDiv(i,false,t.is_archived)},removeMsgsAfterTruncation:function e(t){var i;var n;for(var a=0;a<t.length;a+=1){i=t[a];n=TS.client.msg_pane.getDivsForMsg(i.ts);var r=n.parent(".day_msgs");TS.client.msg_pane.cleanMsgDiv(n);n.remove();r.children().length||r.parent(".day_container").remove()}var s=TS.utility.msgs.getDisplayedMsgs(TS.shared.legacyGetActiveModelOb().msgs);s&&TS.view.rebuildMsg(s[s.length-1]);TS.view.resizeManually("TS.view.removeMsgsAfterTruncation")},removeMessageDiv:function e(t,i,n){var a;a=n?TS.client.msg_pane.getDivForArchiveMsg(t.ts):TS.client.msg_pane.getDivsForMsg(t.ts);if(!a.length)return;TS.client.msg_pane.cleanMsgDiv(a);var r=TS.client.msg_pane.last_rendered_msg&&TS.client.msg_pane.last_rendered_msg.ts==a.data("ts");var s;var o=a.nextAll(".message:not(.hidden)").first();r&&(s=a.prevAll(".message:not(.hidden)").first());var l=function e(){a=TS.client.msg_pane.getDivsForMsg(t.ts);var i=a.parent(".day_msgs");a.remove();i.children().length||i.parent(".day_container").remove();if(TS.client.ui.$msgs_unread_divider){var n=TS.client.ui.$msgs_unread_divider.nextAll(".message:not(.hidden)");if(!n.length){TS.info("calling TS.client.ui.legacyMarkMostRecentReadMsgInActive(true) after message removal because there are no displayed messages after the red line now");TS.client.ui.legacyMarkMostRecentReadMsgInActive(TS.model.marked_reasons.deleted,true)}}if(r&&s&&s.length){var l=TS.utility.msgs.getMsg(s.data("ts"),TS.shared.legacyGetActiveModelOb().msgs);if(l){TS.client.msg_pane.last_rendered_msg=l;TS.client.msg_pane.last_in_stream_msg=TS.client.msg_pane.last_rendered_msg;TS.info("set a new TS.client.msg_pane.last_rendered_msg && TS.client.msg_pane.last_in_stream_msg because the deleted msg was the last one")}}if(o&&o.length){var c=TS.utility.msgs.getMsg(o.data("ts"),TS.shared.legacyGetActiveModelOb().msgs);c&&TS.view.rebuildMsg(c)}TS.view.resizeManually("TS.view.removeMessageDiv")};i||TS.interop.rules.messages.isTempMsg(t)?l():a.addClass("delete_mode").slideUp(200,l)},updateTitleWithContext:function t(){if(TS.boot_data.feature_incremental_unread_counts)return;var i;var n;var a;var r;var s;n=TS.shared.legacyGetActiveModelOb();TS.model.unread_view_is_showing?a=TS.interop.i18n.t("Unread Messages","view")():TS.model.threads_view_is_showing?a=TS.interop.i18n.t("Threads","view")():TS.model.search_view_is_showing?TS.boot_data.feature_primary_search&&TS.interop.usePrimarySearch()&&(a=TS.interop.i18n.t("Search","view")()):n&&(n.is_im?a=TS.interop.members.getPrefCompliantMemberNameById(n.user):n.is_mpim?TS.mpims.legacyHasUnknownMember(n)||(a=TS.mpims.legacyGetDisplayName(n)):a=n.name||"");if(!a)return;i=" | ";s=document.title;r=s.indexOf(i);s=-1!==r?a+i+s.substr(r+i.length):a+i+s;if(e!==s){e=s;document.title=s}},start_time:new Date,checkIfInputShouldBeDisabledAndPopulate:function e(t){TS.view.actuallyCheckIfInputShouldBeDisabledAndPopulate(t)},actuallyCheckIfInputShouldBeDisabledAndPopulate:function e(t){var i=TS.shared.legacyGetActiveModelOb();var n;if(i&&i.is_general&&!TS.permissions.members.canPostInGeneral()&&!TS.boot_data.feature_announce_only){TS.utility.contenteditable.clear(TS.client.ui.$msg_input,true);TS.utility.contenteditable.disable(TS.client.ui.$msg_input);n=$("#msg_input_message span");n.html(TS.interop.i18n.t("Your Workspace Owners have limited who can post to {channel_or_group}","view")({channel_or_group:TS.interop.i18n.safeString("#<strong>"+i.name+"</strong>")}));TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,"");TS.utility.contenteditable.ariaLabel(TS.client.ui.$msg_input,"")}else if(i&&(i.is_channel||i.is_group)&&(TS.boot_data.feature_announce_only?!TS.interop.rules.user.canPostInChannel(i.id):TS.interop.rules.channels.isOrgShared(i)&&!TS.permissions.members.canPostInChannel(i))){TS.utility.contenteditable.clear(TS.client.ui.$msg_input,true);TS.utility.contenteditable.disable(TS.client.ui.$msg_input);n=$("#msg_input_message span");TS.boot_data.feature_announce_only?n.html('<i class="c-icon c-icon--emoji-objects c-icon--inline"></i>\n\t\t\t\t\t\t'+TS.interop.i18n.t("Read-only","view")()+'\n\t\t\t\t\t\t<i class="c-icon c-icon--question-circle c-icon--inline float_right ts_tip ts_tip_multiline ts_tip_top ts_tip_right ts_tip_float">\n\t\t\t\t\t\t\t<span class="ts_tip_tip">\n\t\t\t\t\t\t\t\t<span class="ts_tip_multiline_inner">\n\t\t\t\t\t\t\t\t\t'+TS.interop.i18n.t("Only selected team members can post in this channel.","view")()+"\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</i>"):i.is_group?n.html(TS.interop.i18n.t("Your Workspace Owners have limited who can post to {channel_or_group}","view")({channel_or_group:TS.interop.i18n.safeString('<ts-icon class="ts_icon_lock prefix"></ts-icon>'+i.name+'<ts-icon class="ts_icon_shared_channel"></ts-icon>')})):n.html(TS.interop.i18n.t("Your Workspace Owners have limited who can post to {channel_or_group}","view")({channel_or_group:TS.interop.i18n.safeString("#<strong>"+i.name+'<ts-icon class="ts_icon_shared_channel"></ts-icon></strong>')}));TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,"");TS.utility.contenteditable.ariaLabel(TS.client.ui.$msg_input,"")}else if(i&&TS.interop.rules.channels.isTeambot(i,TS.boot_data.feature_teambot)&&!TS.permissions.members.canTriggerCustomResponses()){TS.utility.contenteditable.clear(TS.client.ui.$msg_input,true);TS.utility.contenteditable.disable(TS.client.ui.$msg_input);n=$("#msg_input_message span");TS.boot_data.feature_teambot&&TS.boot_data.page_needs_enterprise?n.html('<div id="teambot_disabled_table"><div id="teambot_disabled_left"><span id="teambot_disabled_text">'+TS.interop.i18n.t("Teambot isn't currently enabled for the {workspace_name} workspace","view")({workspace_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team)})+'</span></div><div id="teambot_disabled_right"><button type="button" class="btn btn_outline btn_small" id="teambot_close_button" tabindex="6">Close</button></div></div>'):TS.boot_data.feature_teambot&&n.html('<div id="teambot_disabled_table"><div id="teambot_disabled_left"><span id="teambot_disabled_text">'+TS.interop.i18n.t("Custom responses from Teambot have been deactivated","view")()+'</span></div><div id="teambot_disabled_right"><button type="button" class="btn btn_outline btn_small" id="teambot_close_button" tabindex="6">Close</button></div></div>');TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,"");TS.utility.contenteditable.ariaLabel(TS.client.ui.$msg_input,"");$("#msg_input_message #teambot_close_button").on("click",function(){TS.redux.dispatch(TS.interop.channels.closeChannelApi({channelId:i.id}))})}else if(i&&i._checking_at_channel_status){TS.utility.contenteditable.clear(TS.client.ui.$msg_input,true);TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,TS.interop.i18n.t("Sending...","view")());TS.utility.contenteditable.ariaLabel(TS.client.ui.$msg_input,TS.interop.i18n.t("Sending...","view")());TS.utility.contenteditable.disable(TS.client.ui.$msg_input)}else{TS.utility.contenteditable.enable(TS.client.ui.$msg_input);if(!t){TS.utility.contenteditable.clear(TS.client.ui.$msg_input,true);TS.client.msg_input.populateWithLast()}TS.client.msg_input.setPlaceholder()}TS.client.msg_input.updateSendButton()},userGroupUpdated:function e(t){r&&TS.view.maybeRebuildUserGroupList();if(t&&TS.model.previewed_user_group_id===t){var i=TS.interop.userGroups.getUserGroupById(t);if(i&&!TS.interop.rules.user_groups.isUnknownOrNonExistent(i)&&-1===i.date_delete){TS.model.previewed_user_group_id="";"team"===TS.model.ui_state.flex_name&&$("#back_from_user_group_preview").trigger("click");return}TS.client.ui.previewUserGroup(t)}if(TS.client&&TS.client.msg_pane){var n=TS.shared.legacyGetActiveModelOb();if(!n||!n.msgs)return;var a="<!subteam^"+t;_.each(n.msgs,function(e){e.text&&-1!==e.text.indexOf(a)&&TS.view.rebuildMsg(e)})}},maybeRebuildUserGroupList:_.noop,rebuildUserGroupList:function e(t){var i="user_groups_flexpane_rebuild";var n="start_user_groups_flexpane_rebuild";TS.metrics.mark(n);if(!TS.boot_data.feature_lazy_user_groups){var a=TS.client.ui.user_groups.getUserGroupQuery();var r=$("#user_groups_list");t||(t=TS.model.user_groups.concat());if(void 0!==a&&null!==a&&a.length){a=a.toLowerCase();t=t.filter(function(e){return!e.date_delete&&(-1!==e.handle.indexOf(a)||-1!==e._name_lc.indexOf(a)||e.description&&-1!==e.description.toLowerCase().indexOf(a))})}else{a=null;t=t.filter(function(e){return!e.date_delete})}if(t.length){r.empty();var s=97;var o=$('<div id="user_groups_list_wrapper">');r.append(o);o.longListView({items:t,approx_item_height:s,preserve_dom_order:true,scrollable:$("#user_group_list_scroller"),makeElement:function e(){return $('<div style="width:100%">')},renderItem:function e(t,i){var n=TS.templates.builders.buildUserGroupHTML(i,true);t.html(n)},calcItemHeight:function e(t){var i=t.outerHeight();if(!i)return s;return i}});"groups"!==TS.model.ui_state.flex_name&&o.longListView("setHidden",true)}else if(a&&TS.model.user_groups.length){var l={query:a,tab:{label:TS.interop.i18n.t("User Groups","view")()}};var c='<div class="no_results top_margin">'+TS.templates.team_list_no_results(l)+"</div>";r.html(c)}else r.html(TS.templates.user_group_tip({is_flexpane:true}))}TS.utility.enableFeatureForUser(1)&&TS.metrics.measureAndClear(i,n)},showUnSentControlsForMsg:function e(t,i,n){if(n&&n.error&&("6"==n.error.code||"7"==n.error.code||"8"==n.error.code)){TS.utility.msgs.handleFailedMsgSend(t.ts,i,false);var a={text:TS.interop.i18n.t("A Workspace Owner has restricted posting to the {channel_name} channel.","view")({channel_name:"#*"+i.name+"*"}),ephemeral_type:"general_posting_restricted",slackbot_feels:"sad_surprise"};TS.client.ui.addOrFlashEphemeralBotMsg(a);TS.utility.contenteditable.value(TS.client.ui.$msg_input,TS.format.unFormatMsg(t.text));TS.view.focusMessageInput();return}setTimeout(function(){TS.model.display_unsent_msgs[t.ts]=true;if(TS.interop.messages.isReply(t)){TS.ui.replies.maybeUpdateConversationWithMessage(i,t);TS.client.threads.maybeRerenderMessage(i,t)}else TS.view.rebuildMsg(t)},5e3)},scroll_down_when_msg_from_user_is_added:false,legacyAddMsg:function e(t,i){var n=TS.shared.legacyGetActiveModelOb();t.user==TS.model.user.id&&TS.view.scroll_down_when_msg_from_user_is_added&&(TS.view.scroll_down_when_msg_from_user_is_added=false);var a=TS.utility.msgs.getPrevDisplayedMsg(t.ts,n.msgs);var r=TS.templates.builders.msgs.buildHTML({msg:t,model_ob:n,prev_msg:a,container_id:"msgs_div",enable_slack_action_links:true});var s=TS.client.ui.$msgs_div;var o=TS.client.ui.$msgs_div.find(".day_msgs").last();if(TS.interop.datetime.toCalendarDate(t.ts)===o.attr("data-date"))s=o;else{r='<div class="day_msgs" data-date="'+TS.interop.datetime.toCalendarDate(t.ts)+'" data-ts="'+t.ts+'">'+r+"</div>";r='<div class="day_container">'+TS.templates.messages_day_divider({ts:t.ts})+r+"</div>"}o=null;s.append(r);s=null;var l=TS.client.msg_pane.getCanonicalDivForMsg(t.ts);if(TS.prefs.getPref("animate_new_msgs")){l.css("opacity","0");l.transition({opacity:1},200)}TS.utility.makeSureAllLinksHaveTargets(l);if(!t.is_pending){TS.client.msg_pane.last_in_stream_msg=t;TS.interop.rules.messages.isHidden(t)||(TS.client.msg_pane.last_rendered_msg=t)}var c=TS.client.ui.isUserAttentionOnChat()&&!TS.client.activeChannelIsHidden()&&i<2;t.user==TS.model.user.id||c||TS.client.ui.checkInlineImgsAndIframes("main");TS.attachment_actions.select.decorateNewElements();TS.ui.utility.updateClosestMonkeyScroller(TS.client.ui.$msgs_scroller_div)},rebuildMsg:function e(t){if(!t)return;var i=TS.shared.legacyGetActiveModelOb();var n=TS.client.msg_pane.getCanonicalDivForMsg(t.ts,i.is_archived);if(!n.length)return;var a;var r;var s;var o;var l=false;var c=false;r=TS.utility.msgs.getPrevDisplayedMsg(t.ts,i.msgs);a=TS.templates.builders.msgs.buildHTML({msg:t,model_ob:i,prev_msg:r,container_id:"msgs_div",enable_slack_action_links:true});TS.client.msg_pane.cleanMsgDiv(n);var d=n.hasClass("hidden");c?o.replaceWith(a):n.replaceWith(a);n=TS.client.msg_pane.getCanonicalDivForMsg(t.ts);d&&n.addClass("hidden");l&&TS.ui.thread.renderReplyInput(n.closest("ts-thread"),s);TS.utility.makeSureAllLinksHaveTargets(n);TS.client.ui.checkInlineImgsAndIframes("main");TS.attachment_actions.select.decorateNewElements()},rebuildMsgsIncludingMember:function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i)return;_.each(i.msgs,function(e){if(TS.utility.msgs.messageIncludesMember(t,e)){TS.has_pri[l]&&TS.log(l,"memberChangedProfile: Rebuilding msg "+e.ts+" because it includes member "+t.id);TS.view.rebuildMsg(e)}})},rebuildMsgCurrentStatusIncludingMember:function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i){var n={"TS.model.active_channel_id":TS.model.active_channel_id,"TS.model.active_im_id":TS.model.active_im_id,"TS.model.active_mpim_id":TS.model.active_mpim_id,"TS.model.active_group_id":TS.model.active_group_id,"TS.boot_data.channel_id":TS.boot_data.channel_id,"TS.boot_data.im_id":TS.boot_data.im_id,"TS.boot_data.mpim_id":TS.boot_data.mpim_id,"TS.boot_data.group_id":TS.boot_data.group_id};TS.console.logError(n,"We tried to rebuildMsgCurrentStatusIncludingMember without a model object",null,!TS.boot_data.feature_tinyspeck);return}var a={member:t,for_message:true};_.each(i.msgs,function(e){if(TS.utility.msgs.memberSentMessage(t,e)){var i=TS.client.msg_pane.getCanonicalDivForMsg(e.ts).find(".message_current_status");i.replaceWith(TS.templates.current_status(a))}})},rebuildMsgFile:function e(t,i,n){if(!t||!i)return;var a=n?TS.client.msg_pane.getDivForArchiveMsg(t.ts):TS.client.msg_pane.getCanonicalDivForMsg(t.ts);a=a.length?a:TS.client.msg_pane.getDivForArchiveMsg(t.ts);a=a.length?a:TS.client.ui.unread.getDivForMsg(t.ts);a=a.length?a:TS.client.ui.threads.getDivForMsg(t.ts);a=a.length?a:TS.msg_edit.getDivForMsgInConvoPane(t.ts);if(!a.length)return TS.warn("Trying to rebuild message file, but invalid message");var r=a.find(".file_container");var s=TS.files.getFileActions(i);s.file=i;s.is_message=true;s.msg_dom_id=a.attr("id");s.new_window=!s.edit;s.download=!("snippet"===i.mode||"post"===i.mode||"space"===i.mode);$.extend(s,TS.files.getFileTemplateArguments(i));if("post"===i.mode||"space"===i.mode)r.replaceWith(TS.templates.file_post(s));else if("snippet"===i.mode){var o=$(TS.templates.file_snippet(s));o=o.filter(".file_container");r.replaceWith(o)}else if("email"===i.mode)r.replaceWith(TS.templates.file_email(s));else{if("docs"!==i.mode)return TS.warn("Trying to rebuild message file, but cannot rebuild "+i.mode);r.replaceWith(TS.templates.file_arugula(s))}TS.utility.makeSureAllLinksHaveTargets(a);TS.client&&TS.ui.utility.updateClosestMonkeyScroller(a)},showInterstitialAfterChannelOrImShown:function e(){var t=TS.interop.channels.getPublicChannelById(TS.model.active_channel_id);var i=TS.interop.channels.getGroupById(TS.model.active_group_id);var n=false;if(t&&TS.interop.channels.getNeedsCreatedMessageState(t.name))if(TS.prefs.getPref("no_created_overlays"))TS.redux.dispatch(TS.interop.redux.models.channelsMeta.needsCreatedMessage.setNeedsCreatedMessageState({name:t.name,needsCreatedMessage:false}));else{n=true;TS.view.overlay.startWithCreatedChannel(t)}else if(t&&TS.interop.redux.models.channelsMeta.inviters.getInviter(TS.redux.getState(),t.id))if(TS.prefs.getPref("no_joined_overlays"))TS.redux.dispatch(TS.interop.redux.models.channelsMeta.inviters.removeInviter(t.id));else{n=true;TS.view.overlay.startWithInvitedChannel(t)}else if(t&&t.needs_joined_message)if(TS.prefs.getPref("no_joined_overlays"))t.needs_joined_message=false;else{n=true;TS.view.overlay.startWithJoinedChannel(t)}else if(i&&TS.interop.redux.models.channelsMeta.inviters.getInviter(TS.redux.getState(),i.id))if(TS.prefs.getPref("no_joined_overlays"))TS.redux.dispatch(TS.interop.redux.models.channelsMeta.inviters.removeInviter(i.id));else{n=true;TS.view.overlay.startWithInvitedGroup(i)}n||TS.view.overlay.cancelIfShowing()},toggleStarsError:function e(t){$("#member_stars_more").toggleClass("hidden",t);$("#member_stars_error").toggleClass("hiden",!t)},rebuildStars:function e(t){if(!t&&"stars"!==TS.model.ui_state.flex_name)return;var i="";var n=$("#member_stars_list");var a=$("#member_stars_explanation");var r=$("#stars_scroller");var s=$("#member_stars_more");TS.view.cleanStars();var o=TS.stars.getAllStars();o&&o.length&&o.forEach(function(e){i+=TS.templates.builders.buildStarredItemHTML(e)});if(i){n.html(i);TS.view.member_stars_list_lazyload=n.find(".lazy").lazyload({container:r});TS.utility.makeSureAllLinksHaveTargets(n);a.addClass("hidden");TS.stars.has_more?s.css("visibility","visible"):s.css("visibility","hidden")}else{n.html("");a.removeClass("hidden");s.css("visibility","hidden")}r.trigger("resize");var l=_(o).filter({type:"file"}).map("file.id").filter(function(e){return!TS.interop.files.isObjectFresh(e)}).value();l.map(TS.files.getFileById)},cleanStars:function e(){if(TS.view.member_stars_list_lazyload&&TS.view.member_stars_list_lazyload.detachEvents){TS.view.member_stars_list_lazyload.detachEvents();TS.view.member_stars_list_lazyload=null}$("#member_stars_list").empty()},mentionChanged:function e(t){TS.warn("mentionChanged:"+t.message.ts);var i=$("#member_mentions").find("#"+TS.templates.makeMsgDomId(t.message.ts));if(!i.length)return TS.view.rebuildMentions();var n=TS.templates.builders.buildMentionHTML(t);if(!n)return TS.view.rebuildMentions();i.replaceWith(n)},mentionRemoved:function e(t){TS.warn("mentionRemoved:"+t);var i=$("#member_mentions").find("#"+TS.templates.makeMsgDomId(t));if(!i.length)return;var n=function e(){TS.view.rebuildMentions()};i.addClass("delete_mode").slideUp(200,n)},mentionsFetched:function e(){TS.interop.console.info("ACTIVITY","Mentions finished fetching");TS.view.rebuildMentions();$("#member_mentions_more_btn").data("ladda")&&$("#member_mentions_more_btn").data("ladda").stop()},rebuildMentions:function e(t){if(!t&&"mentions"!==TS.model.ui_state.flex_name)return;$("#mentions_spinner").empty();TS.view.prefs.rebuildMentionOptions();var i=$("#member_mentions_more_btn");if(void 0===i.data("ladda")){i.data("ladda",Ladda.create(document.querySelector("#member_mentions_more_btn")));i.bind("click.fetchMoreMentions",function(){TS.interop.console.info("ACTIVITY","Load more button clicked");TS.mentions.fetchMoreMentions();$(this).data("ladda").start()})}$("#exclude_at_channels").unbind("change.toggle_exclude_at_channels").bind("change.toggle_exclude_at_channels",function(){var e=$(this).is(":checked");TS.mentions.setExcludeAtChannelsPref(!e)});$("#exclude_at_user_groups").unbind("change.toggle_exclude_at_user_groups").bind("change.toggle_exclude_at_user_groups",function(){var e=$(this).is(":checked");TS.mentions.setExcludeAtUserGroupsPref(!e)});var n=TS.templates.builders.buildMentions();if(n){$("#member_mentions").html(n);TS.utility.makeSureAllLinksHaveTargets($("#member_mentions"));$("#member_mentions_explanation").addClass("hidden");TS.mentions.has_more?$("#member_mentions_more").css("visibility","visible"):TS.view.hideMentionsMoreButton()}else{$("#member_mentions").html("");$("#member_mentions_explanation").toggleClass("hidden","replies"===TS.mentions.active_tab);$("#member_mentions_more").css("visibility","hidden")}TS.view.resize()},rebuildMentionsLoading:function e(){$("#member_mentions").html(TS.templates.builders.loadingHTML())},hideMentionsMoreButton:function e(){$("#member_mentions_more").css("visibility","hidden")},cleanMentions:function e(){$("#member_mentions").empty()},mentionsBeingFetched:function e(t){if(!t)return;$("#mentions_spinner").html(TS.templates.loading_indicator())},loggedIn:function e(){r=true;TS.templates.makeSidebarBehaviorRule();TS.ui.setThemeClasses(true);var t=TS.shared.legacyGetActiveModelOb();!TS.isPartiallyBooted()&&t.is_group?TS.client.ui.rebuildAllButMsgs():TS.client.ui.rebuildAll();var i=t.msgs;if(i&&i.length){var n=true;var s=true;TS.redux.messages.addMessages(i,n,s);var o=t.last_read&&_.some(i,function(e){return e.ts>t.last_read});o&&!t.unread_cnt&&(t.unread_cnt=1)}TS.client.activeChannelIsHidden()||TS.redux.dispatch(TS.interop.redux.features.workspace.setPrimaryView({id:t.id,fromLegacy:true}));TS.view.focusMessageInput();new TS.PresenceList(TS.model.user.id);a();TS.client.ui.rebuildMemberListToggle();TS.view.members.updateUserDisplayName();TS.view.members.updateUserCurrentStatus();TS.view.showProperTeamPaneFiller();var l={full_profile_filter:true,is_long_list_view:false,include_bots:true,include_deleted:false};TS.members.view.bindTeamFilter("#team_filter","#team_list_scroller",l);TS.view.showInterstitialAfterChannelOrImShown();TS.view.prefs.toggleSpellcheck();TS.interop.members.shouldDisplayRealNames()?$("#col_channels").addClass("real_names"):$("#col_channels").removeClass("real_names");if(!TS.model.is_iOS)if(TS.ui.growls.no_notifications&&"1"!=window.readCookie("no_growl_prompt")){$("#growl_prompt_div").removeClass("hidden");$("#growl_prompt_a").bind("click",function(){TS.view.overlay.startWithGrowlPromptDisplay()})}else if(TS.ui.growls.shouldShowPermissionButton()&&"denied"!==TS.ui.growls.getPermissionLevel()&&"1"!=window.readCookie("no_growl_prompt")){$("#growl_prompt_div").removeClass("hidden");$("#growl_prompt_a").bind("click",function(){TS.view.overlay.startWithGrowlPromptDisplay()})}TS.model.is_FF&&TS.client.ui.$msgs_scroller_div.removeAttr("tabindex");TS.boot_data.feature_tinyspeck;TS.model.unread_view_is_showing||TS.model.threads_view_is_showing||TS.model.search_view_is_showing||(t.is_channel&&!t.is_member||TS.interop.channels.isImWithDeletedMember(t))&&TS.client.archives.start()},showProperTeamPaneFiller:function e(){var t=TS.members.getActiveMembersWithSelfAndSlackbot().length;var i=4;if(TS.model.user.is_admin){$("#team_block").removeClass("hidden");if(t>i){$("#team_block_admin_invite_few").addClass("hidden");$("#team_block_admin_invite_many").removeClass("hidden")}else{$("#team_block_admin_invite_few").removeClass("hidden");$("#team_block_admin_invite_many").addClass("hidden")}}if(t>i)$("#team_block_description").addClass("hidden");else{$("#team_block").removeClass("hidden");$("#team_block_description").removeClass("hidden")}if(TS.model.team.email_domain){var n=TS.model.team.email_domain.split(",");if(1==n.length)$("#team_block_email_domains").html("<b>@"+_.escape(TS.model.team.email_domain)+"</b>");else{var a=_.escape(n.pop());var r=n.join("</b>, <b>@")+"</b> "+TS.interop.i18n.t("or","view")()+" <b>@"+_.escape(a)+"</b>";$("#team_block_email_domains").html("<b>@"+r)}$("#team_block").removeClass("hidden");$("#team_block_email_on").removeClass("hidden");$("#team_block_admin_email_off").addClass("hidden")}else{$("#team_block_email_on").addClass("hidden");if(TS.model.user.is_owner){$("#team_block").removeClass("hidden");$("#team_block_admin_email_off").removeClass("hidden")}}if(TS.model.user.profile&&TS.model.user.profile.phone&&TS.model.user.profile.real_name)$("#team_block_fill_prompt").addClass("hidden");else{$("#team_block").removeClass("hidden");$("#team_block_fill_prompt").removeClass("hidden")}},current_unread_status:null,changeUnreadStatus:function e(t){if(TS.boot_data.feature_incremental_unread_counts)return;TS.view.current_unread_status=t;TS.view.maybeChangeFavIco()},maybeChangeFavIco:function e(){if(TS.boot_data.feature_incremental_unread_counts)return;var t=TS.view.ms.current_connection_status;var i=TS.view.current_unread_status;var n;n="online"===t?"app_icon_32px_green":"trouble"===t?"app_icon_32px_yellow":"app_icon_32px_red";"unreads"===i?n+="_unreads":"mentions"===i&&(n+="_mentions");var a=c[n];var r=$("#favicon");r.attr("href")!=a&&r.replaceWith('<link id="favicon" rel="shortcut icon" href="'+a+'" sizes="16x16 32x32 48x48" type="image/png" />')},windowUnloaded:function e(){if(!TS.model.mac_ssb_version||TS.model.mac_ssb_version>=.32){$("BODY").addClass("loading");$("#connection_div").html("").addClass("hidden");TS.client.msg_pane.topMessagesBannerHidden()}},buildMemberPresenceStatusHTML:function e(t){var i="";i+='<span class="'+TS.templates.makeMemberStatusDomClass(t.id)+'">';t.status&&(i+=' - "'+t.status+'"');i+="</span>";return i},last_team_list_html:null,large_team_directory_trigger:2e3,rebuildTeamMember:function e(t){if(!TS.model.ui_state.flex_visible||"team"!==TS.model.ui_state.flex_name)return;if(!t||!t.id)return;var i='#team_list .team_list_item[data-member-id="'+t.id+'"]';var n=$(i);if(n.length){if(TS.view.members_list_lazyload){TS.view.members_list_lazyload.detachEvents();TS.view.members_list_lazyload=null}n.replaceWith(TS.templates.team_list_item({member:t}));n=$(i);n.length||TS.error("Unable to find node at selector "+i);var a=$("#team_list_scroller");var r=$("#team_list_members");var s=r.find(".lazy");TS.view.members_list_lazyload=s.lazyload({container:a,ignore_when_hidden_element:r,all_images_same_size:true});TS.utility.makeSureAllLinksHaveTargets(n);TS.view.updateTeamListCache()}},clearTeamListCache:function e(){TS.view.last_team_list_html=null},updateTeamListCache:function e(){TS.view.last_team_list_html&&(TS.view.last_team_list_html=$("#team_list_members_wrapper").html())},refilterTeamList:function e(){if(!TS.model.ui_state.flex_visible||"team"!==TS.model.ui_state.flex_name)return;var t=$("#team_list_container input.member_filter");var i=TS.storage.fetchFilterState();"string"!==typeof i&&(i="");if(i){t.val(i);$("#team_list_container .icon_close").toggleClass("hidden",!i);TS.members.view.filterTeam(i,"#team_filter","#team_list_scroller",true)}},buildLongListTeamListItems:function e(t,i){var n=t.members;var a=t.disabled_members;var r=t.deleted_bots;var s=t.bots;var o=t.restricted_members;var l=t.ultra_restricted_members;var c=t.admin_members;var d=n.slice(0);if(s.length){i||d.push({bot:true,is_divider:true});d.push.apply(d,s)}var u=[];if(o.length){i||u.push({multi_channel_guest:true,is_divider:true});u.push.apply(u,o)}if(l.length){i||u.push({single_channel_guest:true,restricted_members:!!o.length,is_divider:true});u.push.apply(u,l)}var _=a.slice(0);if(r.length){i||_.push({deleted_bot:true,is_divider:true});_.push.apply(_,r)}var m=[];c&&c.length&&(m=c);return{active_members_list_items:d,restricted_members_list_items:u,deleted_members_list_items:_,admin_members_list_items:m}},cleanTeamList:function e(t){if(TS.view.members_list_lazyload&&TS.view.members_list_lazyload.detachEvents){TS.view.members_list_lazyload.detachEvents();TS.view.members_list_lazyload=null}var i=$("#team_list_members");i.off("click.toggle_list_item");i.off("click.member_preview_menu");t&&i.remove();i=null},triggerInitialTeamListLazyLoad:function e(){TS.ui.utility.updateClosestMonkeyScroller($("#team_list_members"));$("#team_list_scroller").trigger("resize-immediate")},maybeFollowLink:function e(t){if(!TS.utility.isSpaceClickEventSafe(t))return true;if(!t.metaKey&&!t.ctrlKey)return false;var i=$(t.target);var n=i.closest("a[href]");if(n.length&&document.hasFocus())return true;return false},markAllUnread:function e(){TS.model.last_reads_set_by_client={};function t(e){var t=TS.utility.msgs.getDisplayedMsgs(e.msgs);if(!t.length)return;var i=t[t.length-1];if(!i)return;if(e.is_channel)TS.channels.markReadMsg(e.id,i.ts);else if(e.is_im)TS.ims.markReadMsg(e.id,i.ts);else{if(!e.is_group){TS.warn("markIt "+e.id+"????");return}TS.groups.markReadMsg(e.id,i.ts)}TS.info("markIt "+e.id+" "+i.ts)}_.forOwn(TS.model.channels,function(e){if(e.is_archived)return;if(!e.is_member)return;t(e)});_.forOwn(TS.model.ims,function(e){if(!e.is_open)return;t(e)});_.forOwn(TS.model.groups,function(e){if(e.is_archived)return;t(e)});TS.model.client.reads.length=0;TS.client.markLastReadsWithAPI();TS.client.msg_pane.dont_check_unreads_til_switch=true},onGroupReferenceClick:function e(t,i){var n=TS.interop.channels.getGroupById(i);if(!n)return;if(n.is_archived&&!n.was_archived_this_session){t.preventDefault();TS.groups.legacyDisplayGroup({id:n.id})}else{t.preventDefault();TS.groups.legacyDisplayGroup({id:n.id})}},onChannelReferenceClick:function e(t,i){var n=TS.interop.channels.getPublicChannelById(i);if(!n)return;t.preventDefault();TS.channels.legacyDisplayChannel({id:n.id})},onMemberReferenceClick:function e(t,i){var n;TS.interop.utility.looksLikeMemberId(i)?n=TS.interop.members.getMemberById(i):TS.boot_data.feature_deprecate_get_member_by_name||(n=TS.interop.members.getMemberByName(i));if(!n)return;TS.menu.member.startWithMember(t,n.id)},onUserGroupReferenceClick:function e(t,i){var n=TS.interop.userGroups.getUserGroupById(i);if(!n||TS.interop.rules.user_groups.isUnknownOrNonExistent(n))return;TS.client.ui.previewUserGroup(n.id)},adjustForWelcomeSlideShow:function e(){if(TS.model.cancelled_welcome_2_this_session)return;TS.model.showing_welcome_2=true;$(".messages_banner").css("visibility","hidden");TS.view.makeMsgsDivUnscrollable()},msgs_unscrollable:false,makeMsgsDivUnscrollable:function e(){TS.view.msgs_unscrollable=true;TS.client.ui.$msgs_scroller_div.css("overflow-y","hidden").css("height","100%");$("#monkey_scroll_wrapper_for_msgs_scroller_div").find(".monkey_scroll_bar").css("visibility","hidden");TS.client.ui.$msgs_scroller_div.scrollTop(0);TS.client.ui.$msgs_div.css("visibility","hidden");$("#footer").addClass("hidden")},unAdjustForWelcomeSlideShow:function e(t){if(!TS.model.showing_welcome_2){TS.ui.utility.updateClosestMonkeyScroller(TS.client.ui.$msgs_scroller_div);return}TS.model.showing_welcome_2=false;$(".messages_banner").css("visibility","");TS.model.seen_onboarding_this_session&&TS.shared.legacyGetActiveModelOb().id==TS.model.welcome_model_ob.id?$("#messages_unread_status").css("visibility","hidden"):$("#messages_unread_status").css("visibility","");if(TS.view.makeMsgsDivScrollable()){TS.view.resizeManually("ran TS.view.makeMsgsDivScrollable()",true);t&&TS.client.ui.$msgs_scroller_div.scrollTop(0)}else TS.view.resizeManually("NOT ran TS.view.makeMsgsDivScrollable()",true)},makeMsgsDivScrollable:function e(){if(!TS.view.msgs_unscrollable)return false;TS.view.msgs_unscrollable=false;TS.client.ui.$msgs_scroller_div.css("overflow-y","auto").css("height","");$("#monkey_scroll_wrapper_for_msgs_scroller_div").find(".monkey_scroll_bar").css("visibility","");TS.ui.utility.updateClosestMonkeyScroller(TS.client.ui.$msgs_scroller_div);TS.client.ui.$msgs_div.css("visibility","visible");$("#footer").removeClass("hidden");return true},submit:function e(){var t=TS.utility.contenteditable.value(TS.client.ui.$msg_input);t=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(t);if((!TS.redux.socket.isConnected()&&!TS.boot_data.feature_degraded_send||!TS.interop.connectivity.isOnline()&&TS.boot_data.feature_degraded_send)&&"/wakewake"!==t)return false;TS.client.ui.onSubmit(t);TS.i18n.sendButtonEnabled()&&TS.utility.contenteditable.focus(TS.client.msg_input.$input);return true},focusMessageInput:function e(){var t=TS.shared.legacyGetActiveModelOb();if(!t)return;if(TS.model.active_im_id){var i=TS.interop.channels.getImById(TS.model.active_im_id);var n=TS.interop.members.getMemberById(i.user);if(n&&n.deleted){TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,"account deactivated");TS.utility.contenteditable.disable(TS.client.ui.$msg_input);return}}if(TS.utility.contenteditable.isDisabled(TS.client.ui.$msg_input))return;if(!TS.client.ui.isUserAttentionOnChat())return;if(TS.model.is_iOS)return;var a=TS.model.last_key_down_e;var r=TS.utility.keymap;if(a&&a.altKey&&(a.which==r.down||a.which==r.up))return;TS.utility.contenteditable.focus(TS.client.ui.$msg_input);if(!TS.model.archive_view_is_showing){var s=TS.model.input_cursor_positions[t.id];if(s){TS.utility.contenteditable.cursorPosition(TS.client.ui.$msg_input,s.start,s.length);delete TS.model.input_cursor_positions[t.id]}else TS.utility.contenteditable.setCursorAtEnd(TS.client.ui.$msg_input)}},clearMessageInput:function e(){TS.client.msg_input.populate("")},teamProfileChanged:function e(){TS.view.refilterTeamList();TS.view.rebuildPreviewedMember()},rebuildPreviewedMember:function e(){TS.model.previewed_member_id&&TS.client.ui.previewMember(TS.model.previewed_member_id)},displayMsgInModelOb:function e(t,i){var a=TS.shared.legacyGetActiveModelOb();if(a.id===t.id&&!TS.client.activeChannelIsHidden()){TS.redux.dispatch(TS.interop.redux.features.messagePane.jumpToTimestamp({ts:i,highlight:true}));return}n=i;t.is_channel?TS.channels.legacyDisplayChannel({id:t.id}):t.is_mpim?TS.mpims.legacyDisplayMpim({id:t.id}):t.is_group?TS.groups.legacyDisplayGroup({id:t.id}):TS.ims.legacyStartImById(t.id);n=null},flexpaneDisplaySwitched:function e(t){var i=TS.model.ui_state.flex_name;if(!i||"team"===t&&"team"!==i){TS.view.cleanTeamList(true);return}if("team"!==t&&"team"===i)return;if("mentions"===i&&TS.mentions.mentions_needs_fetched){var n=true;TS.mentions.maybeUpdateMentions(n)}"files"===i&&TS.client.flex_pane.maybeFetchFileList()},_maybeUpdateOnboarding:function e(){TS.model.seen_onboarding_this_session&&(TS.shared.legacyGetActiveModelOb().id==TS.model.welcome_model_ob.id?TS.onboarding.startOnboarding():TS.onboarding.cancelOnboarding())},addReplyMsg:function e(t,i){if(!TS.ui.thread.isThreadExpanded(t.id,i.thread_ts))return;var n=TS.client.ui.$msgs_div.find('ts-thread[data-thread-ts="'+i.thread_ts+'"]');if(!n.length)return;var a=TS.ui.thread.makeInlineThread(t.id,i.thread_ts);var r=true;TS.ui.thread.updateThreadWithMessage(n,a,i,r)}});var e=null;var t=false;var i=true;var n=null;var a=function e(){TS.view.ms.maybeChangeConnectionDisplay()};var r;var s=function e(t){if(TS.utility.contenteditable.isEmpty(TS.client.ui.$msg_input)){delete TS.model.input_cursor_positions[t];return}var i=TS.utility.contenteditable.cursorPosition(TS.client.ui.$msg_input);i&&(TS.model.input_cursor_positions[t]=i)};var o=389;var l=888;var c={app_icon_32px_green:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2lJREFUeNqMVk1vGkEMndmu4MLmkOWQoCqkh0APqAdUVNpKiXLux/+tFKlSDlEitcm15RI4BBBiucCFjdDUs571eL1L1EEC450d28/P9ujvH7+qbBljFFtaa9SgAN9ij9Xnb/LNdBrKIUn0rNKGKi1vvkpPQqi0syYiIBvlN7lt2kM7C6ErE2gr6BfcpCXO4mg4AURlCg6ZHCIrGuk1Kckp/q20P13u1NknW4E7VMkAreE8ONTLEA0Lpep0jDvgSReZIGRQbkSNuBnT0+ggOowP0X3uB0cC1qvu6453Te8lT3/Qv7i8SLfpbDrDN4efh4MPg91ut1gsMBprqYSEY1EledA1fNo+bcN3kiS0HzVgz7pMwGrJhRBs5glS+EuVQbkDZKIoAmHyOEEP2m/s6WmaJsnKRZ5XoijJkIrAWtKG8sP5dNw6ds46Puhmswni+HFsmclKnZe9M0BmiXD4uFavdbod3ERC713PRZDhA2GhJlkmmBuOj0vkt+EXbhl5BnY6bzvDT0P1f+v25nb0Z8SZ6rikMwO51gcGf8G7xkEDNtRqtfPLc1Be/7zebreYkv77PghXP65g5ypZWT3RP3ufjIWeOb6A7LPNZrNerymfIE/GE4wSKgAZNX2aenIrhwF5jzZCOpg3Ly4jf1bIlozsWF+zpxmxQ+liN81UWBaBMrIjOhpoZwkpBGl0hW0U1vNmvXGFooycHMbHFJY7OO4jwqAB6BOkieMYM9GrW818Oge4CuzUDCIqcW4GDsU00iKm0jrrnqFw/+t+uVxyHhZA9jRlZuAvOg5wgyXI8N3NHb55cnoCxgCxh98P6A1gBR/uIkc7LGQ4xx0WFA4lAEAAwuA76Ph85jR82ogJmje7whD37RBfOGodYYaJ4GgSMKFZW25BHiiVzwMaOx47KLF6DfPpupAxkFioO99Eiye6GhYRFEZYcdi2Wi0sMYCYJwYCek6fOdC+GRt5zQmlC8wSdGNgiG3RxlX46O8ITfojlBHDkuLwzU7cscr1LLqhd5y3hfK8Iogq7lLZ8jZK9zU+9co3KK4P+LnCca9nG8T9RedLXBL8tUUMIGwvojXtc99dthiqLnoWViADNHvvAGL2uROVFtcykZjwhZdFcAJc6TjbwTEM3QAq3lP40VSThRxU3U0rgf0nwADpJQebhAz3/AAAAABJRU5ErkJggg==",app_icon_32px_green_unreads:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA4JJREFUeNqMVj1MFEEUntlsx1FzQgmXnI13JGA0XIWJmvgTEzAxBhXbw0Rjg4VWamFLIjWGUkwgFoIFNkAhJN5VHGEpMVBz1OPbfW/evJldyc1d9t7Nzrzf7/3o+9fvqmwZY5RYWmvcQQKewZl0396Uh5kb0jFT/K5QhsotJ75on4lYaZIWWMAy8jelbD7DJz3TlYl0SugL1OQV8JLeIAJIZTyFjHVRSppQa95kpeRTacc9PKmzT7YiYqpCA1PB1jjcD000wpQi7mh3JIMeRII9k8eYp4oyUg/pCVix5zJdAFAg+kp98x/f1Mbr3bPu45uPkN3aznd4tndb716+ZT+z7nw3QhTltaMLGa+JGw3gjuzw/JWxGp7s6y+lKiM7Gwp2XWoByLQBUvjLmcEXRqojyK4FArIzvNPea1G8tZZ3WemYzUklaWejxFNtrE7sMgvg05hskMjfLSVSXaY9CQhcJiMGXAYGB4AoD5VxZ2KygRYPWwtGqpVKtQI735ZXgiyhQN67dkdKplAbNf3k4dPmM9XbSjrJ6+evJFIJSzrLA7trI5N5CXXvcW1vbiltPSrSIs0VsCBwnKEkpUjMzb+49eA2EIufPq+v/oBjUzPTaNyXxSXwDOqbL7pUTW0KK1m8JM3uTg4SxG5tnDB6+veUqoBWQT5hqOAZKRNWRFIkMxlSjBGZ7B8i2J3IziGKDDsHwT79G+crOPG9XIG/jnsnwVwr9Zfgi5vloUvwPeokkOEeOrVIWOhoaIvMZ+D1fuFDjxHm+uFSSjg5MlzDtSvUAO3eIXRyfBIEkksnJZos8Sh8ZfkrhBSI2eYsehwAc3RwBMTUzBT6CvDT3mvDmfOzrqxCxu+Asd/EDQOitftHxnNjdb3bPYdLzfk5wv6vrWQ/8Qq1bNS2vsZeERWRAHq4OsxOAEdjhMuDZQuqpKCRcA5bvMZeC/ObbX181CuZWtevjrqq52tNrHMZF8ms81ouVIuhAcYoZjjXD6jbdIUbgHEhlO06LmxhqALwPTleAv9AqcFXP9c20Hs7m9uyqJFOHGqR2Ronu8KZR3g21bZwCAumIzEREPqjoDbJHHH7/3EjR5hfSYy4RPPGN+VyJGh+8qScnaQRqB/PWPA3Cg00xTOAlOFxVDoYyyRS0yBfcDkwzjk3531vBDZezYjxV1nMkY2y//DMI2NQNJsWOvafAAMAxE3MJSrFyPAAAAAASUVORK5CYII=",app_icon_32px_green_mentions:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABExJREFUeNqkVktsG0UYnpl9OF6/4JDYaWirNrFIgTbvNEilByS4FHogQeJQoCcOidQjiF6LBGcEnIs4cABBKZeUQw+IQkUicFDVJo0TJ0gtSW2paWLHr90d/t2ZnZ11TBubie3Mzu7+3//9b3z2xdeQuyilKLhMy6yb8KmVq+VLPT0j0RhqfakgF2MMO/YrlnfOYa098PsFQJjLamBA3SVQdyyrPQCCHdWbMJCx4PtPrdYmA64+osgjIJA4MMKEkFy10iYDLgv5QoWtYA+i4Qc+i+Xy/wJgPBo9QZ0PcWHyprVU3m3LyZJXGQ0B46huExAfiUSmzk2VCg/R3VzrDHCTDGBsYKMQomAyOjH63InnN48e3ia4nSjypLJ48fHYLeDR198XiUY6nk5cteotA/iJxv48T7gWc6yvEGVodCgWi8UT8av37y+36AlVeJgpDtEqwvTUy6e6urtM0zx45NDWw61EIv7C8MB3j7YvVMwwwi07WbiXZcTU22++M/0uXAFAtVI1IkY8kXjjrcnNjc3fF7On/7qD6b4BuPpSPgNG8kCSPQEm0jTNMAxAqtfr8M2nj96s1k4urZJ9FCj8+sQZBiAsQxHnz4w2/f7MK2dfrdVqn3/y2eyPs6ZVP/nSxND4sLq6NvLHrfiTbEXEA9Rb2NszQn3H0uBqILGeW9cUVVXUkfGRzmQnerbv43plfmf7SSZyFRYkRBF1vI0wRCfEKJwAxtrdHPyqSD0+fBxMpev631vbF/P5gXD4vVR3Omw8LorkngPSHbnH0nAJ0tlJdjE7MDYIJx1GONWdKpV29ZD+zKGDncmulbX1mdzqoGGMRaKnE08ldT3gA+hoTFk5n0HWpU8/aqza7rJtm8VVpVIpl3aLpVLhQeHihQ/h3LJNeKBH06KKciQUUjGGa5XLxTzT2GW6P90kHljxUBSnymKiqqquaaFwR2Gz0KGHbGpblgYK5Kn9wLRzZpnFixpoyJ4zvv3qm+xSFjbnp8/3ulb68ovLK0srsJk8N3lidABr+MrX3y/ML0DfLj7a0VTNIUdseMB2Mwl7MtVAlrm2YpeZuT9BASYd1rUrs8ViCV6a/mCGUbn582/Lt5eZQhBaTEvgwaIGds4tTIOZLHkC9r39vWy/cW+juFOETTQWTR1IcbffyTIkpylRN/wwJRD3DIBwk6h+FdozXgyODbHNwnyGnQ+OeydzGT/tRfOgvPo6ogi/RURoikcFiWQPrxYQo8xjon5k5jKiqPDXpXxiZvZ94LewIBuQu3HvMtjnxvVf2K2ffrjGrPfr9RtckNxCvNEBS/UDs8lOToK9eIiPYLTpfNYwi3gFjY8pBAXflPu+f/4fZhSjgrjV0A0DHU0gixdkiXIUyPpSRGUSckfhg08jQdp8BpAxAhIRlj0n93Ze7B7zcgM537h7rO8mqTxp+jZU2X/kxZxcsQPAXq/2WneAVmDUDBr2XwEGADZFpKJDFtSPAAAAAElFTkSuQmCC",app_icon_32px_yellow:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA6VJREFUeNp8Vr1PVEEQn3m+Ais+TOQ4TCCeARMxRyESC6EwkUIDpf530kqnJVZqZayMFBI5wpGAYMEdDZzR3Dqzszs7b+9gL7k3b97sfP5mdnH9yUvwyzkHZiGicISg/0yG+XGnFVZtQpdK6behNmBgJfPD+EqUgMFaFoHaGNxpbauMSlZCB1cgE3iNm7oyXTYbgSASXMUhF1PEpMu9VqY6Zf8Bk/ZcEv3PryIohTxANhyDE34eojOhDNMucRe26FklNDNCj4/CdC3pnxjD+mRw3/phM0HrxvydueQaXgmetVX3eqPf60GrLRtxY63/4pn7+w8Oj1CiYUsDmQgoGgoecU2+Lswz/+gEVN5zcL/tXdbEYo6FkmzGAoE8tTO0dpSZ8TEmdnaDgwvz/HrZg6NT3ib67F51ukiNJr9YCV+usO7OsHTrAAMeEKdrrHfnB2uCak9k+SjVrAJO7N0cgaVmwPXjZqjP02XnI+5LxibGiMM5o9S12i7rkliDgdkgSh/eh+erfUi5w8asa8yC0ML3HH59t42ttnE0ZpuI0uAXbXl/HsCbLepzDuXVOou/fV9cXPKueo1AxbY3tyjD8Os3Xlya5mKkpimZIsDUQPytew6drov1xE6XKyw+3hpn/vEJ7h3ITielCc0EaVzQW6mKhxaKaI8f59ESwD51m01STsIkT3Mg6vEsaYtCuzzlR3CFYf89zjtSGQO0XOjns25sFHD5yRFgH1OUTXCRW1kmMU50w2N0YhQJQiJWr3EE9RqujPAm6u3jU9M9Jt2cIm1xa6YxQxBysSK8lhbB5NZzmoIx2P5YUHzqfna6lGn2IqiZ/UPc3GL21CRPoU6XgSguPphzS4sM/A+fCu8NnJ1DVkjbz2WlwjHvtChwHwqDYq/NgJE9j5reg8ixp012gsqnonqIm1ntaSnA8Yk0ecien3pOz1oFSLDHuEpIKSqdbCpBNLVYnQGDFIG4RPi5yYXloa2TMY0A6eEsgsGjVZ3yAKUCQOc88L37VADs/al4nVS7VG3Ba5m7YEpE05gQ8n03jnGAr99YA5lMZQSXHZZqLA277I6lNqiMYRjET+T45y8QnDNDLUQfzw/b2eXgzUejSSAZuK/ZsTh4g7L8wurNBlHiG4Hs/hLPJMwuCenaUmnxeOBko+kq98Nlq4oOPVGEU+QBuivvANnZFzQCZtcywMpMKa/ZnAWXJTd33EjYHJbyhOo9xarWu2WlBsPupkMT+1+AAQCmPwV2bobFnwAAAABJRU5ErkJggg==",app_icon_32px_yellow_unreads:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA1hJREFUeNqMVr1PFUEQn9lcIc+ORylHB9gBNpLY+dEISKWhNHYWdhb+FRaa+CeYWJnYKVoJdAiVQMc7Oh90go1vnX2zOzs7dxj2JXfz9mbne36zuLa8AuPlvQe1EJF3mKCn4Qn76aRmFmlMV0LJt04d0FpZfde+EBVg1GY8EB3tk1q38Ahn4Tp4h4HA/5gpy8jS0YgEkeALg3wKUSC9tVo2xSj9BMzSLSeOf+PlolCwDgbFyTnety565UqXdPbb6aSbTEhk2jVWmAJe26EjQasqQoYdBUrExDX/7Kmfnx2dX8DLV47FvX39l54HR/jmHUqcxXY5G6uos3jYNPq6tEjSA8/BITL/3Gzk7PUCH4g3aGuhohMpQcBv6QzJ3fR0FHd4FHnqaZ92MOYbUZ8Vo11uNP6lTIwjFhebLx7QztJiVPnzIJtv+oNXZUKmM3ZrwU9Ohs2pfuReXGDOUX0jSqlrmKmDNV++2i5JOWgVBoflwT14tDIyuVlf9QCFgetjnsEJkoJsaIo2EU7Vb9TMldDvdyDHZWv3B3Do2Expi9Arq7cfarwELgpV+xtP/J3lQLz/4L5vh2P373p27uMnMhzZ3jboxipKLQydiSJaCqY5ifg1l3J+dparw/QTFyc9XXZHyp8NGbtMLSb5PB5E/BKVx01UaSdHLPvwt2ojeJRbh78ia9AgN9f1nu9NRGOpuqb6vmmQOlwHWRwKGaWJxr7o+iVZL56PrphhwQ+pIh1k5wXDMQP1TH31CoLhEE0iBTpzHwjEs/LPmxQT0g3razEHVDDNSThAJcSNTfVDSEc8FxcZVPQEtY2m4XAMk+GYZHhrG8//BJzbeJxqfx8HA3HaFqjgqys6WWWC6Dph3PA0BJpOU3qnUgOSdCNRAL/woBhh5bCdn4PkTdy/OV+CqAZOhodWxznddcXIhWxs08QOZ+wLIHqYZ0YeZJinZpGD9ghjEwYN/Bri6Sns7kUM396hkI6I3tsvQC3aJKlWkaraNx8J6NaOS+5Hnt/nfvObM1OvfYPS+85gk+6RvH9JGKXe5ZOuETvRRLMcMMNPc+q7k0ZGPVF4x1kH/aV3ADP7ZHiYa1meNiYH7cPGORNca7ji0DGs+A3lPaWYP3Ln0Tnoupt2BvafAAMA603M1k3efM4AAAAASUVORK5CYII=",app_icon_32px_yellow_mentions:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABBhJREFUeNqkVk1vG0UYfudj/bExbWo3kJLaKRWO3aaooIoKOMCBDwlBI06F/oEeQOIHcIU7N34CEieQekMIkBDtBaEgDk1aRIgdRGiSpqSpN1nvzPDOzuzurO2SxozX69lZz/vM836ThRffhngopSA/IhH1I7zCYD/4eGbmQuUxOPzgKJcQgjNzT0eybmHFEPyjAgCxsgYYqHikqPeFGA+AEn30EQxcLPz+FYZjMrDHBwUJgRTJAgOhlK7s743JwMqCTGiqK5yjaLzhtRQE/wvA8Bi0hNIXjWE2IrEc9MYHsFaN1ZTC6KPjl1K/RBbepJv1u2MBkBERYNjghFHKCD13lj59mv4xtf0PhON4USLV+EuGZ14hh0ad+WVWrNAvg/VDA2SBZj6JJTRMrH1G2ZkWmZjglQq/dmfn9iEtwVon54adx0wuPAfzZ+WpWTh/DqRUeG3dVUti5yI95hF6aIBMdHx74zW4clm256DVNHrT+ntyWvnV/hrsNnePZbo90Ivs8RMMs7NWs4QoBY+TcolVfH7kiDc5Wdid3vt2alXAI2UncumFtwxAqhllOVhrv/eueumi7Efy8y/ghxtRJPrPzIft5r7/d/GVtVNHqXewm7rZTSMlc0Noto4kCOd0fZ16jHPG59terVoIZ8JPdn/76f7OQdk0PnBKIk2iqHNcLpdU46TGYpSs/YlOhRt4q6n6EXge6T4QH213zpfLV6dPNMv+QwAcx09PreU29GOjblZgtUNacwhPSyU1VeO9PVLw6InHRXWS3V7vf7Dy+7O+//xE5eWjk08UCjkbYEUzh3XjuTUHH74vB7N2/F5IJSIVhnI/FMGe7AXR9rb49DN0YilkhEJmPK/C2FPFIicEn7mVS2ykmcfZxih/0ElF64pwncEZJx6XxQK9d0+VCjpOhPCUkhtK3onkShQYf+G5gpwY4+tvoNPFIId3FrQN8M1X10h3TfvD668qjAw0+3ffw81lJoR80FOIhLsk1aRlnDRJIpO7Cc7oyjwu3dIHMNJx/HidoN5x05XLlsrir3R1Fd1B64AzaU6JPIzX4EwLJIrnlOBYAuf1up1vbkEvZuyX4XjNmr3TsZGvi5KK3Y8oin5vAKhVCU+z0HB70W5Bwsaun2lbyOVb2T+z4qFs9tWiqH1FU9dM/5qSOJ5ki27XRni1alduLidbkhrlxpNRc2aDrITl2XS6sLFJtrbg50Wbw6/fwNwlcb74SyLILSFJ6+DmQWI6OzcIhvHAtmBqZH82kOSThGbbFAr5nW5hyNYfosa0VUhfDVTDXEVLkdMNrkTXC9zzKlAuCZvNwGl8Bgmq0T2Ai5GTCMS1nFvbbbL7j80D5DLlDmk/DlK308x0yM0vJD7nZuwcMKicDfK0cq1mXrH/CjAAfjaCPa5V5tYAAAAASUVORK5CYII=",app_icon_32px_red:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2pJREFUeNp8Vr13EzEMly5uQl+nlKnpRrtRNsp7DO1Ilz5W/gZW/iG6MrLCyMhIN9JsKVvDlH7dRdiWLcu6K27fxaeTrY/fT7Lx/dtziIOIQA1EZAlP/NPoBHleqZVlN547mcm3QRvQG8X8kFwmDjBZMxGIjf5KbVt0RLMKHajBMMH/uCnD7KWzkSZ+ClQ5RDlFYUrWaxGKU/oJWHa3mhj/4mjSpmADDIZzcCy3IZIKZWh3jrvRoBskJDM8nzawPyr7745w1iT3tR86E3401XZAg+Txr2fP4NMOHbmy8t2EPu7Aybj4J1mWHPiRWDRIHnaNv/LWyw2IPksWm6AHkli0XHA+Xxkg4F+pDMFu38E0hnr5mDw42grPW4JlF5bxfnqtOO2kCIIlJMFH8+lFzPVVK3zACAYFewFV1NVa/GMDJYNUIbaNcDxOlt6Mk7bPOGtyfnYbOJkE7WXnzZOpklzJvd7AaXm1FWDUXw9c+AdVSlESXr/e4VUEVZiatDAayFLU8P5u6fM6ZMOH8mE7qH+5xXV0ajbCs2j7Yh3w+7PB9UYVV2BqYWOJAEsBhW9/CVatnxLjudrAZcsJx+cR8OsO5i1DRQxNKiYVo39zsrFuXno+jQgHgub+tRcNeMyFHYB1N42iACf4QiPbERMNMK0/jNW7bHNhU6rnm00uFCB7ciTa5xSZDs56p5MUx4EQJnNpFg3MHJ5yKB36dFXsRJUidoGtiRm/qaHQ8dh28uOtpPDtHpctifvmdHGl9yKImUWHF+sg3hvR2SQg7InIfrx05I154n+/T3y7iRQyXUiy7SqEc9798IHHUAIp5h3Ocx29jqEsskTaWGmU9Qno6kOchBC84GAUntctpQLzJhnzjuSs7begkiigpqpkhQSXGOM575JLnj/bmDgqnbG0ACLL19BN9RFWH7aHMT8egFWmMrcKD8Bd7AZV4+QCI3vNcdYFZcl3Y8+QX4+pnfvHz4egsiKVE31GCU2wxsDcscSGh3HeVn3wDvHHAx+uoJtaCiKfH7qyXf/mI9EUOvfua7ot9m9QWt7ofU0jKnKlYO4vmIe5JJRrizmAuL2Y1vSU++mypTqjPlFY0tgA6ck7gDn70o6A5loGul9rDPqLTXAmudZxpaFz6PgX6nuK3lpqssJg6G46mNh/AgwA1LYLPz5hMyUAAAAASUVORK5CYII=",app_icon_32px_red_unreads:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAzFJREFUeNqMVr1zUzEMlxyHtincsdDOyUo6Aytz6Qoz3HVk5y/gr6ATQ2dgBWZYKWvDDAsDaZvmJUZ+smVZ77UXp5e4sqyPn76MR08OoV0hBFALEZnCG/o2PJGeb2pmkcZ7Lzs569UBnVXU99Fl4wGTNuOB6Oje1LqFRzgr1yE4jBu8xUxZRpZGI21oC6EyKGSI4jZYq4UoRulvwCLdcmL7aZdLQsE6GBVn55huXQzKlT7p7LfTQTeREGS6OVaZAkHboZGg5SvIsCdBaTOC8PoeTH2YBzj+mwx/fz8enS3h7RwEZ7Fd7qYs6k0eNo1OH90h6cDimH86TJy7LvKBeIM2FzzpzAEC/pXKkNiNs59nTeIZDxSF442o74rRrhQaf3IkWsTSmoqC1gOikE+KUtWEwcMbyHTEHg/hgYvEvZQKQHLZY/FgPMDJIHr18SqYKskx6CQGw3K0jc93bGxe7ABAqCnx39mKFChDM9q0cSp/k2bOBLZ9w/XtOkHHZkpZxEou5pcCimcnl/DuIjK+GsHTrUg/ucDPi2jjsy1g504vo+FsrzRdVD62dYC2l5lGNvZpTzhwsj/MVv1ZR2mqL5R64lDRtyvuSPpzXrUuj1Q8z5sUIMna81WqLzs5UtrHf323g7Pcia+yhczn4trF+Mdr3+G+oyOc6+pRcEfEaKKxLzp/Sdabu5tGWPqHZJEG2QXp4Vga9WSAm6fQ7zWYQErrLHUgLZ6Vf7gK5DhppsRnlChhfq3ihcPtwIVN+fOziTzzdWkqeoLaQtPtkNaPpo1nBurLAubtpZejnPtLmDWCe9WCClCQ54GMnZKggBJhAoGAptsUXmkbswaMRGn4lQfVCKuH7cEwFU1qmYgHQzCUaoKGquL4yOlpXo1c6haDUBmr+gc1UZkZZZBhmZpVDLojjE0guaeriA+1Gj76ep1K9/sSdFNLNkmoFVK++/IRQElcdj/x/FuHTws0U6/7gtJ0p+WaRlToN8Ao+S5HOkfsRBPNcsEMP82p3066M+qJwhRnHQw3vgHM7JPhYZ5lgNVM8rdcNs4ZcK3hikNj6PkX6neKFl3ePDoGfW/TXmD/CzAAcryyBfjeu1oAAAAASUVORK5CYII=",app_icon_32px_red_mentions:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAIAAAD8GO2jAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA+pJREFUeNqkVktvHEUQ7q7unp19xAkHJ6BFAhshgeI8pAgpuSAO3OLkCJw5cOEXwBX4F/yAiBMCxA1yyQWUG4kEIsoGoyiWDYg4jsc7091F9XRPT8/YkeNlPLvunUd99X1V1VX8+pV1Vh+IyLqHNrrSdJbFvPhsOr00OcGOf0iyyzmnlf+OR3M9wJoD8M8LwHiw1WOA9RFRnxizGABw5/ohDFIs+jwqywUZBPcZsoZARArAjAPAbL6/IINgi7VGo1a0JtP0ReevRfG/ADyPfiTQnVDDbGvzW7G3OECIai1ThHGu0wdgzPl7Y3i8+89CAPyQCvBsaCEABIeLA/FGJh7uPd6pykWyqLHq86XF87eIw0oGIyEHnH+9vXlsgLbQ/F8TCQdTqy9AnM/ERIolJb/9d+f3Y0YCYoR9CFK5Liu2PsCrOZ9KGAt5Qqo3c/HVo43iOEUne9LHUF/P+ftDx0IjKw1JJJakvDZWW/Py1ubs3elrrbZHMgjuN/Xs31yGQEWQFwBDQSrJk0q9oFSh57c2N55zd+LXLl/1ALGAkQXfvFwfjtg7GVbWfrmLPxSVNtUlVq6xciAHV868siTV0Wma7m4OqVl7QqvS1RqReIighJRCns+z5UFmTPnFg3u3n+wcFYPa4UgibqIUCbo8Yrgi3COE8YdllFSSybNDXmmmOGzMq0//3LgwHH704kuvD0fPDHLMnOg12V2VDoOs+wqZGbaWETzkyE4rXnCeAbyci2Wp71XVx7P7F0ejt8aTt0+eOpNlnRhQR/POpgm6ptgnk0N2bTotokYsjd23hvJ1z5i/KvP5jrHWGkt3cKrURIiVwUByykCUwS4PleZ/roqmrFNffFLVyeDKD7gCyEH8zU2eWYvWGIVot9FuaTvThfdJdhpyE4xv9nFmnEQfDJlX6UbBHhgHsZ7jWemS+fsC71ag0ewaUJKIoQXLaoq1JMGm7FRZrZX/+Yt2BbfSCPXjnD2tHaGs9U/c1vy+pnSQ9JwU1ntJPHzW0MoZ5Nit5CQStH5VhPWWZU/dEsecnYYm7Dq0PNeUsE4/jkB57wEgSCLj7n9wvDinQiTu6EDxnGK9K23ugXPYL5wpCLcgpmZ8NJJYbhjMdMiiuH/cqZpXmh6V1pMXsY1B28K6bMjuDeP0+akMt26WjhPZ+bliwVDaQprRId0HZTqtpDDeXJNd4Zldi9/NOzNHHEb6c1tzHVK7vamivf4MGeOoEG/1umGno0Xk+EJqMc2C1F9kmI45aUcJg0+fIB4+A6QYHYuMp5FLe3s/Bgdf7pHridt3vDNpthpK/581EUt37A4ww04MurQ6o2ZX2P8EGAAu1YEi4TmT9gAAAABJRU5ErkJggg=="};var d=function e(t){var i=$(".unknown_team");var n=$(".unknown_team_icon");var a=$('#jumper-results [href^="https://my."]');t.forEach(function(e){var t=_.escape(TS.interop.rules.teams.getTeamDisplayName(e));i.filter('.unknown_team[data-id="'+e.id+'"]').each(function(){$(this).replaceWith(t)});n.filter('.unknown_team_icon[data-id="'+e.id+'"]').each(function(){var t=$(this);var i=t.data("size");var n=t.data("classes");var a=t.data("with-tooltip");var r=t.data("pending-shared");t.replaceWith(TS.templates.team_icon({team:e,size:i,classes:n,with_tooltip:a,is_pending_shared:r}))});n.filter('.unknown_team_icon[data-external-id="'+e.id+'"]').each(function(){var t=$(this);var i=t.data("size");var n=t.data("badge-size");var a=t.data("with-tooltip");t.replaceWith(TS.templates.member_type_external_badge({team:e,size:i,badge_size:n,with_tooltip:a}))});a.filter('[data-id="'+e.id+'"]').each(function(){var t=$(this);var i=t.attr("href");t.attr("href",i.replace("my",_.get(e,"domain","my")))})});i.length&&TS.teams.unknown_resolution_rebuild_sig.dispatch(t)}})()},3030:function(e,t){(function(){TS.registerModule("view.channel",{unknown_resolution_rebuild_sig:new signals.Signal,onStart:function t(){TS.channels.renamed_sig.add(TS.view.channel.channelRenamed,TS.view.channel);TS.channels.switched_sig.add(TS.view.channel.channelSwitched,TS.view.channel);TS.channels.member_joined_sig.add(TS.view.channel.channelMemberJoined,TS.view.channel);TS.channels.member_left_sig.add(TS.view.channel.channelMemberLeft,TS.view.channel);TS.channels.archived_sig.add(TS.view.channel.channelArchived,TS.view.channel);TS.channels.unarchived_sig.add(TS.view.channel.channelUnArchived,TS.view.channel);TS.channels.msg_not_sent_sig.add(TS.view.channel.channelMsgNotsent,TS.view.channel);TS.channels.changed_is_unknown_sig.add(e)},channelRenamed:function e(){TS.client.ui.rebuildAll();TS.view.updateTitleWithContext()},channelSwitched:function e(){TS.view._maybeUpdateOnboarding();TS.view.switchedHelper();TS.view.updateTitleWithContext();TS.client.msg_input.mountOrReMountNotificationBar()},channelMemberJoined:function e(t){if(t.id!=TS.model.active_channel_id)return;TS.client.msg_pane.rebuildChannelMembersList();TS.interop.channels.getNeedsCreatedMessageState(t.name)&&TS.view.overlay.startWithCreatedChannel(t)},channelMemberLeft:function e(t){if(t.id!=TS.model.active_channel_id)return;TS.client.msg_pane.rebuildChannelMembersList()},channelArchived:function e(t){TS.client.msg_pane.rebuildChannelMembersList();if(t.id!=TS.model.active_channel_id||TS.model.threads_view_is_showing||TS.model.unread_view_is_showing)return;TS.client.archives.start()},channelUnArchived:function e(t){if(t.id!=TS.model.active_channel_id)return;TS.client.msg_pane.rebuildChannelMembersList()},channelMsgNotsent:function e(t,i,n){if(!i.thread_ts&&t.id!==TS.model.active_channel_id)return;TS.view.showUnSentControlsForMsg(i,t,n)}});var e=function e(t){$(".unknown_channel").length>0&&TS.view.channel.unknown_resolution_rebuild_sig.dispatch(t)}})()},3031:function(e,t){(function(){TS.registerModule("view.dnd",{onStart:function e(){TS.dnd.dnd_statuses_changed_sig.add(TS.view.dnd.dndStatusesChanged,TS.view.dnd);TS.dnd.current_user_dnd_status_changed_sig.add(TS.view.dnd.currentUserDndStatusChanged,TS.view.dnd)},dndStatusesChanged:function e(t){if(!t||!t.length)return;var i=$(".presence[data-member-presence]");var n={};i.each(function(){var e=$(this);var t=e.attr("data-member-presence");n[t]||(n[t]=[]);n[t].push(e)});var a=0;t.forEach(function(e){var t=n[e.id];if(!t)return;t.forEach(function(t){a+=1;var i=TS.templates.makeMemberPresenceStateClass(e);t.removeClass("away active dnd").addClass(i);var n=TS.redux.channels.getImByMemberId(e.id);n&&t.closest(".im_name").attr("aria-label",TS.templates.builders.makeMemberLinkAriaLabelSafe({member:e,im:n}))})});TS.has_pri[2002]&&TS.log(2002,"dndStatusesChanged updated "+a+" out of "+i.length+" presence icons")},currentUserDndStatusChanged:function e(){TS.redux.socket.isConnected()&&TS.view.ms.maybeChangeConnectionDisplay();var t=$("#team_menu").find(".notifications_menu_btn");TS.dnd.isMemberInDnd(TS.model.user)?t.removeClass("ts_icon_bell_o").addClass("ts_icon_snooze_outline"):t.removeClass("ts_icon_snooze_outline").addClass("ts_icon_bell_o")}})})()},3032:function(e,t){(function(){TS.registerModule("view.files",{onStart:function e(){TS.files.team_file_added_sig.add(TS.view.files.teamAdded,TS.view.files);TS.files.team_file_deleted_sig.add(TS.view.files.teamDeleted,TS.view.files);TS.files.team_file_changed_sig.add(TS.view.files.teamChanged,TS.view.files);TS.files.file_uploaded_sig.add(TS.view.files.uploaded,TS.view.files);TS.files.file_uploading_sig.add(TS.view.files.uploading,TS.view.files);TS.files.file_progress_sig.add(TS.view.files.progress,TS.view.files);TS.files.file_canceled_sig.add(TS.view.files.canceled,TS.view.files);TS.files.file_queue_emptied_sig.add(TS.view.files.queueEmptied,TS.view.files)},teamAdded:function e(t){!t.is_deleted&&TS.view.files.shouldAppearInlist(t)&&TS.view.files.throttledRebuildList()},teamDeleted:function e(t){TS.view.files.shouldAppearInlist(t)&&TS.view.files.throttledRebuildList()},teamChanged:function e(t){if(!TS.model.ui_state.flex_visible||TS.model.ui_state.flex_name&&"files"!==TS.model.ui_state.flex_name||!TS.model.ui_state.flex_name&&"files"!==TS.model.default_flex_name)return;if(!t.is_deleted&&TS.view.files.shouldAppearInlist(t)){var i=!TS.interop.files.isObjectFresh(t.id);if(i){TS.files.getFileById(t.id);return}TS.view.files.singleListItemChanged(t)}var n=TS.shared.legacyGetActiveModelOb();n&&TS.utility.msgs.updateFileMsgs(n,t)},uploaded:function e(t){t&&TS.redux.dispatch(TS.interop.redux.features.fileUpload.uploadComplete())},uploading:function e(t,i,n){TS.redux.dispatch(TS.interop.redux.features.fileUpload.uploadStarting({fileName:t,isRetry:i,cancelable:n}))},progress:function e(t){TS.redux.dispatch(TS.interop.redux.features.fileUpload.progressUpdate({percentComplete:t}))},canceled:function e(){TS.redux.dispatch(TS.interop.redux.features.fileUpload.uploadCanceled())},queueEmptied:function e(){TS.redux.dispatch(TS.interop.redux.features.fileUpload.uploadQueueEmptied())},getNoFilesMessage:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=t.type,n=void 0===i?"all":i,a=t.user,r=void 0===a?null:a;switch(n){case"posts":case"spaces":case"docs":return r?TS.interop.i18n.t("No posts from {user}.","files")({user:r}):TS.interop.i18n.t("No posts from you.","files")();case"snippets":return r?TS.interop.i18n.t("No snippets from {user}.","files")({user:r}):TS.interop.i18n.t("No snippets from you.","files")();case"emails":return r?TS.interop.i18n.t("No emails from {user}.","files")({user:r}):TS.interop.i18n.t("No emails from you.","files")();case"images":return r?TS.interop.i18n.t("No images from {user}.","files")({user:r}):TS.interop.i18n.t("No images from you.","files")();case"videos":return r?TS.interop.i18n.t("No videos from {user}.","files")({user:r}):TS.interop.i18n.t("No videos from you.","files")();case"pdfs":return r?TS.interop.i18n.t("No PDFs from {user}.","files")({user:r}):TS.interop.i18n.t("No PDFs from you.","files")();case"gdocs":return r?TS.interop.i18n.t("No Google Docs from {user}.","files")({user:r}):TS.interop.i18n.t("No Google Docs from you.","files")();case"spreadsheets":return r?TS.interop.i18n.t("No spreadsheets from {user}.","files")({user:r}):TS.interop.i18n.t("No spreadsheets from you.","files")();case"all":return r?TS.interop.i18n.t("No files from {user}.","files")({user:r}):TS.interop.i18n.t("No files from you.","files")();default:return TS.interop.i18n.t("No files","files")()}},throttledRebuildList:function e(){TS.utility.throttle.method(TS.view.files.maybeRebuildList,"file_list_rebuild",1e3)},maybeRebuildList:function e(){if(!TS.model.ui_state.flex_visible||TS.model.ui_state.flex_name&&"files"!==TS.model.ui_state.flex_name||!TS.model.ui_state.flex_name&&"files"!==TS.model.default_flex_name)return;TS.view.files.rebuildList()},last_files_html:"",rebuildList:function t(){if(TS.boot_data.feature_file_threads)return;TS.metrics.mark("start_file_flexpane_rebuild");var i=$("#file_list");var n=$("#file_list_block");var a=i.data("list");var r=TS.model.files;var s;var o="/files";if("user"===a){r=TS.model.user.files;o+="/"+TS.model.user.name}else if(TS.interop.utility.looksLikeMemberId(a)){s=TS.interop.members.getMemberById(a);if(s){r=s.files;o+="/"+s.name}else TS.error(a+" is not valid?")}var l=r.filter(function(e){return!e.is_deleted&&TS.view.files.shouldAppearInlist(e)});var c=_(l).map("id").filter(function(e){return!TS.interop.files.isObjectFresh(e)}).value();c.map(TS.files.getFileById);$("#file_list_heading").find(".heading_label").text(TS.view.file_list_heading);$("#file_list_toggle").removeClass("hidden");$("#file_search_cancel").addClass("hidden");var d=TS.model.file_list_types;var u=!d||!d.length||-1!=d.indexOf("all");n.find(".subsection").addClass("hidden");if(u)n.find('.subsection[data-filter="all"]').removeClass("hidden");else{"all"===TS.model.active_file_list_member_filter&&(o+="/all");o+="/"+TS.model.active_file_list_filter;n.find('.subsection[data-filter="'+d[0]+'"]').removeClass("hidden")}if(!l.length){var m=TS.interop.i18n.t("No files.","files")();u?"user"===a?m=TS.interop.i18n.t("No files from you.","files")():s&&(m=TS.interop.i18n.t("No files from {user}.","files")({user:TS.interop.i18n.safeString("<strong>"+TS.interop.members.getPrefCompliantMemberName(s,true)+"</strong>")})):"user"===a?m=TS.view.files.getNoFilesMessage({type:d[0]}):s&&(m=TS.view.files.getNoFilesMessage({type:d[0],user:TS.interop.i18n.safeString("<strong>"+TS.interop.members.getPrefCompliantMemberName(s,true)+"</strong>")}));if(e){i.longListView("destroy");e=false}i.empty().html('<p class="no_results">'+m+"</p>")}if(l.length)if(e)i.longListView("setItems",l,false,true);else{i.empty();var f=80;i.longListView({items:l,approx_item_height:f,preserve_dom_order:true,scrollable:$("#file_list_scroller"),makeElement:function e(){return $("<div>")},renderItem:function e(t,i){i=TS.files.getFileById(i.id);var n=TS.templates.builders.fileHTML(i,{show_channel_name:true});n=TS.format.replaceHighlightMarkers(n);var a=$(n);a.find("i.lazy").each(function(){var e=$(this);e.removeClass("lazy");e.css("background-image","url("+e.attr("data-original")+")")});t.attr("id",a.attr("id"));t.attr("class",a.attr("class"));t.attr("data-file-id",i.id);t.data("file-id",i.id);if(TS.boot_data.feature_docs){t.attr("draggable","true");t.attr("data-drag-meta",TS.templates.makeFileDragData(i))}t.empty();a.children().each(function(){t.append(this)});TS.utility.makeSureAllLinksHaveTargets(t)},calcItemHeight:function e(t){var i=t.outerHeight();if(!i)return f;return i+12}});e=true}TS.boot_data.feature_file_threads||(0===TS.model.files.length?$("#file_listing_bottom_button").addClass("hidden"):$("#file_listing_bottom_button").removeClass("hidden").attr("href",o));TS.ui.utility.updateClosestMonkeyScroller(i);TS.metrics.measureAndClear("file_flexpane_rebuild","start_file_flexpane_rebuild")},filterSet:function e(){"files"===TS.model.ui.active_tab_id&&TS.model.ui_state.flex_visible&&!TS.model.previewed_file_id||TS.client.ui.files.showFileList();TS.view.files.maybeRebuildList();$("#file_list_scroller").scrollTop(0);TS.client.flex_pane.maybeFetchFileList();TS.boot_data.feature_file_threads&&TS.redux.dispatch(TS.interop.redux.features.filesFlexpane.setFiletype(TS.model.active_file_list_filter))},clearFilter:function e(){TS.model.active_file_list_filter="all";TS.view.file_list_heading=TS.interop.i18n.t("All File Types","files")();TS.model.file_list_types=["all"];TS.view.files.filterSet();TS.view.files.setButtonState("all");$("#file_list_clear_filter").addClass("hidden")},setButtonState:function e(t){$(".secondary_file_button").addClass("hidden");"snippets"===t?$("#secondary_snippet_button").removeClass("hidden"):"posts"===t?$("#secondary_post_button").removeClass("hidden"):$("#file_list_button").removeClass("hidden")},shouldAppearInlist:function e(t){var i=TS.model.file_list_types;if(!i)return true;if(!i.length)return true;if(i.indexOf("all")>-1)return true;if(i.indexOf("snippets")>-1&&"snippet"===t.mode)return true;if(i.indexOf("posts")>-1&&"post"===t.mode)return true;if(i.indexOf("spaces")>-1&&"space"===t.mode)return true;if(TS.boot_data.feature_docs&&i.indexOf("docs")>-1&&"docs"===t.mode)return true;if(i.indexOf("emails")>-1&&"email"===t.mode)return true;if(i.indexOf("zips")>-1&&"zip"===t.filetype)return true;if(i.indexOf("pdfs")>-1&&"pdf"===t.filetype)return true;if(i.indexOf("spreadsheets")>-1&&("xlsx"===t.filetype||"xls"===t.filetype||"xlsm"===t.filetype||"gsheet"===t.filetype||"tsv"===t.filetype||"csv"===t.filetype))return true;if(i.indexOf("images")>-1&&t.mimetype&&0===t.mimetype.indexOf("image/"))return true;if(i.indexOf("videos")>-1&&t.mimetype&&0===t.mimetype.indexOf("video/"))return true;if(i.indexOf("gdocs")>-1&&t.mimetype&&0===t.mimetype.indexOf("application/vnd.google-apps"))return true;return false},singleListItemChanged:function t(i){if(!e)return;if("files"!==TS.model.ui_state.flex_name)return;$("#file_list").longListView("itemUpdatedById",i.id)},cleanList:function t(){if(e){$("#file_list").longListView("destroy");e=false}},hideList:function t(){if(!e)return;$("#file_list_scroller").data("disable-scroll",true);$("#file_list").longListView("setHidden",true)},unHideList:function t(){$("#file_list_scroller").data("disable-scroll",false);e?$("#file_list").longListView("setHidden",false):TS.view.files.rebuildList()},shareInCurrentChannelOrIM:function e(t,i){TS.ui.share_dialog.start(t,void 0,void 0,i,true)},delete:function e(t){var i;var n;var a;var r=TS.files&&TS.files.getFileById?TS.files.getFileById(t):null;if(r&&r.filetype&&"space"===r.filetype){i=TS.interop.i18n.t("Delete post","files")();n=TS.interop.i18n.t("Are you sure you want to delete this post permanently?","files")();a=TS.interop.i18n.t("Yes, delete this post","files")()}else{i=TS.interop.i18n.t("Delete file","files")();n=r.is_external?TS.interop.i18n.t("Are you sure you want to permanently delete this file from Slack?","files")():TS.interop.i18n.t("Are you sure you want to delete this file permanently?","files")();a=TS.interop.i18n.t("Yes, delete this file","files")()}TS.generic_dialog.start({title:i,body:n,show_cancel_button:true,show_go_button:true,go_button_class:"btn_danger",go_button_text:a,cancel_button_text:TS.interop.i18n.t("Cancel","files")(),onGo:function e(){TS.files.deleteFile(t)}})},saveToDropbox:function e(t){TS.generic_dialog.start({title:TS.interop.i18n.t("Save to Dropbox","files")(),body:TS.interop.i18n.t("Do you want to save this file to your Dropbox Slack folder?","files")(),show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Yes","files")(),cancel_button_text:TS.interop.i18n.t("No","files")(),onGo:function e(){TS.files.saveFileToDropbox(t)}})}});var e=false})()},3033:function(e,t){(function(){TS.registerModule("view.group",{onStart:function e(){TS.groups.switched_sig.add(TS.view.group.groupSwitched,TS.view.group);TS.groups.member_joined_sig.add(TS.view.group.groupMemberJoined,TS.view.group);TS.groups.member_left_sig.add(TS.view.group.groupMemberLeft,TS.view.group);TS.groups.opened_sig.add(TS.view.group.groupOpened,TS.view.group);TS.groups.closed_sig.add(TS.view.group.groupClosed,TS.view.group);TS.channels.archived_sig.add(TS.view.group.groupArchived,TS.view.group);TS.groups.msg_not_sent_sig.add(TS.view.group.groupMsgNotSent,TS.view.group)},groupRenamed:function e(t){if(!t.is_group)return;TS.view.updateTitleWithContext();TS.client.ui.rebuildAll()},groupSwitched:function e(){TS.view._maybeUpdateOnboarding();TS.view.switchedHelper();TS.view.unAdjustForWelcomeSlideShow();TS.view.updateTitleWithContext();TS.client.msg_input.mountOrReMountNotificationBar()},created_group_overlay_tim:0,groupMemberJoined:function e(t){if(t.id!=TS.model.active_group_id)return;TS.client.msg_pane.rebuildChannelMembersList()},groupMemberLeft:function e(t){if(t.id!=TS.model.active_group_id)return;TS.client.msg_pane.rebuildChannelMembersList()},groupOpened:function e(){TS.client.msg_pane.rebuildChannelMembersList()},groupClosed:function e(){TS.client.msg_pane.rebuildChannelMembersList()},groupArchived:function e(t){if(!t.is_group)return;if(t.id!=TS.model.active_group_id||TS.model.threads_view_is_showing||TS.model.unread_view_is_showing)return;TS.client.archives.start()},groupMsgNotSent:function e(t,i,n){if(!i.thread_ts&&t.id!==TS.model.active_group_id)return;TS.view.showUnSentControlsForMsg(i,t,n)}})})()},3034:function(e,t){(function(){TS.registerModule("view.im",{onStart:function e(){TS.ims.opened_sig.add(TS.view.im.imOpened,TS.view.im);TS.ims.closed_sig.add(TS.view.im.imClosed,TS.view.im);TS.ims.switched_sig.add(TS.view.im.imSwitched,TS.view.im);TS.ims.msg_not_sent_sig.add(TS.view.im.imMsgNotsent,TS.view.im)},imOpened:function e(){TS.client.msg_pane.rebuildChannelMembersList()},imClosed:function e(){TS.client.msg_pane.rebuildChannelMembersList()},imSwitched:function e(){TS.view._maybeUpdateOnboarding();TS.view.switchedHelper();TS.onboarding.inOnboarding()||TS.view.unAdjustForWelcomeSlideShow();TS.view.updateTitleWithContext();TS.client.msg_input.mountOrReMountNotificationBar()},imMsgNotsent:function e(t,i,n){if(!i.thread_ts&&t.id!==TS.model.active_im_id)return;TS.view.showUnSentControlsForMsg(i,t,n)}})})()},3035:function(e,t){(function(){TS.registerModule("view.members",{unknown_resolution_rebuild_sig:new signals.Signal,onStart:function e(){TS.members.presence_changed_sig.add(TS.view.members.memberPresenceChanged,TS.view.members);TS.members.changed_name_sig.add(TS.view.members.memberChangedName,TS.view.members);TS.members.changed_self_sig.add(TS.view.members.somethingChangedOnUser,TS.view.members);TS.members.changed_deleted_sig.add(t,TS.view.members);TS.members.changed_profile_sig.add(TS.view.members.memberChangedProfile,TS.view.members);TS.members.changed_current_status_sig.add(TS.view.members.memberChangedCurrentStatus,TS.view.members);TS.members.changed_tz_sig.add(TS.view.members.memberChangedTZ,TS.view.members);TS.members.changed_account_type_sig.add(TS.view.members.memberAccountTypeChanged,TS.view.members);TS.members.changed_admin_perms_sig.add(TS.view.members.memberAdminPermsChanged,TS.view.members);TS.members.changed_owner_perms_sig.add(TS.view.members.memberAdminPermsChanged,TS.view.members);TS.members.changed_is_unknown_sig.add(i);TS.stars.member_stars_fetched_sig.add(TS.view.members.memberStarsFetched,TS.view.members);TS.view.members.unknown_resolution_rebuild_sig.add(TS.view.members.memberChangedName)},memberPresenceChanged:function e(t){if(!t)return;var i;var n;var a;var r=TS.redux.presence.getPresenceByMemberId(t.id);if(t.is_self){TS.redux.socket.isConnected()&&TS.view.ms.maybeChangeConnectionDisplay();var s=$("#menu").find("#member_presence").find(".menu_item_label");"away"===r?s.text(TS.interop.i18n.t("[Away] Set yourself to active","view_members")()):s.text(TS.interop.i18n.t("Set yourself away","view_members")())}else{i="."+TS.templates.makeMemberDomId(t);n=$(i).not(".call_icon");"away"===r?n.addClass("away"):n.removeClass("away")}i="."+TS.templates.makeMemberPresenceDomClass(t.id);a=TS.templates.makeMemberPresenceStateClass(t);var o="active"===r?TS.interop.i18n.t("active","view_members")():TS.interop.i18n.t("away","view_members")();$(i).removeClass("away active dnd").addClass(a).attr("title",o);var l=TS.redux.channels.getImByMemberId(t.id);l&&$(i).closest(".im_name").attr("aria-label",TS.templates.builders.makeMemberLinkAriaLabelSafe({member:t,im:l}));TS.view.last_team_list_html=null},memberStatusChanged:function e(t){if(!t)return;t.is_self&&$(".user_status_label").text(t.status||"");var i="."+TS.templates.makeMemberStatusDomClass(t.id);$(i).html(t.status?t.status:"-");TS.view.updateTeamListCache()},memberChangedName:function e(t){if(t.id==TS.model.user.id){TS.view.members.updateUserDisplayName(t);TS.prefs.setHighlightWords(TS.prefs.getPref("highlight_words"))}TS.view.updateTitleWithContext();var i=true;TS.client.ui.rebuildAll(i);TS.view.rebuildTeamMember(t);if(t.id!=TS.model.previewed_member_id)return;TS.client.ui.previewMember(t.id)},somethingChangedOnUser:function e(){TS.view.showProperTeamPaneFiller()},memberChangedProfile:function e(t){var i=[];if(!TS.members.legacy_is_in_bulk_upsert_mode){var n=false;var a=TS.shared.legacyGetActiveModelOb();a&&(n=a.is_im&&a.user===t.id||a.is_mpim&&a.members.indexOf(t.id)>-1);var r=_.map(TS.model.ims,"user").indexOf(t.id)>-1;var s=t.id===TS.model.user.id;var o={channel_header:!n,user_current_status:!s,channel_pane_channels:true,channel_pane_apps:true,channel_pane_ims:!r,channel_pane_starred:!r};var l=true;TS.client.ui.rebuildAllButMsgs(o,l);TS.view.rebuildMsgsIncludingMember(t);TS.client.ui.threads.rebuildMsgsIncludingMember(t);TS.ui.replies.rebuildMsgsIncludingMember(t);TS.client.unread.isEnabled()&&TS.client.ui.unread.rebuildMsgsIncludingMember(t)}if(t.id==_.get(TS.model.user,"id")){TS.view.members.updateUserDisplayName(t);i.push("url("+t.profile.image_72+")");$('a[data-member-id="'+TS.model.user.id+'"] .member_image, a[data-member-id="'+TS.model.user.id+'"].member_image').attr("style","background-image: "+i.join(","));$('#menu a[data-member-id="'+TS.model.user.id+'"].member_image').attr("style","background-image: "+TS.templates.builders.makeMemberPreviewCardLinkImageBackground(TS.model.user.id))}TS.view.rebuildTeamMember(t);if(t.id!=TS.model.previewed_member_id)return;TS.client.ui.previewMember(t.id)},memberChangedCurrentStatus:function e(t){if(!TS.members.legacy_is_in_bulk_upsert_mode){var i=TS.shared.legacyGetActiveModelOb();var n=i&&i.is_im&&i.user===t.id||i&&i.is_mpim&&i.members.indexOf(t.id)>-1;var a=_.map(TS.model.ims,"user").indexOf(t.id)>-1;var r=t.id===TS.model.user.id;var s={channel_header:!n,user_current_status:!r,channel_pane_channels:true,channel_pane_apps:true,channel_pane_ims:!a,channel_pane_starred:!a};var o=true;TS.client.ui.rebuildAllButMsgs(s,o);TS.view.rebuildMsgCurrentStatusIncludingMember(t);TS.client.ui.threads.rebuildMsgCurrentStatusIncludingMember(t);TS.ui.replies.rebuildMsgCurrentStatusIncludingMember(t);TS.client.ui.flex.rebuildMsgCurrentStatusIncludingMember(t);TS.client.ui.unread.rebuildMsgCurrentStatusIncludingMember(t);$(".team_list_item.member_item .current_status.color_"+t.id).replaceWith(TS.templates.current_status({member:t}));var l=TS.templates.current_status({member:t,classes:"ts_tip_float"});$(".member_info .current_status.color_"+t.id).replaceWith(l);$("#channel_page_member_"+t.id+" .current_status").replaceWith(l)}t.id==TS.model.user.id&&TS.view.members.updateUserCurrentStatus();TS.view.rebuildTeamMember(t);if(t.id!=TS.model.previewed_member_id)return;TS.client.ui.previewMember(t.id)},memberChangedTZ:function e(t){var i=true;TS.client.ui.rebuildAll(i);TS.view.rebuildTeamMember(t);if(t.id!=TS.model.previewed_member_id)return;TS.client.ui.previewMember(t.id)},member_account_changed_tim:0,memberAccountTypeChanged:function e(t){if(t&&t.id==TS.model.user.id)return;clearTimeout(TS.view.members.member_account_changed_tim);TS.view.members.member_account_changed_tim=setTimeout(function(){if(t.id!=TS.model.previewed_member_id)return;TS.client.ui.previewMember(t.id)},1e3)},memberAdminPermsChanged:function e(t){t&&t.id==TS.model.user.id&&TS.ui.admin_invites.maybeShowInviteLink();$("#team_list_admin_link").toggleClass("hidden",!t.is_admin);TS.model.previewed_member_id===t.id&&TS.client.ui.previewMember(t.id)},updateUserDisplayName:function e(t){t||(t=TS.model.user);var i=TS.interop.members.getPrefCompliantMemberName(t,true);i||TS.console.logError("no name for TS.model.user","updateUserDisplayName_no_name","v7");$(".current_user_name").html(i)},updateUserCurrentStatus:function e(){$(".current_user_current_status").replaceWith(TS.templates.current_status({member:TS.model.user,tip_direction:"bottom",classes:"current_user_current_status ts_tip_float"}))},memberTypingStarted:function e(t,i){var n=TS.redux.channels.getEntityById(t);var a=TS.interop.members.getMemberById(i);if(!TS.prefs.getPref("show_typing"))return;var r=TS.shared.legacyGetActiveModelOb();r&&t==r.id&&TS.client.msg_input.mountOrReMountNotificationBar();if(a.is_self)return;var s=TS.view.members.getSelectorForTypingIndicator(n,a);s&&$(s).addClass("typing")},memberTypingEnded:function e(t,i){var n=TS.redux.channels.getEntityById(t);var a=TS.interop.members.getMemberById(i);var r=TS.shared.legacyGetActiveModelOb();r&&t==r.id&&TS.client.msg_input.mountOrReMountNotificationBar();var s=TS.view.members.getSelectorForTypingIndicator(n,a);s&&$(s).removeClass("typing")},getSelectorForTypingIndicator:function e(t,i){var n;var a=TS.shared.legacyGetActiveModelOb();t.is_im?n=".channels_list_holder ul li."+TS.templates.makeMemberDomId(i):a&&t.id===a.id&&(n="#"+TS.templates.makeChannelListDomId(t)+" ."+TS.templates.makeMemberDomId(i));return n},memberStarsFetched:function e(t,i){TS.view.toggleStarsError(!!t);if(t)return;if(!i||!i.is_self)return;TS.view.rebuildStars()}});var e=false;var t=function t(){if(e)return;var i=TS.shared.legacyGetActiveModelOb();if(!i)return;e=true;TS.utility.rAF(function(){e=false;TS.client.msg_pane.rebuildChannelMembersList()})};var i=function e(t){$(".unknown_member").length>0&&TS.view.members.unknown_resolution_rebuild_sig.dispatch(t)}})()},3036:function(e,t){(function(){TS.registerModule("view.mpim",{onStart:function e(){TS.mpims.switched_sig.add(TS.view.mpim.mpimSwitched,TS.view.mpim);TS.mpims.msg_not_sent_sig.add(TS.view.mpim.mpimMsgNotsent,TS.view.mpim)},mpimSwitched:function e(){TS.view._maybeUpdateOnboarding();TS.view.switchedHelper();TS.onboarding.inOnboarding()||TS.view.unAdjustForWelcomeSlideShow();TS.view.updateTitleWithContext();TS.client.msg_input.mountOrReMountNotificationBar()},mpimMsgNotsent:function e(t,i,n){if(!i.thread_ts&&t.id!==TS.model.active_mpim_id)return;TS.view.showUnSentControlsForMsg(i,t,n)}})})()},3037:function(e,t){(function(){TS.registerModule("view.ms",{onStart:function e(){TS.redux.socket.troubleConnectingSig.add(TS.view.ms.socketTroubled,TS.view.ms);TS.redux.socket.waitingForRateLimitSig.add(TS.view.ms.socketReconnecting,TS.view.ms);TS.redux.socket.connectedSig.add(TS.view.ms.socketConnected,TS.view.ms);TS.redux.socket.disconnectedSig.add(TS.view.ms.socketDisconnected,TS.view.ms)},ever_connected:false,socketConnected:function t(i){var n=!!TS.view.ms.ever_connected;if(TS.view.ms.ever_connected){TS.utility.msgs.removeAllEphemeralMsgsByType("disconnected_feedback");TS.client.ui.rebuildAllButMsgs();TS.client.ui.rebuildMemberListToggle();TS.mentions.maybeUpdateMentions();if(i){var a=TS.shared.legacyGetActiveModelOb();a&&TS.shared.legacyMaybeDealWithAllSentTempMsgs(a,TS.shared.legacyGetControllerForModelOb(a))}}else{if(TS.metrics.getLatestMark("start_load")){TS.metrics.measure("client_load","start_load");TS.metrics.measure("client_load_react_msgs","start_load")}TS.metrics.measure("client_total_load","start_nav");TS.interop.metrics.logPerfTimingSections();e()}TS.view.ms.ever_connected=true;TS.client.msg_input.setOnline();_();m();$("#connection_div").html("").removeClass("resync_banner").addClass("hidden");TS.client.msg_pane.topMessagesBannerHidden();TS.view.ms.changeConnectionStatus("online");TS.view.prefs.toggleSpellcheck();document.activeElement&&document.activeElement.classList.contains("c-toast")||TS.view.checkIfInputShouldBeDisabledAndPopulate(n);TS.ui.a11y.annouceCurrentChannelOrImOrGroup()},socketTroubled:function e(){TS.view.ms.changeConnectionStatus("trouble");TS.client.msg_input.setOffline();if(l())return;TS.info("Showing the reconnection banner because we are troubled");TS.boot_data.feature_degraded_send?d():u()},socketDisconnected:function e(){TS.view.ms.changeConnectionStatus("offline");TS.client.msg_input.setOffline();TS.info("Hiding the reconnection banner because we are disconnected");_();m()},socketReconnecting:function e(i){if(TS.model.window_unloading){TS.info("Hiding the reconnection banner because we are unloading");_();m();$("#connection_div").html("").removeClass("resync_banner").addClass("hidden");TS.client.msg_pane.topMessagesBannerHidden()}else if($("#connection_div").hasClass("hidden")&&!TS.boot_data.feature_degraded_send)o(i);else if(TS.boot_data.feature_degraded_send)if($("#connection_div").hasClass("hidden")&&TS.boot_data.feature_degraded_send){var n=t;d(n)}else TS.boot_data.feature_degraded_send&&d();else u(i)},current_connection_status:null,changeConnectionStatus:function e(t){TS.view.ms.current_connection_status=t;TS.view.maybeChangeFavIco();TS.view.ms.maybeChangeConnectionDisplay()},maybeChangeConnectionDisplay:function e(){var t=$("#presence");var i="";var n;switch(TS.view.ms.current_connection_status){case"online":if("away"===TS.redux.presence.getPresenceByMemberId(TS.model.user.id)){n=TS.dnd.isMemberInDnd(TS.model.user)?TS.interop.i18n.t('Away<br><span class="greigh">Notifications snoozed</span>',"ms")():TS.interop.i18n.t("Away","ms")();i="away"}else{n=TS.dnd.isMemberInDnd(TS.model.user)?TS.interop.i18n.t('Active<br><span class="greigh">Notifications snoozed</span>',"ms")():TS.interop.i18n.t("Active","ms")();i="active"}TS.dnd.isMemberInDnd(TS.model.user)&&(i+=" dnd");break;case"trouble":n=TS.interop.i18n.t("Connecting...","ms")();i="connecting";break;default:n=TS.interop.i18n.t("Away","ms")();i="away"}TS.tips.updateTipTitle($("#presence_container"),n);t.removeClass("active away connecting dnd");t.addClass(i)},manualSyncNow:function e(){if(!l())return;$("#connection_div").html("").removeClass("resync_banner").addClass("hidden");_();m();d(t);var i=TS.shared.legacyGetActiveModelOb();i&&!TS.client.activeChannelIsHidden()&&TS.redux.dispatch(TS.interop.actions.requestOfflineHistory({channelId:i.id}));TS.model.threads_view_is_showing&&TS.redux.dispatch(TS.interop.actions.requestOfflineHistory({channelId:"Vall_threads"}));var n=TS.ui.replies.activeConvoModelId();var a=TS.ui.replies.activeConvoThreadTs();n&&a&&TS.redux.dispatch(TS.interop.actions.requestOfflineHistory({channelId:n,threadTs:a}));TS.redux.dispatch(TS.interop.actions.requestOfflineCounts());TS.client.manualReconnectNow()}});var e=function e(){var t=Array.prototype.slice.call(document.getElementsByTagName("style"));var i=Array.prototype.slice.call(document.getElementsByTagName("link"));var n=Array.prototype.slice.call(document.getElementsByTagName("script"));var a=n.filter(function(e){return!e.src&&"text/x-handlebars-template"!==e.type});var r=n.filter(function(e){return!!e.src});var s=n.filter(function(e){return!e.src&&"text/x-handlebars-template"===e.type});i=i.filter(function(e){return"stylesheet"===e.rel});TS.metrics.store("inline_script_nodes",a.length,{is_count:true});TS.metrics.store("inline_template_nodes",s.length,{is_count:true});TS.metrics.store("inline_style_nodes",t.length,{is_count:true});TS.metrics.store("external_script_nodes",r.length,{is_count:true});TS.metrics.store("external_link_nodes",i.length,{is_count:true})};var t=1e4;var i=6e4;var n;var a;var r;var s;var o=function e(i){a=i;if(n)return;if(1e3*i>t){u(i);return}n=setTimeout(function(){n=void 0;TS.redux.socket.isConnected()||u(a)},t)};var l=function e(){return!$("#connection_div").hasClass("hidden")};var c=function e(t){if(!TS.boot_data.feature_degraded_send)return"";if(TS.interop.desktop.isDesktop){if(t)return TS.interop.i18n.t("Last updated {time_ago}\u2026 Press F6 to navigate to the status banner and click load new messages","ms")({time_ago:t});return TS.interop.i18n.t("Last updated less than a minute ago\u2026 Press F6 to navigate to the status banner and click load new messages","ms")()}if(TS.model.is_mac){if(t)return TS.interop.i18n.t("Last updated {time_ago}\u2026 Press Cmd + F6 to navigate to the status banner and click load new messages","ms")({time_ago:t});return TS.interop.i18n.t("Last updated less than a minute ago\u2026 Press Cmd + F6 to navigate to the status banner and click load new messages","ms")()}if(t)return TS.interop.i18n.t("Last updated {time_ago}\u2026 Press Ctrl + F6 to navigate to the status banner and click load new messages","ms")({time_ago:t});return TS.interop.i18n.t("Last updated less than a minute ago\u2026 Press Ctrl + F6 to navigate to the status banner and click load new messages","ms")()};var d=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;if(!TS.boot_data.feature_degraded_send)return;if(TS.interop.api.isPaused()&&l()){TS.info("Not showing reconnecting banner because API is paused and showing its own banner");return}if(s)return;r=Date.now();var a=function e(){if(TS.interop.api.isPaused()&&l())return;var t=void 0;var n=void 0;if(Date.now()-r>i){var a=r/1e3;var s=TS.interop.datetime.toTimeAgo(a);t=TS.interop.i18n.t('Last updated {time_ago}\u2026 <a onclick="TS.view.ms.manualSyncNow()" data-qa="connecting_banner_cta">Load new messages</a>',"ms")({time_ago:s});n=c(s)}else{t=TS.interop.i18n.t('Last updated less than a minute ago\u2026 <a onclick="TS.view.ms.manualSyncNow()" data-qa="connecting_banner_cta">Load new messages</a>',"ms")();n=c()}$("#connection_div").html(t).addClass("resync_banner").removeClass("hidden");TS.client.msg_pane.topMessagesBannerShown();n&&TS.ui.a11y.ariaLiveAnnounce(n,true)};s=setInterval(a,i);n=setTimeout(a,t)};var u=function e(t){_();if(TS.interop.api.isPaused()&&l()){TS.info("Not showing reconnecting banner because API is paused and showing its own banner");return}var i=TS.interop.i18n.t("Reconnecting...","ms")();var n=i;if(t){i=TS.interop.i18n.t("Reconnecting in {num_secs, plural, =1 {# second} other {# seconds...}}","ms")({num_secs:Math.max(0,t)});n=i;if(t>2){i+=' <a onclick="TS.client.manualReconnectNow()">'+TS.interop.i18n.t("Retry now?","ms")()+"</a>";TS.boot_data.feature_degraded_send&&(n=TS.interop.desktop.isDesktop?TS.interop.i18n.t("Reconnecting in {num_secs, plural, =1 {# second} other {# seconds...}}, or press F6 to navigate to the status banner and click retry now.","ms")({num_secs:Math.max(0,t)}):TS.model.is_mac?TS.interop.i18n.t("Reconnecting in {num_secs, plural, =1 {# second} other {# seconds...}}, or press Cmd + F6 to navigate to the status banner and click retry now.","ms")({num_secs:Math.max(0,t)}):TS.interop.i18n.t("Reconnecting in {num_secs, plural, =1 {# second} other {# seconds...}}, or press Ctrl + F6 to navigate to the status banner and click retry now.","ms")({num_secs:Math.max(0,t)}))}}$("#connection_div").html(i).removeClass("hidden resync_banner");TS.client.msg_pane.topMessagesBannerShown();n&&TS.ui.a11y.ariaLiveAnnounce(n,true)};var _=function e(){if(!n)return;clearTimeout(n);n=void 0};var m=function e(){if(!s)return;clearInterval(s);s=void 0}})()},3038:function(e,t){(function(){TS.registerModule("view.prefs",{onStart:function t(){TS.prefs.webapp_spellcheck_changed_sig.add(TS.view.prefs.toggleSpellcheck,TS.view.prefs);TS.prefs.emoji_mode_changed_sig.add(TS.view.prefs.farReachingDisplayPrefChanged,TS.view.prefs);TS.prefs.messages_theme_changed_sig.add(TS.ui.setThemeClasses,TS);TS.prefs.team_perms_pref_changed_sig.add(TS.view.prefs.teamPermsPrefChanged,TS.view.prefs);TS.prefs.display_real_names_override_changed_sig.add(TS.view.prefs.farReachingDisplayPrefChanged,TS.view.prefs);TS.prefs.team_display_real_names_changed_sig.add(TS.view.prefs.farReachingDisplayPrefChanged,TS.view.prefs);TS.prefs.time24_changed_sig.add(TS.view.prefs.time24PrefChanged,TS.view.prefs);TS.prefs.sidebar_theme_changed_sig.add(TS.view.prefs.sidebarThemePrefChanged,TS.view.prefs);TS.prefs.mentions_exclude_at_channels_changed_sig.add(TS.view.prefs.rebuildMentionOptions,TS.view.prefs);TS.prefs.mentions_exclude_at_user_groups_changed_sig.add(TS.view.prefs.rebuildMentionOptions,TS.view.prefs);TS.prefs.k_key_omnibox_auto_hide_count_changed_sig.add(e,TS.view.prefs);TS.prefs.team_display_email_addresses_changed_sig.add(TS.view.prefs.farReachingDisplayPrefChanged,TS.view.prefs);TS.prefs.hide_hex_swatch_changed_sig.add(TS.view.prefs.hideHexSwatchPrefChanged,TS.view.prefs)},toggleSpellcheck:function e(){var t='textarea, [contenteditable="true"]';$(t).attr("autocorrect","off");$(t).attr("autocomplete","off");TS.prefs.getPref("webapp_spellcheck")?$(t).attr("spellcheck",true):$(t).attr("spellcheck",false)},farReachingDisplayPrefChanged:function e(){TS.view.rebuildMentions();TS.view.rebuildStars();TS.view.files.throttledRebuildList();TS.view.members.updateUserDisplayName();TS.view.members.updateUserCurrentStatus();TS.client.msg_pane.displayTitle();TS.client.msg_pane.rebuildChannelMembersList();TS.view.rebuildPreviewedMember();TS.interop.members.shouldDisplayRealNames()?$("#col_channels").addClass("real_names"):$("#col_channels").removeClass("real_names");TS.model.previewed_file_id&&TS.client.ui.files.rebuildFilePreview(TS.files.getFileById(TS.model.previewed_file_id))},mutedChannelsChanged:function e(){TS.client.msg_pane.displayTitle()},teamPermsPrefChanged:function e(t){"who_can_edit_user_groups"!==t&&"who_can_create_delete_user_groups"!==t||TS.view.userGroupPrefUpdated();TS.view.checkIfInputShouldBeDisabledAndPopulate()},time24PrefChanged:function e(){TS.view.rebuildMentions();TS.view.rebuildStars();TS.view.files.throttledRebuildList();TS.model.previewed_file_id&&TS.client.ui.files.rebuildFilePreview(TS.files.getFileById(TS.model.previewed_file_id))},hideHexSwatchPrefChanged:function e(){TS.view.rebuildMentions();TS.view.rebuildStars();TS.model.previewed_file_id&&TS.client.ui.files.rebuildFilePreview(TS.files.getFileById(TS.model.previewed_file_id))},sidebarThemePrefChanged:function e(t){t=false!==t;if(TS.prefs.getPref("sidebar_theme")){if(TS.prefs.last_theme_selected_in_UI&&TS.prefs.getPref("sidebar_theme")!==TS.prefs.last_theme_selected_in_UI)return;if(TS.prefs.last_theme_selected_in_UI&&t){TS.sidebar_themes.setLastThemeSelectedInUI(null);TS.sidebar_themes.default_themes[TS.prefs.getPref("sidebar_theme")]&&TS.prefs.setPrefLocal("sidebar_theme_custom_values",JSON.stringify(TS.sidebar_themes.default_themes[TS.prefs.getPref("sidebar_theme")]))}"arctic_theme"===TS.prefs.getPref("sidebar_theme")&&TS.prefs.setPrefLocal("sidebar_theme","hoth_theme");var i=$("#client-ui");var n="sidebar_theme_";var a=i[0];var r=a.className.split(" ").filter(function(e){return 0!==e.lastIndexOf(n,0)});a.className=r.join(" ");i.addClass(n+TS.prefs.getPref("sidebar_theme"))}if("default"===TS.prefs.getPref("sidebar_theme")||"default_theme"===TS.prefs.getPref("sidebar_theme")||"basic_theme"===TS.prefs.getPref("sidebar_theme"))$("#sidebar_theme_css").remove();else if(TS.prefs.getPref("sidebar_theme_custom_values")){var s=JSON.parse(TS.prefs.getPref("sidebar_theme_custom_values"));TS.environment.supports_custom_scrollbar&&_.forEach(s,function(e,t){s[t+"_rgb"]=TS.utility.hex2rgb(e)});if(TS.boot_data.feature_tinyspeck&&!s.menu_bg&&s.nav_bar_bg){s.menu_bg=s.nav_bar_bg;TS.logError(new Error("Sidebar theme menu_bg undefined"),"TS: sidebar theme menu_bg falsey but nav_bar_bg defined","global_nav_menu_bg",true)}var o=TS.templates.sidebar_theme_css({theme:s});$("#sidebar_theme_css").length?$("#sidebar_theme_css").replaceWith(o):$("head").append(o)}TS.interop.desktop.refreshTileColors()},rebuildMentionOptions:function e(){var t;var i=TS.prefs.getPref("mentions_exclude_at_channels");var n=TS.prefs.getPref("mentions_exclude_at_user_groups");t=i&&n?TS.interop.i18n.t("mentions and reactions, no {at_label} or User Groups","prefs")({at_label:TS.templates.builders.atLabel("channel")}):!i&&n?TS.interop.i18n.t("mentions, reactions, and {at_label} mentions","prefs")({at_label:TS.templates.builders.atLabel("channel")}):i&&!n?TS.interop.i18n.t("mentions, reactions, and User Group mentions","prefs")():TS.interop.i18n.t("everything","prefs")();var a=TS.templates.mentions_options({include_text:t});$("#mentions_options").html(a);$(".mentions_filter_menu_target").click(TS.menu.startWithMentionsFilter)},userGroupPrefUpdated:function e(){var t=$("#user_group_edit.tab_action");var i=TS.permissions.members.canEditUserGroups();var n=TS.permissions.members.canCreateAndDeleteUserGroups();$('[data-action="admin_user_groups_modal"]').toggleClass("hidden",i);$('[data-action="admin_user_groups_modal_new"]').toggleClass("hidden",n);t.toggleClass("hidden",!(i||n))}});var e=function e(){if(TS.prefs.getPref("k_key_omnibox_auto_hide_count")===TS.ui.jumper.k_key_omnibox_auto_hide_count_max){TS.prefs.getPref("show_sidebar_quickswitcher_button")&&TS.redux.dispatch(TS.interop.redux.features.channelSidebar.setJumperCoachmarkState("HIDE_BUTTON_PENDING"));TS.interop.clog.track("QUICKSWITCHER_ACTION",{trigger:"keyboard_shortcut",action:"button_hidden",quickswitcher_session_id:TS.ui.jumper.getSessionId()})}}})()},3039:function(e,t){(function(){TS.registerModule("client.windows",{open_log:"WINDOWS OPENED:",win_became_key_sig:new signals.Signal,win_resigned_key_sig:new signals.Signal,win_crashed_sig:new signals.Signal,win_will_close_sig:new signals.Signal,win_began_loading_sig:new signals.Signal,win_estimated_progress_changed_sig:new signals.Signal,win_finished_loading_sig:new signals.Signal,onStart:function e(){TS.client.login_sig.add(TS.client.windows.onLogin);TS.ui.window_unloaded_sig.add(o);u=TS.utility.throttleFunc(d,2e3)},onLogin:function e(){var n;var a;var r=false;var s=TS.interop.desktop.listWindows()||"";TS.has_pri[g]&&TS.log(g,"listWindows windows_str:"+s);if(s){n=JSON.parse(s);TS.has_pri[g]&&TS.dir(g,n,"listWindows wins:");_.each(_.keys(n),function(e){t[e]=n[e];a=t[e];a.token=e;"screenhero"!==a.windowType&&"calls"!==a.windowType&&(r=true);a.no_spinner=true;i(a)})}if(r){p();return}var o=TS.storage.fetchClientWindows();var l=Object.keys(o).length;if(!l)return;var c=3e3;setTimeout(function(){var e=function e(){_.forOwn(o,function(e){TS.client.windows.openWindow(e)})};TS.generic_dialog.start({unique:"reopen_windows",title:TS.interop.i18n.t("You previously had {window_count} {window_count, plural, =1{window}other{windows}} open","client_window")({window_count:l}),body:TS.interop.i18n.t("Would you like to re-open {window_count, plural, =1{it}other{them}}?","client_window")({window_count:l}),show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Yes, re-open {window_count, plural, =1{it}other{them}} please","client_window")({window_count:l}),go_button_class:"btn_success",cancel_button_text:TS.interop.i18n.t("No thanks","client_window")(),onGo:_.once(function(){setTimeout(e,1e3)}),onCancel:function e(){TS.storage.storeClientWindows({})}})},c)},openFileWindow:function e(t,i){if(!TS.model.supports_spaces_in_windows)return false;var n=TS.files.getFileById(t);if(!n)return TS.files.fetchFileInfo(t).then(function(e){return a(e,i)});return a(n,i)},openWindow:function e(i){if(isNaN(i.x)||isNaN(i.y)||isNaN(i.width)||isNaN(i.height)){var n={x:0,y:0,w:1024,h:768};var a=m();TS.has_pri[g]&&TS.dir(g,a,"sizer_win");if(a){n.x=a.x;n.y=a.y;n.w=a.width;n.h=a.height}if(isNaN(i.width)||isNaN(i.height)){i.width=n.w;i.height=n.h}if(isNaN(i.x)||isNaN(i.y)){i.x=n.x+22;i.y=n.y+22}}if(!i.no_spinner){i.destination_url||i.url&&(i.destination_url=i.url);window.desktop&&(i.url="data:text/html;charset=utf-8,"+l(i))}TS.has_pri[g]&&TS.dir(g,i,"calling openWindow");var r=_.cloneDeep(i);r.url=r.url&&r.url.substr(0,100);TS.client.windows.open_log+="\n\n"+JSON.stringify(r,null,2);i.token=TS.interop.desktop.openWindow(i);t[i.token]=i;p(i.token);TS.has_pri[g]&&TS.log(g,"new window:"+i.token);window.last_win=i;return i.token},closeFileWindow:function e(t){var i=TS.client.windows.getWinByProp("file_id",t);if(!i)return;TS.interop.desktop.closeWindow(i.token)},getWinByToken:function e(i){return t[i]},getWinByProp:function e(i,n){if(!i)return null;var a=null;_.forOwn(t,function(e){if(e[i]==n){a=e;return false}});return a},distributeMsgToWins:function e(i){_.forOwn(t,function(e,t){if(!e)return;if("screenhero"!==e.windowType&&"calls"!==e.windowType)return;TS.utility.calls.isSupportedMessage(i.type)&&TS.ssb.distributeMsgToWin(t,i)})},closeAll:function e(){_.each(_.keys(t),function(e){TS.interop.desktop.closeWindow(e)})},windowWithTokenBecameKey:function e(t){TS.has_pri[g]&&TS.log(g,"windowWithTokenBecameKey token:"+t);var i=TS.client.windows.getWinByToken(t);if(!i){TS.error("windowWithTokenBecameKey: no win for token:"+t);return}p(i.token);TS.client.windows.win_became_key_sig.dispatch(t)},windowWithTokenResignedKey:function e(t){TS.has_pri[g]&&TS.log(g,"windowWithTokenResignedKey token:"+t);var i=TS.client.windows.getWinByToken(t);if(!i){TS.error("windowWithTokenResignedKey: no win for token:"+t);return}TS.client.windows.win_resigned_key_sig.dispatch(t)},windowWithTokenCrashed:function e(t){TS.has_pri[g]&&TS.log(g,"windowWithTokenCrashed token:"+t);TS.client.windows.win_crashed_sig.dispatch(t)},windowWithTokenWillClose:function e(i){TS.has_pri[g]&&TS.log(g,"windowWithTokenWillClose token:"+i);var n=TS.client.windows.getWinByToken(i);if(!n){TS.error("windowWithTokenWillClose: no win for token:"+i);return}delete t[i];p();TS.client.windows.win_will_close_sig.dispatch(i)},windowWithTokenBeganLoading:function e(t){TS.has_pri[g]&&TS.log(g,"windowWithTokenBeganLoading token:"+t);var i=TS.client.windows.getWinByToken(t);if(!i){TS.error("windowWithTokenBeganLoading: no win for token:"+t);return}TS.client.windows.win_began_loading_sig.dispatch(t)},windowWithTokenEstimatedProgressChanged:function e(t,i){TS.has_pri[g]&&TS.log(g,"windowWithTokenEstimatedProgressChanged token:"+t+" progress:"+i);var n=TS.client.windows.getWinByToken(t);if(!n){TS.error("windowWithTokenEstimatedProgressChanged: no win for token:"+t);return}TS.client.windows.win_estimated_progress_changed_sig.dispatch(t,i)},windowWithTokenDidChangeGeometry:function e(t){p(t)},windowWithTokenFinishedLoading:function e(t,n){TS.has_pri[g]&&TS.log(g,"windowWithTokenFinishedLoading token:"+t+" doc:"+n);var a=TS.client.windows.getWinByToken(t);if(!a){TS.error("windowWithTokenFinishedLoading: no win for token:"+t);return}a.document&&TS.warn("windowWithTokenFinishedLoading: win already has document? token:"+t);var r=function e(){i(a,n);TS.client.windows.win_finished_loading_sig.dispatch(t,n)};a.no_spinner?r():setTimeout(r,50)}});var e=true;var t={};var i=function e(t){n(t)};var n=function e(t){TS.has_pri[g]&&TS.log(g,"_setUpWindowForAtomSSB: win.token: "+t.token);TS.ssb.setUpAtomSSBWin(t)};var a=function t(i,n){if(!i&&!i.id)return;var a=i.id;if("space"!==i.mode&&"docs"!==i.mode)return false;var r=TS.client.windows.getWinByProp("file_id",a);if(r){TS.interop.desktop.focusWindow(r.token);return true}if(TS.boot_data&&TS.boot_data.feature_file_links_betterer&&TS.boot_data.page_needs_enterprise){var s=i.permalink.indexOf("?")>-1?"&":"?";n=(n?""+s+n.substr(1):s)+TS.getQsArgsForUrl()}else n=(n?"?"+n.substr(1):"?")+TS.getQsArgsForUrl();var o=TS.interop.rules.teams.getTeamDisplayName(TS.model.team);var l=_.unescape(i.title);var c=o?o+": "+l:l;r={file_id:a,title:c,destination_url:i.permalink+n,url:i.permalink+n,worth_saving:true};e&&(r.no_spinner=true);var d=TS.client.windows.openWindow(r);if(!d){TS.error("no window token!");return false}return d};var r=function e(t){var i=TS.client.windows.getWinByProp("window",t.currentTarget);if(!i){TS.warn("unknown win in _macSSBWinUnloaded");return}i.window=null;i.document=null};var s=function e(t){var i=TS.client.windows.getWinByProp("window",t.currentTarget);if(i)p(i.token);else{TS.warn("unknown win in _macSSBWinResized");p()}};var o=function e(){_.forOwn(t,function(e){if(!e.window)return;delete e.document.ssb_main.TS;e.window.removeEventListener("unload",r);e.window.removeEventListener("resize",s)});p()};var l=function e(t){var i="";var n="";var a;if(!t.skip_css)for(a=0;a<document.styleSheets.length;a+=1){if(!document.styleSheets[a])continue;if(document.styleSheets[a].cssRules)for(var r=0;r<document.styleSheets[a].cssRules.length;r+=1)i+=document.styleSheets[a].cssRules[r].cssText;else document.styleSheets[a].href&&(n+='<LINK href="'+document.styleSheets[a].href+'" rel="stylesheet" type="text/css">')}var s=t.destination_url?"document.location.href = '"+t.destination_url+"'":"";var o=TS.interop.i18n.t("Loading...","client_window")();var l="data:image/gif;base64,R0lGODlhUABQAPdqAOn38njO398JXN4GWarg6////7Xk7fP7++mmGvjI2mnI27Di0v326P7///XXmEi9lzC0ieiiD94DV/POgPTSjD65kaHd6Du4kDK1iupck/jjt+mnHffdp2TH2uARYJTYwvOfv+H0+GvJ2+Msc+ijE////jW2jP/+/d8NXje3jfSpxlLAnOEeaYnU4/768W/LrTq4j/WzzeU4e//+/4DRt/LJdNnx9vzi7OmoIOT18PrV47/o8G/L3u/BX27K3OAVYzO1i+v49P7//vzq8fDEaef2+ehTjHfOsu+9VWzJ3OtlmfD69v/+++IkbeikFv76/J/cyOyzO/3w9v/8/edJhvzy3OZAgPCNtMbq8f74+t/z7WTHp++Fru22RKngztLv5tfx6crs4eqqJc/u9MLp3Pf8/HLN4H/Q4WbH2u35+7jl11rEoYnVvO5+qZbZ5ve90+uvM/StyfGVuP789/n9/f3+/vv+/eqsKu1zovrpxkC7kvvu0uEZZu65TPz+/mzK3P70+C6ziP/9/vCKseEVZc7x5eAQY+qrIGrH2DpraOGmILmbHiaaieEVaCmihTUON27G0WWKKza+kV6AEla6wfFMim/O5r4UWtdDfr65beL3/qU8bdEfEf2hw8qCojemnm24p+cVZS+jkPKzOGWCEx+XgF6DHDq8kWWFHOF7GBqSfGWvluqvHvOwMPT3827I1UwPPTWui+uxIecPYWjK4uaXGT22kM0NC9ikIuigH+2pINwSTuMVZNMPJz6/lGXF0z2cgskKVz6qpZ+TGj1WXmaPOSSggrJYgekVZfGqIDSoh4CMG23J2d0UVTqJd9QKWdLDetcRO12/yj7DluWFSOWnIFC2uTcxSdUUYHUQSNlMFGmfZKURU8+hHm3EyvCoGucKXtQxEnvKx+I1aqyrU9wHTpHgxbqSpvFclOmpFemSWtknQzrAk9k1djS8j6jGotufE+HCbGPUrvJTj5Tc8NnCzOqtJ32Jj+yqc+6rjNMHWOJcWLzx3/CfkQAAAAAAACH/C05FVFNDQVBFMi4wAwEAAAAh+QQFFABqACwAAAAAUABQAAAI/wALCBxIsKDBgwgTKlzIsKHDhxAjSpxIsaLFixgzatzIsaPHjyBDihxJsqTJkyhTqlzJsqXLlzBjyrwoREuYMABEHghho0iDkV9eVEiR4gGNIB6LWAigQAGPFjZCkqkA5EKFChcwrMjBMUSADiJ8iEWjAMtHAA9SXF1bAcILji0UiJ3rQwSPIh0bQIHAti+YjA1ChKU7twMBjy9M9F2LwYvGHWgIz1XQwuMWtYupfnjcQbJYyh6PAMlcobHGMXI9d7CQdwHfxRcu/M1Y5kxquklERO24ZIXivhBo/DwNlq6IDgZAhnmAweoFGBC2LNn4E4uZDmjQdAiwQ6QWGg+srv+AcqCExzQ7CFjAcmA4yAZCloDR0j5kA/cz8+vfz7+///8ABijggAQWaOCBCCao4IIMNujggxBGKOGEFFbYoBQ3DCGSCxpMMAEHDIyUQAYjsNCEETF8pEEUJLRIghgOhBTDDxJ4YKMAAnDRkQYbOIHDjzggEAEFH93QBAo/JJmkBwOocIJGLkThI5A/boBDFeZxdMUASnaJggxPZHSCBiRQSSUJRHZkhABdtqmDRhOUaeaPTvTgERVstrlkAnDKOacTSHikBJd6JvlmRhz4aSYJNXikAqFtCmDFkxlVIYaVf2rg0RRUSNAmCk1yNEEEc0Zgp0cnDEHFADgKIEETIHQ4xEQNLSKAgBOmuhBSFiooQYURXNwAkgZEdBFFDxwwMdIMM5h0grIWRivttNRWa+212Gar7bYVBQQAIfkEBQUAAAAsDgARADQAMgAACP8AAQgcSLCgwYMICR4YI1BEwocQIwpscMBCgA4SER7JCPHAmQ5JfHAseEFPjpEI3XTwIRIlQSALhLgkGIIly5kDTbzAORDLyps8S57kuQONTYgFvAA5WKECEDU8AYwxevRhDj0VDDbF4EUmzgMBRNhsmfCFiaYAmqp9GhXAjg5/xvpQgHABBrVpmwptC8CAiA4K0HTg4WbHwSAPUqhVG+gDX4EhCLgpXKRBQjJ6MFyocCEFhCNlLD8G0EA0RDBHHlTQs8aLndE4l4DJQacE7Nu4c+vezbu379/AgwsfTry48ePIkytfzry58+fG52igMIEDgxPH83RxQoJEhDsUbCennHIjgY4ssPOIcYKjPQ4EESYg1HHFCh8UP2TImcKXSR/27rW3AQ57GETFDwOg4MEPP6AwgBLi8ZQHgAG2RwIFBXkwAIMcciiBHG05QIJ7BOHgRB8RHtQhCiOgx5MDEbSH0B4FPNThDzpEpQF7bTHoQQJRMQAHAlH5yMcNUZVABF8/CEAFXxoU2aQHb/AlJJEueSDAADJUidwALBgBAiDJZQDicjMgFxAAIfkEBQIADAAsDwARADIAMgAACP8AGQgcSLCgwYMIC7pJyLChQ4EHsAhEg+ZhwRcWE4awEKCiiIwEK8D4ArLgmD8dRPgoWRDDhwIsGRw4o2BlTIIw1vhh2QBLBx9ALZpAKJIkSwtogNpsuIChy5hIlT4E8AAGwhRr6LA08FNqwwZHElZIYRRkCJVKlzL4U9EgkIMVKmCA0oAlgQ5/0to0w0AiTIIXDMYFwiamHwIiOlDswKNvmr8Fj5iIyyCu5bl1Y4YgYMHCjjQMMh9Ug4Gy5bhkbw5sIJphmTVATseFEFY1SzArIMC4cCEFhC1BbMcEwGZFBT0roBwoITxmiQNatJRpTr269evYs2vfzr279+/gw4vyH0++vPnzGV1ooEBBgwvzGqKQmB8BDofxJTQgcIKjPw4EEdwXngtw8OdffwiIUUVDJUihww1PqFYCByQceCAJDiBUwBAqZNAEIXzIcEUWN9VQYX8E4eAEEswRNEQcHgoggAc/eICCBEZIEZOJKB604EBKNCHjQD8UWaQEeJzAkgMVJuQAEwL9wIAHBxnpAR86sLQHDhswBFlCRv4ggAox9YEAdUUOAEJMTDKUoUNGChCDICxVIUaXqlnJwhA3IeGEbUV6IAEXqr150w83snCFkjdVwWVJiE5pxSA3MDqeB1ZwoQOd5RnRRgJ0zjBDeV+OFxAAIfkEBQIASAAsDwARADIAMgAACP8AkQgcSLCgwYMIC1pAoiChw4cQkYwR2KFDxIJHLiI8MFEgGo0FYTwAAHJgEQsB0HwsaRDIApYhAnQQ4YPlQRMvCoCk0wKNj5oggSC8oCcHyDEdfgK96MWhS40NCCT9CTKHngoIceq8aMEnVY0FXiQkajRiHQNTlxr00TCol60QbShQ+nVgQx5IdiBpMLBsVrEX61hIq7ShmRY7ivA1CPggWSEXy7jpgEaBgqQtkBQpANfgAqEHKzzV6GeMmxZuDGyOCOABDIMVKmD4YHPv4ohCjpiIzZs3hqa1S6rBEBtJ7wopvgQH2SDIgxTHK0BovFyjGhO7Y1+AsMJv9Yh8yaz/gYFdDw2S31naAaOGTI4Gt9PLn0+/vv37+PPr38+/v80qFPTQwwR5+FeQA2JE4IQTJDhRwxwGIsEBCQjgYKGFEdRQgn8M3FHhhRZugEMV/k0IIogkOHBCfxOQcCFBODjRh0ZT6PBGAkPMUBIFLuJgkIh7PHSCDldY8YMAKLCAxxAanaCBEz4iRAFCMxBJxQ8DoPDDlh5IIMMQK0bU4QYJ9dEZElZiicQPa27p5gAZaFQCEQ8FOdCVA6x5kJtb6qCRBg9RsJUHeibE5wAqaMQAHAg4tKFGbgoAAkhEkJAQmSBF+oacTzo0JaQ/oDCCFCAt2uh3W6IgaUkFVJqeAAOMNRBDmCB1WpsHsCJhBAik2uQCoyXhigQfuyJxJktTYnoRH1TIccMMOlb3KEhX3BAhQifQ6l9AACH5BAUCABAALA8AEQAzADIAAAj/ACEIHEiwoMGDCAu6gSAiocOHEAViEYgGTUSDLy5G7KDRYAUYYDoKPDBGJEQMHzqGsBCgokmHKbbUuWjDTAcRPl5CMIHw45eIZc4o8JHz5YKHKSFiQUO06MsHMBCmWOMHIgGmRHUKOZLQJ0QLWJ06tCgSJUQDHZpCNANhYkEAMNfQeRgCp9qDPBamKYCQa08YPx8S6PCnaVYIPASmadAgoRA1Ds06bEDHgoIOFdO22KHz4NQyEW0QcOPGQJECfDXyBfI3zEXGnQWyPlhBcuyIqS94rACExu2OXCsMrECcN5vfFwuoAVK8eW3IyCMeWGHCeQUTa8qUiB4xjB4gF4hf/8DwIDD3iGBeXK/+Qsv5jkK0kCGjpfH7+/jzD9xDoUcPClXo9xAFG0TghBMR4ECBgAeVQEEEG+AgIQ4bkLAggwTtQeGEEyIgBgMnYAiBgwlyOCEJDogoEBEkTFiQE0ikxmAJLEp4kBgqQuBAgg7J2NEQCegwxEUabpAQEh0VMEQcGTTxgyFNKHFDRH044VAVIfa4pBJNQCCABx784MEATegAkQMkJBRBiggVIEUcXAowgAcC/WCnnQNYkcVDexziEBJZEiRFDHFCQKdBd/4wQBwPFVBlQn4WpMQIAhgKEZ54nPmQAzMM9IOlEd05QKYOnVAFhT3qJCoXgR5pJUI4dGd2JwoJQFQAmg6xKZKdHkigxEVViGFkQtt19OkAfLSx50VIvHrbpxD8QIUcN7R6ZpqyohCtFVfoIIggnXYU7LDGauuBFVzoMMVtE0AQa0ceyMBFAoL4qJO9F7WRwBMQoJajQf7+C0FAACH5BAUCAAQALA4AEQA0ADEAAAj/AAkIHEiwoMGDCA1aCKAgocOHEAeOEdihQ8SDR4Rc3MiR4AU9WjqK5OilQYGTKFOmPDBx5EaVME+GWIgGjcuBQCro3Knzo5aYKcfw6CDCx00CGh9CAXoyDUMfRo8K1MOzqoktTAsY6AA16tECLxyCZNpCQdezaNP6aDhyacwGZbtu5OFmxwGYOR5ifesGjdyHXh2GTVgBDNCtaA9GLVLgYYEFSoGWOeMXrYIOPFoYkGpwb8wQZzooEHH5TwuBJrO+PWKialXDQA8YaHFGc4gGnB1CSc10Bm/VqgE4vJo099EKF74AX768+MEKJtwynw40yIMLrnUCYUO9e0zW2StA/5DuvbyanNlNhPnNvIoDIkQo7Jm+ZEXrqkC21PHuQEwEEiREgAAFJzBHRgVAYIccBCv81J0DTiCAw4Q4bBDBBNN98QJ0JuhBQw7dncDAHRJSOOEGYlQxnR9akBEGiOU5QIKJJpLgQHcNsEddDTPSOKETSJQnZAE1OOHjiSmWMCR1J3Awo3FSVSHGBg4VuCR1SDiREA6cTaFDDDHoIEhWHECkpHcn6DCIFT8IIMAPVCTAlJQO9dHdDDpcQcUPA6Dww59t8vEGUz2Q4NB8y+W55wBvAuooCiNIERMTZR51gxyL+unopn8OoIKVKlVhT51npnTCpVQQwiinrP4pAB6EOnrEpUFGqNpoq62+CqpKlSZEQWMDeTAArsR2egVQJYz4UAmc/enBDzpk1YNDVDaLwgBtqNYrQhRIJcAATYAAnLIOAcuRBwKxYAQIki43LZQC8bHuDd1te9O3fFAhB73ljYiAS9/Cue8J8HL0gxVXRHsCwQVfNIiYDT8UEAAh+QQFAgAaACwPABEAMwAxAAAI/wA1CBxIsKDBgwgLutEgIqHDhxAFYhGIBk3EghheNLjIsePACim+eBzJ8UMBkigdrrHz8MCYgR1S0khYAUaYhCEsBLCYcqAahxg+HGwwRkQHET56DgTw4ALCFGvKGCzCQ4GPpEoHHgGS0KZBAh2uYu34h2fBnw7ZGGyB9CrHJBbNaJhYMMjDqAVbWHUbEQ2PuQ6POExxk6AbNGIh8liYRsPJhGpMJASiluCOsIkPyt2RZmNEu04PwlghdSCdFpjFYk26Q0MJj0JocEVoorDABmlQo1GgIKzAIo9RSkZIObhAOljctHBjIIRxlEs0wEA4+gDCBp6zCpSdsLYQ7Q/rkP8ZfhBCZY4lqlAgQsQBg4vRu6448DpiCQobIpAgEeEOByYRcXdQBSaQwdEEEWyAw4I4IEACBxGNh1AFGJz3UB4bKMjgggjA8V5E0xVUAYEvRDQDghtu+GCAJowo0IgjAkHDdxAh4QSDBOHgRA8RAlGBBjDCCMECF9m44EF3fOiQH1tgEOSIJqwQH0QUkIBDQv9BBMYDGFww4gVA6CHSRXkgcKVSORyhRwom6PGCFtlBxEQXCCR0h2P2ARBGGDmMVMAED0EI3kN7mOnQcyg9kYAcV8QxREElnNBFQjiIkVUCbcjgwQADCMCCHCcUVOVDiEIkSAJcaDoAChr84KoHErTUQdAJeyiYEBIdTYGqFR4Y5OqrKCQgyECS1omQGFVANIUGXPCqAasH/frDAEoQVAAFDpHg0Ak6DOJsRL+iYEVBe5yJEBLPFaDDFVb88CxH4VJhUB8OIVsQFe5C29Gv1IZKELYOOTDorwLEUFAB5TqErnb5SoBHfQXRS2kVEKPUqwAjgDDsQQAnJHBPAmigRBxSOFSFuYMK1EQGjkL0msRZ9aoBCxmoMIS/F32ckswsGAGCBoLM4FF6OGwwksx8+JyyR4RQIccNQZe69EFX4DmD0FMfFBAAIfkEBQIAEwAsDgARADQAMQAACP8AJwgcSLCgwYMIDVpIyLChQ4JlxjxkCGFCgYkHywxUgAYjwgpgPArUKHIilAYTSU5QUPLhFiENVU7o2FLgEYYXQmaUeGZmTYINFlCEYrAIgQBoaP4smENPwxkEbQTooMDH0oMlJphImHPggTNofFit6YPlQaEMPww00EHsWI9lJ/CYsGMCyoENADCEMcGOXTdhxYrsYKZF3Z8XvghsUVXwRB8tJhR5uABIQgxqGwB269CqgSIXJ+pNmGJNHbodknA+mGSCAbslCxzZihDGlwZfA7sdK0JgiLs/LSPE7HuqAhEiOojo2Rd4FQc1iDiogjHIhAsIS9Oxe4BAiwAtCIT/8NMA+AQHYiKQWC/GAcbZCfmGnjCDjp3y5s9HQICjPw4EEbjnUANqCHcQcQ6VUIUY/PnXHwJ3MPCQdaStQcd8CVFAgoMOksDBCQ/dFF8YDxGxYX8E4eAEEhOpkcJVE5iIYkEbiEHdQw9UKBNCGuKAUAQeGVhQBSmQ2NAeOGyQEIsPqUGbQRUAoVZDJfTBkI0PLfEAdkNGSQOM52GYEA1AVFCBQGaaCQQbDyGp5FVkYJDmnFGSkVVDBfThREJiPFQCHWuYQGcFGGyxnUMnCJiQog198QAGF5h5AQQr6ESQIDqoAMIbgKT4JkJ3OqTFEXqkAIMeNORA0Ak6XGHFDwII/4DCCCpYlGdCn2KUQxhhUGhRq1T8MAEKPxT7AwoDXCEQo2AOVIAOcgQ7gQAEGfuDBx4kMEMVSSZkpUfPRisstQdZOwAeFiGxJ0I+gtjQCTdEy8e0DhkrABUTlMBsQUAyVEC8RsxL7kPGokAFiDd6exC8IAQ8rQciGTuAEgMxeVB/exjksAAQtyRxDAPtWxAFB3X807ESUDzQggx92+wEHggwQBNXTFGQxQjtIWZNMrOQgQpDHCQyQSRfNQALRoAwhLsI9fmyQMJOwEfSNzh0Ec5XRf0DFXLcIAhUE3EA47ETbC2HDgXsjOcETpdE9g9WXIH20x55YAUXOpygNt0JcQiRgCC28o1QQAAh+QQFAgAEACwOABEANAAxAAAI/wAJCBxIsKDBgwgNuknIsKFDggewPJxIseCBgWg6VDyY4stGAhc/PvxQYGJIAmhEOlxjp+FJAhpVCjSREMYXIQdDBoApc2AJNQwxfLA4xkLPhAAewGBIR6ANCwHQoBFx9GADAkBqhpmxI6MIH0f/SD2oBkPDEAq+glWZROrOMQRKbmyhwIfdijx4iCUQwA2WlxtTSDNjd21DHpYsSbVE7+/VhkATAhFG+O5hAqu2LSMXbw/FIAxhMGLGozBDWpC2LYL3LVkEBBRKUMx6UI8xSpUNF+RBYEefCN906cKBY0MEBxRp1o4lrHRhuwoI+GhBoEgBDk50bSDOHcEdBg4bLP8hsPRgBVs80ChY3yEJAQPWCxQoQYQE9/s4SHCYSIP2wQtqGNDCGW4YEEID8slFQB9OcEcQDk708JCCCJnAhkANZIgQg8QZtAFF49W0wgGyMTSBfQxRmBANDKVAhkN5IIBDQhI+RIZyB2U1Q0NzdOFEQt+d8NAKIgJ20AQMkVCRWRW+2FAe29FYIkMNOLmiQyd00RB4Q5ZnEAwrhGhiQxwwcVQFJliJ0I4yVkVACghVAAQbODHEhJZVHbCClwNVUEEKWxz0RAJXtCGHDgSkk1AE+z3EBgZ+CuSnnya8UCcBg7YhAwoDdNqIESQckqKNJkxqqpzmECBIApp6MAAKP8T/+oMHAoSDgKg90bFGqZPq4cs0etTDhRUeGCTrD41Eo40suMoUhh5AVPArDMAQswkyBKCAkKyG7BLOjAghQREY8rgDTCLXPMINCsUyFCshhvRSS7MFiRGXQwXowMUm3GTDDTahPCQrH9HMi5CSDM2gwxVU/CAAOLPMgkzAAsdqyDiH0FsQElMOlC/DPwgUMgGE8MILRbJKcEWNB31YhUENi3zUD5waIQgBETDkQMcyH+WqACPI8UQJe4DrJkUCEKBEDFIQ1EdDVQjppgBNEBDHQVLrfHQGKtybkNFHE9AuCwIN4ZBsT4ctEB9GgBBXATPs6BByVSXNh0A3yAT2RkkTEUCFHGp/FPIVXgdeEaKGNxQQACH5BAUCAAYALA4AEQA0ADEAAAj/AA0IHEiwoMGDCA1aSMiwocOCYx5KnFiwzEAFaCgavFABjEYDFj8+hDIxpAEFIh1uKdDQpIGMKQUCSdiRpUGTGGMObLCgIUmCLnUezKHnQsItDUBGPCmRBw+KBV6YSKiHDIEALx/ysGTJKdeCPgx0OLhg6kE9yoTRShLWoVNQ24oV2waqqw8FHZ5iMZB0YIEcCPUAUcXIx1O3kLaRIoVqsalttJ7uSNNwZkE9xlSpmshDMWNUpkyhWpYpjZ++CXsatFVKs0RLoBiHRmVgWDcErRg8BGAABkE9rF0fZmhp26TRw3DpMpBMFwkOE80ODK5ZWsOM22zrSmYAh0AcTnpM/7Q8ELPmzWaGCxRhQMQZA5qQfPvWveAGA1UcFghiwGj5WOcxkgQPPvjA3h9nEBBCHQJREIF3Qh1hEFrnUcJDBwokaIMfBe2xAYQIleCQEAZI919mwrRAgA102FQQEw7l5xB/Z+lhwhpluIgQBQ7N8JCECV3whUN74HAfQkhIpAZDGHyAGkIF9MGQGFXoeFBSDySUwhp0OMRjQk44MJ6WYRBpZEJIWHlQAUsmBMEH+knJkIwOPeDfQTiKyJCYe6qp0QUplMlQCVXIIsshQpXYkJ8CCaIDCPukUsshiB6kZ0INLMEQDCsEZUABOhhgxQ8D9HLLLdpsUOlAJPDpEA00Bf9K4qc6XEHFDwag8AMhzZx6SziUGnQppgxV4I45oMpxqwECEPTDD6aemoosKS2xgm8DVSCQL8Dcs2yzCfnKyZEFDZsQDUBou60BiVzzSDbgNMSruJMWJKdDZLgzjS8EPeJvNrPwwtCuBviay6rf7THiAau06+/D/mIjsLwF/ypSATeAMA83EEPMDTIPzYsqtQbdS9AJQ4BgBAu5IsMNLBDD8rFEhBjyq6oIKVxQBiwb4MFAyPDCDTfZXIINyA55IIAAI+xzcEIUqPmzQaEgY3UoEzPUbBMZxAEIA/YkhIAB5iZqwAAsZKDCEAQlydAejH6EthEgIAQdQ1+mhKsBfNBLfUNDYphd0N58UCHH34saIJ7gA/1geKifxk3Q3UKhYMAPVlyhg48alcDAHWOLZLkHVgxigCA6lT3Rz22czrhIbSQwxQwnnPA6QwEBACH5BAUCAAAALA4AEQAzADEAAAj/AAEIHEiwoMGDCBEqSMiwocOCHTo8LIgBQIOJBw8MjIjRYAUTXzoK1Cjy4QchE0kCQFPS4Ro6DVUCkNgSAA2GKcIgVMlyIA9Llnj8tPSwgBqGQNgQvMiQB4BV24oV2+YtqMMgDxLCWFOmBE+EPCAVI0UWFSlUq8w4FEIDyEE9ekx4eSh0LKq7d8muIirwz0qDRw3qieVI1ScAIhpaWnUWL15SkV7xQINGLYAyBZcAgEFQjzJVqgQicmjJLl4AeCftBYBFZkEaJgYOBh0aAKWGPJgVc5yxQIGEQsjEFqjHGO2JTu0WXITrGwAXDjVfEGir1HHRirdNMiVwUTeBunA4/9FQwmFb6tZBD7zNkBaoZQJxGCRB5KFw9NcBHPZRcOGfFgDkEAUAyRyEABwMRLcCZ8XlB8BoAi0kQgsGWCRQDSQwpMFDNwEQF221ETQhACHUUVAeTiREn0MFkCFbLCCGdphAfhxUwhxRIIDQgQnGtCBxJjhSypDG6JGGQxNE0NBvDNWhlGx6yJaCiwyVkAcC8h20okNUIgQEDUwmhKOOCN3RY0JeraDVCppVOUFDHDz0JEImkIESQ1dmeVAPa4WRQkIYdMjQHF2QeZCZDh3wI0IPLBEmQm/KIqmkhxAUp0NzegRAYAkxsQcOqWgjaioAsDIQnw75yRAN5SH0RAJtcP9yy6yzclJLpQAgylABmCV0wQNBGDQFrDJ4AEA0AtE6660CXdoQG27RqQaTw3JR7ECN7DKQsuHIIlAPjx5UgKoISULDCQBwYYWxKDCkLLMAnJlQGWv8qWkimMwCQLsOKZuKtwA4yxAbFQ1UAUGPcINMQ9omS2sqpgKAxENhnJLQI9l4QAhDPxBEay64moluQiNfDAsAvDDUSC8O36JNxABEIPBBV1SSDUKPPAJLyhPVWosYBCERriA3yEFFyuBwkzPCOWO8cEPt3sKJNtXgOpAYVRRkRMcAdMxLKLA0LXbOl4QyUSq1yAIzQQ4YxLVAvCBzydhNK9yQEjFIscchVhd05ITQDsmdjdiwcIPNQQIIFEdBfTCE9UNmcyO54aFsXFAGKohLQUNtT4RMKI3wkrKxArAg0BCClFzQpyrWNJARIGDUuOsM3SCIIDNMtDntBFEhBwDhPjRDFThs4HrHVwAwQ+41Bd8RFwCozntJ0APv2/QPBQQAIfkEBQIAAQAsDwARADMAMgAACP8AAwgcSLCgwYMID4pIyLChw4Jo0DwsCCFAgYkHywxUIBGjQRhgPAZoQEfgGVq0RDK86BHUtmLFtnnjwUNlQRgB/DTUKPDXNlKTTKEiRWqVpZoNj5hIeOELQp4BFAT4s20SKVRYsRZFynABQwwfCLI0aGnV1axaSUWCxBVhjgA4D6bIWQCq1IKWfp7FGgBVgKKWGjZQmtCWV4Y0i50t6HebwQ4GDw/Uo8fWQGEOeRTja9CvN4GQBR4YGwBAgAsC9cRyVIpgEsR5rz5Mk/BIamWqVIm0BMpvQnIjGzBUA0R1bt0imSEcNpCBQ9MBSh03uNDjMFwCkwUgwYE0wiOBjiP/tylQl0EnPR6qwT29IGaErwOE6CIQh8ENdwKUaBjElviGC/1xhkB+CDdBQxw8dMR/CSkwoA3BEYRAQuh5d5AaxjBI0HsMMUEfQvg9tMQDGYqXm0APBDCDQyQ0tB9DDdBggjKlSFeKI7FYBkMYDZ2wR0PpPVRcALakYAtlA7HhkIdOJCRGFYKNmJoeBx3QkIUFtfgQDQ5hSdCPDCHhUB1kLJWQkgyVcEIATQZwiCyyHMJKnAFA2dCIqCG0wgEvJkRBm7mkok044aRSSzoBrNkQlwyRcWUAuQh0y6SUcpLKRGUyxEYdCQHyhhIGUTrppUzcyRAMKyxhkKd4jICCAAhR/xqOA1s2RIZwAbDqKkHNHCRqFII4lOlBp7jDxhMJtPqqBxNReqlDB6wQV2rTEOkMMe2gEACzHjlLq5ACVRvAteQRNCknEWAkibXEHITMDypNqg0rONiZkBBZANNuQtg0REg0BU0aTi6HkPDtQVMkwIUMDT3CTSjdWurmQIoOVIDCVjA7S8PZIONRKjiwQpB9BWUsgLYBhAJvQo/AAvFB2qLA8MR0GlTqQLASBG82CD3ySDa8GDQACiPgkcAMDMjCUB8OIXOJzwT57HPHBRX9RhYqztAnQjiA2RAsUoft8yUbCzCCEm8AYlAJB5cbytNi+8wNOE0oEYMUBRSwokFViFJBoX5NXwK21LBwg04cUkwkZrkDIeNBMNxwc4wKQ+TtpUFt2+QBrCwYAcIQdXDq0UV+q7S5AHx4fkPejJPHBxUgrN4643LcsObes5N3QsW5TxQQACH5BAUCAAAALA4AEQA0ADIAAAj/AAEIHEiwoMGDCBEqSMiwocE5Gogg6UGBQYMyWAR26ODwIAYADToKZICEBIlvJCIsemdJZMMUYUS66EMimaJFw1CZmgSqpcuEbEQ6gIdTpylUqEgV88Hj58EUAMowDImFHClTR5ECQEqqZ0c2HxHCDGnwwMBfWJGiMrjNUtOpZEwkBBJ0IFmCf5gVI7W2INJirzouWZEQxgqpZgWiKWhpG9++BkF1LEADiEE9Ak14aWgJFF+RSQAsNkgGqkDMA40B+NSQB6RICZW++iM6gIUxZe4CKHFgBQw9emwBUE0QEUMfHUEFADAmMcKgsYyVckqQFMNMAAoU0G0wjCNVqqgP/3x9cJEiAKPmdMRSCjzCUsZ/LgKQDIAuAE40OPTT4lN48aINtAguB5FQg0NFmEHJfwixhhByO+QwCgA4HIQAHC4UwJANfyDCiEsL+dACAEVoB8CBCeXXUBF/mCFMQ9YIlEQLBhTRgIkC6ZeQgQ35cQYPCzLEmgEhcCdQAXNEkdCFLjSERQceMliQIxVk11ANTqSogYYJ1WEALf6BJ2WVKZDR0Ax5ZIlQBChOZYM4qpRSiiOxVEkQDQ4liQBCTJbQUAFlrCDXUwAs0dAJDanY0QdhHQSEGg6ladAhrMiSTg1MOFRAGDDMhWdDeg7ECoWpaGOqHDc4ZMcaph30wBJcJv80AQmjVggAJ7fkeks5LKgww1SMJmQCpAxlCkAttxaUay+GCBBHQ1+0ehANQiQ0RQJchMPQLT+gMIIUDNHBakIPBGHQFDpwYYUhA/SybTSNCBBDQx8w9CiXgugwiBUeELRLQ700MoAc0HZ6EGY0FKDDFVb8MAAKTt3iwQAg9LhGQRX4AoAewCSCCS8AQIyQuwndEo0hCQhCb1gac5yIS41se0svVKgMLTsA+NLxQf0CqGsCxiZUAB2rvIzQIw41QrKynGgTgY4IFXCDHJUASFDMBmmTSi6W9uBnQSfcAIIRfAAAziUOheKStrkAwMohAt3BgEFkDyBAv7yAzNAjlyDOwzMAAowgELIIcRCrQAP0LJDee3PjN0ECCNBEBnEMsQfcCfVgNUGPZEPQACxkoMIQ2RVwQhd7IiT31wnxonZCj8DyDOhGgEC6QRQ0xEFHyHBzdOy1pyrQrwXtYWuBRIh0ySNID8T8NYmAYqRBJfSx+UC8ZMP884kAcwo7hYiU+/XdBvMI9MDoMc0pGEAhEqLHO9Vt4lYMksAR7KQARAorqFGtSKyjDgqs0AYdCKIBfgCAFtSwgDA453oOaUMCnjCDEyAKguKZwQxwhEGXBAQAIfkEBQIAAQAsDAAOADgANwAACP8AAwgcSLCgwYMEmbhwgbChw4cQA7ig0AUOnB4aImrcaHBPlAhOECAg4aTGiYINynBcWdBFFCc4YsbcEIHCQJUBzohgyfKEgwgyZer61srVmJwK0PAkCCFAgYhIYMbUlSyZogDDQNFaivACGIgnoiCgGqCawGUCt3FtCEUIxD7frgpEFcCUwEje1ho0scVtwwINMg1Di3AVyyMmGsL48tSgSgJnQE2C6GNjgQVAHH4g+NQG0gC0XjkkFQnSyhwPGqZYMyMAHc9nFLA0zFEIYoMVBNpSk1MvwcodHi7AMDD3QEcBhEFkVowUQlSovPFQ0IGHGywH/gJ4cEFgd+S/fa//shRgRxqNRzKDNygtIt2G5NI0aND4YRFxqvT6KHZwGK4ArTCwERY8tOcQI0msNEwAugSQTAAkcBBRAzaIkIQZEBmI0FYCDdPNQU70oFELClRmzUPKGbTTTgaE0IWDB21wBwMlODRDGjz44AMPv5Ty0E4C7SQbASHYMd8EDkUIkQ1J6FjZJw9RIpACZxBggx0CNSBQHhs0FCJEITjpgxknOqSclXQgdEIXTiAko4AO0aGTjjz6iJAxqUFEAQkNRVhjQzPs0IGTGCJkSwAXhPEQE3t0iZATSEDkhwUdlEhmAPkZE8ChBLEBERNsuilGFfUhFOgZPOToiDKcFgRDADg1/1SCTX1KGJEfaRThBw2JIZRCGH41tAcCB8kSQC3UKEEFFXjoIAhEavSKkKeL9tGmQLKwkotAnNxSDgooSODBIBAtwV1DKxzwZ0M2GbutQdE08sMPHgwgx0MF0JBZQ4o+VEUAqThEyLw/oNDEEA+RIe1BbJRaECBv4MHJQ80MPK8AMZzU0BIrvIpQugZBjMcIAgQQTUQE2wsRDQ6ZQMZAWUQ8AgoBeCBQMxAR/MMAIECkMEKnSMLGEwngIQPNNq9U8bwe6FDuCgXpMc2mzhBz9EMnPySvBEZEVAcbmekhUAVVb0QIzg+hMAAVN2hEhiQBkE3MQcj4Ng4IWWgkRBbAzP+NECwQEZI1Qqk4oNEUOrRhRUR1N0RIQ4cEwEofDheEOBdW2DwLNxA1HpE2AeAgi7ECibGHQ5kHgMIPAYTC+kPY8HIQzQHIINC7Bzmg8UECvC6Q7zyNoMQbgDAgCw4N9eHbQaEMJEATSsQAiEAzlBBVQzjsUXlDP2Dz0CMBPK9EHFLk7lAEhq+UjUOPHBMHwk5VXoUYXorIETKcN6QMtQ4VEOnyAuHFDwBXkFhMYxqSWIOWHpI+AHoAHOsTiDKm5osKVCAFW4DIU+jnm5L9oBKeUIYvpuELPVjQghhgmQaXx7p7NYAOWzDBCU94ARP0C4AOGYQOSlCAHgYgDDCQIQ0xA/GBOuDwL5XTEhlWgIEmYqACUPDDEZdyADV8gA1e0MJ8priU+fTwi2AMoxjHOMaAAAAh+QQFBQAhACwKAAsAPQA9AAAI/wBDCBxIsKDBgwWZuGBSAqHDhxAjEizBYEIXOFGI5JHIsSPEPHciOEGAgAQCBx5TqqxyxwmOly83RNCgsqbEGhFg6nTShaHNnwVLzImCQKdOBBsJFjgAtCaDOxteFsRBYsJApm4CNFXpAk5RhKOWCAyAZmtBDCEaRCRCAgfEDmYPpggD8YQGlwMVCUQVNyKbAhBdtCpoKgTfEMVe9TWYYg2dhyXK7HUIqikNIA7nImRqIcSqxQaFkDHxkE3BA2NCaIULKdLhg4mBLlmRAiGMFZJRqy6bsrJBBRwbXDaoR6AJL6r7igiB5kzH0QOLDzQW4lPE1q8LkioG6Q8aNAEs2P8oA1ji7IG2QlAniGgrqDMWxpRpoNYjGwjqEVKSSMrhsExMlddRA2XYYNYrkRB02CKKIDCKCyk1YIMFASgA10OltOcRg8mEoEsITtDkkQUdlOWDRPsh5N1AHBpEQg0eGdCBDzQKlKJD1v0WAg9u7ADAKB4ehAAcLgj4UBpmiFCjQIgwApGGIQDnQ49pFGAljA6FyNEYMy4pkDAQWSOQDy3sUEQBapWnAQIOkUAERzug4aWNEH3ihgFnIjQUm0ISKREWctJ4IpNOIuRICEFEVIMTWYoIURE+JCEoQWAeVEEIJpAB0Qx58HmQmxyRKOiSNx4q3UA0RLQnQkMyINEBbnT/oEASSYjQgQhnxBLLpYyFINZDJ1jVaAhPJNBGBka0kYBBdBjQghlmnEGADQV88BAQahh5UB6MTsUKiOoMIgMKAwggwAAo4DGFQX4ckMZjaYVRm0OpQrRqCDiwIksItQw0QAg/BCywBHhIRMca8x70wBLaGmTVt26FEA5CAv/ggQfLQlTHB2g5pAZEJeyBQL8TH9TIQBUPwIVEYcDwEA1COCSIDlyU7FDAKAcsgBISlYEwQhc8kGhBM+gwiBUn9+KRwAMULBHHDmE7UNFXUPFDCCh0dLJATIMgSERCfOHyQXq4Q0MBOshhdQgCAKVzE0NwZMfPA1XgSwi+AJMIJnyw/+2Q0hL9gIIETbzRUbVo8Zp3IlrvEpEhWMvQxg0pfXEK3nof5AEhTY2ARwJZqNQAHaswjtAjETUCOGgF3ADCPBKF8tDWB+XCSjo9eNQ6CEawEAI4l0Qk+82QCzSx7d8O5CpHGfgugAch8CLRJchoLtAIAvWLr0EcMMHRANAPJL1NAzSRQRxD7HHIIQiRkDtoBcGCzPgDsJCBCkOcEIKVfTwkRhU/4cX4HAKLYISABUYAwQ0EoT+CUOAhJOAA/AqyiU5QziF7iNin9mcT6QXPIY44gkT6N0GBDJAgwCiOL/SQg4g8sIQnDEEKCVIBDCygLtsDTdY8YAUZ2uJuvBJIBXpM8IKINESHMuBCAqbwtYTVrQJB+1UJD6KsJxAEChgIYggqwMXbSHGKU5tBaLQARS5ycYtD3AIYPfICIJjxjRC44Ro5ooUHuNGMF4CACOfYETBswQQYAAIGLsCGMhyRj0akQxg+wAYvgAGRolNLA6xEyUpa8pKYxGRAAAAh+QQFMgAgACwGAAgAQwBDAAAI/wBBCBxIsKDBgwhLzGGCsKHDhxAhunDQB06XGntORNzIsWOVKCScIEAQAYGDjihTGnQBEodLlxtIcFBJEyWFCC9zIogyp6ZPiH2c5MzpRMPPowddwEHgsiAOEjWQSh3IpIvQgwjguCgw1WCDHF++LNlYgAgJHAiLGiwDIkQarjXBHNEDAwYINmMhariKsEYJgWwtgPAhAoSbmmH0YBgIA8KaIA//QnSF8E8HEWNSLllhwiCEI0IgRoWIJslBBWbShN5Yx4vDL5EbLuNoAOWRxQg/RBxVEBUIUyBQRYLkEI0bPxyFvOjc0I7DAs67bsR90C5CtgRAgArukIfD7B3VAP9piEE3wTI2QJwBgQYEIhCkGg5HKOJPCJQAHlg3mGINHRBsqQdCB0gVtkMDKR1xUAUCpbCAegpI9ceAAWBBk3gDMTiQIyAIA9ErDgnnjXcdmOEGFgfUFMQDBXFIUGE/rWLJiW/BVRMNArkoHQizvYUUHfchVQxBwAmECwitMPDTfwSs98tDjKQ0DC66gICWTDWF0CQaBILgXU0+RCjQMN0c5AQRNO0gwmUFWfOQhwgl0YIBIUQBQjIHbXCHkihhgYYIPvhgUCkcFabAnCHUAQITEziEZUd0nKFAoAd98hAlAilwhgE2IIegQHk40ZATPXTUgA2TUmqQmw+1QIANdnz/SlAJDDWkJ58b+RmooAcRipAxtqT40AQkNCSTjRCNgQalvBZkaUMwhPEQsmaWetAJGhVUhA9/7HoQqwNdUBAbij5kFUJ6gpAtCEPEoYQVVigRA0ENWNDBrviypwAPoihjS3UgCNsQtQalM5MUMSjRhAACoIDCAAIoAchAB7RwWaAioIFGABaMUQcbGOiBkAlkRISAQYfIAkIt1OCxsAAe/CDzzBIocR4BARAWwIkHICgEGczRVEBVA6UsUCoDlWOIQTP/4EECBZURQggCD7TZfgatsJETKuciECcQNT0AFx2xMV5DJT8HQi5Ig30QIQfNPAAeHQE9bUNZvIGH2w01/9MI0zIP0AZHJRywAtYG5UXQE3rLgIIA0ag0swDzlu1Q0CBkkQAejhO0C0RwFySzBFZk0VEBdh90yl1TJNBG5ygc9cPDVuiQkuFY6zENCLY4Q0w7HkgQO0KRczSAB1bI8QRNZoMgsvO+cxT6Q7EjD4IO66oUhiQgMEjMQbz88NM4gwsCwgwz1FTAE8B8XxMhxe9YkCA6cGFFRMg4NP1BKiMhmUr0G4QVxLeR/DWEEMMDgTYEIguVDaQKNaGC+FBAQGxABBu8+IkDCAaRN/ABBAQ8igBAIC9AVIEVo+pDSobgk2yETyACaAII4iCFgpwMIWjJHkTkcEALOuQR+hBIBv9UMIQCIIuDBTlJRzLwk2Owq1wHgSBaEEKE/0XECA35QSgiIiuVkMBaHRlhFhGyO3Y8AABdPIgSETIBK0KkcgjxgEF8UZCzqU0MDckDSmaARYT8gAoCOcXuDgKaaVEABBswCJpQwhUsDmAgyBuEDqCzBofoIQcQKcEERCUQEpBgkSqZwryMkAEu2I4g5lkQEB4UkTxEpQtEMIpPjGhEbBGkAF+AgYYKUgETKCgiJXCj/ATihzWkYEH9ic4wafIBDOyyexWoAAzWAMVlpgQMuoymNqOJARxZkyYNeIEzt1mBC5hAWt+kiRYeMM5owiAQH1hNOlUChi2YAAMYAIIeoJAdxnmihA5hgAIUFgAAfyKlAQ2gpUIXytCGOpSWAQEAIfkEBQUAAAAsBgAIAEMAQwAACP8ACwgcSLCgwYMImQBYyLChw4cQI0qcKJEBhYVRiORByLGjx48c90SJwJCEEwogU6pUySBiBA4nKMqcSZOmkyguVurcSbALAhxAgwIlUbOo0aNIkyqdeIKn05Q1JhJ9+LRqwTwUiQz0k6ZIGasfZc6JEhHHt1YuQhhoYYZHAAtFwAr0A4ZMmCADZzoRiiNZMhzdFprpoODPHxEdeIwBG2bLhRQmHrBZAjLPz75/AwNAJVFBgDRVF0CuQBpGoDV4Pc5ZCHjYsoakAHiD2MFAA6da9MAgzbsChCMgoblGZcrUw1UQFbR4ygZDb94XLoBB2EBtCwDFjSp3KmRLColQClb/X/unAy1mxSjOdojGjVM6a75H3HK7jvXyCooiZ79YIFITEtlCxg4t4LfUQkl0YEFoEFVggiOlLJSfRD4Ug8qFGGbIGUM8EFBHVTk0VAEQyjjkw0Q81NTCDgcydIQJsZQIkTQzbRgROS0uVABXOaYI0TDdfJNjA0WsxQONFPlIkXEMaZZMi0W24ANhPpghE5IR0eIQDhD14JQBU054IGIinGGADX3I1JRKDWDRQRIQ/SITnA2VSUAIfjTQwEU5MnRAACIohSUABNhgRwF6CrTHBhSVsNIYaCwlzBkL0ZFQH05MVMVKLE4k50QPHDDDbRzxOdEMKmGBlDGx2FIBDF94/1TCHjgwGhESCAkiiEEh+HCiTKosZEtDGHwgxEdpSiTGpg2pkIEMMmQQxxQEuRERna840pAevaWwhqUemfqQrQAMEUcGLAzAkAADZCDFQGlQylASaKBhhhtY0EGDCc91G8ZHtJILkRIAqCvRmgUcsJAIIlgJAGgCqTERBB+AhKlDtSx0y0wovFHQASGEkAZED1ww0VfhpsNKQxsX1cZKNEyUwr8eVcFQy0YJQHCfALDRESBv7EwRIRPhweYSE8GwAsoDlQC0EiMIkKMKOsUs0czHFgA0HlEL4MFCzcj0w9hkkz2ADIDwrAcA5jzxBtdS5+gBuzIghTRFI3gwwNctsv/LhxEgAMJTHQxVMM00wxoV9kyEGCHHDVaRIawzESFT9uVjE02RFY9Ta5UQaU8Ey1LhAFCLAycg7NQUCbRRN88YcwlAskkJpIIMes/CDeymsyLLIQzhsEdVcggQNwA/UDR6RCgMgIIVCx0iy8oPoeSUDj94UDZSKBgvQxsJFOCCLAI7hKtTbRjc0O4UWd49CiPgkQAggqBaAhJ78QWUE304utMJRhDA5UKRPNE9QwDxewMgUlcQB0iEBF5yChWOZxQFzgBVB2GAGC7DFxJw4ClKGADmkME+h1zjGs4IhM8+QoEIbIAvEUCC6nQSAwpOhHILOcUDKCOrCTiBBAhAgBOrItAHBvjPKRmQAEViMQ2HmEANIDlBHojQhSgggQNzAAsglNA8dg2ABeg4BxMP1y8gWI0iBShBCZiQRTXKpQAJ4IIS8ACCG2wrIjt8I1hq8kQ9vrEBYUhBv3iDARr48Y10SNoamHbIpzRgIib4ViPB8gVBDhIIRyDVJKuyBSBckgybBAsY9MAv6KgwlHL5whqAgIFW6uEDfuCdLAFABiiwYQE5OCIqwaLJXQYEACH5BAUCAA4ALAoACwA8AD0AAAj/AB0IHEiwoMGDCAcWSMiwocOHAhFEYQKxosWHCPJc3Mix4IQCIEOKHEmypMmTIOdEQZAwyhyUMGPKLECEoZM8M3PqBMmhYY2dQGMygINQl4NRrjSFOBC06ciaBI06ULRIoKUkASykcepUgxMcUqk6QGWKoIgOAUJwDeqi1dSqqATGFfhqIJoWdJz60UKGTI6ZdjKNNWVqLkFQBDuMaQrmxQUTJvQc0XKyzBgLZ1ZNMnzQko/PHQg02CkkTAUMFypUuIDhAZiRdC6fUaCA1qtIqHLr3h0Jkl0LQJesMKG6eAUgW+wUsIwZDRoRFhEL7LBjtE4vEBCa8EJg9vOOAhUE/9i684iJgrZiOVL1iVYShpBw757fm5YCLEFfpNCjJ72jgtAl5ANEZywWFBsQqIcQJQ+RwlAmB1inEx02gEeQbwctgstRLkxoA2YK/OIQIg9NMpCGAumCgxMazBQCiN89xGBCaBCEi1QFETGTCGi8RxAlqgQp5JDsHaRABz60sEMOoySEABwMLMQRiQ1R6cCRSbRgQBENjFZDQxpY6NCMImgZQh0jaYAADmy22SYJUHUEJJFEftICAWeapNKabrb5pAvgIcIIQ7YIBNMEETQkpZgDORJLBXrAQIZDefDZJ5twWjhnKQJVQBAQNMS0Z0J3RBmSFDEo0VCAAYgSy0DGVf8AwwpLwHTCBGAWAEiqIwiQEI9oZDVGCWykEKtxQKgRU6U4IJQoHr06JGwZIJVm7LGqmRAqTHN0wRJBuQjEiUAePBShhAUcsAIMCT1Q66EkyELQuIwKxEZDyqJUwh7f0mtQI+CFkQJDNJRwUhYJ4OGQBz9wVEIZayR0wQNBkIQwHjKgMEC9DN2bkAn5FvBEAm1kPAAKAu3iEMAdCYxtBadIQoMgJGfM8Q8oPwTxwAT54kAFwDiAySwn16uxBzLIIZMQH2AAqc8OBG2Ryg0ZIgAKMrSRwBQ5FXLKz1IbxPAPZJdtdsMNjaD1EzudcMAqDD2yci+31G133eOm4kBTOlT/8lAoHKUSrgM/AZUACxJc4hDgD93igOCssCIQnEA9YYWvDslNyNlkeyCAACMIVIsshxziJgkTGKxTDAL8wAtHngvQRAZxSLEHK6ZfehNQXGws0CWPBC/88I/A4gAvng/AQgYqDCESERFcGoGOOwnSxgBkv+5QMMpnAILzJLnQQwROIIAACST00CFQckhg0Sad3GArBz1EEUUPHDDB9w/l/k688A5IhCOOoJM5vGQtbZBA/w6SiJ4BAF1rkckT2qAxzA0EGHooCBAWEEGgzIBkRnCAJ4BxAQf44lgmeEEHudKALVwLW3r4ywqbAgWGYMALHAMPGFLzshTOsCktZMgKH5TzQ6DUECE8y2FHwOCphBQxKHV4gRKnKJAvUBEhAQEAIfkEBQIAAQAsCgALADwAPQAACP8AAwgcSLCgwYMIB55IyLChw4cCnURxAbGixYckNFzcyLFgjQIgQ4ocSbKkyZMgmXRxkhAOA5QwY8o8MYFhRpk4c47Mg4AhEZ1Acc6JghBHADgugipFOYEEjqdPkyXDgQueBiZLs+5EEHVqt2HLUJEKYKCM1rMqA+D4uszUQFQBvLVI0+BsVmhgTek1uIpWi7p2c9YJYaAFqL0M0YwJHNMP4RZJOtBKUowUqsuYL4/11oEA4wM5ctARObiwiA4KLPa1YBcAmxV69KzxQqdI4cgKfOjWzUMgXIa0DJwF8wDDBT0VAhj79EpB6oQ8KmeejsqbJq1L1qSoYKLgJzO7w+//7u3w3VkvgRJKe/j74LAeSxuE2PGp40BLCIcJvPMyp/zCPnTASEPkNeSWQPoJNBUJHOBkWwsB5lagesAR1M1BJMAnE24FWaPKhyCGqIowZvAg3mkinGGAJn0ktMEdVdj3i0M+DITiGQSEUEcDDVDQEAf2PbReAArgaIMfI+2BwwZQNYmDEz0s1JGHIooojJGjlVRCH044CdWLMXb0SykMPVAGYCdRQEJDMwRpkDEB2ILcFzEpyaSXTyIRJJWqCGQLQRh8gOZJXCYkRhUiDaFCBg0lIdArjigzEHIVVJrCGnQ45MCPBQwRRwZNMJQEGmiY4cYYdNBgQqWstgpDGHUu/4lQLQEo0cQAD7mBxQEF1KXGqq22CsQHMhVKEK0B3CKQIQ+lQdISD1wQLKuX0lECTJsWpKybA9HA0KsOVZGLQNsaRIh9ZAA7bQUYsIESIG8o4VAz527UwBIrJFQtSfAqMYIAAnDbkLf6wgoSvHj8K4AHAjXj0A8dNZDuuhXo4Y45T7yRMMDmchTwQ/jCUNA009jiDDEycCywAAMQQgUIONEARKXTCOSMRY043BAKA3hAxRU66JRuyTcfhMwPSCet9A/1JtSLFYPocAJQJRywQtEHwfJQNAzhc9Y9DiHDC0eHsJLHtUtJsUnYDRnSyy2cCISDLKxEUAPaS6kgQUOwYMfDy9JIoyAACiPgkU8u6bBCAgkITDCHVnW0AY59hb+RxQwFVEFBDz1MsAfeWeEBDjcNZXO0QAKMoMQbgMyAuZagLyUHONg49IwATSgRgxSMyXQDC7M4dMzuU/eO0xWjI0RMAMq4azxQcvBxkDK+CLTCEs/rNMMN9xCzvDI1F0RG9tqHIQk7JE8LBA2Dko9SCWWsoe/17uf0AQQUc6eGwEGGkQJDNKgfTuggP4TsS4AwacAH+MdAg3zhfw2MYAG2EMEKgqGCCAkIACH5BAUCAA4ALAoACwA8ADsAAAj/AB0IHEiwoMGDCAcWSMiwocOHBOdAnEjxoZM8Jypq3DjQCcePCKMgSBhlTgmQKAsQYTgSpUsNJBjWcImSAZyECKLQREnE40BdQHXh8Lhw50YNHnUJVOQAV7VkJGoUKGqUootWDhQtcoCq67JhG0a5mEq1qkM7mbgKRCXQlKllTjSQNduwzBgLZ1ZNQmhqWI0SU+ketItXgQIHryLxRYVrbFmQZMsSPoMGjQiIphbJfbwx8ty7ASpfJuhDICmEkxZJ5VzRsx0bBAIosMwQUiS2BjO3YsB6Ilk6NixAktaBB4/SCZEffIuDhAaUdmN/KiWQkTBExx2eJmgKVTddJFZq/2wAHO8faYwMMvrlENLBbslwIIDjgmL5M7P/+BCFUFSSh3sJtMhTOODgQFwZORRCYbT5YIY1DFHC0GEC4pLMQeI5dNloAjkoDEOfOKCcQIfx0MIOAIzigFIGzccARz7wECJDiAw0mw8nFkHWTAn59NGHEf4hYgsG6FhQHk4YeFB4ve1EZAislTCHSAi5+FGNCTmixwEzNDSBQ01u5IgDFTiQAhkO5YGAkgf1QBN1ZBIEBA1hOjBlSwfd8eJAUsSAR0OXJRGAMrGUGedAMKywREMlfIkQm4D4OYIDAyB0mQJnWGBDAWwwZAIZQjSkJpsFkaAOHiOgMAAKDGU6Bh0OLP+EZkIY0MAoE13gKVAuAnFCURkGHbACDAjB8MASdU7gBCsE+bpTpwkBMStDe2zQK0KNfBRGCtHS0EBCTyTwp0PZalQAsAldcKxBUyTQhgweCFYQG0AkZIIaA4X7rgerCrQLudpye1AFktCZABfwVlrQDw1F0wjDBLH6ELoEVeALmcAk0g4vCm8UDSEQs+qBDHJAxAYGAlnsCzAUEfJvQs0QIhAKMrSRwBQThQFDBRVMo8xBhjRU7kHRrCoDHglkoVEZa6QwDTDXGPSIQ4Q00otBvYyAxxuAgPQBBL4Qk1AoEB/0Q9W7XN3LOhlwPUNgHDUQxiksj83QDx4IIEATSsS4IAVgc31UAB1rOJPQ1DIbFO/efUshyNuRQVZAA+YkotEATWQQxxALeQa35IUYfvdAA7CQgQqc9/a54AXYsULUCD0SjAMsGAHCDTN0KS9BZFXO0Cad3FCnYFMVMo3lBUXtyBG7P9T6GuzEkojYDtTtwAM5NN/QVB8A4Ysv0xy0gPbbg3EBz4YSZMILw+9egO4IVaBH9uQ3ZAKtXtSfUAnmM/SC/gmpwxbud5BE2QGACIECAjfSv/oFBAAh+QQFAgAAACwKAAsAOwA7AAAI/wABCBxIsKDBgwgHnkjIsKHDhwNdQJxI8aGGAhUzahRIYqPHjHAkfhxZg6GTkSgBIGBIJKVHF1EYwnHpsUbHgThy4hhYgqZHHLp06czppKXPinNGAcChSJGuZDoRwGFwdGKJOtAALEO1bNmioDlvVm3oJwSBFqAGmlo7rJpQEkbHGixroEUSNAKLEWQLVSpVuQLpthDRAW9DXEJPMhkrOEkHBRBNLYIK92idEAbO/HnMkFkxUnu/4thwx+XluiIAKPChUTJUgRw+nh782Idt2w9RqV3mlGiPjAUaYLZb2wcPM2Z43G7ITC2AyTkBkP77UDhqzraRI5ImTURy3BCh7//kyAFjwyJ1N0MGcNvML2GlSgFgJAyRGdYIaQ0cJjD6QCe/OZSEagVlJw0jBjHyS0KpGRBCFwmRBkBPGRmHCIIHiaKcQIRBRkAIdjQAwAQMiVWhGdY0xINqZxBgQx0GbZAQgBv5YMYnDrnox0EFMAEhQhJqZJwoCRnzQBrmfUQhTbYAAEMYDc2wh4wImfiRMQA0SRAbDvl4EkJiVEHQECpkwNCACrwiijJaHlSGQxQ8NEQcGTQBgAAHDYhGAG6M4QcNAOiBUApQNrQHQ7VQo0QTAgjgQUJ8YnGAQDAyBASXDvXx5UC1CHTLRGkYtMQDFyS0wgFLIkQBCbKMBWhCKTj/hFEunh5FhgkMsVHpQYC8oURDvRDyg0ZLMATDqQYBEgMeI6DgUDSNDKvRqwmRMVCvzDo7UDMM7SKsRgXcitApALAhyBvZ4lkQIdEgBO0P0mY0qUEV+AKAM8QAMAsAjx4Eb7sF9QIvvAX9YMVDMwAAxEAVVDCNMxMN3EwvFPeySyPCEsyvFVzoIAhEZMQKQMO+AFMQMg3BSwjGPzQS7Q/aAsAFAB9TdMAKMDRc7zUEweLQwECjMAAKMrSRwBMesYEBySYbhDJDA3sw9AhGZzGSEACk0PA0iRz0NENT4/FGFoIkjNLNOT+MEC8MjQDAG4AUkGRKBbABRL0QQyTACErEmQAIYACEobUeFfBsUCgDCdCEEnFIAbhAJdDhpMN5F/TMAE1kEMcQcj++5d2UGz7QMQAM4TlCgjeshy+xOJNIvgBQe7pBb2qtui++TAOAvUHMfhDWS+vcMEFq+H6Q4AkBcYTxBkme0AUP9M58QRgkr4aI0wNQQBgwMLR89oGt0T1Ca7wJfgEfJIQr+AN9MT5CDcgt//z0119/QAAh+QQFAgAAACwKAAsAPgA8AAAI/wABCBxIsKDBgwgHFkjIsKHDhwW7MIFIsSJFBHksatx4cALHjwjnNIzCZCHIkwBKEGGIEaVLDk4YenR5kgEchlFE0gS5MiFGkzs1niCIA0fBCDODbnRxE0DRogRzllCq0U48eDiSPYUKwElGqhDp2BhIatmiarq2CqwBFOxBsQTOKOgAwFskU6aWoX0qMKdbg3DlohFx0NSwtHwB5Bn6N7ACAIQb4kJsFEANt3ABPI6MEFIkVABMLaIMAEEUF0EdQ7YoWitXBBpcquZMkVTo0YlJXP44W6CP3z4ges67t3Lp0xp7+wbOnOIi1wWdxKYYIu7mgsyzB0/4GMBzrgR1V/8kTHtgdh5mzPAAjjD4DlejEBgniACOi7YbmaNHJE3ar/TbaQZAcAYUUUAJJeyGkHQoAWcGIsIwIlApn/z3WBItGBACfhogkJBujH30mxm/SFhQKdIAoGEdIUXhk30n/caDKAmV4VANMS04nYhmUHJQBQCkQIZDeXiYUE88CiOQIwAASRANDs0RhZEG1ccAR4Sh0YI1AFxwUAoALNHQCUkhtCMALAzQEGcWpAQFBk4aBIQa+BmUR44IqSOQmg4lAYAFY9iYUhhgJgRlQ1JSaVA0AnhA0QGArVHoQQ8sUWdBE+Ap0C0DRdPIDyAJ8QEGCZmgBpEMeUAIqCAVMulBNAj/kZAUAq2DkKc/sMqbpAhd8EAQBU31hhIACDCAAL0sumquKI2a0JwHCdAoAD8QQsguvWTbSzOf5qorR0J8AQNCFWBwqEDGGpSrtdU20i2z0VZkB68FAckOMJgI4JC3/H47kL6EUAECADM8VICzBFVQgS/KVNSvtwZRcQXBBVP0hZcDKVzBNMQI5Oi+zMLrsRWD6DBFxRUVUAe9TVagRywCPfKRB1YAoIMgzQIhkMa+AENQKBChIJAMAglSwAwoc1TAxTsr3PPPDaGgLwBtJPBEAZd+5AevGuthC0GXIHOQ0ELjkYBASe9UwpstK8zxQ3i8kQXSfwkEhpdAOm3LNQLBioIMLwONAEAMgNBdt0AFCLEFmBovrEzHsAQDDgBKxEDr4Qix3bbLPTtzzhuYO3R3012f4o48oTvUwBYmZNy4lzmkzlABUDCEwQKyMwRGBRgbZMILuSdUAOsJ6RF78AfVnhAGXmQtuxBa8J4Q8MgbNHzrCK1gR/UGKf8l9wdpoUfv1oNPUAMvkJp6QAAh+QQFAgAUACwKAAsAPgA8AAAI/wApCBxIsKDBgwgHlkjIsKHDhwWjzIFIsSJFJxosatx4sAbHjwiZNITjAqTJgQUcZjx5cmVCjyxBnijJkGRMkzARYrz5cSFDEjl5ckSQ0KZQiwVK1CBBAQdCl0cdNqDToIAGJziyOi1IJGrDOhQMtDjTgoCWUQi0bh1o1CtBPyEotBDRAY0IBR0oZCKh1qAGn17rxG2RhIICg7QoLErWd6CTrlEFG6DwB42CPwl/LVO7ViAcBjzhyhVh2CEPgd10aS3IlKVkCkksY67YbcNqroA1NgghljTHPyJwfbtN8LNGyXNLf0RDbwLWzgQ5WBRb+LBJBT405UmbEDLE6g59iP/30TCAjQZzoiTccAf0zfHwyRf0nabqiQk/pceMH580aQIUNFBQHk4k5EQPKZ0UHw9mmOGDZWcQYIMfB+V2EHvumTQeg79II80rBoRAh0MTtHYQCRwk+NGGv3zCiEAPsLGEigjReJATQXFEFw+/iKJMCgJdAMEKWjzURYEn1mAjBUpQpEAAFoyxBpAFYbCFHQ0tSRAJDqioRBMUDFDRAQWQYUJCZDy0wQYGsUJBHjEIJICYDZHmBgUHCFRAAWxg8NGeNURw0D4jCKBbQQUccSZCKzw0h0duCsRJLxII0MgPJvHZUJpZAtIPBZP2Uk4jl/6AqUmcMqSlQIBQgMcIhsT/Gmuppp5UwgErwIBQCissgahAeAzkAamkmmrsTWwAAdETA6FAJwXGRlvrTWFQmdCeOlBBgQAeHFTrsQ2hMGauCMHwwAFDyPAsSOJ6IIMcFKxqULIHVVCBCfzgIQFLKMjARQKCyHtQtfVW4A4oI8zCUbf9tpHAEwInVAa5BNlbwQPAfITCCHgkkMUMJrFhkMW+ZIwMRN1SwPEbWVBrrUAWnwIBBQoz1K2hSrzRqlBljGzxNMQ8w8tBNzehRJzxRuXHBz5XcIoym4BzkNFxSLGnWwIRXLHFkoAyjwcDiNlEBioMcTXWA9GxRtMXB6EDCHLEMQTaCTHdNBALnE03QjMUR6KrzyYcsbdDar9sEAACDl43Q8oqztAXMFTg+EZ2TJnQA5PX3fhBeGduUAGQS8654J4XVIflpVNkd+oQgRE56w8VsMXmdAcEACH5BAUCABQALAoACwA7ADwAAAj/ACkIHEiwoMGDCAcWSMiwocOHArswgUixokMEeSxq3DgwwgSOIAvOaRhlZMiTDjOiBMmh4YQTKzcWYEDSZEyNRBhiLHHTIsyeQB9GobAwqEOeORMiMOqwgFOBJBjWYHrQzwE6TguUcAGH4VCqAunYoHAmwBk3NrJObVgUqFiyaCiImItGgQGtGpzgQEhi7U2xBCgo6CDCR8E/HbAU4Lo0oYuVb88okMtQxBk/J2qQ2HvQyUnAggkbfhiiQF7OB/1WBCx5o4i0jBk+hsh6sgiOPIo41cxQA0QCrW+D7OAma96Enh/eFh4SjZnSTmcjRADHxU+wAs9AX1hAtUEnvqlO/za84wCFBgQ1ND5IwgHPmD7iD/bRwoDug235OsgPUn6HJC0IxF9qyOVxHUgidKBAfSHU8dRDTmzwnUQDWmSZASHY0UBWDzLUXQQSDhRhHiVUmEFDHZBFgA1+NLBhCWUcIERWTX1Ewo0kRJEHjQOdKIAACCl4xop0EOVUA2S8sMIKW0BxwHseFlCFAzVMoIELJZQ4BAUnUgBkQmdYYEORChVgBw0YmAADDCZAsEYOD3GYZQlSxKFEExSVMaBTHwRiEAZbkBmlU1LEcOePHvwQUgFa6HHBQUCoAZGhTSD6g6InFbAABgxBiZASXgqQ6KUr8cnpQRc8EIRBT1AAqpcUXP9Kak9QUOTUDVT8iB1RFMCQkAlHCFgAIFYMsOtAdKyRAkKPBpGVHBKs9IMVDzXwwamQquFUCbmG5AG1OlD0ha8IAesUICN4YBEKA3FBgSAW2aEssw8AUMATI7BbkQxtUPBEhQ9di1AFQCzgVAZfQpTAux1qNO7AQBxRwAkxGIvQAOziQUEWN9nBUKr2FoCHBPoSNAIFbxgFsEAVmGCwU3LkSwEKJ8cACFhfPFruETOem0AMb0jhKVMr90pByDweKxAUECTEKXpKF9QAGDoj9ELUB9VhNEJ65FA0drVibREYFYhdUQFbJFSBHmYXBAW2f3rR9kBk/3r13ESljbdDYe8NzZAWFVTtt0FC3I1dQAAh+QQFAgA3ACwKAAsAOwA8AAAI/wBvCBxIsKDBgwgHlkjIsKHDhwKjzIFIsaJDJxosatw4kESNAiBDihxJsqTJkwWYNITjAqXLly9P1GCIEabNmyI1kGA4k6NPhS5WtsRJ9GVPhDWLKjX5s2nFDQlZllhKVeTRgzudNnXCkMjUqlVdRGEIhwFYmDNIam1ax4aBFi3cGDgw8kSehkTOjvQTgkALER0UKEDT4YwNkREbmj3L18AZwAoMogmQZqRDDlUbn0kSmGEHAg1E3u2qlK9fERQVnKETMjHCDXcWwzT9F42CPxSTBDgQOuQEhyodvk1ie6OI1SJL5EGQkMQEmJzR/PzcO+TE5s8LrE2ogDLJE78Rkv/QoH07wjMhTO5BALWgE6nlzUMWSLfk1AkR2gt0klR+h+MG2OBHdSdRIEYEJCQIhwYntLbWGQQISOBLVThQwwQcMPBVfBzZBqENrFVVwoYgHRSHEg1Jd4MFIOqlVkExoMgQGpNZMEZBLpIkRYwPBWBjGTmetKMSI1BUn0sNHLBEHUoBEgMeRa4Vkh8LbLHCCltAASRMUrwBpQADoLAdSAccAYEJMMBgAgRbAIDSFF4KFKZ5AoFEAwQV5KknBC9MGNIQGYBJJ45fwJAQGX4+QYUEgxrUABR46ikpEDSUJAejjeLIBgaSSgrDCktMSIUAP3kgg1YpDBQSICOIqREKMrTXkcAUNoVhQqeT0kAiqx5A1KtAeCSQBU4llLGCoQktIdIJRpDK0K8j4PEGIFSxAQRDaoykwgAJCeDstGeFkQKueppQp0hKSPCrQN6OoEQMUjSol7EwkFsBDA8oK9ITXLDgrQBNvCtFkCGxwRAQ2ZI0RAwgxDAEwSOFUa+9QBwB8U3FMnTBA0FcfNMHB6shhMcwicuQxSS/RMcaqSL0gJspo9QAyJlq9UXLCB0xcswnrZwQvjDzbBLNCS0g9EmFnny0SX6sgWzNPxENtU+FVjC1TwVscfUNAQEAIfkEBQIADgAsCQALADoAPAAACP8AHQgcSLCgwYMICRZIyLChw4cOupSASLFiww17JlrcyDEChQIgQ4ocSbKkyZNzGDrpwuSky5cwQZYgwhBHnpg4c4bk4IQhhRk6g75koJKl0KMmaSZEcBOpU5AnHE54SpUBHAQJu8yh+lQpQqYcwx4kwXAqV6RWGUZpedZlWLBiGZZp4LKEhoZm29KxIfBMCwJp6II0CEft1qcN9hI4g0agCAUdzIwxGZUhU6eKGXcQ4aOzZwU8ipi8y5CD0MwKHHawILJgYYQkTONEvdmz7ds+RJwpY7LG0j0nXjYIsRgyZ9zIO4sIcGA0CRzQo+Mg0afEwoYiaiffnvsMnZNEImz/kO7E5uC4DTsQOFliTg0EJOKTiNL0OnqEHc40f7mHQo0aHMxhXUj3GYRGBy2IFlMJA7ZW4ECQ+dDCDt899WCELRigIFX3QfZHhiG05ZAKGTDUgQIg1vFgQ3GUmNBmZxgQgh0NrJhQHA4lcQYBNvjRgGBtjVSZA00IMIBDdgR5khQOKGGjQE9N8YaTDgjggY1PSZHBAANc+aQDIy2xRJIxZSDBlwOF1AAZLzzwwBofBPHSGwKgCSVIfrABgQkwwJACBCuAcdIJeBxpJ5gFQBHIBRU02qgJaxzQ4EhG1GlnAQ0A8AAMjnYKgUEhnZCBpRVxoZMaGHTaqQlHnDSIoQ+1t5HAE0FBgQFDAJh0AwsoHNTrQAlkAZRQC9ya0AInqeABqQ7A6kAWBcwwrFBgqKoqEAeJ9AYVfKDw6xuABLlFCtY2esEDObgkiA5vJIAmFA0hq6ROWlTAaLkmvDBvUFuYkJAe6e6LExTYHntoQ0JooccFCekrME5bMATwwzDV4UVDXlAMk8IMI+SwxifV8YIJ5TaqhxYgu+TFpwllnLJJHDf88kkjHyxWA14UbDNHOeixs1gvGGtnQAAh+QQFAgASACwKAAwAPAA7AAAI/wAlCBxIsKDBgwgFRpmTsKHDhxAHOslzIqLFixAnFNjIsaPHjyBDitzIpCGChSVGqlzJ0iECDSxjyvSogUTDGgUw6tw58KQLnkAPOknoBObMoytLPMSJtKnInw3hQA1K1WHRqlWHJqyR0qlXjiWmIpSKtaxQo1/TPnSQdmbDDQhJOOjatkERA25auNlRJmnDonXvtvCBRoHhDmdCrMxj06CThV+L7BjcQYGPy5jRBEgzsgSTGhHg9nzpVDJlNJhTY+5AoIHKORMQkJhNAo4GujHTGKBsWbVvHyLO0FFZosQeCkRqcGCAOybh3r9/J9ncNqaI6Nh9TO/r1GzCDha+ev8/qMBMEaTjEYroEMDGxvRA1ys4QyANfJ4iCp+xYIPO/Z1ooLHfGP79VxALAzQUYAAWjMFddSINEUcGEInA4BgHQChSCVLEMZAAER3QgGsafgSIQE0IkKCBF210gxUrsojRRlNQESOLTcVx431fKQGigV/NYIQAPxRp5JFIFvmjRR0JsUQQw8WUAZFJVqkiH1SAgJQfC2zxwANrfLDESjPIsSNCP1Ahhw5NlXEEBCZccEEKEKyhxUpDjEAlkigM8IMVV+gwg1dsBFLBoYgCsUaUI72BoAeQCuSBFVzoIEhaWsiJ6KYYqCHESjooMQIfLMjARQInQOgFBptuaoJDHQl2IsUNNzxRYgEfYNAQADKdUJGMBHV6K1JfwFBBQkd8OqxMdqyRQquIwvAAr8vKlCus1cZU7LHA7uTHGjAk9EC3CeHaEAYLZBsTGBdwS+5FMzjbUA7qsgRFQ0C8e1AD7LqrL0QNbJHCvxdBoSvBEbGLsEVb5CtjQAAh+QQFAgABACwKAAwAPAA7AAAI/wADCBxIsKDBgwgDkEBSIKHDhxAjCtyAY09DiRgzPiThoIDHjyBDihxJsqTHOQ6d9DHJsqXLAiUcbhBj8aXNmwU4OHHo4ITGn0AHqrwYtGhBEjiSKk1KsSbOpyWZQKQAtSpJBin7xDTKFWLFrl2RLl3qRIPVsyCxJiRhFizXCGOZVkRLt4QGsWMX0t3LBAlcsjQ/ug1QByqDHk5IKCYRJc9ej3RsEGhxxs0OOjhP5JlApAYHF3sjEziDRqAINB1apHlaokRoyaQ7iPBBu3ZqzI9thhitQHbt37Z35LYpwjfw4z7QuBn+Mgny5wpagBw8WLlg6m47YLmOnWsHN7i7c/9VgKbFAY/ig/b20QKLH6LpMa5vYaAI/PgBlDQRkLD3H/r2MTeSFDEoIdAADv1nQAiFCSjSGz816GBIU+CBIH5AfdSGBBhm6NENfHjQ4U8eCQLChSNmpCGKKUYE0iAD/CDjjDTSiEJRZ70hQI08ojCABzLIMaFJU1DBYkEoyNBGAlMMyZIOI0jgwQ8eeDBAkngkkMVeDSwBQBlQ3aDflCPg8QYguanxwgMPrMCGFlANoYMOaA7HBgYmXHBBChA8EMZTM8wgIBQQGGTCA0s04KRLSzwAA0ILLOoSGSYk9IKkLDWwABAIXaBHDpiaRAanDgkR6kgN5KDHBS2S+EIKCek60epBmpJ6EBBenEoSAI7OquILlSYEp64iLRDsQRh40YCvBPHKKrMuHnEstKWqYSu1DjmLLURHFNphQAAh+QQFAgAAACwJAAsAPAA8AAAI/wABCBxIsKDBgwgJlkjIsKHDhwKdRJkDsaJFhzic5DlxsaNHgjU+ijTIhCGCKC5GqgRQgCEOBBpWqtRAgmGNljJzFtwAJ6XOj04Qvtz48yJOhg6KdvSJkASHo0ofngh5cAOAPVCjOszjxGrBCD0KZNXKsMCECAgIRoBTRSzZigUc3CFBFwGStm7fOhRbgIEGBw72nOCrFyLfEiX4Ev6Z16hixTofL4YrWWaDIgbcuCFgowFkx5Yxt/CBRoGCDmjcHPhceGAB0T4AKDDYwY3nxq0Fkp6dsAOWybkBiHCYGnhwhwpaGD/OsPZy5gg7GHgOvSCaM2VwVzc4/EwR7dsFiv8ofYbAgeAZWAxIOP66BRt0CmcBkAHAAAEMRZyxMCZ+4QJSGLEeROe1xpcSEoRX1gk6eKBgQnzJMeCDBSnWxoQUEsTXFRhmKJBYMySAgocV8mVEggbh94MV1Sl2gxUSoOCBgwB4YMUgOizUIl9SDCJDE01YwYUOU8jEmkWPPTHEEFOcwNFKko310JFGRillQ+BBaSV1wSkGBhtbbHGEGnRceRxfUFyAQQopAAHBFkE8KFYDC0BwQUEYbOFfeAUs8QAMB2GghoIFCEEGEAgBcQSFUGCQ0ANyeuFoQgs8+MUFFZBoUB1rpMBQDg9+gGiilfJ5aaaaElTHFgytQYeOLX4RMKlBJmQIBqYJNUDhFqO+FRAAIfkEBQUAAQAsCQALAD0APAAACP8AAwgcSLCgwYMICRZIyLChw4cE+yyESLGiww049ky0yLHjQAoFQoocSbKkyZMoRc5h6ERiypcwYxYo0RBHFZk4c4rk4ASHz58/neQ54bGoRaEbjSoNQALoTwR3GOicGpNmBKc+SdSgyvVliR4RMP6M0MXFjK5oTc6ZIIaE2w1EpKadW7IKBwocNNLda7IE37+AAwseTLiw4cOIE4ukY4NAixYWbDRQ/LJBCAJnFAgUgUaBBTojlxoV0UGEj9OoO1gILdpjEtSwTycJIbK17YEdDNS+bRvN6pC8beeenDT4aBu7jRtVnVx5wThKHKJRDVrxGyVNBDBU0IFHizFCKA/PQjGA4esWO4pQDgligAeHRRrIX59FBgrnRUXOSHAff/6QcWjnn0civSHggByJNAQL7yFY0UiCtCGBgwmGBIgREqDggQfkeSDDFeullMUVMvDBhwxtJPBEiDBlcUMAK7IY01ky1mjjjTjmqKNJDdSxY0lafLDFGi9AcYBfOy6gBwQmpGACBGuAsSMZKcBQkAkrLJHjDGuYcBAEXuQIxgUUdlSAGl4mpAWOVCaEQZg35vAAmWVaVMALDK1gB44LAIFQCnUmBMADViKk4xEQIBgQACH5BAUUAAAALAkADAA9ADsAAAj/AAEIHEiwoMGDCAd2YZKwocOHEAfiQADgRMSLGCE64ZCxo0eDGj6KzLhBTJUCKFOqXMmypcuXKjWQwEGzJo4IRErA3MmzZ8oTNSJssEkCzkmfSJOuZDJBDImnCJAcVUpVaRUOFBzkOVG1q9evYMOKHUu2rNmzaNOqXcu2rdu3cOPKXVnEgAULBoqsHMm3oA80gDv4MKCyr2GDIjoQTnm4scAkPvSidOxYMWPKh9FYKIy5LxoClzvzRTNmLsopcTI47ODGNEolEhombnHA9ZXYCEWIOGOgjGspTVA0DEHHNco3wkWPVBlHgHK+Kd84fy4S5Qngyal3VDkIt/aMKqfgdBkgwIOH7xdVnohjZMQIK3KM8wQkRZD8+/jz69/Pv7///wAGWJUQdgQIBg1brPGCF7XxB0UFGKSQggkQrJGDEPkJoQYQF1TgoYdArNHgfQeskMKHKEKAnkMNhGHCih8tgAGMHqlBo0daVHDBjRgJ8QIQ3wUEACH5BAUFAAEALAcACABCAEMAAAj/AAsIHEiwoMGDCBMqXMiwocOHECNKnEix4kAmLpiUsMjRYQkGE7rAiUIkT8eTCfPcieAEAQISCBygnDmwyh0nOHLm3EBCA82ZNSLoHOqkz8afFkvMiYJgqNMqSDkyuLPBqU4neU5EpVjCBZymVnFg3WoRCU6rCO4wIFuRg1CrJGqwrViiR4SqOiN0cTFjLsU5E8SQGLyByFq/FqtwoMBhD+KZRx9Lnky5suXLmDNrLtBgDIEWLSzYaLBZoYUOHRSIQKPAAp3SBw108EG7dgcLsAumMSOitu8kIXIPHDPbt20DwgXuQGO8NhrcybEwb+6jgwHSwov4SEJdhI3kAk83/78NXuABN6mTJEFz+7XkBG0yGGmTYCEdAy3MmGkxRsjkQSgMIIAAA6CAxxQL+bHEAZWBMIAHP0QYoQR4lJeFDChIKKEHHtQn3AwJZKihhANwAV4cAowooQBKgPdGiir+MECFyQ3BAoQqDgCCIMkJ0oYEKgrQxBDlAWKEBChw6MEATbzRl4VXyMAHH03gcUN5BWVxgw5SYOnll2CGKeaYEdVRx5iF0LDFGkeoYYeXDXyQAgYppGACBC8sgSUUgVxQwZ9/4lleDnr4CSigQIQB3gIYHHooBmwkJ8QHjTr6pwkvgAcFBJZemqlwDZBhQqcVQPABeGWskIKlF1wARnlq1CN5KAwQQOElGStgoCsGD3jhH5YNLKHGB2wsAACZyCarLGUBAQAh+QQFAgAAACwKAAsAPQA8AAAI/wALCBxIsKDBgwgTKlzIsKHDhxAjSpxI8SATFy4qamzogkIXOHB6aNhI0uCeKBGcIEBAwkmNEyVLuojiBIdNmxsiOIAZs+IJBxFuCkUAJ2PPikhqCr3pJA+ToxNPREGw9CYJB1Ap9lFalQSHrBNrkKiKYwOOPWAl5kFgdmmEHmknTohA9WYEOFXiTnRwh4RfBEjy6p3IQIMDB3t4Dp5YosTix5AjC5yRxoAbNwRsNJDcEAuPDgoUdEDj5gDnhA1siBDho3XrDm42nz7YQoHr2x2wzC5Imcft26R3F7SR5LdrBS2EEwxh3DVs5QPpnGFtvIMB6JN3dDCO5kwZ7AL9WP8A3VpEhzNFwA+cseOM7zMETKsn6CdNke+Ds6jIYIUKHh2CzFeAFEZIIAAKKAzgwSACKiHBDxBC6MEAcoB3gg4eRKghCk0MAZ4cA2iooQAxKCZcGyGKCCGF4F2RoooDgIDdDAmgoKKEOqhXoIoSGDHfDVZIgIIHHiRIxQ0CSjGIDE00YQUITwg40BNDDDGFlFhmqR4YbGyxxRFq0CElFBdgkEIKQECwRRDqNbAABBdUIKecGGxhB3hLPADDnHwCoQZ2QpABBJ990gAeFBgQOmcKa4DnRaKKVpDCFuB9kUKkFWBgKHZ1rGGCoheYEIZ6YcDw6ZwXBPJBHfORsQIGsCYWCoUfUh6gxgdseKFFA7IJyKuWwCoXEAAh+QQFAgAZACwMAA4AOAA3AAAI/wALCBxIsKDBgwgTKlzIsKHDhxAjSpy4kIkLFxQzJizBYEKUO3B6aNBIcmAeOBEQbEBAwsmEkhk5wnGCo2bNDRE4wKQ4IYLNn06iMCmxEyKTLjR/2kSwpyhEF3AQKLVJQgMTpw7nRJE6FYeTkVgdEiHRdYOYKmEdaiA7NUKNtA9rpLSJMwoDoiQb1JlYgsIdEoA3EGFQ0oaFFmfc7KAjkYEGBxya4s1oAE0HBSIst0gD1yEWNH98iBbdoQXjzgrrtFAwunWHHagVFgndejQaN7ET2hBRe7SCFrkRzu4t+nbwg37OsO7dAcvxg1g6MHdz+nlBAmjQiMiMpsUB6wjHuP8JEKAFFj/gFdIpMyO9+/cOE7RRokTODfgDp+ARMEAA/yYqnIBfGxL8YKCBKAgQB3w38OHBgQeiMIIU7gkCwgAQQihADO+1gWGGBg4gx3uDfAjiACC894YAICKYgCDuTUGFiQcOYAWM7+kwggQPeuCBBCPoICCDSjRhYBNtDFHSFzRssQUNZFA0hA46KNleRnZ8kAIQKaSAgQk0lCHRDIIMSdIHgVxQwZprBkIDfFpUoCaba14AAxjvQYEBnXRiAIUQ7tEABJ9sAnHEe2wMSmgFhronhBqKEgoBFO8F8QAMhMKghxbweYEBpmzCAIEX+BWwwAMYAAEEBg940UADpQYQ4QUbbHgBQKm45qrrrgsFBAAh+QQFAgAAACwQABEAMQAwAAAI/wALCBxIsKDBgwgTKlzIsKHDhxAjSjTIhIGLExMzEnRBocsdOH04YNQYsUSVKBGcIEDgJAKROSQhzulCAofNmxEmjIy5kAmHCDeDIhDDgGfDHjWD3iTBwSjDPk6U3nRCwelCJFGl4iDhIGIIAm5aWBjjpyEFoFoR5IG4Q0EHNArQdHBzoMHCPTg2SCWBBOIYNEl8CPaRZG4dhg5IIAhKAs6ehw1aoBlMuQOWhhyikNiMAEkVyEUoi0bjxqGLPA447Nnp0IYI0YMVtHhYQmOIwLB9kLaqkM4ZBbk77OCdsMGODrA7tKBDvLiFDgr+/HHbIk1zhQ2wtDDDo4UB5tcX1v9Jk8ZO+PPo06tf3xCQCiVUMsgZwn7gDSsSBKAQMKDJm/pTUDHADwQSiMIPCbAXx4AFFigAFewpIUCDBXrAxw2CpDeDERNSaGCCEQmxRBDgNZRBhx56AKJDfiywxQMPrPHBEgzNIAeDFKIwghQPlXEEBCZccEEKEKyhBUNDjIBigRK0McVDbARSwZRUArFGiQm9wcIAHnTJXwaAPKSFkFSWCYQaDemgxAh8sGCFCqwx5AUGZZpJg0OCSHHDDU9G9AGddU5pwhYQnRCnQ1AAGmgKL6z3RQqBTgkBFEKoJ8QWQAQKgx45sPeFHplSaUIKalS6XglabAEDEECksAYZ9Q0QVAcYCywQRhmx5qrrrgsFBAAh+QQFAgAAACwSABQALAAqAAAI/wALCBxIsKDBgwgTKlzIsKHDhxAjIpzDwMUJiRhPMJgQ5c4dJBxKYIS4B04EBBs2OCFRg0nEOmUaNGQAhwSOmzc3RKDwMISFFmdaEEgjMyGFCDiTIoDjQuRCLCI6KBChoIOZMQr7OEmalEQehiFEiPBBlqwCHkUQMomCgCtOEhxcKnTToazdDhYQltDq9ibchWXOjLVLVsSZMghr2HS7AUeVGQkbHAiQhHDhAAcQ5kHpNgIRhnQEW/ZhmI7Rk0kjRGHgVKGFupY7EFBYggOclTaJsG4YgocCwh3OZF7oIo8DDVWYlGi9cAwPqVQ7tEjL0OlyiUUInAm6w/RIiDJn2P/5Tr68+fPo06tfz179lARc8LSJAah9QSkZBAzYL8CKDkEQ1bHEEnU4lIEEPySY4ABN6OBQGV5s8cADW3hBB3MGvSGAghwOkAGGBwWxBQQmXHCBCYG8sERCJ+AxAIcKesDHDQy9AEEFOOYYyBEKGbEhjAmikACACZFhQo5IVpACGAidkB+QQSawEBtAJJkjBlAkNMiLQHrQxBAXJXTEkVZWAAQNCd3AAgpASqAEQzSQaSUQbCikggc//oCCBFbQSJsaGJRZAQZqLPQGFYSggMIIXNTH0BIPpGClCSscAGJBJ+jwRgJSQOaQGinIaWYFYdg3EBlrmIABBils8YUQpgoRVAIdYXjhxRfexarrrrxCFBAAIfkEBQIAKgAsFQAXACYAJAAACP8ACwgcSLCgwYMIEypcyBDhjIYQDxYh0KKFGwMHGs5hwIBJwzE+OihQgKbDGRsKXUzoIuZOFwdzFIbwIcKHTZtoAqRBWCVKBAQbNjiJgMRFQgsdbirtQKCBQSZ9SOCYSjUCEYRlztRUalPBGToGOUSgSjZolYMHAmzlmiTAAacEiUglS5WEg4Nl1HK1KeKrQSRO6NadgNANmr0hmxqUK3gqCQoHZ4QQsbarzoMOxjYmkSchFhEdRCRRYDIEQgZ3EAgm0YdJCYQNQrg5E+AMRoUcnASue2dPQzoH/DTU0AUBCRIbkFQ5ETEikzwcOOx53by69evYs2vfDvvAkjrcEfr2WbBlxYotUMqEJ3jgCAQTMGCYgLAFgEIpIJRkwBPjyUIaEFQg4IAQvICQIDqMMIAAAixIxQ0JfQHDgBRWYEIYBw2h4A8ccjiADFIwV1ADUARYoYAYfGDQDFxI0OGLEnCBEBsYnCigCUcIYZAVArzYIQoy+DfiBzXaiKNBUozggY8cetDEEAeRYYKNFUDgBXUDZaEkkz84GaJBZawwZYUpPGCfQRkMwKUAVCRExgVj3piCGgglgMKSPkoAgkJhrGECBhiYsAYZDhVwBYNLesAgHiImREcYXngRRhlYIhQDFXz8wAcVMaxnkCA3JHDDFJ4q9FCp1QUEACH5BAUCAA8ALBYAGAAkACIAAAj/AAsIHEiwAJ0DdgoqXMiwoA03ZwKcsVCkoUWGdXagQSOiYwceYy6KHGiDo4+TJ0X4KNJg5EU3aFDK7GDBpcUDAZLIRCniDJ2WCl0wYMDkYpqcO1MGOKCQQY0oYu50cVCUIZ0zCpL6UHAG6MA9cCIg2LDBSYQeLhpa6KC1gwGCJVxEIYGjrt0INRoW4ZF1ZosyBR1EsEt4wx0GJRiOMdNBgQI0HdykUYjECWHCTjhYTEOgRQs3WOx4HdjH8uW6JBzMuNhgNGXTp1PbbEhh8OkNCPbMXliiCg4Ep8/ubujACewNEeBU4X2A6WwNURCQoEuEgcIyXrasWPFCjR+bc/Jw8dBQpURiggC2QDABAwYQDEcAD1dY5wWECvjzB2IzX6EaDPkFeEEFOfRHEA1ABBggBgsYKFB9JiiYHwYfLJRFAoO0IYcOFx2RoIQVUOjaDVQIMMCJHighxQkMQXEfiECQUVAWVkjww403SkBFFgzloMeACpqwBh3nCSSHjTjiKMEVDXkBRAoBmqBHGAWVUGKSOKIgA4sMqbHCexiksMUXCgEyggdY3uhBE0OsxhwZUHgRBh0LPTECCmn+sOYQDgqUgQB5omBFnwWcEMMAeS5JqEB4SIDnjShIYASPixYgx50CoDCCHE9UOhAgCcTwhhQWBQQAIfkEBQIAAAAsFQAXACYAJQAACP8ACwgcSLBgAzoNCipcyHBhEQMtzrSwEKKhxYs2AnRAI0JBhz87LooseOAMGh8oUYpAM2akSwMdUspU0CKhS4sN3JyUKbPIzYstFPBMKcLGz4Y5dw714fMowx0dkgxF46aO04UNSipFKbTiwhMnnIbQqKBjhwA2bA4soYFIly5ENJS4mZVAiwAtDKRRK3AOERIkEDgBTGTO0Rl07DTgK7BGBByQI0eocZVhHgQbIkfesKGKwgZlysy9OYGEZs0kHIwu4GfBixUrXiywM7LE39ORSVAWuOQFBhMpYJiA8OLA6oaOcUPWPfAIhArQoweiMdKBaeUkOAgMkyK69wswwIj1ZCAGAW4EcBgUaPABg3fvGKBUj2A+smDtAo+YeB8dCPWRHNwBGGBw4CcQDUDwBx0GbNRWAgMcTDABBy4UtECCCmKwQGUKBfFAd++ZsMISHCqkBnDemQADGYwNAQIeSlyhQ1gjNVAHGSuYgMFva4RR0AlvNDGAAAIM4AEeWdB1ABlQQEFGGQrpQAgKP1T5gwcSKFFiQYJkMICVYAoQw5YDDcGCB2BaOYASx1U2gw5oplmlAFSQKZCUcs5JxQx2AiIDlXIOgIedAl0hgZweoJAAoQU8kYEEgP4gAApXMCrQE1eMkOgPVLxhKUFS6JDAjJ/+SKNLAQEAIfkEBQIAAAAsFAAWACgAJgAACP8ACwgcSLAgwTJpDhhcyLBhQRtuzpgJ4GaMw4sOG4xJgkZEEhFoFBDASLJgETOIfKhc2QFLyZcEOqycKeKMnZckW4iYybNIA5wXWyjguTKJDaAX3aAh6iOJmTRIHe6QSRSNm6gO6bSguhJNAKhYGTZIszUkmg4tioS9SAeLmxZusND5GbVBGTprSZbxsmXFmiNk1jJhwjDHFggmYMAAAoSNEKBMOPSI0oWIhoJ0tmCowLlzICiPS7pAQsIJAgQkSNQgLHDB5s6dYTwI8rJHBBy4c0eYMPAIENiwTZCpQ1IDidzIN9xhUELIlhTAO0OAQvJEjePIc5PgIPDF7+gVMFD1J4nESXbtvBt8eB09RZiSPcyfx0GCgkAwMC5EB7LlJkkK2J1HwmUCfQABDLABoccXL+2BwwbnORHFHAR58QAGGJqwBYM4URABAsiZRiBBQagBBRRh4IWUA3eklloUeTTUAF1YMcDBBBRo4EIJJQA1QxYJyHFFHEM4xGOPUelghQADDCAAC3KckNdCN4wwwA9Y/uCBBG1MaZASV2aJpQcoJCCIlwJJ0YQHYmY5gBJoCqRDm2KiYEWcBcxJJ5YoUIEnICOgsOebUsbZhgR7ChADngVIQYUEbPIpAR5I4jkEHnwIIAAKI4BwJqMCnXBDHCq8IQVSAQEAIfkEBQIAAAAsEwAVACoAKAAACP8ACwgcSLCgQYF1Dtg5yLChw4EhCJwJcMaCjYcYH47h0UFBEhEdd9TJSJJgmgAKfKhUCXJMyZcGOqycqaBFg5ckW6ScObMITowNdPJcKSLEzZ8NG7hBM9RHEh5pkD6M2bSDG6kPy5xhStOMT5x0Fj4McaajCAUdzhgtaUfNizVrjpB5eMBAizMtdhx4ueQFBBMpUgDBQEOswxkFGhzNKOQIhAqQI0Ngg9UhGSCRM1/Qk6PywTpsMGTOjGGB54MvTIyOjIHy6YJHVK+uAOQDViZMDkIRPRuImp8lNPSIEgUJh9wCheTQA2N1ihV7X86pQYIEAgROSCBxQXB388gmLszxxVkjAo7z6CP0KLjgAYb3QNaE+blnwwb0+BHkKRhEzQcoZBxQwk8UkIAffiRQcMJrBFF3IHokEMEgQRMY+CAOEQ444QkaWPhgBA5MOJALcDjxIAJ3MKChiBw4gUB+JHCwIkY3qNBGGyoMgVhDGsBRXXVwcPASCCwMYOQATYDgUAkuaEDBBBpwV1IMKKDww5U/oDAACAs2VMKAX5b0hAwCYIklCizcIKJACVhpJpYDyLHmCSqU+eaVA+CxZgFx2HlnnnvqcCecSu6ZgQR3oqnmnjeMIIEHV3oggAcq7DnQDUqwUOUPRiRgaUE3vPGGDp4FBAAh+QQFAgAAACwRABQALAAqAAAI/wALCBxIsKBBgw3KFElj56DDhxAJhrAQgAePMzvoRNwYcUYIHh1E+EiioIObMhxTGixzRoGPlzA7WFBJUyCWDjBzJuFRpKZKAjhzwkSDxWdKC2iEDt1hlKOBoEoV2GiQ0k4dlSFEKkXTws/GMl5erFlD40sJjkD/5HQ5NWKOLRBMwEiBIQWUjQ3oWCiJBk2HMza+rsFQoXDhCxC8pLRBwI0bLCg3eoFguHKKFZHxUlX5wkRly2GaQixRZg2Mz4aBKBb9UMiaFKgLY1jA+uEJNoRjw/hS+2EYz6iBbOn9sAGbQBcqA3kAhvhDPx/0YJhuYgsYIc4h5vDyAUoYjdk5NvoY73zOnPARmXBAEiVKDw5M0Bt00SOCEwQInJDo4UL+wBJERIDDgARGUIN/AuVBAoEMbrDBHv6dMMGCDBJIggMI9kBhhTiQcKB/RGxYYQQTIMiBgBx2yAFHgCQAAggJZLEREwzcgQCHCMDRX0RvyIDCAAOgIMMbG5Vw4o0E3qfBRgkQIsAPUP4gAAoxRHQWB3CQoKUTUSy5ERUDRBklCk0MwZELGlBAgQbnRSSIDh6IKeYAIHBUwlk0qfCknFAOgMcM/sWxJ59+Iggnn33KIYh8gILJZ5w6IFiADiyEOeYAV0g6wxQ6UPHjAALIEIekA83whItyvAEIcQEBACH5BAUCAEAALBEAEwAuACwAAAj/AAsIHEiwoMGDA+2kOdAAocOHEAUCIXAmQIAWWOpE3BgxRIAOIpKIQNPBAh2OKA3SaYHGh0uXfzoQSElT4JgOL3Mm4ZGmJsoGBHDmfNlhTMQDOXKcpGmh5VCXaHY8BMBmhR49a6As3VjHgNCnaGw4BPMAA4wKFVJAeHGgBEcbCp76UHCGTsOCJQ6sMIG2bwUINFDWsfDVpQIRYhF6geC37wU9OVCWcdMBjQIFHQKMaXDX4Au+jdGaWJDSzxg3LdwYOABxS4rQaDF88FmAc8TPsCtg8EKbIxQMuVN86b0xh56zjdcS56jGBOgKFyCsiLwcYkMya2A410MDQHWUdsCo/yGTw/b38+jTq1/Pvr379/BrzpnjNj5BDT3gROnjgH58JjWQ4AQCCDgRQRcMxDdBBDg06GAEfTDxXhU4bODghSRo8J4DJFyIYQ3vTdChhw06gQREN6jAxRVvPEETBSOS6EQP9R10BR8D5IiCFQmgNEMeTpDYYAQUOCSHBB78oOQPArDQI0dzRBGkhwiIUcVBM9zAQpJLKikAFSdwxEQeG0zZYIEOOATCAF12icKTG5WQRxdOkGAnHBw8hAebbXoJAkpuuZCHAxRo4AJEbfDZpwB/0lRCjRCpoGibb74nxQgCLCrDFPDF4EGmSw7AB5zvJWDFp5lmoEMBM8A3wwxTJAcQRxyrrhcQACH5BAUCAAEALBAAEgAwAC4AAAj/AAsIHEiwoMGDB9OEKEIHocOHEAnacGMmiY8zBspE3MhxjI8Of3z4UNChxQGOKBEeOKNApMuPFh6WOJAjSJ2UBRtg6fDSpcUiCLXQWKHnwRY1QnAOtICmp0s0WA6S0QMBxoULJiCwuamUqVORUA3meJCigtmzEKAoLWCA51cFNgyygXC2booVGnGGEPEVTQuDftaUrXs2xZekOAmAfInGTAiDS1bAIHwWg5q1fgiI6ICmQ8nHBukIpmzWBJkGawuEIGDBwpiGCGlgIH1BD4DUA1FDDJPiAmWtXHFz/ABhcIULgbYsEY5zwYoUQEzoYbOcecqZYdSQuW09dQPd3cOL/x9Pvrz58+jTq1/Pvr379/DjCyzhwoV8JhyQwIGDxMEc9y70EIETCCDgRARIMMDeCTVEgMODEEbQA3t5ILABhBg6kYdDgCSgQhw3CEeBgxhGSAFCcYzggQAC/JDBDSesVQMJJUJIAhElFDRDHCig8MOPHkgwQog4lTABjTXicKNBQ4zg449QDmCEIEppgGSNEThQ0AkqDADllz94kECRLsDhRI0IwKFgQW14CeaPA4CwlgZOnAlhnRrESNAMbb75owByzhmFEySQ4EQUGuRoEAhuvinAG7jNkYcDDmjw30EnDNHEk1+iMAIguJUgakQzgCAApz+cqkJ7JagwggADDBAggBWQvidFHFdc8UYW6QUEACH5BAUCACwALA8AEQAyADEAAAj/AAsIHEiwoMGDCAfSSZOGTsKHECMWaHCAwBkzPM4QOPCwDIAgdSSKPHCmg4g/f0R0OFPkIAA2Kx482LIgpMiHbjr42MmzQ4sGBb88gADjwgUTEGg4vHkwBM+nO9GMIRhkhYkKWLMG+sD0IBadUKMSIAgFQtazMB4sAdp14A40YaNaILjl6tmsJsi0JTgGbtwOOxSuSXE3KwYvbPceCCAirAgzaegSLlwByIK9BHd0+PNUBJrABD+YLWwUDGaCBlQqQNPBDJbEAsEYLQzhyOmCIQi4cWMg8kEoQCZXuABhTY7bBhvAPqhmRQogQCrQAIAc84EwC9TkELK8uvfv4MOL/x9Pvrz58+jTq1/Pvr379/Djy59Pv7598C5cMJGvAQmcO11QwIB7J9RAghMIbOBEBFHsgdANKsihgg7gURABDhhmSEIXLhSURRt8CDCAAD8oMQRyJzAgxgYZthgBBwXhIYEHP9TogQRWSFHCbRyQ0GKLJBCxo0BvkFjjkT9IgMdtJzhw4Y8YOtEHQXgMgOSRHjSh42kO+AglDlISRIWRV9aYwG17sPglCROIiUKZNp55Wx9etsiigwNVCWeWJ6IpRp04IECCAwUl4AGNV0qQgXd79CHogXDAaBAXM2IpwQg3fMfEHg44oEGHCMnRhAAilnhDCSd8NyREJUgRAwgT0gZ3QqrsBQQAIfkEBQIABgAsDQAQADUAMgAACP8ACwgceCDIkoEIEypcyFBgGhs20jTUQmPFgwcvyDTcyLFACDdmFCgw46aIQjJ6MMC4cAGIiQ8dYyIMEaDDHx8+kqAxEwKhFj0pKggVegHDApkyWyjAydQHmjN2BtKAMLRqijV1kG5sEEJE06YdxggsswJG1bNahGhtuAPNV6YdCBRoAODBhbNDTWhcy3BHh7c44wo8UBav0BRh+DIcsxRwBywNCgg5AsQwjAcHFSssc6ZxUwUBDgwkQxUvBDaaF3fwylRBErECGwhhE8gsUQhbRKdOGBmLmQ5ogp+xodAPlAcmgADRwybz7oVpdhAgMKYMwwZLyCxQk+M5xwbgI3v/H0++vPnz6NOrX8++vfv38OPLn0+/vv37+PPr38+/v///AAYo4AkuuMDERoAkEEMCUqh3Agd9wHFHFxS4sBAII3ggAApNcJHFeXMQEYETG2zgRARdVJHQIBKg8MOLHkhgxIfl1RABDjjmSEIfBwqkgwcevCjkDxJwUd4eOGyQ45IkaCCQIG0MMKSQKIzQ4HgOkLAkkzUMZIQAUwrpgQ6CjDeBllvi6AQSA1EBZpg/eJAAeRSgmaYTPQyEh5RhesDHDeTl4USaOEZAgUAnvPHmlAMYQV4JTHQx6JYI3MEAQnhIEKSQAvCRwAzl5YGDnTg44QQHBZSAaBZt/DDAqwJQITHneXn0gQAJJDgRhZML6SBHG1y88YR6TOTBgQN5WDhQQAAh+QQFAgBjACwNABAANQAzAAAI/wDHCBQoREuYMAAGKlzIsKHDMQdCjCnSwOGXFxVSpHhAI8jDjyCLWAggkEcLGw0rALlQocIFDCtygJzpUIRAH2MUYFEI4AHDChBe0Bz6UASPIgIbQHHYEgzRpwwJCCzwwoRDDF4KQN2qoMWYAgW2pHAI5MNWrl6/HgFy1cvZrRa0NlgAoeGFC07fDk0iAqXAJSusMqRRUe9MER0MDAQb5gGGC2MuwPhreGaHADsYFtBC4wHLFVAOlKj80QKWA4UZClkCRgtq0iDBwp5Nu7bt27hz697Nu7fv38CDCx9OvLjx48iTK1/OvLnz59CjwwYr+2EBKTeGaMVdwIWGCRM4MMnYvjBBhhEsmhiJQX52AQ1RSMgnIcZB+zExfkjwwF+AAC73VabBBk4ohEAEFJB3QxMoLOTBACqcMJsLURS40AY4VDFaAVc8JMMTsJ2gwUcU0PTDV731INwEHyExkBIO/fCDDrNxQIJDJNQwlQoDNCSAFRKSVkAVYmzAEA5OjCjQFFSMceJAKEAYoF4TRICDQjhEoCJ5Q1AxgH8CSNAECLYxUYN8CCAwhpYuMJSFCkpQYQQXN+SmARFdRNEDB0w4NMMMv53ABHXUBQQAOw==";var c;c='<img onload="'+s+'" src="'+l+'" alt="'+o+'" /><br />';var d=t.content_html?t.content_html:'<div class="loading_hash_animation">'+c+o+"</div>";var u='<base href="https://'+document.location.hostname+'" target="_blank">\n<style>'+i+"</style>\n"+n+"\n"+d;TS.dir(439,t,"_getSpinnerHtml html: "+u);return u};var c=function e(t){TS.has_pri[g]&&TS.dir(g,t,"_storeLastWindowSize token: "+t.token);TS.prefs.setPrefLocal("ssb_space_window",JSON.stringify({token:t.token,x:t.x,y:t.y,width:t.width,height:t.height}));u()};var d=function e(){TS.prefs.setPrefByAPI({name:"ssb_space_window",value:TS.prefs.getPref("ssb_space_window")})};var u=function e(){d()};var m=function e(){return TS.utility.parseJSONOrElse(TS.prefs.getPref("ssb_space_window"),null)};var f=function e(t,i){h(t,i)};var h=function e(t,i){var n;try{n=TS.interop.desktop.getGeometryForWindow(t.token)}catch(e){TS.warn('TSSSB method getGeometryForWindow threw error with token of "'+t.token+'"',e)}if(n){t.x=n.x;t.y=n.y;t.height=n.height;t.width=n.width;setTimeout(i,0)}};var p=function e(i){var n={};if(!Object.keys(t).length){TS.storage.storeClientWindows(n);return}_.forOwn(t,function(e,a){if(!e.worth_saving)return;f(e,function(e){return function(){var a=t[e];if(!a)return;n[e]={token:e,x:a.x,y:a.y,width:a.width,height:a.height,file_id:a.file_id,title:a.title,destination_url:a.destination_url,url:a.url,no_spinner:a.no_spinner,worth_saving:a.worth_saving};TS.has_pri[g]&&TS.dir(g,n[e],"_storeWins LS_win token: "+e);TS.storage.storeClientWindows(n);e==i&&c(n[e])}}(a))});Object.keys(n).length||TS.storage.storeClientWindows("")};var g=438})()},3040:function(e,t){(function(){TS.registerModule("client.ui.files",{$file_btn:null,onStart:function e(){TS.files.team_file_comment_added_sig.add(TS.client.ui.files.teamFileCommentAdded);TS.files.team_file_comment_edited_sig.add(TS.client.ui.files.teamFileCommentEdited);TS.files.team_file_comment_deleted_sig.add(TS.client.ui.files.teamFileCommentDeleted);TS.files.team_file_changed_sig.add(TS.client.ui.files.teamFileChanged);TS.files.team_file_deleted_sig.add(TS.client.ui.files.teamFileDeleted);TS.view.members.unknown_resolution_rebuild_sig.add(TS.client.ui.files.memberChanged);TS.view.channel.unknown_resolution_rebuild_sig.add(TS.client.ui.files.channelChanged);function t(){TS.client.ui.files.bindUploadUI();TS.client.ui.files.bindFileUI();TS.files.media.bindVideoElements({container:".p-history_container",onError:o});TS.boot_data.feature_file_threads&&TS.interop.mountFilesFlexpane(TS.model.team.id,$("#files_tab")[0])}TS.has_pri[82]&&TS.log(82,"deferring UI bind until login_sig");TS.client.login_sig.add(t)},preview_file_waiting_on:null,showFilesFromHistory:function e(t,i){if(!t){TS.client.ui.files._displayFileList();TS.client.flexDisplaySwitched("files",null,false,true);return}if(TS.boot_data.feature_file_threads){var n;TS.interop.utility.looksLikeMemberId(t)?n=TS.interop.members.ensureMembersArePresent([t]):"all"===t&&(n=Promise.resolve());if(n){n.then(function(){if(i){TS.client.ui.files.filterFileList(i);TS.view.files.setButtonState(i)}TS.client.ui.files.toggleFileList(t);TS.client.ui.files._displayFileList();TS.client.flexDisplaySwitched("files",t,false,true)});return}}var a=TS.files.getFileById(t);if(a){TS.client.ui.files._displayFile(t);TS.client.flexDisplaySwitched("files",t,false,true);TS.boot_data.feature_file_threads||TS.files.fetchFileInfo(t)}else{if(TS.boot_data.feature_file_threads)return;TS.client.ui.files.preview_file_waiting_on=t;TS.files.fetchFileInfo(t,function(e,t){if(e!=TS.client.ui.files.preview_file_waiting_on)return;TS.client.ui.files.preview_file_waiting_on=null;if(t){TS.client.ui.files._displayFile(t.id);TS.client.flexDisplaySwitched("files",t.id,false,true)}else{TS.client.ui.files._displayFileList();TS.client.flexDisplaySwitched("files",null,true)}})}},_displayFile:function e(t,a,r){var s=TS.files.getFileById(t);if(!s)return false;if(!TS.client.ui.flex._displayFlexTab("files"))return false;TS.client.ui.files._rebuildBackFromFilePreview(a);TS.model.previewed_file_id=t;TS.view.files.hideList();$("#file_list_container").hideWithRememberedScrollTop();if(TS.boot_data.feature_share_mention_comment_cleanup)r?n(s,r):i(s);else{$("#file_preview_container").unhideWithRememberedScrollTop();TS.client.ui.files.rebuildFilePreview(s);$("#file_preview_scroller").scrollTop(0)}$("#file_comment_form").css("visibility","");if(TS.files.isFileAuthorExternal(s)){$(".p-external_file_author_notice").removeClass("hidden");$("#file_comment_form").addClass("hidden")}else{$(".p-external_file_author_notice").addClass("hidden");$("#file_comment_form").removeClass("hidden")}TS.view.resizeManually("TS.client.ui.files._displayFileList");return true},_displayFileList:function e(){if(!TS.client.ui.flex._displayFlexTab("files",true))return false;TS.model.previewed_file_id="";$("#file_preview_container").hideWithRememberedScrollTop();$("#file_list_container").unhideWithRememberedScrollTop();TS.view.files.unHideList();TS.view.resizeManually("TS.client.ui.files._displayFileList");return true},rebuildFilePreview:function t(i){if(TS.boot_data.feature_file_threads)return;var n;if(i.user&&"USLACKBOT"===i.user&&i.bot_id){n=TS.interop.bots.getBotById(i.bot_id);n.is_bot=true;n.is_service=true}else n=TS.redux.members.getPotentiallyUnknownMemberById(i.user);var r=TS.files.getFileActions(i);r.file=i;r.member=n;r.user=TS.model.user;r.show_open_public_link=!TS.prefs.getTeamPref("disallow_public_file_urls");r.show_revoke_public_link=!TS.prefs.getTeamPref("disallow_public_file_urls")&&r.revoke_public_link;if("email"===i.mode){r.to_more_count=i.to.length-1;r.cc_more_count=i.cc.length-1}i&&i.id&&("snippet"!==i.mode&&"post"!==i.mode&&"space"!==i.mode||i.content||i.content_html||i.content_highlight_html||TS.files.fetchFileInfo(i.id));$.extend(r,TS.files.getFileTemplateArguments(i));var s=$("#file_preview_scroller").find("#file_preview_head_section");r.video_height&&(r.video_height=TS.model.native_video_embed_height_flexpane);var o=TS.templates.file_preview_title(r);var l=TS.templates.file_preview_file(r);var c=TS.templates.file_preview_meta(r);var d=false;if(TS.interop.files.fileIsHostedSupportedMedia(i)&&i.id===TS.model.previewed_file_id){var u;TS.interop.files.fileIsSupportedAudio(i)?u=s.find("audio"):TS.interop.files.fileIsSupportedVideo(i)&&(u=s.find("video"));if(u.length){var _=u[0];var m=!_.paused;var f=0===_.currentTime;var h=_.currentTime===_.duration;(m||!f&&!h)&&(d=true)}}if(d){s.find(".file_preview_title").replaceWith(o);s.find(".file_preview_meta").replaceWith(c)}else{var p=o+l+c;s.html(p)}TS.utility.makeSureAllLinksHaveTargets(s);TS.files.fileIsImage(i)?s.find(".image_container .image_bg img").error(function(){$(this).closest(".image_body").addClass("broken_image")}):TS.interop.files.fileIsSupportedVideo(i)?TS.files.media.bindVideoElements({container:s,onError:function e(t){t.addClass("hidden")}}):"space"===i.mode&&TS.utility.attachments.unfurlPlaceholders(s);r={file:i};var g=$("#file_preview_scroller").find("#file_preview_comments_section");g.html(TS.templates.comments(r));TS.utility.makeSureAllLinksHaveTargets(g);if(i.id!=TS.model.last_previewed_file_id){var T=TS.storage.fetchLastCommentInput(i.id);T?TS.utility.contenteditable.value($("#file_comment_form #file_comment"),T):TS.utility.contenteditable.clear($("#file_comment_form #file_comment"));TS.utility.contenteditable.clearHistory($("#file_comment_form #file_comment"))}"email"===i.mode;TS.model.last_previewed_file_id=i.id;if(i.content&&"snippet"===i.mode){$("#truncated_message").addClass("hidden");var S=!!e;var v=$("#snippet_wrap");var b=$('#flex_contents .snippet_container[data-file-id="'+i.id+'"]');v.bind("change",function(){e=$(this).prop("checked");e?b.addClass("snippet_wrap"):b.removeClass("snippet_wrap")});if(S){v.prop("checked","checked");b.addClass("snippet_wrap")}}TS.ui.utility.updateClosestMonkeyScroller($("#file_preview_scroller"));a(i);(TS.utility.contenteditable.hasFocus($("#file_comment"))||TS.utility.contenteditable.isActiveElement($("#file_comment")))&&$("#file_comment_submit_btn").scrollintoview({offset:"bottom",px_offset:-50,duration:0})},cleanFilePreview:function e(){$("#file_preview_head_section").empty();$("#file_preview_comments_section").empty()},_rebuildBackFromFilePreview:function e(t){var i=$("#back_from_file_preview");i.unbind();var n;n="member_preview"===t?TS.interop.i18n.t("Member","files")():"starred_items"===t?TS.interop.i18n.t("Starred Items","files")():"channel_page"===t?TS.interop.i18n.t("Channel Details","files")():"group_page"===t?TS.interop.i18n.t("Channel Info","files")():"im_page"===t?TS.interop.i18n.t("Conversation Details","files")():TS.interop.i18n.t("Files","files")();i.html(TS.templates.builders.filePreviewBackIcon()+" "+n);i.bind("click.back",function(){TS.client.ui.files.backButtonOnClick(t)});i.data("origin",t)},backButtonOnClick:function e(t){if("member_preview"===t)TS.client.ui.previewMember(TS.model.last_previewed_member_id);else if("starred_items"===t)TS.client.ui.flex.openFlexTab("stars");else if("channel_page"===t)TS.client.ui.flex.openFlexTab("details");else if("group_page"===t)TS.client.ui.flex.openFlexTab("details");else if("im_page"===t)TS.client.ui.flex.openFlexTab("details");else if("mentions"===t)TS.client.ui.flex.openFlexTab("mentions");else{TS.client.ui.files.showFileList();TS.client.flex_pane.maybeFetchFileList()}},previewFile:function e(t,i,n,a,r){if(TS.boot_data.feature_file_threads){TS.client.ui.flex._displayFlexTab("files");TS.client.flexDisplaySwitched("files",t,false,false,i);return}var s=TS.files.getFileById(t);TS.model.ui_state.flex_visible&&TS.model.previewed_file_id===t&&!$("#file_preview_scroller").is(":hidden")&&$("#file_preview_scroller").highlight(1500,"flex_highlight",false,0);if(!s){TS.client.ui.files.preview_file_waiting_on=t;TS.files.fetchFileInfo(t,function(e,t){if(e!=TS.client.ui.files.preview_file_waiting_on)return;TS.client.ui.files.preview_file_waiting_on=null;t?TS.client.ui.files.previewFile(t.id,i,true,r):TS.generic_dialog.alert(TS.interop.i18n.t("This file can\u2019t be found.","files")(),TS.interop.i18n.t("Sorry, that didn\u2019t work","files")())});return}if(!TS.client.ui.files._displayFile(t,i,r))return;TS.client.flexDisplaySwitched("files",t);a&&TS.utility.contenteditable.focus($("#file_comment"));n||TS.files.fetchFileInfo(t)},teamFileCommentAdded:function e(i,n){t(i)&&TS.client.ui.files.appendFileComment(i,n);TS.boot_data.feature_share_mention_comment_cleanup&&TS.files.resetFileCommentsGroup(i)},teamFileCommentEdited:function e(i,n){t(i)&&TS.client.ui.files.updateFileComment(i,n);TS.boot_data.feature_share_mention_comment_cleanup&&TS.files.resetFileCommentsGroup(i)},teamFileCommentDeleted:function e(i,n){t(i)&&TS.ui.comments.removeFileComment(i,n,function(){TS.ui.utility.updateClosestMonkeyScroller($("#file_preview_scroller"))});TS.boot_data.feature_share_mention_comment_cleanup&&TS.files.resetFileCommentsGroup(i)},teamFileChanged:function e(t){var i="files"===TS.model.ui.active_tab_id&&TS.model.previewed_file_id==t.id;var n=!TS.interop.files.isObjectFresh(t.id);if(n&&i){TS.files.getFileById(t.id);return}i&&TS.client.ui.files.rebuildFilePreview(t);TS.boot_data.feature_share_mention_comment_cleanup&&TS.files.resetFileCommentsGroup(t)},teamFileDeleted:function e(t){"files"===TS.model.ui.active_tab_id&&TS.model.previewed_file_id==t.id&&TS.client.ui.files.showFileList();TS.boot_data.feature_share_mention_comment_cleanup&&TS.files.resetFileCommentsGroup(t)},memberChanged:function e(i){var n=TS.files.getFileById(TS.model.previewed_file_id);if(!n||!t(n)||!i.id)return;_(n.comments).filter({user:i.id}).map(_.partial(TS.client.ui.files.updateFileComment,n)).value()},channelChanged:function e(i){var n=TS.files.getFileById(TS.model.previewed_file_id);if(!n||!t(n)||_.isEmpty(n.comments)||_.isEmpty(i))return;var a=_.map(i,"id");_.each(n.comments,function(e){var t=e.comment;var i=TS.format.extractIds(t).c_ids;if(_.isEmpty(i))return;_.intersection(a,i).length&&TS.client.ui.files.updateFileComment(n,e)})},storeLastCommentInputForPreviewedFile:function e(t){if(!TS.model.previewed_file_id)return;TS.storage.storeLastCommentInput(TS.model.previewed_file_id,t)},bindFileUI:function e(){$("#file_list_heading").bind("click.show_menu",function(e){e.preventDefault();TS.menu.file.startWithFileFilter(e)});$("#file_list_clear_filter").bind("click.clear_filter",function(e){e.stopPropagation();TS.view.files.clearFilter()});$("#file_list_toggle_all").bind("click.toggleList",function(){TS.client.ui.files.toggleFileList("all")});$("#file_list_toggle_user").bind("click.toggleList",function(e){if(e.isDefaultPrevented())return;var t=$("#file_list").data("filter-user");t?TS.client.ui.files.toggleFileList(t):TS.client.ui.files.toggleFileList(TS.model.user.id)});$("#file_list_toggle_users").bind("click.show_menu",function(e){e.preventDefault();TS.menu.file.startWithFileMemberPromiseFilter(e)})},showFileList:function e(){if(!TS.client.ui.files._displayFileList())return;TS.client.flexDisplaySwitched("files")},filterFileList:function e(t){if("all"===t){TS.model.active_file_list_filter=t;TS.view.files.clearFilter()}else if("user"===t){TS.view.files.clearFilter();TS.client.ui.files.toggleFileList(TS.model.user.id)}else if(TS.interop.utility.looksLikeMemberId(t))TS.client.ui.files.toggleFileList(t);else{TS.model.active_file_list_filter=t;TS.view.file_list_heading=TS.model.file_list_type_map[t];TS.model.file_list_types=[t];TS.view.files.filterSet();$("#file_list_clear_filter").removeClass("hidden")}},toggleFileList:function e(t){if(TS.boot_data.feature_file_threads){TS.redux.dispatch(TS.interop.redux.features.filesFlexpane.setUser("all"===t?"":t));TS.client.ui.flex._displayFlexTab("files");TS.client.flexDisplaySwitched("files",t);return}var i="all"===t;var n=!i&&TS.interop.members.getMemberById(t);if(!i&&!n){TS.error(t+" is not valid?");return}var a=$("#file_list");if(a.data("list")==t)return;a.data("list",t);var r=TS.interop.i18n.t("Just You","files")();var s=["all","user"];var o=i?"all":"user";s.forEach(function(e){var t=e==o;var i=$("#file_list_toggle_"+e);t?i.addClass("active"):i.removeClass("active");i.find(".tab").attr("aria-selected",t)});var l=s.reduce(function(e,t){if(e)return e;if(t===o)return"file_list_toggle_"+t;return null},null);$("#file_list_scroller").attr("aria-labelledby",l);var c=function(){if(i)return r;if(n){if(n.id==TS.model.user.id)return r;return TS.interop.members.getPrefCompliantMemberName(n)}}();$("#file_list_toggle_user .tab_label").text(c);TS.model.active_file_list_member_filter=t;var d=function(){if(i)return TS.model.user.id;if(n)return t}();a.data("filter-user",d);var u=$("#file_list_toggle_users");i?u.removeClass("active"):u.addClass("active");TS.view.files.filterSet()},submitFileComment:function e(t){var i=$("#file_comment_form #file_comment");var n=TS.utility.contenteditable.value(i);n=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(n,{enableBroadcastKeywords:false});var a=TS.format.cleanMsg(n);if(!$.trim(a)){TS.sounds.play("beep");return}var r=TS.model.previewed_file_id;var s=i.closest("[data-model-ob-id]").attr("data-model-ob-id");TS.ui.fs_modal_file_viewer.is_showing&&(r=TS.ui.fs_modal_file_viewer.getCurrentFileId());var o=TS.files.getFileById(r);if(!o){TS.error("no file to submit comment");return}var l=TS.ui.needToBlockAtChannelKeyword(n,o);if(l){TS.generic_dialog.alert(TS.interop.i18n.t("<p>A Team Owner has restricted the use of <strong>{keyword}</strong> messages.</p>","files")({keyword:TS.interop.i18n.safeString(_.escape(l))}));return}if(!t){var c=o.channels.concat(o.groups);var d=c.filter(function(e){return TS.ui.needToShowAtChannelWarning(e,n)});if(d.length>0){TS.ui.at_channel_warning_dialog.startInFlexPane(o,d,n);return}}TS.utility.contenteditable.clear($("#file_comment_form #file_comment"));TS.utility.contenteditable.clearHistory($("#file_comment_form #file_comment"));TS.ui.fs_modal_file_viewer.is_showing&&$("#file_comment").closest("#fs_modal").length&&TS.interop.clog.track("FILE_FULLSCREEN_COMMENT_ADD",{});TS.files.addComment(r,a,s,function(e,t,i){if(e)TS.storage.storeLastCommentInput(i.file,"");else{alert("error: comment not added to file");i.file==TS.model.last_previewed_file_id&&TS.utility.contenteditable.value($("#file_comment_form #file_comment"),TS.storage.fetchLastCommentInput(i.file))}})},rebuildFilePreviewAndCommentsIncludingMember:function e(t){var i={member:t,for_message:true};$("#col_flex .message_current_status.color_"+t.id).replaceWith(TS.templates.current_status(i))},appendFileComment:function e(t,i){var n=$(".file_comments_"+t.id);var a=TS.redux.members.getPotentiallyUnknownMemberById(i.user);n.append(TS.templates.builders.buildCommentHTML({file:t,comment:i,show_comment_actions:true,member:a}));TS.utility.makeSureAllLinksHaveTargets(n);if(i.user==TS.model.user.id){var r;r=$(".file_comment_submit_btn");r.scrollintoview({offset:"bottom",px_offset:-50,duration:0})}var s;s=TS.boot_data.feature_share_mention_comment_cleanup?$(".file_comments_scroller"):$("#file_preview_scroller");TS.ui.utility.updateClosestMonkeyScroller(s)},updateFileComment:function e(t,i){var n=TS.redux.members.getPotentiallyUnknownMemberById(i.user);var a=$('.comment[data-comment-id="'+i.id+'"]');if(!a.length)return;a.replaceWith(TS.templates.builders.buildCommentHTML({file:t,comment:i,show_comment_actions:true,member:n}));a.each(function(){TS.utility.makeSureAllLinksHaveTargets($(this))});TS.ui.utility.updateClosestMonkeyScroller($("#file_preview_scroller"))},validateFiles:function e(t,i,n,a,r,s){if(!t)return;i=!!i;var o=[];var l=0;var c=0;var d=false;var u=false;var m={};var f=[];function h(e){c=Math.max(0,c+e)}function p(){o=[];c=0;l=0;d=false;u=false}TS.client.ui.resetFiles||(TS.client.ui.resetFiles=p);function g(){if(!d&&o.length){d=true;TS.client.ui.file_dropped_sig.dispatch(o,i,a,r,s)}}function T(){if(u)return false;if(l>0&&(o.length>=c||c<=0)){u=true;f.length?y(t,function(){n?n(o,g):g()}):n?n(o,g):g()}}function S(e){o.push(e)}function v(e){e.onerror=null;e.onload=null;return null}function b(e,t){var i;var n;n={isFile:null,isDirectory:null};if(e.size<16384&&window.FileReader){i=new FileReader;i.onload=function(e){i=v(e.currentTarget);n.isFile=true;t(n)};i.onerror=function(e){i=v(e.currentTarget);n.isDirectory=true;t(n)};try{i.readAsDataURL(e)}catch(e){i=v(i);n.isDirectory=true;t(n)}}else t(n)}function w(e,t,i){var n;var a;var r;var s;var o;a=false;o=e.name||t.name;if(!o)return false;r=o.lastIndexOf(".");-1!==r&&(s=o.substr(r));s&&(n=m[s]&&m[s].enabled?m[s]:null);if(t&&(t.isFile||t.isDirectory)){if(t.isDirectory||t.isFile&&n&&n.applyToFile){a=true;return i(a)}a=false;return i(a)}b(e,function(e){e.isDirectory?a=true:n&&n.applyToFile&&(a=true);return i(a)})}function y(e,t){var i;var n;var a;var r;var s;var o;var c;var d;var u;if(f.length){a=[];c="";u="";for(i=0,n=f.length;i<n;i+=1)a.push("<li><strong>"+_.escape(f[i].name)+"</strong></li>");if(f.length>1){s=f.length===l?TS.interop.i18n.t("All files unsupported","files")():TS.interop.i18n.t("Some files unsupported","files")();c="<ul>"+a.join("\n")+"</ul>"}else 1===f.length&&(s=TS.interop.i18n.t("File unsupported","files")());r=l-f.length;f.length>1?d=TS.interop.i18n.t("<p>Try uploading a .zip version of these files instead.","files")():1===f.length&&(d=TS.interop.i18n.t("<p>Try uploading a .zip version of this file instead.","files")());r>1?u=TS.interop.i18n.t("<p>(Don\u2019t worry, your other files are next.)</p>","files")():1===r&&(u=TS.interop.i18n.t("<p>(Don\u2019t worry, your other file is next.)</p>","files")());o=1===f.length?TS.interop.i18n.t("<p>Sorry, <strong>{excluded_file}</strong> is a type of file not supported by Slack</p>","files")({excluded_file:TS.interop.i18n.safeString(_.escape(f[0].name))}):f.length===l?TS.interop.i18n.t("<p>Sorry, none of those file types are supported by Slack.</p>","files")():TS.interop.i18n.t("<p>Sorry, some of those file types are not supported by Slack.</p>","files")();TS.generic_dialog.start({title:s,body:o+c+d+u,show_cancel_button:false,esc_for_ok:true,onGo:function e(){TS.generic_dialog.end();t&&t()}})}return f.length}function A(e){l=e.length;h(e.length);var t;var i;var n;var a;for(var r=0;r<e.length;r+=1){t=e[r];n=t;a=t;if(t.isFile||t.isDirectory){i=t;a=t}if(t.getAsEntry){i=t.getAsEntry();a=i}else if(t.webkitGetAsEntry){i=t.webkitGetAsEntry();a=i}"function"===typeof t.getAsFile?n=t.getAsFile():File&&t instanceof File&&(n=t);a&&n||h(-1);(function(e,t){w(e,t,function(i){if(i){t.name?f.push(t):f.push(e);h(-1);T()}else{0===e.size?h(-1):S(e);T()}})})(n,a)}}A(t);T()},bindUploadUI:function e(){TS.client.ui.files.$upload||(TS.client.ui.files.$upload=$("#file_upload"));$(".file_upload_btn").bind("click.file_menu",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;TS.menu.file.startWithNewFileOptions(e,$(this));return false});TS.client.ui.files.$upload.bind("change",function(){window.desktop&&desktop.app&&desktop.app.focusWebView&&desktop.app.focusWebView();if(!$(this).val())return;var e;if(TS.boot_data.feature_file_threads){e=TS.client.ui.files.$upload.data("upload-location");TS.client.ui.files.$upload.removeData("upload-location")}var t=$(this)[0].files;if(t){if(!t.length)return;TS.view.filesSelected(t,e);TS.client.ui.files.$upload.val("")}});TS.client.ui.files.$upload.bind("click",function(e){if(TS.client.ui.files.shouldEnforceFileLimits()){e.preventDefault();TS.client.ui.files.showOverFileLimitsModal(true)}});$("body").bind("drop",function(e){var t;var i;window.focus();e.preventDefault();TS.client.ui.files.hideAllDragDropModals();if(TS.client.ui.checkForEditing(e))return;i=e.originalEvent.dataTransfer;if(!i)return;t=i.files||i.items;var n;n=window.bowser&&window.bowser.msie&&window.bowser.version<=11?i.getData("url"):i.getData("text/uri-list");if(!t.length&&!n)return;if("disable_all"===TS.prefs.getTeamPref("disable_file_uploads")){TS.generic_dialog.start({title:TS.interop.i18n.t("Upload failed","files")(),body:TS.interop.i18n.t("At the request of your administrator, file uploads have been disabled on this workspace.","files")(),show_cancel_button:false,onGo:function e(){TS.files.uploadOver(false)}});return}var a=e&&e.shiftKey;var r=TS.shared.legacyGetActiveModelOb();if(TS.boot_data.feature_file_threads){var s=$(e.target);var o=s.closest("#col_messages").length>0&&!TS.client.activeChannelIsHidden();var l=s.closest("#convo_tab").length>0;if(!o&&!l)return;if(l){TS.client.ui.files.shouldEnforceFileLimits()?TS.client.ui.files.showOverFileLimitsModal(true):TS.ui.replies.maybeUploadDroppedFiles(t,a);return}}if(!TS.boot_data.feature_announce_only&&r&&r.is_general&&!TS.permissions.members.canPostInGeneral()){TS.generic_dialog.start({title:TS.interop.i18n.t("Can\u2019t share in #{channel_name}","files")({channel_name:TS.interop.i18n.safeString(r.name)}),body:TS.interop.i18n.t("To keep things tidy, your Workspace Owners have set limits on sharing files and sending messages in #<strong>{channel_name}</strong>.","files")({channel_name:TS.interop.i18n.safeString(r.name)}),show_cancel_button:false,go_button_text:TS.interop.i18n.t("OK","files")()});return false}if(TS.boot_data.feature_announce_only&&r&&!TS.interop.rules.user.canPostInChannel(r.id)){TS.generic_dialog.start({title:TS.interop.i18n.t("Cannot Post To #{channel_name}","files")({channel_name:r.name}),body:TS.interop.i18n.t("Only selected members can post in this channel. Nothing personal! You can share your file in another channel.","files")(),show_cancel_button:false,go_button_text:TS.interop.i18n.t("Okay!","files")()});return false}if(r&&TS.interop.rules.channels.isOrgShared(r)&&!TS.interop.rules.user.canPostInChannel(r.id)){TS.generic_dialog.start({title:TS.interop.i18n.t('Cannot Post To #{channel_name}<ts-icon class="ts_icon_org_shared_channel"></ts-icon>',"files")({channel_name:r.name}),body:TS.interop.i18n.t('An Owner of your workspace has limited who can post to <strong>#{channel_name}<ts-icon class="ts_icon_shared_channel"></ts-icon></strong>. Nothing personal! You can share your file in another channel.',"files")({channel_name:r.name}),show_cancel_button:false,go_button_text:TS.interop.i18n.t("Okay!","files")()});return false}TS.model.archive_view_is_showing&&TS.client.archives.getCurrentModelOb().is_archived&&(a=false);var c=!t.length&&window.desktop&&desktop.app&&"function"===typeof desktop.downloads.startTempDownload;if(TS.boot_data.feature_browser_dragndrop&&c){t=[];TS.files.file_uploading_sig.dispatch("dragged file...",false,false);var d=desktop.downloads.startTempDownload(n);d.then(function(e){var i=e.bits;var n=e.mimeType;var r=e.fileName;var s=new Blob([i],{type:n});var o=new File([s],r,{type:n});t.push(o);TS.files.file_queue_emptied_sig.dispatch();TS.client.ui.files.validateFiles(t,a)},function(){TS.generic_dialog.start({title:TS.interop.i18n.t("Upload failed","files")(),body:TS.interop.i18n.t("Verify your URL contains a valid file.","files")(),show_cancel_button:false,onGo:function e(){TS.files.uploadOver(false)}});TS.files.file_queue_emptied_sig.dispatch()});return}if(!t)return;TS.client.ui.files.shouldEnforceFileLimits()?TS.client.ui.files.showOverFileLimitsModal(true):TS.client.ui.files.validateFiles(t,a)});$("#drop-zone").unbind("click.dismiss").bind("click.dismiss",function(){TS.client.ui.files.hideDropTargetModal()});TS.boot_data.feature_file_threads&&$("#message_pane_drag_overlay_mount_point").unbind("click.dismiss").bind("click.dismiss",function(){TS.client.ui.files.hideDropTargetModal()});$("#over-storage-limit-modal").unbind("click.dismiss_over_storage_limit_modal").bind("click.dismiss_over_storage_limit_modal",function(){TS.client.ui.files.hideOverFileLimitsModal()});var t=$(window);TS.boot_data.feature_file_threads&&(t=$("#col_messages, #convo_tab"));t.draghover().on({draghoverstart:function e(t,i,n){window.desktop&&TS.info("draghoverstart winssb_file:"+n);if(TS.model.ui.is_mouse_down)return;var a=false;if(i&&i.originalEvent&&i.originalEvent.dataTransfer&&i.originalEvent.dataTransfer.types){var r=i.originalEvent.dataTransfer.types;for(var s=0;s<r.length;s+=1){var o="text/uri-list"===r[s].toLowerCase()&&TS.boot_data.feature_browser_dragndrop&&window.desktop&&desktop.app&&"function"===typeof desktop.downloads.startTempDownload;if("files"===r[s].toLowerCase()||o){a=true;break}}}a||(a=!!n);if(!a)return;if($("body").hasClass("file_snippet"))return;if("disable_all"===TS.prefs.getTeamPref("disable_file_uploads"))return;if(TS.msg_edit.editing)return false;if(TS.boot_data.feature_file_threads&&$(this).closest("#convo_tab").length){TS.client.ui.files.shouldEnforceFileLimits()?TS.client.ui.files.showOverFileLimitsModal(false):TS.ui.replies.showDragOverlay();return}if(TS.boot_data.feature_file_threads&&TS.client.activeChannelIsHidden())return;var l=TS.shared.legacyGetActiveModelOb();if(l&&TS.interop.rules.channels.isRequired(l)&&!TS.interop.rules.user.canPostInChannel(l.id))return false;TS.client.ui.files.shouldEnforceFileLimits()?TS.client.ui.files.showOverFileLimitsModal(false):TS.client.ui.files.showDropTargetModal();TS.ui.fs_modal.is_showing&&TS.ui.fs_modal.deactivate()},draghoverend:function e(){if(TS.client.ui.files.shouldEnforceFileLimits()&&!TS.client.ui.files.isShowingOverFileLimitsModalWithCTA())TS.client.ui.files.hideOverFileLimitsModal();else{if(TS.boot_data.feature_file_threads&&$(this).closest("#convo_tab").length){TS.ui.replies.hideDragOverlay();return}TS.client.ui.files.hideDropTargetModal()}TS.ui.fs_modal.is_showing&&TS.ui.fs_modal.activate()}})},hideAllDragDropModals:function e(){$("body").removeClass("drop-target over-file-limit-target show-cta-button")},showDropTargetModal:function e(){if(TS.boot_data.feature_file_threads){var t=$("#message_pane_drag_overlay_mount_point");t.removeClass("hidden");TS.interop.mountMessagePaneDragOverlay(TS.boot_data.team_id,t[0],{channelId:TS.model.active_cid});return}$("body").addClass("drop-target")},hideDropTargetModal:function e(){if(TS.boot_data.feature_file_threads){var t=$("#message_pane_drag_overlay_mount_point");t.addClass("hidden");TS.interop.unmountMessagePaneDragOverlay(t[0]);return}$("body").removeClass("drop-target")},showOverFileLimitsModal:function e(t){var i="over-file-limit-target";t&&(i+=" show-cta-button");$("body").addClass(i);$("#over-storage-limit-modal").focus();TS.interop.clog.track("UPGRDEXP_ENFORCE_FILE_LIMITS",{contexts:{ui_context:{step:"over_file_limit_modal",action:"impression"}}});$("#over-storage-limit-modal").unbind("click.over_storage_pricing_link").bind("click.over_storage_pricing_link",function(){TS.interop.clog.track("GROWTH_PRICING",{contexts:{ui_context:{step:"over_file_limit_modal",action:"click",ui_element:"pricing_link"}}})})},hideOverFileLimitsModal:function e(){$("body").removeClass("over-file-limit-target show-cta-button")},isShowingOverFileLimitsModalWithCTA:function e(){return $("body").hasClass("show-cta-button")},shouldEnforceFileLimits:function e(){if(TS.model.team.plan||TS.model.team.is_enterprise)return false;if(TS.prefs.getTeamPref("file_limit_whitelisted"))return false;if(!TS.model.team.over_storage_limit)return false;if("treatment"===TS.interop.experiments.getGroupForUser("file_limit_upload_block"))return true;return false},chooseFile:function e(t,i,n){TS.boot_data.feature_file_threads&&TS.client.ui.files.$upload.data("upload-location",{model_ob_id:t,thread_ts:i,view_context:n});TS.client.ui.files.$upload.trigger("click");TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"plus_menu_item_upload"}}})}});var e=true;Object.defineProperty(TS.client.ui.files,"$file_btn",{get:function e(){delete TS.client.ui.files.$file_btn;TS.client.ui.files.$file_btn=$("#primary_file_button");return TS.client.ui.files.$file_btn}});var t=function e(t){var i="files"===TS.model.ui.active_tab_id&&TS.model.previewed_file_id==t.id;var n=t.id===TS.ui.fs_modal_file_viewer.getCurrentFileId();return i||n};var i=function e(t){$(".file_comments_container").hideWithRememberedScrollTop();$(".file_details_container").unhideWithRememberedScrollTop();r(t);$(".file_details_scroller").scrollTop(0)};var n=function e(t,i){$(".file_details_container").hideWithRememberedScrollTop();$(".file_comments_container").unhideWithRememberedScrollTop();s(t,i);$(".file_comments_scroller").scrollTop(0)};var a=function e(t){$(".file_comment_tip").html(TS.templates.builders.makeFileCommentHelpHTML(t))};var r=function e(t){var i=$.extend(TS.files.getFileDetailsMetaTemplateArguments(t),TS.files.getFileTemplateArguments(t));i.video_height&&(i.video_height=TS.model.native_video_embed_height_flexpane);var n=TS.templates.file_details_meta(i);var a=$(".file_details_scroller").find(".file_details_meta");a.html(n);TS.utility.makeSureAllLinksHaveTargets(a);"space"===t.mode&&TS.utility.attachments.unfurlPlaceholders(a);TS.files.createFileCommentsGroup(t);var r=TS.templates.file_details_share_to(t);var s=$(".file_details_scroller").find(".file_details_share_to");s.html(r);TS.utility.makeSureAllLinksHaveTargets(s);TS.model.last_previewed_file_id=t.id;TS.ui.utility.updateClosestMonkeyScroller($(".file_details_scroller"))};var s=function e(t,i){TS.files.createFileCommentsGroup(t);var n=jQuery.extend(true,{},t);var a=n._comments_grouped[i];n.comments=a.comments;var r={file:n,comment_group:a,c_id:i};$.extend(r,TS.files.getFileTemplateArguments(t));var s=$(".file_comments_scroller");var o=TS.templates.file_comments(r);var l=s.find(".file_comments");l.html(o);$(".back_from_file_comments").attr("data-file-id",n.id);s.attr("data-model-ob-id",i);var c=s.data("monkeyScroll");c&&c.updateFunc()};var o=function e(t){t.addClass("hidden")}})()},3041:function(e,t){(function(){TS.registerModule("client.ui.flex",{onStart:function e(){TS.client.flexpane_display_switched_sig.add(c);function t(){TS.client.ui.flex.bindFlexUI()}TS.has_pri[g]&&TS.log(g,"deferring UI bind until login_sig");TS.client.login_sig.add(t)},bindFlexUI:function e(){var t=$("#client_header");$("#col_flex").delegate(".close_flexpane","click",function(){if(TS.model.ui_state.flex_visible){TS.client.ui.flex.clogOnHideFlex();TS.client.ui.flex.hideFlex()}});t.delegate("#flex_menu_toggle","click",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;TS.menu.startWithFlexMenu(e);TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_flex_menu_button"}}});TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_FLEX_MENU"}}})});t.delegate("#details_toggle","click",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;"whats_new"===TS.model.ui_state.flex_name&&TS.interop.clog.track("WHATSNEW_ACTION",{action:"close_pane",trigger:"details_toggle",step:TS.client.whats_new.getNewestID()});l("details");TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_channel_details_button"}}});TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_CHANNEL_DETAILS"}}})});t.delegate("#recent_mentions_toggle","click",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;l("mentions");TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_activity_button"}}});TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_FLEX_ACTIVITY"}}})});t.delegate("#stars_toggle","click",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;l("stars");TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_stars_button"}}});TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_FLEX_STARS"}}})});t.delegate("#channel_members_toggle_count","click",function(e){TS.client.ui.flex.toggleMembersView(e);TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_members_count_button"}}});TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_CHANNEL_MEMBERS"}}})});t.delegate("#pinned_item_count","click",function(e){TS.info("Pinned item count in channel header clicked");TS.client.ui.flex.togglePinsList(e);TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_pins_count_button"}}});TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_CHANNEL_PINS"}}})});t.delegate("#channel_share_info","click",function(){TS.client.ui.flex.openFlexTab("details");TS.client.channel_page.showAboutSection();$("#channel_page_scroller .channel_page_about").highlight(null,"channel_page_details_highlighter");TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_channel_share_info"}}})});t.delegate("#whats_new_toggle","click",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;TS.interop.clog.track("WHATSNEW_ACTION",{action:"open_pane_badged",trigger:"whats_new_toggle",step:TS.client.whats_new.getNewestID()});$("#client-ui").removeClass("whats_new_showing");l("whats_new")})},clogOnHideFlex:function e(){"whats_new"===TS.model.ui_state.flex_name&&TS.interop.clog.track("WHATSNEW_ACTION",{action:"close_pane",trigger:"close_flexpane",step:TS.client.whats_new.getNewestID()})},cleanupFlexExcluding:function e(t){if("files"!==t){TS.view.files.cleanList();TS.client.ui.files.cleanFilePreview()}if("team"!==t)if(TS.boot_data.feature_sonic_member_directory)TS.interop.unmountMemberDirectoryFlexpane($("#team_list_container")[0]);else{TS.client.ui.flex._unregisterCurrentStatusInput();var i=TS.SearchableMemberList.get("team_directory");i&&i.destroy()}if("stars"!==t)if(TS.boot_data.feature_modern_starred_items&&p){TS.interop.unmountStarredItemsFlexpane($("#stars_tab")[0]);p=false}else TS.view.cleanStars();"mentions"!==t&&TS.view.cleanMentions();if("groups"!==t&&!TS.boot_data.feature_sonic_user_groups){TS.boot_data.feature_lazy_user_groups?TS.client.ui.user_groups.cleanupLazyUserGroupList():$("#user_groups_list_wrapper").longListView("setHidden",true);if(TS.view.user_groups_members_list_lazyload){TS.view.user_groups_members_list_lazyload.detachEvents();TS.view.user_groups_members_list_lazyload=null}}},toggleFlex:function e(){if(TS.model.ui_state.flex_visible)TS.client.ui.flex.hideFlex();else if(TS.model.ui.active_tab_id){var t="list"===TS.model.ui.active_tab_id;TS.client.ui.flex.showFlex(t);TS.client.flexDisplaySwitched(TS.model.ui.active_tab_id||"",TS.model.ui.last_flex_extra||"")}else{var i=TS.model.ui_state.prev_flex_name||TS.model.default_flex_name;var n=TS.model.ui_state.prev_flex_extra;TS.client.ui.flex.setFlexStateFromHistory(i,n)}},hideFlex:function e(t,i){TS.client.ui.flex.cleanupFlexExcluding();if(TS.model.ui_state.flex_visible)if("details"===TS.model.ui_state.flex_name)t||(TS.model.ui_state.details_tab_active=false);else if(TS.model.ui_state.details_tab_active&&!TS.client.activeChannelIsHidden()){TS.client.ui.flex.openFlexTab("details",i);return}if(TS.boot_data.feature_sonic_user_groups){TS.interop.unmountUserGroupsFlexpane($("#groups_tab")[0]);h=false}var n=function e(){$("#"+TS.model.ui_state.flex_name+"_tab").removeClass("active");TS.model.ui.last_flex_extra=TS.model.flex_extra_in_url;TS.client.ui.maintainMessagePanePosition(function(){$("#client-ui").removeClass("flex_pane_showing")});TS.model.ui_state.flex_visible=false;TS.model.ui.active_tab_id=null;TS.view.resizeManually("TS.client.ui.flex.hideFlex");TS.model.ui.scrolled_to_msg_ts&&(TS.model.ui.scrolled_to_msg_ts=null);TS.client.flex_pane.stopLocalTimeInterval();$(".messages_banner").removeClass("flex_pane_showing");TS.client.flexDisplaySwitched("","",i,t);TS.client.ui.flex.adjustIFramesInSpecialFlexPanes();document.activeElement&&$(document.activeElement).closest("#col_flex").length>0&&TS.view.focusMessageInput()};"list"===TS.model.ui.active_tab_id?$("#flex_contents").transition({opacity:0},100,n):n()},last_window_width_diff:392,last_window_width_diff_default:392,showFlex:function e(t,i){var n=TS.client.ui.areMsgsScrolledToBottom();TS.client.activeChannelIsHidden()||!n?TS.client.ui.maintainMessagePanePosition(function(){$("#client-ui").addClass("flex_pane_showing")}):$("#client-ui").addClass("flex_pane_showing");TS.model.ui_state.flex_visible=true;TS.storage.storeUIState(TS.model.ui_state);i||TS.view.resizeManually("TS.client.ui.flex.showFlex");$(".messages_banner").addClass("flex_pane_showing");t?$("#flex_contents").css("opacity",0).transition({opacity:100},150):$("#flex_contents").css("opacity",100);"files"===TS.model.ui.active_tab_id&&""!==TS.model.ui.last_flex_extra&&TS.ui.utility.updateClosestMonkeyScroller($("#file_preview_scroller"),true);"downloads"===TS.model.ui.active_tab_id&&TS.ui.utility.updateClosestMonkeyScroller($("#downloads_scroller"),true);"team"!==TS.model.ui.active_tab_id||TS.model.previewed_member_id||TS.boot_data.feature_sonic_member_directory||TS.client.flex_pane.startLocalTimeInterval();("files"===TS.model.ui.active_tab_id||!TS.model.ui.active_tab_id&&"files"===TS.model.default_flex_name)&&("files"!==TS.model.ui.active_tab_id?TS.view.files.throttledRebuildList():TS.view.files.maybeRebuildList());"team"===TS.model.ui.active_tab_id&&(TS.boot_data.feature_sonic_user_groups||window.setTimeout(function(){TS.view.maybeRebuildUserGroupList()},1));if(TS.boot_data.feature_sonic_user_groups&&!h){TS.interop.mountUserGroupsFlexpane(TS.boot_data.team_id,$("#groups_tab")[0]);h=true}if(TS.boot_data.feature_modern_starred_items&&!p){TS.interop.mountStarredItemsFlexpane(TS.boot_data.team_id,$("#stars_tab")[0]);p=true}TS.client.ui.flex.adjustIFramesInSpecialFlexPanes()},_displayFlexTab:function i(a,r){var s=$("#"+a+"_tab");if(!s.length)return false;TS.model.ui_state.flex_visible||TS.client.ui.flex.showFlex(false,true);if(TS.isPartiallyBooted()){e=a;t=r;n();return true}if("stars"===a)if(TS.boot_data.feature_modern_starred_items){if(!p){TS.interop.mountStarredItemsFlexpane(TS.boot_data.team_id,$("#stars_tab")[0]);p=true}}else if(TS.stars.fetched_once)TS.view.rebuildStars(true);else{$("#member_stars_list").html(o);TS.stars.fetchUserStarredItems()}else if("downloads"===a)TS.client.downloads.maybeBuild();else if("mentions"===a)if(TS.mentions.fetched_once)TS.view.rebuildMentionsImmediately(true);else{TS.view.rebuildMentionsLoading();TS.mentions.fetchMentions()}else if("files"===a)TS.view.files.unHideList();else if("team"===a)TS.boot_data.feature_sonic_member_directory?TS.interop.mountMemberDirectoryFlexpane(TS.boot_data.team_id,$("#team_list_container")[0]):TS.client.flex_pane.startLocalTimeInterval();else if("details"===a)TS.model.ui_state.details_tab_active=true;else if("groups"===a)if(TS.boot_data.feature_sonic_user_groups){if(!h){TS.interop.mountUserGroupsFlexpane(TS.boot_data.team_id,$("#groups_tab")[0]);h=true}}else TS.boot_data.feature_lazy_user_groups?TS.client.ui.user_groups.mountLazyUserGroupList():$("#user_groups_list_wrapper").longListView("setHidden",false);"team"!==a&&TS.client.flex_pane.stopLocalTimeInterval();TS.client.ui.flex.cleanupFlexExcluding(a);$("#flex_contents > .panel").removeClass("active");s.addClass("active");TS.utility.contenteditable.isActiveElement(TS.client.msg_input.$input)||s.find(".heading").focus();TS.model.ui.active_tab_id=a;TS.model.ui.active_tab_ts=Date.now();r||TS.view.resizeManually("TS.client.ui.flex._displayFlexTab flex_name:"+a);TS.client.ui.flex.adjustIFramesInSpecialFlexPanes();return true},adjustIFramesInSpecialFlexPanes:function e(){if(!TS.boot_data.special_flex_panes)return;var t=TS.model.ui.active_tab_id;var i;var n;var a;_.forOwn(TS.boot_data.special_flex_panes,function(e){TS.has_pri[g]&&TS.log(g,"special_flex_pane: "+t);n=$("#"+e.flex_name+"_tab");if(!n.length)return;a=n.find("iframe");if(!a.length)return;i="about:blank";TS.model.ui_state.flex_visible&&e.flex_name===t&&(i=a.data("src"));if(a.attr("src")===i)return;TS.has_pri[g]&&TS.log(g,"loading src: "+i);a.attr("src",i)})},openFlexTab:function e(t,i){if(!TS.client.ui.flex._displayFlexTab(t))return;var n;if("files"===t)n=TS.model.previewed_file_id;else if("team"===t){n=TS.model.previewed_member_name;n||(n=TS.model.previewed_user_group_id)}TS.client.flexDisplaySwitched(t,n,i)},setFlexStateFromHistory:function e(t,i,n){if(TS.isPartiallyBooted()){a=arguments;r();return}if(!t){(TS.model.ui_state.flex_name||n)&&TS.client.ui.flex.hideFlex(true);return}i=i||"";var s=TS.model.ui_state.flex_extra||"";if(!n&&t==TS.model.ui_state.flex_name&&i==s)return;"list"===t&&(t="files");if(!TS.client.ui.flex._displayFlexTab(t))return;if("files"===t){var o=TS.model.ui_state.flex_extra_type;TS.client.ui.files.showFilesFromHistory(i,o)}else"team"===t?TS.client.ui.showTeamFromHistory(i):"convo"===t&&i?TS.client.ui.showRepliesFromHistory(i):"apps"===t?TS.client.ui.showAppsFromHistory(i):"groups"===t&&TS.boot_data.feature_lazy_user_groups?TS.client.ui.showGroupsFromHistory(i):TS.client.flexDisplaySwitched(t,null,false,true)},openConversationFlex:function e(t,i,n,a){var r=t.id+"-"+i;var s=!TS.model.ui_state.flex_visible||"convo"!==TS.model.ui_state.flex_name||TS.model.ui_state.flex_extra!=r;if(!s)return;TS.client.ui.flex._displayFlexTab("convo");TS.client.flexDisplaySwitched("convo",r,false,false,n,a)},openAppProfileFlex:function e(t){var i=t;TS.client.ui.flex._displayFlexTab("apps");TS.client.flexDisplaySwitched("apps",i)},toggleFlexTab:function e(t){l(t)},toggleMembersView:function e(t){if(TS.client.ui.shouldIgnoreClick(t))return false;TS.client.ui.flex.openFlexTab("details");TS.client.channel_page.showMembersSection();$("#channel_page_scroller .channel_page_members").highlight(null,"channel_page_members_highlighter")},togglePinsList:function e(t){if(TS.client.ui.shouldIgnoreClick(t))return false;TS.client.ui.flex.openFlexTab("details");TS.client.channel_page.showPinsSection();$("#channel_page_scroller .channel_page_pinned_items").highlight(null,"channel_page_members_highlighter")},rebuildMsgCurrentStatusIncludingMember:function e(t){var i=TS.model.ui_state.flex_name;if("mentions"===i||"stars"===i){var n=$("#col_flex");var a={member:t,for_message:true};_.each(TS.model.user[i],function(e){if(TS.utility.msgs.memberSentMessage(t,e.message)){var i=n.find('ts-message[data-ts="'+e.message.ts+'"] .message_current_status');i.replaceWith(TS.templates.current_status(a))}})}else"files"===i&&TS.client.ui.files.rebuildFilePreviewAndCommentsIncludingMember(t)},registerCurrentStatusInput:function e(){TS.client.ui.flex._unregisterCurrentStatusInput();$(".member_current_status_actions_edit_status").on("click.current_status",function(){TS.redux.dispatch(TS.interop.redux.actions.openCustomStatusDialog())});$(".member_current_status_actions_clear_status").on("click.current_status",u)},_unregisterCurrentStatusInput:function e(){$(".member_current_status_actions_edit_status").off(".current_status");$(".member_current_status_actions_clear_status").off("current_status")}});var e;var t;var i=function i(){e=void 0;t=void 0};var n=_.once(function(){var n=function n(){var a=e;var r=t;i();if(!TS.model.ui_state.flex_visible||!TS.model.ui_state.flex_name)return;if(!a)return;TS.client.ui.flex._displayFlexTab(a,r)};TS.redux.socket.connectedSig.addOnce(n)});var a;var r=_.once(function(){var e=function e(){var t=a;a=void 0;return TS.client.ui.flex.setFlexStateFromHistory.apply(window,t)};TS.redux.socket.connectedSig.addOnce(e)});var s=TS.interop.i18n.t("Loading...","flexpane")();var o='<div class="loading_hash_animation"><img src="'+cdn_url+'/9c217/img/loading_hash_animation_@2x.gif" alt="'+s+'" /><br />'+s+"</div>";var l=function e(t){TS.model.ui_state.flex_visible&&TS.model.ui_state.flex_name===t?TS.client.ui.flex.hideFlex():TS.client.ui.flex.openFlexTab(t)};var c=function e(){var t=TS.model.ui_state.flex_visible;var i=TS.model.ui_state.flex_name;var n=TS.shared.legacyGetActiveModelOb();d(n);if("team"!==i||!TS.model.ui_state.flex_extra){TS.model.previewed_member_id=null;TS.model.previewed_member_name=null;TS.model.previewed_user_group_id=null}if(!t)return;var a=$("#details_toggle");var r=a.find(".ts_tip_tip");var s=$("#recent_mentions_toggle");var o=$("#stars_toggle");if(n&&"details"===i){a.addClass("active");n.is_im||n.is_mpim?r.text(TS.interop.i18n.t("Hide Conversation Details","flexpane")()):(n.is_group||n.is_channel)&&r.text(TS.interop.i18n.t("Hide Channel Details","flexpane")());$("#client-ui").hasClass("details_showing")||TS.client.ui.maintainMessagePanePosition(function(){$("#client-ui").addClass("details_showing")})}else if("mentions"===i){s.addClass("active");s.find(".ts_tip_tip").text(TS.interop.i18n.t("Hide Activity","flexpane")())}else if("stars"===i){o.addClass("active");o.find(".ts_tip_tip").text(TS.interop.i18n.t("Hide Starred Items","flexpane")())}f(i)};var d=function e(t){var i=$("#details_toggle .ts_tip_tip");$("#client-ui").hasClass("details_showing")&&TS.client.ui.maintainMessagePanePosition(function(){$("#client-ui").removeClass("details_showing")});$(".channel_header_icon.active").removeClass("active");t&&(t.is_im||t.is_mpim?i.text(TS.interop.i18n.t("Show Conversation Details","flexpane")()):i.text(TS.interop.i18n.t("Show Channel Details","flexpane")()));$("#recent_mentions_toggle .ts_tip_tip").text(TS.interop.i18n.t("Show Activity","flexpane")());$("#stars_toggle .ts_tip_tip").text(TS.interop.i18n.t("Show Starred Items","flexpane")())};var u=function e(t){t.stopPropagation();var i={status_text:"",status_emoji:"",status_text_canonical:"",status_expiration:0};TS.interop.members.updateCurrentMemberProfile({profile:i})};var m={details:"details_tab_header",files:"files_tab_aria_label",team:"team_tab_aria_label",convo:"convo_tab_aria_label",apps:"app_profile_tab_header",stars:"stars_tab_aria_label",downloads:"downloads_tab_header",mentions:"mentions_tab_aria_label",groups:"back_from_user_group_preview",shortcuts:"shortcuts_tab_aria_label",whats_new:"whats_new_tab_header"};var f=function e(t){m[t]&&$("#col_flex").attr("aria-labelledby",m[t])};if(TS.boot_data.feature_sonic_user_groups)var h=false;if(TS.boot_data.feature_modern_starred_items)var p=false;var g=82})()},3042:function(e,t){(function(){TS.registerModule("client.stats",{start_collecting_sig:new signals.Signal,stop_collecting_sig:new signals.Signal,initial_time_period_collection_finished_sig:new signals.Signal,onStart:function t(){TS.client.login_sig.addOnce(function(){T();if(TS.utility.enableFeatureForUser(e)||d||c){p();d||c||setInterval(p,a)}(TS.boot_data.feature_tinyspeck||TS.utility.enableFeatureForUser(1))&&_.each(TS.boot_data,function(e,t){0===t.indexOf("feature_")&&TS.metrics.count(t+(e?"_on":"_off"))});if(window.PerformanceObserver)try{var t=new window.PerformanceObserver(function(e){_.each(e.getEntries(),function(e){if("longtask"===e.entryType){(TS.boot_data.feature_tinyspeck||TS.utility.enableFeatureForUser(5))&&TS.metrics.store(e.entryType,e.duration);TS.utility.enableFeatureForUser(5)&&TS.interop.clog.track("PERF_LONGTASKS",{elapsed_time:e.duration})}})});window.PerformanceLongTaskTiming&&t.observe({entryTypes:["longtask"]})}catch(e){TS.console.logError(e,"perf_observer","client_error",true)}})},isEnabled:function e(){return d&&"1"===TS.qs_args.client_stats||!!o},isCollectingInitialTimePeriodStats:function e(){return!!s}});var e=50;var t=5;var i=1;var n=6e4;var a=6e5;var r=6e5;var s;var o;var l;var c=!!TS.has_pri[y];var d=TS.qs_args.hasOwnProperty("client_stats");var u="rb_all";var m="rb_all_but";var f="rb_msgs";var h="up_member";var p=function e(){var t=!!o;var a;if(d||c){a="1"==TS.qs_args.client_stats||c;TS.has_pri[y]&&TS.log(y,"client.stats: enabled? "+a+" set by "+(c?"user in debug prefs":"query parameter"))}else a=TS.utility.enableFeatureForUser(i);TS.has_pri[y]&&TS.log(y,"client.stats: enabled now? "+t+"; should be enabled? "+a);if(a===t)return;if(a){l={};l[u]=0;l[m]=0;l[f]=0;l[h]=0;o=setInterval(g,n);TS.client.ui.did_rebuild_all_sig.add(S);TS.client.ui.did_rebuild_all_but_msgs_sig.add(v);TS.client.msg_pane.did_rebuild_msgs_sig.add(b);TS.members.member_was_upserted_sig.add(w);TS.client.stats.start_collecting_sig.dispatch()}else{l=void 0;clearInterval(o);o=void 0;TS.client.ui.did_rebuild_all_sig.remove(S);TS.client.ui.did_rebuild_all_but_msgs_sig.remove(v);TS.client.msg_pane.did_rebuild_msgs_sig.remove(b);TS.members.member_was_upserted_sig.remove(w);TS.client.stats.stop_collecting_sig.dispatch()}};var g=function e(){_.each(l,function(e,t){TS.has_pri[y]&&TS.log(y,"client.stats: "+t+" = "+e);TS.metrics.store("cs_"+t,e,{allow_zero:true,is_count:true});l[t]=0})};var T=function e(){var i=TS.boot_data.feature_webapp_always_collect_initial_time_period_stats||TS.utility.enableFeatureForUser(t);if(!i)return;TS.has_pri[y]&&TS.log(y,"Will collect additional stats for the first "+_.round(r/6e4,1)+" minutes of this session");TS._count_bytes_received=true;TS._bytes_received=0;var n=0;var a=function e(){n+=1};TS.members.member_was_upserted_sig.add(a);s=setTimeout(function(){s=void 0;TS.info("Received "+TS._bytes_received+" bytes in the first "+_.round(r/6e4,2)+" minutes of the session");TS.metrics.count("client_session_bytes_received",TS._bytes_received);TS.metrics.count("client_total_members_loaded",_.filter(TS.model.members,function(e){return _.isUndefined(e.is_unknown)||!_.get(e,"is_unknown")}).length);TS.metrics.count("client_total_member_upserts",n);TS.metrics.count("initial_beachballs",TS.interop.metricsResponsiveness.getTotalBeachballCount());TS.metrics.count("initial_stutters",TS.interop.metricsResponsiveness.getTotalStutterCount());TS._count_bytes_received=false;TS.members.member_was_upserted_sig.remove(a);TS.client.stats.initial_time_period_collection_finished_sig.dispatch();TS.utility.enableFeatureForUser(10)&&TS.interop.BandwidthChecker.start().then(function(e){TS.metrics.count("bandwidth_mbps",e.mbps);TS.metrics.count("latency_ms",e.lat)});A()},r)};var S=function e(){l[u]+=1};var v=function e(){l[m]+=1};var b=function e(){l[f]+=1};var w=function e(){l[h]+=1};var y=1991;var A=function e(){TS.interop.api.callFuncWhenApiQisEmpty(function(){TS.metrics.mark("client_stats_api_test_start");TS.interop.api.callExpedited("api.test").then(function(){TS.metrics.measureAndClear("client_stats_api_test","client_stats_api_test_start")});TS.metrics.mark("client_stats_users_info_start");TS.interop.api.callExpedited("users.info",{user:TS.boot_data.user_id}).then(function(){TS.metrics.measureAndClear("client_stats_users_info","client_stats_users_info_start")});if(window.fetch){TS.metrics.mark("client_stats_files_edgespeed_start");fetch("//files.slack.com/edgespeed",{mode:"no-cors"}).then(function(){TS.metrics.measureAndClear("client_stats_files_edgespeed","client_stats_files_edgespeed_start")});TS.metrics.mark("client_stats_filesedge_edgespeed_start");fetch("//files-edge.slack.com/edgespeed",{mode:"no-cors"}).then(function(){TS.metrics.measureAndClear("client_stats_filesedge_edgespeed","client_stats_filesedge_edgespeed_start")});TS.metrics.mark("client_stats_www_humans_start");fetch("/humans.txt",{mode:"no-cors"}).then(function(){TS.metrics.measureAndClear("client_stats_www_humans","client_stats_www_humans_start")})}});TS.metrics.mark("client_stats_flannel_fetch_start");TS.interop.Flannel.fetchRawMembersByIds([TS.boot_data.user_id]).then(function(){TS.metrics.measureAndClear("client_stats_flannel_fetch","client_stats_flannel_fetch_start")})}})()},3043:function(e,t){(function(){TS.registerModule("client.stats.responsiveness",{onStart:function e(){TS.client.login_sig.addOnce(function(){if(!_.isFunction(window.requestAnimationFrame)){TS.warn("Unable to install beachball detector without requestAnimationFrame");return}if(!window.performance){TS.warn("Unable to install beachball detector without performance");return}TS.client.stats.start_collecting_sig.add(TS.interop.metricsResponsiveness.startMonitoringResponsiveness);TS.client.stats.stop_collecting_sig.add(function(){TS.interop.metricsResponsiveness.storeResponsiveStats();TS.interop.metricsResponsiveness.stopMonitoringResponsiveness()});if(TS.client.stats.isEnabled()||TS.client.stats.isCollectingInitialTimePeriodStats()){TS.interop.metricsResponsiveness.startMonitoringResponsiveness();TS.client.stats.initial_time_period_collection_finished_sig.add(function(){TS.client.stats.isEnabled()||TS.interop.metricsResponsiveness.stopMonitoringResponsiveness()})}window.addEventListener("sleep",function(){TS.interop.metricsResponsiveness.isEnabled()&&TS.interop.metricsResponsiveness.stopMonitoringResponsiveness()})})}})})()},3044:function(e,t){(function(){var e=10;var t=10;var i=100;var n=100;var a=33;var r=100;TS.registerComponent("SearchableMemberList",{_constructor:function e(t){this.id=t.id;this.triggered_by_user_action=t.triggered_by_user_action;this.$_container=t.$container;this.$_long_list_view;this.$_search_bar;this.$_search_input;this.$_clear_icon;this.$_filter_input;this._current_filter=t.memberType||"everyone";this._current_query_for_display="";this._current_query_for_match="";this._next_marker="";this._have_all_members=false;this._members=[];this._model_ob_id=t.model_ob_id;this._filter_counts={};this._suppress_presence=t.suppress_presence||false;this._show_filter_bar=_.isUndefined(t.show_filter_bar)?!this._model_ob_id:t.show_filter_bar;this._compact_results=_.isUndefined(t.compact_results)?!!this._model_ob_id:t.compact_results;this._prevent_member_click_handler=t.prevent_member_click_handler||false;this._approx_item_height=this._compact_results?30:89;this._long_list_view_height=0;this._long_list_view_items_height=0;this._long_list_view_initial_height=null;this._fetch_page_p=null;this._suppress_presence||(this._presence_list=new TS.PresenceList);this._resize_sig_handler=null;this.member_clicked_sig=new signals.Signal},destroy:function e(){this._resize_sig_handler&&TS.view.resize_sig.remove(this._resize_sig_handler);if(this._maybeSetupFilterInputDebounced){TS.members.joined_team_sig.remove(this._maybeSetupFilterInputDebounced,this);TS.members.changed_deleted_sig.remove(this._maybeSetupFilterInputDebounced,this)}this.$_container.off();this.$_long_list_view&&this.$_long_list_view.off();this.$_search_input&&this.$_search_input.off();this.$_clear_icon&&this.$_clear_icon.off();this.$_filter_input&&this.$_filter_input.off();this.$_long_list_view&&this.$_long_list_view.length&&$.data(this.$_long_list_view.get(0),"TS-longListView")&&this.$_long_list_view.longListView("destroy");this.$_search_bar&&this.$_search_bar.remove();this._suppress_presence||this._presence_list.clear()},showInitial:function e(){var t=this;this._prevent_member_click_handler||this.$_container.on("click",".team_list_item",TS.members.view.onTeamDirectoryItemClick);this.$_long_list_view=this.$_container.find(".searchable_member_list_scroller");this._showLoadingState();this._fetchPage().then(function(e){t._hideLoadingState();t._processPage(e);TS.utility.rAF(function(){t._updatePresenceListForVisibleMembers()});t._setupLongListView();t._maybeSetupSearchBar();return null});var i="channel_membership_dialog"===this.id?"channel_membership_dialog_scroller":"team_list_scroller";TS.metrics.count(i+"_initialized")},maybeRerenderLongListView:function e(){this.$_long_list_view&&this._members&&this.$_long_list_view.longListView("setItems",this._members,true,true)},_fetchPage:function e(){if(this._fetch_page_p)return this._fetch_page_p;var t=this;var i=this._buildQueryParams();this._fetch_page_p=TS.members.fetchAndUpsertMembersWithQuery(i).timeout(TS.interop.connectivity.getMaximumSocketWait()).then(function(e){t._fetch_page_p=null;t._next_marker=e.next_marker;e.next_marker||(t._have_all_members=true);return e.objects||e}).catch(function(){t._fetch_page_p=null;t._next_marker=void 0;t._have_all_members=true;var e=i.query||"";var n={prefer_exact_match:false,frecency:false,allow_empty_query:true,flat:true};var a={members:{include_self:true},sort:!!e&&n};return TS.searcher.search(e,a).then(function(t){return e?t:TS.sorter.search(e,t,n)})});return this._fetch_page_p},_buildQueryParams:function e(){var n={count:this._current_query_for_match?i:t,index:TS.interop.members.shouldDisplayRealNames()?"users_by_realname":"users_by_display_name",locale:TS.interop.i18n.locale};var a=TS.interop.utility.looksLikeTeamId(this._current_filter);if(a){n.external_team=this._current_filter;n.filter="everyone"}else n.filter=this._current_filter;TS.boot_data.feature_bots_not_members&&"everyone"===n.filter&&(n.filter="people");if(this._current_query_for_match){n.query=this._current_query_for_match;n.search_profile_fields=true}else n.marker=this._next_marker;this._model_ob_id?n.channels=[this._model_ob_id]:TS.model.user.is_restricted&&(n.channels=_.map(TS.interop.redux.models.channels.getAllChannels(TS.redux.getState()),function(e){return e.is_im?e.user:e.id}));return n},_processPage:function e(t){this._members=_.union(this._members,this._maybeFilterOutBotUsers(t))},_updatePresenceListForVisibleMembers:function e(){if(this._suppress_presence)return;if(this._presence_list&&this.$_long_list_view&&this.$_long_list_view.longListView){var t=this.$_long_list_view.longListView("getCurrentItemsInView")||[];var i=_.map(t,"id");if(i.length){this._presence_list.clear();this._presence_list.add(i)}}},_fetchProcessAndDisplayPage:function e(){var t=this;if(t._have_all_members)return;return this._fetchPage().then(function(e){t._processPage(e);t._maybeHideNoResultsState();t._members.length>0?t.$_long_list_view.longListView("setItems",t._members,true,true):t._showNoResultsState();return null}).then(function(){TS.utility.rAF(function(){t._updatePresenceListForVisibleMembers();t._long_list_view_height=t.$_long_list_view.height();t._long_list_view_items_height=t.$_long_list_view.find(".list_items").height();t._recursivelyFillLongListViewToHeight()});return null})},_maybeFilterOutBotUsers:function e(t){if("deactivated"===this._current_filter&&TS.boot_data.feature_bots_not_members)return _.filter(t,["is_bot",false]);return t},_maybeSetupSearchBar:function t(){var i=this;if(this.$_search_bar)return;return TS.interop.utility.makeSafeForTimeout(TS.interop.memberCounts.fetchMemberCountsForTeam()).timeout(TS.interop.connectivity.getMaximumSocketWait()).then(function(t){if(t.everyone>=e){i.$_long_list_view.before(TS.templates.team_search_bar());i.$_search_bar=i.$_container.find(".searchable_member_list_search_bar");i.$_search_input=i.$_search_bar.find(".searchable_member_list_input");i.$_filter_input=i.$_search_bar.find(".searchable_member_list_filter");i._setupSearchInput();i._maybeSetupFilterInput()}return null}).catch(_.noop)},_setupSearchInput:function e(){var t=this;this.$_search_bar.find(".searchable_member_list_search.loading").replaceWith(TS.templates.team_search_bar_input(this._generateFilterSearchBarTemplateArgs()));this.$_search_input=this.$_search_bar.find(".searchable_member_list_input");this.$_clear_icon=this.$_container.find(".icon_close");this.$_search_input.bind("keyup.searchable_member_list",this._handleSearchKeyUp.bind(this));this.$_container.on("click",".searchable_member_list_filter",this._handleFilterSelect.bind(this));this.$_clear_icon.bind("click",function(){t._reset();Promise.resolve().then(function(){t.$_search_input.focus();return null})});this.triggered_by_user_action&&this.$_search_input.focus()},_maybeSetupFilterInput:function e(){var t=this;if(!this.$_filter_input)return;if(!this._show_filter_bar){t.$_filter_input.remove();t.$_filter_input=null;return}return TS.interop.memberCounts.fetchMemberCountsForTeam().then(function(e){t._filter_counts=e;t.$_filter_input.replaceWith(TS.templates.team_search_bar_filter(t._generateFilterSearchBarTemplateArgs()));t.$_filter_input=t.$_search_bar.find(".searchable_member_list_filter");if(!t._maybeSetupFilterInputDebounced){var i=1e3;var n={trailing:true};t._maybeSetupFilterInputDebounced=_.debounce(function(){return t._maybeSetupFilterInput.apply(t,arguments)},i,n)}TS.members.joined_team_sig.add(t._maybeSetupFilterInputDebounced,t);TS.members.changed_deleted_sig.add(t._maybeSetupFilterInputDebounced,t)})},_maybeSetupFilterInputDebounced:null,_setupLongListView:function e(){var t=this;this.$_long_list_view.longListView({items:this._members,approx_item_height:this._approx_item_height,approx_divider_height:this._approx_divider_height,calcItemHeight:function e(t){return t.outerHeight()},makeElement:function e(){return $(TS.templates.team_list_item({is_channel_membership:t._model_ob_id,is_long_list_view:true}))},renderItem:function e(i,n){i.toggleClass("deleted",true===n.deleted).data("member-id",n.id).data("item",n);t._compact_results?i.html(TS.templates.channel_page_member_row({member:n,lazy:false,suppress_presence:t._suppress_presence})):i.html(TS.templates.team_list_item_member_details({member:n,is_long_list_view:true}));TS.utility.makeSureAllLinksHaveTargets(i)}});this.$_long_list_view.on("click","a",function(e){t._prevent_member_click_handler&&e.preventDefault();t.member_clicked_sig.dispatch(e,TS.interop.members.getMemberById($(e.target).parents(".team_list_item").find("[data-member-id]").data("memberId")));TS.interop.clog.track("ORGANIZATION_DIRECTORY_CLICK",{})});this._resize_sig_handler=_.throttle(function(){t._long_list_view_height=t.$_long_list_view.height();t._long_list_view_items_height=t.$_long_list_view.find(".list_items").height();t._long_list_view_initial_height||(t._long_list_view_initial_height=t._long_list_view_height)},a);TS.view.resize_sig.add(this._resize_sig_handler);this.$_long_list_view.on("scroll",_.debounce(function(e){t._updatePresenceListForVisibleMembers();if(t._current_query_for_match)return;var i=t._long_list_view_items_height-($(e.target).scrollTop()+t._long_list_view_height);i<n&&t._fetchProcessAndDisplayPage()},r));TS.utility.rAF(function(){TS.view.resizeManually("TS.SearchableMemberList.showInitial");t._recursivelyFillLongListViewToHeight()})},_recursivelyFillLongListViewToHeight:function e(){var t=this;if(this._current_query_for_match)return;this._long_list_view_items_height<=this._long_list_view_height&&!this._have_all_members&&this._fetchProcessAndDisplayPage().then(function(){t._long_list_view_items_height=t.$_long_list_view.find(".list_items").height()})},_reset:function e(){this._members=[];this._current_query_for_match="";this._current_query_for_display="";this._current_filter="everyone";this._next_marker="";this.$_search_input.val("");this.$_clear_icon.addClass("hidden");this._have_all_members=false;this._maybeHideNoResultsState();this.$_long_list_view.scrollTop(0);if(this.$_filter_input){this.$_filter_input.replaceWith(TS.templates.team_search_bar_filter(this._generateFilterSearchBarTemplateArgs()));this.$_filter_input=this.$_container.find(".searchable_member_list_filter")}this.$_long_list_view.height(this._long_list_view_initial_height);this._fetchProcessAndDisplayPage()},_showLoadingState:function e(){this.$_long_list_view.before(TS.templates.infinite_spinner({color:"white",size:"medium"}))},_hideLoadingState:function e(){this.$_container.find(".infinite_spinner").remove()},_showNoResultsState:function e(){var t=this.$_container.find(".no_results");t.length>0&&t.remove();var i=this;var n={query:this._current_query_for_display,everyone_filter_selected:"everyone"===this._current_filter,members_filter_selected:this._current_filter.match(/members/),admins_filter_selected:this._current_filter.match(/admins/),restricted_filter_selected:this._current_filter.match(/guests/),deactivated_filter_selected:"deactivated"===this._current_filter,free_team:!TS.model.team.plan,user_is_admin:TS.model.user.is_admin,bots_filter_selected:this._current_filter.match(/bots/)};var a=TS.templates.team_searchable_no_results(n);this.$_long_list_view.hide().before(a);TS.model.user.is_admin&&!TS.model.team.plan&&this._current_filter.match(/guests/)&&TS.interop.clog.track("GROWTH_PRICING",{contexts:{ui_context:{step:"team_directory",action:"impression"}}});this.$_container.on("click",".clear_members_filter",function(){i._reset()});if("everyone"!==this._current_filter&&""!==this._current_query_for_match){var r=this._current_filter;this._current_filter="everyone";this._fetchPage().then(function(e){i._current_filter=r;if(e.length>0){i.$_container.find(".no_results").after(TS.templates.team_other_matches_heading({query:i._current_query_for_display}));i.$_long_list_view.longListView("setItems",e,true,true);i.$_long_list_view.show();TS.utility.rAF(function(){i._long_list_view_height=i.$_long_list_view.height();i._long_list_view_items_height=i.$_long_list_view.find(".list_items").height()})}return null})}},_maybeHideNoResultsState:function e(){var t=this.$_container.find(".no_results");if(0==t.length)return;var i=this.$_container.find(".other_matches");i&&i.remove();t.remove();this.$_long_list_view.show()},_handleSearchKeyUp:function e(t){var i=$(t.target).val();if(i.trim().toLocaleLowerCase()!==this._current_query_for_match){if(this._fetch_page_p){this._fetch_page_p.cancel();this._fetch_page_p=null}this._suppress_presence||this._presence_list.clear();this._members=[];this._next_marker="";this._have_all_members=false;this._current_query_for_display=i;this._current_query_for_match=i.trim().toLocaleLowerCase();this._fetchProcessAndDisplayPage();this.$_long_list_view.scrollTop(0);this.$_clear_icon.toggleClass("hidden",!i.trim())}TS.interop.clog.track("ORGANIZATION_DIRECTORY_KEYPRESS",{})},_handleFilterSelect:function e(t){t.preventDefault();var i=this;TS.menu.startWithSearchableMemberListFilter(t,this._filter_counts,function(e){var t=$(e.target).closest("[data-filter]");if(!t.length)return;if(i._fetch_page_p){i._fetch_page_p.cancel();i._fetch_page_p=null}i._suppress_presence||i._presence_list.clear();i._have_all_members=false;i._members=[];i._next_marker="";i._current_filter=t.data("filter");i._fetchProcessAndDisplayPage();i.$_long_list_view.scrollTop(0);i.$_filter_input.replaceWith(TS.templates.team_search_bar_filter(i._generateFilterSearchBarTemplateArgs()));i.$_filter_input=i.$_container.find(".searchable_member_list_filter");TS.interop.clog.track("ORGANIZATION_DIRECTORY_FILTER",{organization_directory_filter:i._current_filter})})},_generateFilterSearchBarTemplateArgs:function e(){var t=this._current_filter;var i={everyone_filter_selected:"everyone"===t,deactivated_filter_selected:"deactivated"===t};TS.boot_data.page_needs_enterprise?_.merge(i,{org_name:TS.model.team.enterprise_name,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team),org_members_filter_selected:"org_members"===t,org_admins_filter_selected:"org_admins"===t,org_restricted_filter_selected:"org_guests"===t,team_members_filter_selected:"members"===t,team_admins_filter_selected:"admins"===t,team_restricted_filter_selected:"guests"===t,org_bots_filter_selected:"org_bots"===t,team_bots_filter_selected:"bots"===t}):_.merge(i,{members_filter_selected:"members"===t,admins_filter_selected:"admins"===t,restricted_filter_selected:"guests"===t,bots_filter_selected:"bots"===t});_.each(this._filter_counts,function(e,t){i[t+"_count"]=e});TS.boot_data.feature_bots_not_members&&(i.everyone_count=this._filter_counts.people);i.bots_count=i.bots_count||0;i.org_bots_count=i.org_bots_count||0;var n=[];_.each(this._filter_counts.external_teams,function(e,i){n.push({external_team_filter_selected:t===i,external_team_count:e,external_team_name:TS.teams.getTeamNameById(i)})});_.merge(i,{ext_teams:n});return i},test:function n(){var a={};Object.defineProperty(a,"MINIMUM_MEMBERS_FOR_SEARCH",{get:function t(){return e},set:function t(i){e=i}});Object.defineProperty(a,"FETCH_PAGE_SIZE",{get:function e(){return t},set:function e(i){t=i}});Object.defineProperty(a,"FETCH_PAGE_SIZE_SEARCH",{get:function e(){return i},set:function e(t){i=t}});return a}})})()},3045:function(e,t){(function(){TS.registerModule("client.ui.user_groups",{onStart:function t(){TS.client.login_sig.addOnce(e);TS.boot_data.feature_lazy_user_groups&&TS.user_groups.changed_is_unknown_sig.add(a)},clearUserGroupFilter:function e(){if(TS.boot_data.feature_sonic_user_groups)return;var t=n.find("#user_group_filter");var a=t.find("input.member_filter");var r=t.find(".icon_close");if(TS.boot_data.feature_lazy_user_groups){i="";TS.redux.dispatch(TS.interop.userGroups.setSearchQuery(i))}else{i=void 0;TS.view.rebuildUserGroupList()}setTimeout(function(){a.focus()},0);a.val("");r.addClass("hidden")},setUserGroupQuery:function e(){if(!TS.boot_data.feature_lazy_user_groups)return;if(!n)return;var t=n.find("#user_group_filter");var a=t.find("input.member_filter");TS.boot_data.feature_lazy_user_groups&&TS.redux.dispatch(TS.interop.userGroups.setSearchQuery(i||""));a.val(i)},getUserGroupQuery:function e(){if(TS.boot_data.feature_sonic_user_groups)return;return i},mountLazyUserGroupList:function e(){if(!TS.boot_data.feature_lazy_user_groups)return;var t=$("#user_groups_list");t.addClass("full_height");$("#user_group_list_scroller").addClass("overflow_hidden");if(t.length&&!TS.view.has_mounted_lazy_user_groups_list){TS.interop.mountUserGroupsList(TS.boot_data.team_id,t[0],{isLegacy:true,onCreateUserGroup:function e(){return TS.ui.admin_user_groups.add()}});TS.view.has_mounted_lazy_user_groups_list=true}TS.client.ui.user_groups.setUserGroupQuery()},cleanupLazyUserGroupList:function e(){if(!TS.boot_data.feature_lazy_user_groups)return;var t=$("#user_groups_list");if(t.length){TS.interop.unmountUserGroupsList(t[0]);TS.view.has_mounted_lazy_user_groups_list=false}},test:function e(){var t={unknownUserGroupResolution:a};Object.defineProperty(t,"unknownUserGroupResolution",{get:function e(){return a},set:function e(t){a=t}});return t}});var e=function e(){if(TS.boot_data.feature_sonic_user_groups)return;n=$("#user_groups_container");n.html(TS.templates.user_groups_flexpane_tab({can_user_edit_user_groups:TS.permissions.members.canEditUserGroups(),can_user_create_and_delete_user_groups:TS.permissions.members.canCreateAndDeleteUserGroups(),use_global_nav:TS.useGlobalNav()}));t();TS.boot_data.feature_lazy_user_groups||TS.view.rebuildUserGroupList()};var t=function e(){if(TS.boot_data.feature_sonic_user_groups)return;var t=n.find("#user_group_filter");var a=t.find("input.member_filter");var r=t.find(".icon_close");a.bind("keyup update-user-group-filter",function(){var e=a.val().trim().toLocaleLowerCase();i=e;TS.boot_data.feature_lazy_user_groups?TS.redux.dispatch(TS.interop.userGroups.setSearchQuery(i)):TS.view.rebuildUserGroupList();r.toggleClass("hidden",!e.trim())});n.delegate("#user_groups_list .clear_members_filter","click",function(){TS.client.ui.user_groups.clearUserGroupFilter()});r.bind("click",TS.client.ui.user_groups.clearUserGroupFilter)};var i;var n;var a=function e(t){if(!TS.boot_data.feature_lazy_user_groups)return;$(".unknown_usergroup").length>0&&TS.user_groups.unknown_resolution_rebuild_sig.dispatch(t)}})()},3046:function(e,t){(function(){TS.registerModule("client.msg_input",{$input:$(),onStart:function t(){e=$("#snippet_prompt");c=$("#msg_input_send");TS.prefs.msg_input_send_btn_changed_sig.add(m);TS.channels.renamed_sig.add(TS.client.msg_input.setPlaceholder);TS.members.changed_current_status_sig.add(TS.client.msg_input.setPlaceholder);TS.members.changed_name_sig.add(TS.client.msg_input.setPlaceholder);TS.members.changed_real_name_sig.add(TS.client.msg_input.setPlaceholder);TS.prefs.display_real_names_override_changed_sig.add(TS.client.msg_input.setPlaceholder);TS.prefs.team_display_real_names_changed_sig.add(TS.client.msg_input.setPlaceholder);TS.prefs.jumbomoji_changed_sig.add(I);TS.prefs.messages_theme_changed_sig.add(I);TS.prefs.emoji_mode_changed_sig.add(M)},bind:function e(t){TS.client.msg_input.$input=t;var i=_.throttle(function(e){var i=TS.utility.contenteditable.value(t);TS.client.msg_input.mountOrReMountNotificationBar();o(i);TS.i18n.sendButtonEnabled()&&d(!!i.trim().length);if("silent"===e)return;i.trim()?TS.client.msg_input.storeLastMsgForActiveModelOb(i):TS.client.msg_input.storeLastMsgForActiveModelOb("")},100);var r={modules:{clipboard:{onPaste:function e(i){var n=false;if(TS.ui.paste.supportsUploadOnPaste())if(TS.model.is_FF&&bowser.version<50||!i.clipboardData)n=true;else{n=TS.ui.paste.detectImageFromEvent(i);n&&TS.utility.contenteditable.blur(t)}if(!n){i.stopPropagation();return TS.utility.contenteditable.paste(t,i)}return n}},msginput:{onLeftWhenEmpty:function e(){TS.utility.contenteditable.blur(t);$("#primary_file_button").click()},onUpArrowCmd:function e(){h(n.up,true)},onUpArrow:function e(){h(n.up,false)},onDownArrow:function e(){h(n.down,false)}},tabcomplete:{appendMenu:function e(t){document.querySelector("#messages_container").appendChild(t)},positionMenu:function e(t){t.style.bottom=0;t.style.left="62px";t.style.right="20px";t.style.top="auto";TS.utility.rAF(function(){t.offsetTop<0&&(t.style.top=0);t=null})}}},tabIndex:1,ariaLabel:TS.interop.i18n.t("Message channel","msg_input")(),placeholder:t.data("placeholder"),onEnter:function e(i){var n=TS.model.is_mac&&i.shiftKey&&i.metaKey||(TS.model.is_win||TS.model.is_lin)&&i.shiftKey&&i.ctrlKey;if(n){TS.model.user&&"U1MV5VA73"===TS.model.user.id&&TS.console.logError({should_start_snippet:n,is_mac:TS.model.is_mac,is_win:TS.model.is_win,args:JSON.stringify(i)},"snippet_on_send","should_start_snippet");TS.utility.contenteditable.blur(TS.client.msg_input.$input);TS.client.msg_input.startSnippet();return false}if(TS.i18n.sendButtonEnabled()){if(i.metaKey||!TS.model.is_mac&&i.ctrlKey){b(t);return false}return true}TS.client.ui.cal_key_checker.prevent_enter||b(t);return false},onTextChange:function e(t){s();C();i(t)},isJumbomojiEnabled:TS.utility.contenteditable.isJumbomojiEnabled};TS.utility.contenteditable.create(t,r);$("#msg_form .msg_mentions_button").removeClass("hidden").on("click",a);TS.utility.contenteditable.enable(t);TS.client.msg_input.mountOrReMountNotificationBar()},setOffline:function e(){if(TS.boot_data.feature_degraded_send&&TS.interop.connectivity.isOnline())return;w=true;TS.client.msg_input.$input.addClass("offline");TS.boot_data.feature_degraded_send?TS.client.msg_input.mountOrReMountNotificationBar():k();if(TS.i18n.sendButtonEnabled()){var t=TS.utility.contenteditable.value(TS.client.ui.$msg_input);d(!!t.trim().length)}},setOnline:function e(){w=false;TS.client.msg_input.$input.removeClass("offline");TS.boot_data.feature_degraded_send||C();TS.client.msg_input.mountOrReMountNotificationBar();if(TS.i18n.sendButtonEnabled()){var t=TS.utility.contenteditable.value(TS.client.ui.$msg_input);d(!!t.trim().length)}},resized:function e(t,i){var n=Date.now();TS.client.ui.$emo_menu||(TS.client.ui.$emo_menu=$(".emo_menu"));TS.model.profiling_keys&&TS.model.addProfilingKeyTime("inputResized "+t+" "+i,Date.now()-n)},storeLastMsgForActiveModelOb:function e(t){var i=TS.shared.legacyGetActiveModelOb();TS.model.input_history_index>-1&&TS.model.input_history[TS.model.input_history_index]!=t&&TS.chat_history.resetPosition("storeLastMsgInputForActive "+t);if(!i)return;if(i.last_msg_input==t)return;i.last_msg_input=t;i.has_draft=!!t;TS.storage.storeLastMsgInput(i.id,i.last_msg_input)},value:function e(){return TS.utility.contenteditable.value(TS.client.msg_input.$input)},populate:function e(t){TS.utility.populateInput(TS.client.ui.$msg_input,t)},populateWithLast:function e(){var t=TS.shared.legacyGetActiveModelOb();if(!t)return;var i=TS.model.ms_logged_in_once||TS.format.hasOnlyValidMemberIds(t.last_msg_input);if(!i)return;TS.chat_history.resetPosition("populateChatInputWithLast");var n=TS.client.msg_input.$input;TS.utility.contenteditable.deserialize(n,t.last_msg_input);TS.utility.contenteditable.updateSpellCheck(n);if(TS.client.ui.isUserAttentionOnChat()){TS.utility.contenteditable.focus(n);TS.utility.contenteditable.setCursorAtEnd(n)}s()},startSnippet:function e(){var t=i;var n=TS.utility.contenteditable.displayValue(TS.client.ui.$msg_input).replace(/\u2018|\u2019/g,"'").replace(/\u201c|\u201d/g,'"');TS.ui.snippet_dialog.startCreate(n,t);TS.view.clearMessageInput();i=false},createSnippetFromPrompt:function e(){if(t){i=true;TS.client.msg_input.startSnippet()}},removePrecedingAtSign:function e(){var t=TS.utility.contenteditable.cursorPosition(TS.client.msg_input.$input);var i=t.start>0?TS.utility.contenteditable.getTextForRange(TS.client.msg_input.$input,t.start-1,1):"";if(TS.utility.contenteditable.getFormats(TS.client.msg_input.$input,t.start).slackmention)return;"@"===i&&TS.utility.contenteditable.deleteText(TS.client.msg_input.$input,t.start-1,1)},setPlaceholder:function e(){TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,v());TS.utility.contenteditable.ariaLabel(TS.client.ui.$msg_input,v(true).replace(/&#39;/g,"'"))},getInputElement:function e(){return TS.client.msg_input.$input[0]},mountOrReMountNotificationBar:function e(){var i=TS.utility.contenteditable.value(TS.client.msg_input.$input);var n=TS.format.cleanMsg(i);var a=n.length-TS.interop.constants.MAX_MESSAGE_INPUT_LENGTH;t=a>0;var r=TS.shared.legacyGetActiveModelOb();var s=null;if(r){var o=TS.interop.typing.getTypersInChannel(r.id);if(!TS.model.archive_view_is_showing&&o&&o.length&&TS.prefs.getPref("show_typing")){s=[];for(var l=0;l<3;l++)o[l]&&s.push(TS.interop.members.getPrefCompliantMemberName(o[l],false))}}TS.interop.mountNotificationBar(TS.boot_data.team_id,$("#notification_bar")[0],{wasRecentlyOnline:TS.boot_data.feature_degraded_send?TS.interop.connectivity.isOnline():!(w&&!y),typingNames:s,snippetCallback:TS.client.msg_input.createSnippetFromPrompt,inputText:i})},focusMsgInput:function e(){TS.utility.contenteditable.focus(TS.client.msg_input.$input)},updateSendButton:function e(){u()},test:function e(){var t={_maybeHandleReactionCmdInMsgInput:p,_maybeShareFilesInMessage:g,_shareFiles:T,_shouldOnArrowKey:f,_maybeDisableSend:d};Object.defineProperty(t,"_is_send_disabled",{get:function e(){return l},set:function e(t){l=t}});Object.defineProperty(t,"_$msg_input_send",{get:function e(){return c},set:function e(t){c=t}});return t}});var e;var t;var i=false;var n=TS.utility.keymap;var a=function e(){var t=TS.utility.contenteditable.getFormats(TS.client.msg_input.$input);var i=TS.utility.contenteditable.cursorPosition(TS.client.msg_input.$input);if(i.start>0&&t.slackmention&&i.start<TS.utility.contenteditable.getLength(TS.client.msg_input.$input)&&TS.utility.contenteditable.getFormats(TS.client.msg_input.$input,i.start+1).slackmention){TS.utility.contenteditable.focus(TS.client.msg_input.$input);return}var n=" @";var a=i.start>0?TS.utility.contenteditable.getTextForRange(TS.client.msg_input.$input,i.start-1,1):"";if("@"===a){n="@";TS.utility.contenteditable.cursorPosition(TS.client.msg_input.$input,i.start-1,1)}(0===i.start||a.match(/\s/))&&(n="@");TS.utility.contenteditable.focus(TS.client.msg_input.$input);TS.utility.contenteditable.insertTextAtCursor(TS.client.msg_input.$input,n,false);"@"!==a&&TS.interop.clog.track("MSG_BTN_MENTIONS",{})};var r=0;var s=function e(){var t=TS.client.msg_input.$input.height();if(t!==r){TS.utility.rAF(function(){TS.client.ui.files.$file_btn.height(t);TS.client.ui.files.$file_btn.height("")});TS.client.msg_input.resized(r,t);r=t}};var o=function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i)return;t&&0!==t.indexOf("/")&&t.trim().length?TS.redux.dispatch(TS.interop.typing.currentUserStartedTyping({channelId:i.id})):TS.redux.dispatch(TS.interop.typing.currentUserEndedTyping({channelId:i.id}))};var l=true;var c;var d=function e(t){var i=void 0;var n=void 0;if(TS.boot_data.feature_degraded_send){i=l&&t&&TS.interop.connectivity.isOnline();n=!l&&(!t||!TS.interop.connectivity.isOnline())}else{i=l&&t&&TS.redux.socket.isConnected();n=!l&&(!t||!TS.redux.socket.isConnected())}if(i){l=false;c.attr("disabled",false)}else if(n){l=true;c.attr("disabled",true);c.mouseleave()}};var u=function e(){if(!c)return;var t=!TS.prefs.getPref("msg_input_send_btn")||TS.utility.contenteditable.isDisabled(TS.client.ui.$msg_input);c.toggleClass("hidden",t)};var m=function e(){u();if(TS.prefs.getPref("msg_input_send_btn")){var t=TS.utility.contenteditable.value(TS.client.ui.$msg_input);d(!!t.trim().length)}else d(false)};var f=function e(t,i){if(t.shiftKey||t.altKey||t.metaKey||t.ctrlKey)return false;var a=TS.utility.contenteditable.cursorPosition(TS.client.msg_input.$input);if(0===a.length){if(t.which==n.up&&a.start<1)return true;if(t.which==n.down&&a.end>=i.length)return true}return false};var h=function e(t,i){if(!TS.client.ui.isUserAttentionOnChat())return;var n=jQuery.Event("keydown",{altKey:false,shiftKey:false,which:t});i&&(TS.model.is_mac?n.metaKey=true:n.ctrlKey=true);var a=TS.client.msg_input.$input;var r=TS.utility.contenteditable.displayValue(a);TS.client.ui.shouldEventTriggerMaybeEditLast(n,a)?TS.client.ui.maybeEditLast(n):f(n,r)&&TS.chat_history.onArrowKey(n,a)};var p=function e(t){var i;var n=TS.shared.legacyGetActiveModelOb();var a=TS.redux.messages.getRecentMessagesInChannel(n.id);a.length&&(i=_(a).take(5).find(function(e){return!e.is_ephemeral&&!e.no_display}));var r=TS.client.ui.maybeHandleReactionCmd(i,t,function(){TS.chat_history.add($.trim(t));TS.view.clearMessageInput()});return r};var g=function e(t,i,n){var a=TS.interop.url.findUrlsInString(t);var r=a.map(TS.utility.getFileIDFromURL);var s=_.compact(r.map(function(e){return TS.files.getFileById(e)}));var o=[];var l=[];s.forEach(function(e){TS.files.isFilePrivate(e)&&e.bot_id?o.push(e):i&&i.is_im&&e.user===i.user?o.push(e):TS.files.isFilePrivate(e)&&e.user===TS.model.user.id?o.push(e):TS.files.isFilePrivate(e)&&e.user!==TS.model.user.id&&l.push(e)});if(!o.length&&!l.length){n(false);return}o.length&&l.length?S(l,t,i,function(){T(o,t,i,n)}):o.length?T(o,t,i,n):l.length&&S(l,t,i,n)};var T=function e(t,i,n,a){var r=t[0];var s=t.slice(1);var o=true;var l="";TS.files.shareFile(r.id,n.id,l,o,function(){s.length>0?e(s,i,n,a):a(true)})};var S=function e(t,i,n,a){TS.files.reShareConfirmation(t,function(){T(t,i,n,a)})};var v=function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i||!TS.permissions.members.canPostInModelOb(i)||!i.is_im&&!i.is_mpim&&!i.is_channel&&!i.is_group)return"";var n;var a;if(TS.interop.rules.channels.isYou(i))n=TS.interop.i18n.t("Jot something down","msg_input","34679214816b29788bffd802f958500d4d949a0d")();else{var r;if(i.is_im){r=TS.interop.members.getPrefCompliantMemberNameById(i.user);r=_.escape(r);var s=TS.interop.members.getMemberById(i.user);a=TS.templates.builders.getMemberCurrentStatusForDisplay(s,{stop_animations:true});a&&!t&&(r+=" "+a)}else i.is_mpim?r=TS.mpims.legacyGetDisplayName(i,false,false,3):TS.interop.rules.channels.isPrivateChannel(i)?r=i.name:i.is_channel&&(r="#"+i.name);i.is_im||(r=_.escape(r));n=TS.interop.i18n.t("Message {msg}","msg_input")({msg:TS.interop.i18n.safeString(r)})}return n};var b=function t(i,n){TS.tips.texty.hide();var a=TS.client.stats&&TS.client.stats.isEnabled();a&&TS.metrics.mark("msg_input_try_to_submit");var r=TS.format.cleanMsg(TS.utility.contenteditable.value(i));var s=r.length>TS.interop.constants.MAX_MESSAGE_INPUT_LENGTH;if(s){e.highlight(600,"",null,0);n&&n.preventDefault();return}var o=function e(){if(TS.view.submit())TS.chat_history.resetPosition("enter key");else if(!TS.model.is_msg_rate_limited){TS.client.manualReconnectNow();TS.client.ui.addOrFlashEphemeralBotMsg({channel:TS.model.active_cid,icons:{emoji:":electric_plug:"},username:"connectbot",text:TS.interop.i18n.t("Hmm, your computer seems to be *offline*, so sending messages won\u2019t work at the moment.","msg_input")(),ephemeral_type:"disconnected_feedback"})}};if(p(r))return;g(r,TS.shared.legacyGetActiveModelOb(),function(){o()})};var w=false;var y;var A=1e4;var k=function e(){if(y)return;var t=TS.client.ui.$messages_input_container||TS.client.msg_input.$input;t.addClass("pretend-to-be-online");y=setTimeout(function(){t.removeClass("pretend-to-be-online");y=null;x()},A)};var C=function e(){if(!y)return;var t=TS.client.ui.$messages_input_container||TS.client.msg_input.$input;t.removeClass("pretend-to-be-online");x();clearTimeout(y);y=void 0};var x=function e(){TS.client.msg_input.mountOrReMountNotificationBar()};var I=function e(){TS.utility.contenteditable.refreshJumbomoji(TS.client.msg_input.$input)};var M=function e(){TS.utility.contenteditable.refreshContents(TS.client.msg_input.$input)}})()},3047:function(e,t){(function(){TS.registerModule("client.channel_pane",{onStart:function e(){var t=document.getElementById("col_channels_react_root");TS.interop.mountChannelSidebar(TS.boot_data.team_id,t,function(e){TS.interop.ChannelSidebar=e.getWrappedInstance()})},openChannelBrowser:function e(){if(!t())return TS.sounds.play("beep");TS.ui.channel_browser.start({show_which_channels:"all"})},openChannelBrowserToSharedChannels:function e(){if(!t())return TS.sounds.play("beep");TS.ui.channel_browser.start({show_which_channels:"ext_shared"})},openCreateChannelDialog:function e(){if(!TS.permissions.members.canCreateChannels()&&!TS.permissions.members.canCreateGroups())return;if(!t())return TS.sounds.play("beep");TS.ui.new_channel_modal.start()},openDMBrowser:function e(){if(!t())return TS.sounds.play("beep");TS.ui.im_browser.start()},openAppsBrowser:function e(){if(!t())return TS.sounds.play("beep");TS.ui.apps_browser.start()}});var e=function e(){if(!TS.redux.socket.isConnected()&&!TS.model.change_channels_when_offline)return false;return true};var t=function t(){if(!e())return false;return true}})()},3048:function(e,t){(function(){TS.registerModule("client.channel_header",{onStart:function e(){i=new TS.PresenceList;TS.members.presence_changed_sig.add(u);TS.members.changed_deleted_sig.add(d);TS.dnd.dnd_statuses_changed_sig.add(S);TS.prefs.muted_channels_changed_sig.add(w);TS.groups.member_left_sig.add(h);TS.groups.member_joined_sig.add(h);TS.groups.converted_to_shared_sig.add(C);TS.channels.member_left_sig.add(h);TS.channels.member_joined_sig.add(h);TS.channels.topic_changed_sig.add(k);TS.channels.joined_sig.add(y);TS.channels.converted_to_shared_sig.add(C);TS.channels.shared_invite_pending_sig.add(C);TS.channels.unshared_sig.add(x);TS.pins.pinned_status_changed_sig.add(m);TS.pins.pinned_message_changed_sig.add(m);TS.pins.pinned_message_deleted_sig.add(m);TS.pins.pins_fetched_sig.add(m);TS.channels.joined_sig.add(v);TS.channels.left_sig.add(v);TS.stars.channel_unstarred_sig.add(b);TS.client.threads.reply_count_changed.add(D);TS.view.channel.unknown_resolution_rebuild_sig.add(function(){TS.client.channel_header.start()});t=$("#client_header .channel_header .messages_header");t.bind("mouseover mouseenter",function(e){$("#topic_inline_edit").toggleClass("inline_edit_hover",!!$(e.target).is("#topic_inline_edit"))})},test:function e(){var i={};Object.defineProperty(i,"_convertedToShared",{get:function e(){return C},set:function e(t){C=t}});Object.defineProperty(i,"_$header",{get:function e(){return t},set:function e(i){t=i}});return i},start:function n(){e=TS.shared.legacyGetActiveModelOb();if(!e&&!TS.client.activeChannelIsHidden()){TS.warn("TS.client.channel_header.start cannot find channel, im, or group.");return}var a;var s;var c=false;var d=false;var u;var f=false;var h=false;var T=false;var S;var b;var A;var k;i.clear();if(e){if(e.is_im){S=e;a=true;i.add(S.user);b=TS.redux.members.getPotentiallyUnknownMemberById(S.user)}else if(e.is_mpim){A=e;s=true;i.add(A.members)}else if(e.is_channel||e.is_group){T=true;!TS.model.user.is_restricted||e.topic&&e.topic.value||(T=false)}c=TS.interop.rules.channels.isPendingExternallySharedChannel(e);d=TS.interop.rules.channels.isExternallySharedChannel(e);u=e.shared_team_ids;c&&(u=_.concat(u,e.pending_shared));f=TS.interop.rules.channels.isOrgShared(e);TS.interop.apps.isAppSpaceEnabled()&&_.get(b,"is_bot")&&(h=true);k=e.name}var C={model_ob:e,is_shared:d,is_org_shared:f,name:k,member:b,is_dm_or_mpdm:a||s,show_topic:T,mpim:A,details_showing:$("#client-ui").hasClass("details_showing"),all_unreads:{is_showing:TS.model.unread_view_is_showing,has_new_messages:TS.model.unread_view_is_showing&&TS.client.unread.new_messages_in_channels.length,messages_loaded:TS.client.unread.messages_loaded,total_unread_count:TS.client.unread.getTotalMessagesCount(),sort_order:TS.client.unread.getSortOrder()},threads:{is_showing:TS.model.threads_view_is_showing},search:{is_showing:TS.client.ui.search_in_react.primarySearchIsEnabled()&&TS.model.search_view_is_showing},is_app:h,shared_team_ids:u,can_post_in_channel:TS.permissions.members.canPostInModelOb(e)};t.html(TS.templates.channel_header(C));TS.model.active_im_id&&g();TS.model.unread_view_is_showing&&TS.client.ui.unread.showOrHideRefreshButton();p();m();y();l();v();w();I();E();M();P();B();_.get(window,"desktop.app.updateDragRegion")?o():t.one("mouseenter",r.bind(this))},updateChannelHeaderInfo:function e(i){t.find("#channel_header_info").html(i)},clearUnreadPinState:function e(){f(false);$("#pinned_item_count .pin_count_new_pin_message").empty()},setActiveTab:function e(i){if(!_.isString(i))return;var n=t.find('[data-target="'+i+'"]');t.find(".channel_header__tab").removeClass("--active");n.addClass("--active");TS.useGlobalNav()&&TS.redux.dispatch(TS.interop.redux.features.globalNav.setActiveAppTab(i))},hideTab:function e(i){if(!_.isString(i))return;var n=t.find('[data-target="'+i+'"]');n.addClass("hidden")},calculateNoDragRegions:function e(){a&&a()},openTopicInput:function e(){$("#channel_topic_text").click().focus().select()}});var e;var t;var i;var n=false;var a;var r=function e(){if(!TS.model.is_our_app||!TS.interop.desktop.areDragRegionsRequired())return;var t=$("header button, #team_menu").toArray();var i=$("#edit_topic_container")[0]||null;t.push(i);function r(){if(TS.ui.fs_modal.is_showing)return;var n=TSSSB.nodrag.updateElements(t);if(i){var r=i.getBoundingClientRect();TS.interop.desktop.updateNoDragRegion({id:"edit_topic_trigger",width:100,height:Math.round(r.height),top:Math.round(r.top),left:Math.round(r.right)})}var s=false;var o=["details_toggle","stars_toggle"];n.forEach(function(e){e&&o.indexOf(e.id)>-1&&e.width<3&&e.height<3&&(s=e)});s&&setTimeout(function(){e();a()},500)}var s=$("#recent_mentions_toggle, #stars_toggle, #search_terms .ql-editor");a=_.debounce(function(){window.requestIdleCallback(r,{timeout:200})},400);if(!n){var o={root:document.querySelector("#client_header"),threshold:1};var l=new IntersectionObserver(a,o);i&&l.observe(i);n=true}s.off("click.setupNoDragH focus.setupNoDragH blur.setupNoDragH").on("click.setupNoDragH focus.setupNoDragH blur.setupNoDragH",a);$(window).off("resize.setupNoDragH").on("resize.setupNoDragH",a)};var s={};var o=function e(){if(!TS.model.is_our_app||!TS.interop.desktop.areDragRegionsRequired())return;if(!window.ResizeObserver){TS.error("_setupDragRegions: ResizeObserver not defined!");return}if(TS.useGlobalNav())return;var t='<div class="channel_header_drag_region" data-region="name"></div>';var i='<div class="channel_header_drag_region" data-region="info"></div>';$("#channel_name_container").append(t);$("#channel_header_info .channel_topic_container")[0]?$("#channel_header_info .channel_topic_container").append(i):$("#channel_header_info").append(i);var n=function e(t){var i=t.getBoundingClientRect(),n=i.top,a=i.left,r=i.width,o=i.height;var l=t.getAttribute("data-region");s[l]={id:l,top:n,left:a,width:r,height:o}};var r=new window.ResizeObserver(_.debounce(function(e){if(!TS.model.ui.is_window_focused)return;var t=true;var i=false;var a=void 0;try{for(var r=e[Symbol.iterator](),o;!(t=(o=r.next()).done);t=true){var l=o.value;if(!l.contentRect.height&&!l.contentRect.width)continue;n(l.target)}}catch(e){i=true;a=e}finally{try{!t&&r.return&&r.return()}finally{if(i)throw a}}var c=s.name,d=s.info,u=s.main;_.get(window,["desktop","app","updateDragRegion"])&&window.desktop.app.updateDragRegion([c,d,u])},300));$(".channel_header_drag_region").each(function(e,t){r.observe(t);n(t)});if(TS.model.ui.is_window_focused){var o=s.name,l=s.info,c=s.main;window.desktop.app.updateDragRegion([o,l,c])}a=_.debounce(function(){if(!TS.model.ui.is_window_focused)return;$(".channel_header_drag_region").each(function(e,t){n(t)});var e=s.name,t=s.info,i=s.main;window.desktop.app.updateDragRegion([e,t,i])},300)};var l=function e(){TS.client.ui.rebuildMemberListToggle()};var c=function t(i,n){if(!TS.redux.socket.isConnected())return;if(!i)return;if(e){var a=TS.interop.membership.getCachedChannelMembershipInfoForUser(e.id,i.id);var r=a.is_known&&!a.is_member;n&&!r&&l()}T(i)};var d=function e(t){var i=true;c(t,i)};var u=function e(t){var i=false;c(t,i)};var m=function t(i){i||(i=e);if(!i)return;var n=$("#pinned_item_count");var a=n.closest(".channel_header_info_item");var r=$("#pinned_item_count_count");var s=i.pinned_items_count;if(i.has_pins)if(s){r.text(TS.interop.i18n.number(s));i.is_channel||a.removeClass("hidden")}else r.text("");else i.is_channel?r.text(TS.interop.i18n.number(0)):a.addClass("hidden")};var f=function e(t){var i=$("#pinned_item_count .pinned_count_icon");if(0===i.length)return;i.toggleClass("is_filled",t)};var h=function t(i){if(!e||!i||e.id!==i.id)return;l()};var p=function t(){if(e.is_mpim||e.is_im)return;var i;if(e.is_group||e.is_private){i='<i class="ts_icon ts_icon_lock" data-qa="channel_header_private_lock"></i>';$("#channel_title").prepend(i)}else if(e.is_channel){i="#";$("#channel_title").prepend(i)}};var g=function e(){var t=$("#channel_header_info .channel_header_member_status");var i=TS.interop.channels.getImById(TS.model.active_im_id);var n=TS.interop.members.getMemberById(i.user);if(!n)return;var a=TS.templates.makeMemberPresenceStateClass(n);var r=TS.templates.makeMemberPresenceDomClass(n.id);var s=TS.templates.makeMemberDomId(n);t.addClass(a).addClass(r).addClass(s);T(n)};var T=function i(n){if(!n)return;if(!TS.model.active_im_id)return;var a=TS.interop.channels.getImById(TS.model.active_im_id);if(n.id!==a.user)return;var r=false;var s;if(TS.interop.rules.channels.isOrgShared(e)){r=true;s=t.find(".ts_icon_shared_channel");s.removeClass("away")}var o;var l=TS.redux.presence.getPresenceByMemberId(n.id);var c=$("#im_title");c.removeClass("away");if("active"===l)o=TS.interop.i18n.t("active","client")();else if("away"===l){o=TS.interop.i18n.t("away","client")();c.addClass("away");r&&s.addClass("away")}else o=l;n.is_restricted&&(o=n.is_ultra_restricted?TS.interop.i18n.t("Single-Channel Guest","client")():TS.interop.i18n.t("Multi-Channel Guest","client")());TS.dnd.isMemberInDnd(n)&&(o=TS.interop.i18n.t("notifications snoozed","client")());$("#header_status_message").html(o)};var S=function e(t){if(!t||!t.length)return;if(TS.model.active_im_id){var i=TS.interop.channels.getImById(TS.model.active_im_id);var n=TS.interop.members.getMemberById(i.user);if(!n)return;var a=_.map(t,"id");var r=a.indexOf(n.id);r>-1&&T(n)}};var v=function t(){if(!e)return;var i="";if(TS.model.active_im_id){var n=TS.interop.channels.getImById(TS.model.active_im_id);n&&(i=TS.templates.builders.buildStarWithTip("im",n))}else if(TS.model.active_channel_id){var a=e.is_member||e.is_archived&&e.is_starred;a&&(i=TS.templates.builders.buildStarWithTip("channel",e))}else TS.model.active_group_id?i=TS.templates.builders.buildStarWithTip("group",e):TS.model.active_mpim_id&&(i=TS.templates.builders.buildStarWithTip("mpim",e));$("#star_container").html(_.trim(i))};var b=function t(i){if(!e||!i||e.id!==i.id)return;e.is_archived&&v()};var w=function t(){if(!e)return;if(TS.client.activeChannelIsHidden())return;if(TS.model.active_im_id)return;var i=['<button type="button" class="btn_unstyle mute_btn ts_tip ts_tip_bottom ts_tip_lazy"',' title="'+TS.interop.i18n.t("Unmute","client")()+'"',">",'<i class="ts_icon ts_icon_bell_slash ts_icon_inherit muted_icon"></i>',"</button>"].join("");var n=$("#mute_container");var a="muted";var r=$("#channel_name");var s=TS.notifs.isCorGMuted(e.id);if(s){n.html(i);r.addClass(a);$(".mute_btn").bind("click",function(){TS.notifs.muteOrUnmuteCorG(e.id)})}else{n.empty();r.removeClass(a)}};var y=function i(){if(!e)return;var n=(e.is_member||e.is_group)&&(TS.boot_data.feature_announce_only?TS.interop.rules.user.canPostInChannel(e.id):!TS.model.user.is_ultra_restricted&&!TS.model.user.is_restricted&&(!TS.interop.rules.channels.isRequired(e)||TS.permissions.members.canPostInGeneral()));var a=$("#channel_topic_text");var r=e.topic&&e.topic.value?TS.utility.formatTopicOrPurpose(e.topic.value,true):"";a.html(TS.utility.removeLinksFromTabFlow(r));if(n){$("#topic_inline_edit").addClass("inline_edit_editable");var s=e.is_group?"group-id":"channel-id";a.data(s,e.id);a.data("inline-edit-unformatted",e.topic.value)}A();if(!TS.interop.environment.isSSBAndAtLeastVersion("3.0.0")){var o=t.find("#topic_inline_edit");o.on("click",function(){TS.interop.desktop.updateNoDragRegion({id:"channel-topic",width:o.outerWidth(),height:o.outerHeight(),top:o.offset().top,left:o.offset().left})})}};var A=function e(){var t=TS.model;t.is_IE&&$("#topic_inline_edit").addClass("in_ie")};var k=function e(){if(TS.ui.inline_edit.containsActiveElement(t))return;TS.client.channel_header.start()};var C=function e(t){var i=TS.shared.legacyGetActiveModelOb();t&&i&&t.id===i.id&&TS.client.channel_header.start()};var x=function e(t){var i=TS.shared.legacyGetActiveModelOb();t&&i&&t.id===i.id&&TS.client.channel_header.start()};var I=function t(){if(!e)return;U();if(TS.model.active_im_id){var i=TS.interop.channels.getImById(TS.model.active_im_id);var n=TS.interop.members.getMemberById(i.user);TS.client.msg_pane.maybeSetupCalls(n)}else if(TS.model.active_channel_id||TS.model.active_group_id)TS.client.msg_pane.maybeSetupCalls();else if(TS.model.active_mpim_id){var a=TS.interop.channels.getMpimById(TS.model.active_mpim_id);TS.client.msg_pane.maybeSetupCalls(false,a)}$(".channel_calls_button").addClass("blue_on_hover")};var M=function e(){if(TS.model.unread_view_is_showing){$("#channel_header_unread_refresh").on("click",function(){TS.client.unread.reload()});TS.model.unread_view_is_showing&&t.on("click",".channel_header_info_sort_order",TS.menu.startWithAllUnreadsSortOrderMenu)}};var E=function t(){if(TS.client.activeChannelIsHidden())return;if(TS.onboarding.inOnboarding()&&!TS.team_creation_setup.inOnboarding())return false;var i=$("#channel_actions_toggle, #channel_name");if(e.is_im){var n=TS.interop.channels.getImById(TS.model.active_im_id);i.on("click.channel_actions",function(e){TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_channel_settings_button"}}});n&&TS.menu.member.startWithMember(e,n.user,false,false,true)})}else e.is_channel||e.is_mpim?i.on("click.channel_actions",function(t){TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_channel_settings_button"}}});TS.menu.channel.startWithChannel(t,e.id)}):e.is_group&&i.on("click.channel_actions",function(t){TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_channel_settings_button"}}});TS.menu.group.startWithGroup(t,e.id)});$("#channel_name").on("click.gn_clog",function(){TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_CHANNEL_NAME"}}})});$("#channel_actions_toggle").on("click.gn_clog",function(){TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_CHANNEL_ACTIONS"}}})})};var B=function t(){if(!TS.permissions.members.canPostInModelOb(e))return;$("#edit_topic_trigger, #edit_topic_container").on("click keydown",function(e){if("keydown"===e.type&&!(e.which===TS.utility.keymap.enter||e.which===TS.utility.keymap.space))return;if("a"===e.target.tagName.toLowerCase())return;TS.ui.channel_topic_dialog.start()})};var P=function e(){if(!TS.interop.apps.isAppSpaceEnabled())return;$('[data-action="toggleAppSpaceView"]').on("click",function(){var e=$(this).data("target");TS.client.ui.app_space.toggleView(e)})};var U=function e(){$(".channel_calls_button").remove()};var D=function e(t){var i=$("#channel_header_info.threads_channel_header_info");var n;n=t?TS.interop.i18n.t("{new_reply_count,plural,=1{{new_reply_count} new reply}other{{new_reply_count} new replies}}","threads")({new_reply_count:t}):TS.interop.i18n.t("No new replies","threads")();i.text(n)}})()},3049:function(e,t){(function(){TS.registerModule("ui.channel_topic_dialog",{onStart:function e(){TS.channels.switched_sig.add(n)},start:function e(){var n='<div id="topic_dialog_input_container"></div>\n\t\t\t\t<label for="channel_topic_validation"></label>';var a=TS.interop.i18n.t("250 character max.","channel_topic_dialog")();if(TS.interop.rules.channels.isExternallySharedChannel(TS.shared.legacyGetActiveModelOb())){a+=" ";a+=TS.interop.i18n.t("This is only visible to {workspaceName}.","channel_topic_dialog")({workspaceName:TS.interop.rules.teams.getTeamDisplayName(TS.model.team)})}n+='<p class="channel_topic_hint mini no_bottom_margin">'+a+"</p>";TS.generic_dialog.start({backdrop_click_to_dismiss:true,body:n,dialog_class:TS.useGlobalNav()?"channel_topic_dialog channel_topic_dialog--global_nav":"channel_topic_dialog",go_button_text:TS.interop.i18n.t("Set Topic","channel_topic_dialog")(),onShow:t,onGo:i})},test:function e(){return{}}});var e="";var t=function t(){var i=$("#generic_dialog.channel_topic_dialog");var n=i.find("#topic_dialog_input_container");var a=["channels","emoji","members"];TS.ui.inline_msg_input.make(n,{aria_label:TS.interop.i18n.t("Add a topic","channel_topic_dialog")(),enableBroadcastKeywords:false,no_emo:false,placeholder:TS.interop.i18n.t("Add a topic","channel_topic_dialog")(),onEnter:TS.generic_dialog.go,onEscape:TS.generic_dialog.cancel,completers:a,autocomplete_below_input:true,onTextChange:function e(){TS.ui.validation.validate(n)}});var r=n.find(".message_input");var s=TS.shared.legacyGetActiveModelOb().topic.value;e=TS.utility.unformatTopicOrPurpose(s);TS.utility.contenteditable.value(r,e);r.attr("data-validation","maxlength=250");r.attr("data-validation-for","channel_topic_validation");r.addClass("no_validation_padding");TS.generic_dialog.div.on("shown",function e(){TS.generic_dialog.div.off("shown",e);TS.utility.contenteditable.focus(r);TS.utility.contenteditable.selectAll(r)})};var i=function t(){var i=$("#topic_dialog_input_container .message_input");if(!TS.ui.validation.validate(i))return false;var n=TS.shared.legacyGetActiveModelOb();var a=TS.utility.contenteditable.value(i);a=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(a,{enableBroadcastKeywords:false});if(a===e)return;TS.interop.channels.submitChannelTopic(n.id,a).then(TS.channels.legacyUpdateTopicFromAPI).catch(TS.channels.legacyAlertSetTopicError)};var n=function e(){var t=$("#topic_dialog_input_container .message_input");t.length&&TS.generic_dialog.cancel()}})()},3050:function(e,t){(function(){TS.registerModule("client.flex_pane",{onStart:function e(){l.init();$("#flex_contents").delegate("div.file_list_item","dragstart",t)},startLocalTimeInterval:function e(){clearInterval(a);a=setInterval(r,6e4);r()},stopLocalTimeInterval:function e(){clearInterval(a)},maybeFetchFileList:function t(){if(!TS.model.team)return;if(!TS.model.ui_state||!TS.model.ui_state.flex_visible||"files"!==TS.model.ui_state.flex_name||TS.model.ui_state.flex_extra)return;var a=(_.isArray(TS.model.file_list_types)&&TS.model.file_list_types||["all"]).sort().join(",");var r=$("#file_list").data("list");var s;if("all"===r){s=i("team",a);if(!e[s]){e[s]=true;TS.files.fetchTeamFiles(a,n)}return}var o=$("#file_list").data("filter-user")||"";if(!o)return;s=i(o,a);if(!e[s]){e[s]=true;TS.files.fetchMemberFiles(o,a,n)}}});var e={};var t=function e(t){var i=false;if(TS.boot_data.feature_docs){var n=t.target.dataset?t.target.dataset.dragMeta:null;if(t&&t.originalEvent.dataTransfer&&n){t.originalEvent.dataTransfer.effectAllowed="link";t.originalEvent.dataTransfer.setData("x-slack/file-drag-json",n);i=true}}i||t.preventDefault()};var i=function e(t,i){t=t||"team";i=i||"all";return t+"_"+i};var n=function t(n,a,r){if(!n){delete e[i(r.user,r.types)];return}TS.view.files.throttledRebuildList()};var a;var r=function e(){TS.utility.throttle.method(o,"view_tz_labels",1e3);s()};var s=function e(){var t=$("#flex_contents").find(".current_status_expiration[data-member-id]");if(t.length){var i=TS.interop.members.getMemberById(t.data("member-id"));t.replaceWith(TS.templates.builders.buildMemberCustomStatusExpiration(i,{inline:true}))}};var o=function e(){var t;var i=$(".timezone_label").add(".timezone");var n=[];i.each(function(e,i){i=$(i);t=TS.interop.members.getMemberById(i.data("member-id"));if(!t){n.push("");return}var a=t&&t.tz?t.tz:"America/Los_Angeles";var r=TS&&TS.boot_data&&TS.boot_data.dst_offsets&&TS.boot_data.dst_offsets[t.tz]&&TS.boot_data.dst_offsets[t.tz].tz_offset?TS.boot_data.dst_offsets[t.tz].tz_offset:-25200;n.push(TS.interop.datetime.memberLocalTime(Date.now(),{timeZone:a,timeZoneOffset:r,do24hrTime:TS.utility.date.do24hrTime()}));t=null;i=null});i.each(function(e,t){t=$(t);t.find(".timezone_value").text(n[e]);t=null});i=null};var l=function(){var e;var t;var i;var n=500;var a=3e3;var r=400;var s=300;var o;var l=function t(a){TS.view.rebuildMentions();if(!a)return;clearTimeout(i);i=setTimeout(function(){if(e)return;d()},n)};var c=function e(){$(".flex_header").append('<div id="rxn_toast_div" class="hidden ts_tip ts_tip_bottom"></div>');o=$("#rxn_toast_div");o.on("click",function(){var e="mentions";TS.model.ui_state.flex_visible&&TS.model.ui_state.flex_name===e||TS.client.ui.flex.openFlexTab(e);f()});o.on("mouseenter",function(){$("html").unbind("mousemove.rxn_toast");m()});o.on("mouseleave",function(){u()})};var d=function t(){var i=TS.rxns.getNextRxnRecordThatNeedsAlert();if(!i)return;if(!i.emoji)return TS.error("rxn_record.emoji missing");if(!Object.keys(i.emoji).length)return TS.error("rxn_record.emoji is empty");e=i;var n=TS.rxns.need_alerts[i.rxn_key];n||TS.error("WTF no since");var a=0;var r;var l;Object.keys(i.emoji).forEach(function(e){i.emoji[e].forEach(function(t){if(t.was_toasted)return;if(t.when<n)return;t.rxn_source=i.source;a+=1;if(!r||t.when<r.when){r=t;l=e}})});if(!l){TS.error("WTF no emoji_name");TS.dir(0,i,"rxn_record")}if(!r){TS.error("oldest_who_when is undefined.");return}r.was_toasted=true;1==a&&delete TS.rxns.need_alerts[i.rxn_key];var c=TS.redux.channels.getEntityById(r.rxn_source);var d;c.is_im?d=TS.interop.i18n.t("Direct Message","flex_pane")():c.is_group&&c.is_mpim?d=TS.mpims.legacyGetDisplayName(c,false):c.is_group||c.is_private?d=c.name:c.is_channel&&(d="#"+c.name);var m=TS.interop.members.getPrefCompliantMemberNameById(r.id,true);var f='<span class="ts_tip_tip"><span>&nbsp;&nbsp;'+m+"&nbsp;&nbsp;</span><br><span>"+_.escape(d)+"</span></span>";var h=TS.emoji.isValidName(l);var p=h?TS.emoji.graphicReplace(":"+l+":"):TS.emoji.MISSING_EMOJI_HTML;i.url&&(p='<span class="emoji-outer emoji-sizer emoji-bg-contain" style="background-image: url('+i.url+');"></span>');p+=f;var g=o.css("top");var T=-(50+o.height());var S=o.find(".ts_tip_tip").outerWidth()>150?"ts_tip_rightish":"";o.html(p).removeClass("hidden");o.addClass(S).css({opacity:0,top:T}).transition({opacity:1,top:g},s);u();$("#client-ui").addClass("rxn_toasting");TS.useGlobalNav()||$("html").bind("mousemove.rxn_toast",u);TS.interop.console.action("GLOBAL-NAV","Showing reaction toast",l);TS.redux.dispatch(TS.interop.redux.features.globalNav.setReactionToast({emoji:l,memberName:m,channelName:d}))};var u=function e(){clearTimeout(t);t=setTimeout(f,a)};var m=function e(){clearTimeout(t);o.css("opacity",1)};var f=function e(){m();TS.interop.console.action("GLOBAL-NAV","Hiding reaction toast");TS.redux.dispatch(TS.interop.redux.features.globalNav.setReactionToast(null));o.transition({opacity:0},r);$("html").unbind("mousemove.rxn_toast");t=setTimeout(function(){o.addClass("hidden");$("#client-ui").removeClass("rxn_toasting");h()},r+1)};var h=function t(){e=null;d()};return{init:function e(){c();TS.rxns.rxn_records_changed_sig.add(TS.utility.throttleFunc(l,100,true))}}}()})()},3051:function(e,t){(function(){TS.registerModule("client.msg_pane",{last_render_time:null,last_rendered_msg:null,last_in_stream_msg:null,dont_check_unreads_til_switch:false,date_change_timer:null,new_msgs_bar_showing:false,did_rebuild_msgs_sig:new signals.Signal,onStart:function e(){TS.team.team_email_domain_changed_sig.add(o,TS.client.msg_pane);TS.team.team_domain_changed_sig.add(o,TS.client.msg_pane);TS.team.team_name_changed_sig.add(o,TS.client.msg_pane);TS.prefs.team_auth_mode_changed_sig.add(o,TS.client.msg_pane);TS.prefs.team_allow_calls_changed_sig.add(d,TS.client.msg_pane);TS.prefs.team_calling_app_name_changed_sig.add(d,TS.client.msg_pane);TS.utility.calls.started_platform_call_sig.add(c,TS.client.msg_pane);TS.members.changed_admin_perms_sig.add(o,TS.client.msg_pane);TS.prefs.dtop_notif_changed_sig.add(h);TS.prefs.team_perms_pref_changed_sig.add(h);TS.prefs.muted_channels_changed_sig.add(h);TS.ui.growls.permission_changed_sig.add(h);if(TS.client&&TS.client.highlights){TS.client.highlights.updated_sig.add(TS.client.msg_pane.maybeRenderHighlightedMessages);TS.client.highlights.feedback_submitted_sig.add(TS.client.msg_pane.maybeRenderHighlightedMessageFeedback)}bowser&&bowser.msie&&bowser.version<11&&r&&(r+=" hidden")},rebuildChannelMembersList:function t(){if(TS.members.legacy_is_in_bulk_upsert_mode){if(!e){e=true;TS.members.batch_upserted_sig.addOnce(function(){e=false;TS.client.msg_pane.rebuildChannelMembersList()})}return}TS.client.ui.rebuildMemberListToggle()},displayTitle:function e(){TS.client.channel_header.start()},hideMessageContainer:function e(){TS.redux.dispatch(TS.interop.redux.features.messagePane.hideMessagePane());t.addClass("hidden");i.addClass("hidden")},showMessageContainer:function e(){t.removeClass("hidden");i.removeClass("hidden");var n=TS.shared.legacyGetActiveModelOb();if(!n)return;TS.redux.dispatch(TS.interop.redux.features.messagePane.switchToChannelIfNotActive({channelId:n.id}))},hideCenterWorkspace:function e(){n.addClass("hidden")},showCenterWorkspace:function e(){n.removeClass("hidden")},getCanonicalDivForMsg:function e(t,i){var n=i?$("#archives_msgs_div"):TS.client.ui.$msgs_div;if(n.find("ts-conversation").length){var a=n.find('ts-message[data-ts="'+t+'"]').not("ts-relatives ts-message");if(1==a.length)return a;return a.filter(":not(ts-conversation) > ts-message")}return n.find("#"+TS.templates.makeMsgDomId(t))},getDivsForMsg:function e(t){if(TS.client.ui.$msgs_div.find("ts-conversation").length)return TS.client.ui.$msgs_div.find('ts-message[data-ts="'+t+'"]');return TS.client.msg_pane.getCanonicalDivForMsg(t)},getDivForArchiveMsg:function e(t){return TS.client.archives.$archives_msgs_div.find("#"+TS.templates.makeMsgDomId(t))},topMessagesBannerShown:function e(){if(t.hasClass("has_top_messages_banner"))return;t.toggleClass("has_top_messages_banner",s().length>0)},topMessagesBannerHidden:function e(){if(!t.hasClass("has_top_messages_banner"))return;t.toggleClass("has_top_messages_banner",s().length>0)},cleanMsgDiv:function e(){},addMaybeClick:function e(t,i){if(!t)return;i=_.isFunction(i)?i:_.noop;a[t]=i},maybeClick:function e(t){var i=_.isString(t)?t:$(t).data("maybe-click");a[i]&&a[i]()},areCallsEnabled:function e(){return TS.utility.calls.isEnabled()},maybeSetupCalls:function e(t,i){var n;i||(i=TS.shared.legacyGetActiveModelOb());if(!TS.prefs.getTeamPref("allow_calls"))return;var a={id:_.get(i,"id")};if(TS.boot_data.page_needs_enterprise&&TS.boot_data.feature_default_shared_channels&&TS.interop.rules.channels.isOrgDefaultChannel(i))return;if(i.is_im){if(t&&!t.is_bot&&!TS.interop.rules.members.isSlackbotOrTeambot(t,TS.boot_data.feature_teambot)&&!t.is_self&&TS.client.msg_pane.areCallsEnabled()){_.assign(a,{is_dm:true});n={dm_member:t,name:TS.interop.i18n.safeString(TS.interop.members.getPrefCompliantMemberName(t,false,true))};m(a,n)}}else if(i.is_mpim){if(TS.client.msg_pane.areCallsEnabled()){n={names:TS.interop.i18n.safeString(TS.mpims.legacyGetDisplayName(i))};_.assign(a,{is_dm:false,is_mpdm:true});m(a,n)}}else if(i.is_channel||i.is_group){i=TS.shared.legacyGetActiveModelOb();var r=!TS.interop.rules.channels.isRequired(i)||TS.permissions.members.canPostInChannel(i);TS.client.msg_pane.areCallsEnabled()&&r&&m(a)}},setUnreadPoint:function e(t){var i=TS.shared.legacyGetActiveModelOb();var n=TS.utility.msgs.getMarkMsgTSForUnreadPoint(t,i.msgs,i);if(!n)return false;var a=TS.shared.legacyGetControllerForModelOb(i);if(!_.isFunction(a.markReadMsg))return false;a.markReadMsg(i.id,n,TS.model.marked_reasons.back);TS.model.client.reads.length=0;TS.client.markLastReadsWithAPI();TS.has_pri[T]&&TS.log(T,"setUnreadPoint for "+i.id+" - marking dont_check_unreads_til_switch = true.");TS.client.msg_pane.dont_check_unreads_til_switch=true;TS.utility.msgs.maybeClearPrevLastRead();return true},maybeResetUnreadsCheck:function e(t){if(!TS.client.msg_pane.dont_check_unreads_til_switch)return;var i=TS.shared.legacyGetActiveModelOb();if(t&&i&&i.id==t.id){TS.has_pri[g]&&TS.log(g,"resetting dont_check_unreads_til_switch, so unread / banner fade work can be re-done on current model_ob.");TS.client.msg_pane.dont_check_unreads_til_switch=false}},setCallButtonState:function e(t){var i=TS.utility.calls.isMultiPartyEnabled();TS.utility.calls.isEnabled()&&"Slack"!==TS.prefs.getTeamPref("calling_app_name")&&(i=true);var n=true;!i&&TS.utility.calls.isCurrentContextMultiParty()&&(n=false);$(".call_icon").toggleClass("call_window_offline",!(t&&n))},maybeRenderHighlightedMessages:function e(t){var i=TS.shared.legacyGetActiveModelOb();t[i.id]&&_.each(t[i.id],function(e,t){var n=TS.utility.msgs.getMsgByProp("ts",t,i.msgs);if(!n)return;(e.show_recap||e.is_leaving_feedback||e.left_feedback)&&TS.utility.msgs.replaceMsg(i,n,false,true)})},maybeRenderHighlightedMessageFeedback:function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i)return;t[i.id]&&_.each(t[i.id],function(e,t){var n=TS.utility.msgs.getMsgByProp("ts",t,i.msgs);if(!n)return;"positive"===e.feedback?TS.client.ui.$msgs_div.find('ts-message[data-ts="'+n.ts+'"] .sli_briefing__feedback_controls').addClass("gave_positive_feedback"):(e.is_leaving_feedback||e.left_feedback)&&TS.utility.msgs.replaceMsg(i,n,false,true)})},updateSharedChannelForeword:function e(){var t=TS.shared.legacyGetActiveModelOb();if(!t)return;var i=TS.utility.teams.getTeamsForModelOb(t,{include_pending:true});if(!i.length)return;$(".p-shared_team_icons").removeClass("hidden");var n=TS.templates.team_icon({team:TS.model.team,size:72,classes:"p-shared_team_icons__team_image"});i.forEach(function(e){var i="p-shared_team_icons__team_image";var a=false;if(_.indexOf(t.pending_shared,e.id)>-1){i+=" p-shared_team_icons__team_image--pending";a=true}n+=TS.templates.team_icon({team:e,is_pending_shared:a,size:72,classes:i})});$(".p-shared_team_icons").html(n);$("p .channel_meta_name").addClass("hidden");$(".channel_meta_end").addClass("hidden")}});var e=false;var t=$("#messages_container");var i=$("#footer");var n=$("#center_workspace_container");var a={};var r="no_pointer_events no_opacity";function s(){return t.find(".messages_banner:not(.messages_banner_bottom)").filter(":visible").filter(function(){var e=$(this);return!("hidden"===e.css("visibility")||e.hasClass("no_opacity"))})}var o=function e(){var t=TS.shared.legacyGetActiveModelOb();if(!t){TS.error("updateEndMarker no channel, no im, no group");return}var i=$(".end_action_slack_invite");var n=i.parent();var a=$(".end_action_invite").parent();if(t.is_general){var r;if("normal"===TS.prefs.getTeamPref("auth_mode")&&TS.model.team.email_domain){var s=location.hostname.replace(/[^.]*/,_.escape(TS.model.team.domain));r=TS.interop.i18n.t('<i class="ts_icon ts_icon_user ts_icon_inherit"></i> Send <a class="underline ts_tip ts_tip_top" href="https://{hostname}/signup">this link<span class="copied_ok ts_tip_tip hidden">Copied!</span></a> to invite people to your workspace',"client")({hostname:TS.interop.i18n.safeString(s)});TS.clipboard.canWriteText()&&i.off("click").html(r).find("a").on("click",function(e){e.preventDefault();var t;var i=$(".copied_ok");var n="https://"+s+"/signup";TS.clipboard.writeText(n);i.removeClass("hidden");t&&window.clearTimeout(t);t=window.setTimeout(function(){i.addClass("hidden")},2e3)})}else if(TS.model.user.is_admin){r=TS.interop.i18n.t('<a><i class="ts_icon ts_icon_user ts_icon_inherit"></i> Invite people to <strong>{teamname}</strong></a>',"client")({teamname:TS.interop.i18n.safeString(_.escape(TS.interop.rules.teams.getTeamDisplayName(TS.model.team)))});i.off("click").on("click.show_admin_invite_modal",TS.ui.admin_invites.start).html(r)}n.toggleClass("hidden",!r);a.toggleClass("hidden",!!r)}else{n.addClass("hidden");a.removeClass("hidden")}};var l=false;var c=function e(t){l=t.is_loading;d()};var d=function e(){u();TS.prefs.getTeamPref("allow_calls")&&TS.client.msg_pane.displayTitle()};var u=function e(){$(".channel_calls_button").remove()};var m=function e(t,i){i=i||{};var n=TS.shared.legacyGetActiveModelOb();if(!n)return;if(!TS.permissions.members.canPostInChannel(n))return;var a=TS.utility.calls.isCallWindowReady();var r=TS.utility.calls.isMultiPartyEnabled();TS.utility.calls.isEnabled()&&"Slack"!==TS.prefs.getTeamPref("calling_app_name")&&(r=true);var s=n.is_channel&&!n.is_member;var o=true;!r&&TS.utility.calls.isCurrentContextMultiParty()&&(o=false);var c=a&&o&&!s;var d="Slack"!==TS.prefs.getTeamPref("calling_app_name");var u=["call_icon"];c||u.push("call_window_offline");i.is_dm_user_offline&&u.push("away");t.is_dm&&i.hasOwnProperty("dm_member")&&u.push(TS.templates.makeMemberDomIdById(i.dm_member.id));if(TS.client.msg_pane.areCallsEnabled()){var _=$("#channel_calls_container");var m;var h;if(s)m=TS.interop.i18n.t("Join this channel to start a call","client")();else if(o)if(t.is_dm||t.is_mpdm)if(i.is_dm_user_offline)m=TS.interop.i18n.t("{name} is currently offline and unreachable","client")({name:i.name});else{h=t.is_mpdm?i.names:i.name;m=d?TS.interop.i18n.t("Call {call_name} with {calling_app_name}","client")({call_name:h,calling_app_name:TS.prefs.getTeamPref("calling_app_name")}):TS.interop.i18n.t("Call {call_name}","client")({call_name:h})}else m=d?TS.interop.i18n.t("Start a call with {calling_app_name}","client")({calling_app_name:TS.prefs.getTeamPref("calling_app_name")}):TS.interop.i18n.t("Start a call","client")();else m=t.is_mpdm?TS.interop.i18n.t("Only paid workspaces can call from group conversations.","client")():TS.interop.i18n.t("Only paid workspaces can start calls from channels.","client")();var p="";p+=TS.templates.menu_call_button({is_platform_call_loading:l,button_classes:"voice_call",tip_text:m,icon_classes:u.concat("ts_icon_phone").join(" ")});_.html(p);_.removeClass("hidden");t.id&&o&&$(".channel_calls_button.voice_call").on("click.video_call",function(){if(s)return;var e="Slack"!==TS.prefs.getTeamPref("calling_app_name");TS.interop.clog.track("CALLS_START_VOICE_BUTTON_CLICKED",{is_platform_call:e,calling_app_id:TS.prefs.getTeamPref("calling_app_id")});TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"header_calls_button"}}});e?TS.utility.calls.launchPlatformCalls(t):TS.utility.calls.startCallInModelOb(t)});_.length&&c&&!d&&f()}};var f=function e(){if(TS.prefs.getPref("in_interactive_mas_migration_flow")&&TS.model.is_mac&&TS.utility.calls.isInteractiveScreenShareHostingSupported()){TS.coachmark.start(TS.coachmarks.coachmarks.calls_interactive_screen_share);TS.prefs.setPrefLocal("in_interactive_mas_migration_flow",false);TS.prefs.setPrefByAPI({name:"in_interactive_mas_migration_flow",value:false});TS.prefs.setPrefLocal("seen_calls_interactive_coachmark",true);TS.prefs.setPrefByAPI({name:"seen_calls_interactive_coachmark",value:true});return}if("enabled"===TS.interop.experiments.getGroupForUser("calls_interactive_ss")){if(TS.prefs.getPref("shdep_promo_code_submitted")&&!TS.prefs.getPref("seen_shdep_slackbot_message")&&!TS.prefs.getPref("seen_calls_interactive_coachmark")&&TS.utility.calls.isPaidTeam()&&!TS.utility.calls.isInteractiveScreenShareHostingSupported()){TS.prefs.setPrefLocal("seen_shdep_slackbot_message",true);TS.prefs.setPrefByAPI({name:"seen_shdep_slackbot_message",value:true});TS.interop.api.call("shdep.sendSlackbotMessage")}if(TS.prefs.getPref("shdep_promo_code_submitted")&&!TS.prefs.getPref("seen_calls_interactive_coachmark")&&TS.utility.calls.isPaidTeam()&&TS.utility.calls.isInteractiveScreenShareHostingSupported()){TS.coachmark.start(TS.coachmarks.coachmarks.calls_interactive_screen_share);TS.prefs.setPrefLocal("seen_calls_interactive_coachmark",true);TS.prefs.setPrefByAPI({name:"seen_calls_interactive_coachmark",value:true})}}};var h=function e(){var t=TS.shared.legacyGetActiveModelOb();if(!t.is_mpim)return;p(t)};var p=function e(t){var i=TS.notifs.isCorGMuted(t.id);var n=TS.notifs.getCalculatedCorGNotifySetting(t.id);var a=TS.ui.growls.checkPermission();var r=false===a&&TS.ui.growls.no_notifications;var s=false===a&&"denied"===TS.ui.growls.getPermissionLevel();var o=false===a&&TS.ui.growls.shouldShowPermissionButton();var l;var c={members:TS.mpims.legacyGetMembersInDisplayOrder(t),model_ob:t,compliance_exports_enabled_for_team:!!TS.prefs.getTeamPref("compliance_export_start"),compliance_export_start:TS.prefs.getTeamPref("compliance_export_start")||0,desktop_setting:n,is_muted:i,desktop_notifs_enabled:a,notifications_impossible:r,notifications_not_allowed:s,notifications_not_yet_allowed:o};$("#im_meta").html(TS.templates.dm_badge(c));l=$(".mpim_notif_prefs");l.find(".more_options").on("click",function(){TS.ui.channel_prefs_dialog.start(t.id)});l.find("#notifications_muted_cb").on("change",function(){TS.notifs.isCorGMuted(t.id)&&TS.notifs.muteOrUnmuteCorG(t.id)});l.find("#no_notifications_cb").on("change",function(){TS.prefs.getPref("all_channels_loud")?TS.notifs.makeCorGDTopEverything(t.id):TS.notifs.makeCorGDTopMentions(t.id);TS.prefs.setMultiPrefsByAPI({loud_channels:TS.model.loud_channels.join(","),never_channels:TS.model.never_channels.join(","),loud_channels_set:TS.model.loud_channels_set.join(",")})});l.find("#all_notifications_rd").on("change",function(){TS.notifs.makeCorGDTopEverything(t.id);TS.prefs.setMultiPrefsByAPI({loud_channels:TS.model.loud_channels.join(","),loud_channels_set:TS.model.loud_channels_set.join(",")})});l.find("#mentions_rd").on("change",function(){TS.notifs.makeCorGDTopMentions(t.id);TS.prefs.setMultiPrefsByAPI({loud_channels:TS.model.loud_channels.join(","),loud_channels_set:TS.model.loud_channels_set.join(",")})})};var g=58;var T=142})()},3052:function(e,t){(function(){TS.registerModule("client.downloads",{onStart:function i(){e=true;if(t){TS.client.downloads.updateDownloadsView(t);t=void 0}},updateDownloadsView:function i(n){if(!e){t=n;return}TS.interop&&TS.interop.redux&&TS.redux.dispatch(TS.interop.redux.features.downloads.syncDownloads(n))},startDownload:function e(t,i){if(!TS.model.supports_downloads)return false;if(!t)return false;if(!a(t))return false;var n=r(a(t));var s=i||!!n;s&&TS.client.ui.flex.openFlexTab("downloads");TS.interop.desktop.startDownload({id:t.id,url:a(t)});return true},maybeBuild:function e(){if(!TS.model.supports_downloads)return;TS.interop.mountDownloadsView(TS.boot_data.team_id,n[0],function(){var e=_.get(window,"desktop.downloads.update");e&&e.call(window.desktop.downloads)})}});var e=false;var t;var i=[];var n=$("#downloads_tab");var a=function e(t){return t.url_private_download};var r=function e(t){return s("href",t)};var s=function e(t,n){if(!t)return null;if(!n&&0!==n)return null;for(var a=0;a<i.length;a+=1)if(i[a][t]==n)return i[a];return null}})()},3053:function(e,t){(function(){TS.registerModule("client.whats_new",{onStart:function e(){TS.client.login_sig.add(l);TS.prefs.whats_new_read_changed_sig.add(p);TS.client.flexpane_display_switched_sig.add(_)},updateIcon:function e(){S()},getNewestID:function e(){return i}});var e=$("#whats_new_updates");var t=$("#what_new_read_cb");var i=-1;var n=0;var a;var r=false;var s=false;var o=Math.round(Date.now()/1e3);var l=function n(){r=true;e.find(".whats_new_content").each(function(){var e=$(this);e.hasClass("html")||e.html(TS.format.formatNoHighlightsNoInlineImgs(e.html()))});i=e.children().first().data("whats-new-id")||i;p();t.bind("change",function(){d(!!$(this).prop("checked"))});c()};var c=function t(){e.find("a.whats_new_content").on("click",function(){TS.interop.clog.track("WHATSNEW_ACTION",{action:"view_update",trigger:"heading_link",page_url:$(this).attr("href"),step:i})});e.find("div.whats_new_description").find("a").on("click",function(){TS.interop.clog.track("WHATSNEW_ACTION",{action:"view_update",trigger:"description_link",page_url:$(this).attr("href"),step:i})});e.find("a.whats_new_more").on("click",function(){TS.interop.clog.track("WHATSNEW_ACTION",{action:"view_update",trigger:"read_more_link",page_url:$(this).attr("href"),step:i})})};var d=function e(t){var n=-1;if(t){n=i||Math.floor(Date.now()/1e3);TS.interop.clog.track("WHATSNEW_ACTION",{action:"opt_in",step:i,trigger:"checkbox_whats_new"})}else TS.interop.clog.track("WHATSNEW_ACTION",{action:"opt_out",step:i,trigger:"checkbox_whats_new"});TS.prefs.legacyOnPrefChanged({name:"whats_new_read",value:n});TS.prefs.setPrefByAPI({name:"whats_new_read",value:n});p()};var u=function e(){if(-1==TS.prefs.getPref("whats_new_read"))return;TS.prefs.legacyOnPrefChanged({name:"whats_new_read",value:i});TS.prefs.setPrefByAPI({name:"whats_new_read",value:i});n=0};var _=function e(){if(!r)return;var t=TS.model.ui_state.flex_name;if(!TS.model.ui_state.flex_visible||"whats_new"!==t){s=false;return}s=true;h();m()};var m=function e(){if(!s){clearTimeout(a);return}if(b())return;a=setTimeout(function(){u()},1e3)};var f=function t(){n=0;e.children().each(function(){var e=$(this);var t=e.data("whats-new-id");t&&TS.prefs.getPref("whats_new_read")<t&&(n+=1)})};var h=function t(){e.children().each(function(){var e=$(this);var t=e.data("whats-new-id");t&&TS.prefs.getPref("whats_new_read")<t?e.find(".ts_icon_presence_online").removeClass("hidden"):e.find(".ts_icon_presence_online").addClass("hidden")})};var p=function e(){f();m();T();g();S()};var g=function e(){t.prop("checked",-1!==TS.prefs.getPref("whats_new_read"))};var T=function e(){if(b()||!v()||w())$("#client-ui").removeClass("whats_new_showing");else{var t=n>9?"9+":n;$("#whats_new_toggle").addClass("exp_expanding");if(n>1){$("#whats_new_toggle").find(".num_only").removeClass("hidden").text(t);$("#whats_new_toggle").find(".num_updates").removeClass("hidden").text(TS.interop.i18n.t("{num_updates} Updates","whats_new")({num_updates:t}))}else{$("#whats_new_toggle").find(".num_only").addClass("hidden");$("#whats_new_toggle").find(".num_updates").addClass("hidden")}$("#client-ui").addClass("whats_new_showing");TS.interop.clog.track("WHATSNEW_ACTION",{action:"do_badge",trigger:i,step:i})}};var S=function e(){var t=$("#whats_new_count");if(n&&v()){t.removeClass("hidden");t.text(n<10?n:"9+")}else t.addClass("hidden")};var v=function e(){return-1!==TS.prefs.getPref("whats_new_read")&&false!==TS.prefs.getTeamPref("whats_new_badges")};var b=function e(){return TS.prefs.getPref("whats_new_read")>=i};var w=function e(){var t=691200;return o-i>=t}})()},3054:function(e,t){(function(){TS.registerModule("key_triggers",{onStart:function t(){TS.boot_data.special_flex_panes&&_.forOwn(TS.boot_data.special_flex_panes,function(t){t.keycode&&function(t,i){e[t.toString()]={func:function e(){TS.client.ui.flex.openFlexTab(i)}}}(t.keycode,t.flex_name)})},getFromCode:function t(i){i=TS.interop.i18n.keyCodeEquivalent(i,{kb:TS.i18n.keyboard(),useReverseMap:true,featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR});return e[i]}});var e={220:{isDisabled:function e(t){var i=$(t.target).closest("#reply_container").length>0;var n=$(t.target).closest(".reply_input_container").length>0;var a=i||n;return!a&&TS.client.activeChannelIsHidden()},shift_optional:false,func:function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i)return;var n=$(t.target).closest("#reply_container.has_focus").length>0||TS.boot_data.feature_react_threads&&$(t.target).closest(".p-threads_footer__input_container").length>0;var a=$(t.target).closest(".reply_input_container.has_focus").length>0;var r=$(".message--focus");var s;if(n)if(TS.boot_data.feature_react_threads){var o=TS.interop.rules.threads.getCurrentThreadKey(TS.redux.getState());var l=TS.interop.rules.threads.decodeThreadKey(o),c=l.channelId,d=l.threadTs;var u=true;s=TS.redux.messages.getRecentMessagesInThread(c,d,u);t.target=$(t.target).closest(".p-threads_footer__input_container")}else{var m=_.clone(TS.ui.replies.getActiveMessages());s=_.reverse(m);t.target=$("#reply_container")}else if(a){var f=$(".reply_input_container.has_focus");var h=TS.client.ui.threads.getThreadFromEl(f);var p=h.replies&&h.replies.length?_.clone(h.replies):_.clone(h.root_msg);p=_.dropRightWhile(h.replies,function(e){return e.ts>h.max_visible_ts});s=_.reverse(p);t.target=f}else{s=TS.redux.messages.getRecentMessagesInChannel(i.id);t.target=TS.client.ui.$msg_input}if(r.length){r.find(".btn_msg_action.ts_icon_small_reaction").click();return}var g=_(s).take(5).find(function(e){return!e.is_ephemeral});if(!g)return;var T=TS.rxns.getRxnKeyByMsgType(g);if(!T)return;var S=TS.utility.msgs.getMsgActions(g,i);if(!S||!S.add_rxn&&!S.add_file_rxn&&!S.add_file_comment_rxn){TS.sounds.play("beep");return}var v=function e(){var i=$(t.target).find("textarea").addBack();i.focus()};TS.ui.react_emoji_menu.start({e:t,rxn_key:T,callback:v})}},77:{isDisabled:function e(){return TS.model.is_chrome_desktop||TS.model.is_chrome_mobile},func:function e(){TS.model.ui_state.flex_visible&&"mentions"===TS.model.ui_state.flex_name?TS.client.ui.flex.hideFlex():TS.client.ui.flex.openFlexTab("mentions")}},83:{func:function e(){TS.model.ui_state.flex_visible&&"stars"===TS.model.ui_state.flex_name?TS.client.ui.flex.hideFlex():TS.client.ui.flex.openFlexTab("stars")}},85:{isDisabled:function e(t){return!!t.altKey||TS.client.activeChannelIsHidden()},no_shift:true,func:function e(){TS.client.ui.files.$upload.trigger("click")}},69:{func:function e(){if(TS.model.ui_state.flex_visible&&"team"===TS.model.ui_state.flex_name)TS.client.ui.flex.hideFlex();else{TS.client.ui.flex.openFlexTab("team");TS.client.ui.showTeamList()}}},65:{isDisabled:function e(){if(!TS.client.unread.isEnabled())return true;return false},func:function e(){TS.model.unread_view_is_showing?TS.client.unread.reloadIfPendingMessages():TS.client.unread.showUnreadView()}},73:{isDisabled:function e(t){if(!TS.model.is_our_app)return true;if(window.loadSettings&&window.loadSettings.devMode)return true;if(t.altKey)return true;if(TS.client.activeChannelIsHidden())return true;return false},func:function e(){TS.model.ui_state.flex_visible&&"details"===TS.model.ui_state.flex_name?TS.client.ui.flex.hideFlex():TS.client.ui.flex.openFlexTab("details")}},70:{isDisabled:function e(t){return t.altKey||!(TS.model.is_our_app||TS.model&&TS.prefs.prefs_loaded&&TS.prefs.getPref("f_key_search"))},no_shift:true,func:function e(){TS.interop.searchActions.openFromCmdF()}},71:{isDisabled:function e(t){return t.altKey||!(TS.model.is_our_app||TS.model&&TS.prefs.prefs_loaded&&TS.prefs.getPref("f_key_search"))},no_shift:true,func:function e(){TS.interop.searchActions.openFromCmdG()}},74:{isDisabled:function e(){return!TS.environment.is_apple_webkit},no_shift:true,func:_.noop},75:{isDisabled:function e(t){return t.altKey||!TS.client.ui.isUserAttentionOnChat()||!TS.model||!TS.model.is_our_app&&!TS.prefs.getPref("k_key_omnibox")},no_shift:true,func:function e(){t("k")}},76:{isDisabled:function e(t){if(!t.metaKey&&!t.altKey&&!t.shiftKey&&t.ctrlKey&&TS.model.is_mac){t.preventDefault();t.stopPropagation()}return t.altKey||!TS.client.ui.isUserAttentionOnChat()||!TS.model},shift_optional:false,func:function e(){TS.ui.channel_browser.start()}},84:{isDisabled:function e(t){return t.altKey||!TS.client.ui.isUserAttentionOnChat()||!TS.model||!TS.model.is_our_app},no_shift:true,func:function e(){t("t")}},89:{func:function e(){TS.redux.dispatch(TS.interop.redux.actions.openCustomStatusDialog({fromKeyboardShortcut:true}))}},188:{isDisabled:function e(){if(!TS.model.is_mac)return true;if(!TS.model.active_im_id)return false;return true},shift_optional:false,func:function e(){TS.ui.channel_prefs_dialog.start(TS.model.active_cid)}}};var t=function e(t){if(TS.interop.isExperimentAnyOmniSwitcher()){TS.interop.searchActions.openFromQuickSwitcherCmd({key:t});return}TS.ui.jumper.expireSession();TS.prefs.getPref("show_sidebar_quickswitcher_button")?TS.interop.clog.track("QUICKSWITCHER_ACTION",{trigger:"keyboard_shortcut",action:"opened",quickswitcher_session_id:TS.ui.jumper.getSessionId()}):TS.interop.clog.track("QUICKSWITCHER_ACTION",{trigger:"keyboard_shortcut_no_btn",action:"opened",quickswitcher_session_id:TS.ui.jumper.getSessionId()});var i=TS.prefs.getPref("k_key_omnibox_auto_hide_count");i<TS.ui.jumper.k_key_omnibox_auto_hide_count_max&&TS.prefs.setPrefByAPI({name:"k_key_omnibox_auto_hide_count",value:i+1});TS.ui.jumper.start(true)}})()},3056:function(e,t){(function(e){var t,i={get:function(e){return n[t].get.apply(this,[e])},set:function(e,i){var a=parseInt(e),r=parseInt(i),s;"undefined"===typeof e?a=0:e<0&&(a=this.val().length+a);s="undefined"===typeof i?this.val().length:i>=0?a+r:this.val().length+r;n[t].set.apply(this,[a,s]);return this},setcursor:function(e){return this.textrange("set",e,0)},replace:function(e){n[t].replace.apply(this,[String(e)]);return this},insert:function(e){return this.textrange("replace",e)}},n={xul:{get:function(e){var t={position:this[0].selectionStart,start:this[0].selectionStart,end:this[0].selectionEnd,length:this[0].selectionEnd-this[0].selectionStart,text:this.val().substring(this[0].selectionStart,this[0].selectionEnd)};return"undefined"===typeof e?t:t[e]},set:function(e,t){this[0].selectionStart=e;this[0].selectionEnd=t},replace:function(e){var t=this[0].selectionStart;var i=this[0].selectionEnd;var n=this.val();this.val(n.substring(0,t)+e+n.substring(i,n.length));this[0].selectionStart=t;this[0].selectionEnd=t+e.length}},msie:{get:function(e){var t=document.selection.createRange();if("undefined"===typeof t)return{position:0,start:0,end:this[0].val().length,length:this[0].val().length,text:this.val()};var i=this[0].createTextRange();var n=i.duplicate();i.moveToBookmark(t.getBookmark());n.setEndPoint("EndToStart",i);var a={position:n.text.length,start:n.text.length,end:n.text.length+t.text.length,length:t.text.length,text:t.text};return"undefined"===typeof e?a:a[e]},set:function(e,t){var i=this[0].createTextRange();if("undefined"===typeof i)return this;if("undefined"!==typeof e){i.moveStart("character",e);i.collapse()}"undefined"!==typeof t&&i.moveEnd("character",t-e);i.select()},replace:function(e){document.selection.createRange().text=e}}};e.fn.textrange=function(n){if("undefined"===typeof this[0])return this;"undefined"===typeof t&&(t="selectionStart"in this[0]?"xul":document.selection?"msie":"unknown");if("unknown"===t)return this;document.activeElement!==this[0]&&this[0].focus();if("undefined"===typeof n||"string"!==typeof n)return i.get.apply(this);if("function"===typeof i[n])return i[n].apply(this,Array.prototype.slice.call(arguments,1));e.error("Method "+n+" does not exist in jQuery.textrange")}})(jQuery)},3057:function(e,t){(function(e){"use strict";var t="underlay";var i=/^[^:]+:([^:+]+)?$/i;var n=/webkit/i.test(navigator.userAgent);e.widget("TS.highlighter",{options:{placeholder_class:"ghost_text",global_modifier_highlight_class:"modifier",global_modifier_incomplete_highlight_class:"incomplete",global_keyword_highlightClass:"keyword",modifiers:[]},_ghost_text:"",_ghost_prev_char:"",_$ghost_text:null,_ghost_text_changed_sig:null,_create:function(){if(!this.element.is('input[type="text"]'))throw this.widgetName+": Element is not a text input.";this._renderUI();this._on({keydown:this._onInputKey,keyup:this._onInputKey,change:this._onInputChange,scroll:this._onScroll,focus:this._onFocus,blur:this._onBlur,mouseenter:this._onMouseEnter,mouseleave:this._onMouseLeave});null===a&&l(this.element.parent());this._$ghost_text=e("<span>").addClass(this.options.placeholder_class);this._ghost_text_changed_sig=new signals.Signal;this._ghost_text_changed_sig.add(this._onNewGhostText,this);this.element.val().trim()&&this._updateUnderlay()},_destroy:function(){s(this._scroll_raf);e(window).unbind("resize.highlighter_resize");TS.client.flexpane_display_switched_sig.remove(this._updateSizing);this.element.off(".highlighter_transition")},_renderUI:function(){var i=this.widgetName+"_";this._$underlay=e('<div class="'+i+t+'"/>');this._$wrapper=this.element.parent();this._$wrapper.append(this._$underlay);this.element.addClass("search_input_highlighted");this._updateSizing();e(window).bind("resize.highlighter_resize",TS.utility.debounce(e.proxy(this._updateSizing,this),500));TS.client.flexpane_display_switched_sig.add(this._updateSizing,this);var n=this;this._$underlay.closest(".flex_header").on("transitionend.highlighter_transition webkitTransitionEnd.highlighter_transition MozTransitionEnd.highlighter_transition",function(e){n._updateSizing()})},_onInputKey:function(){this.element.trigger("change")},_onInputChange:function(){r(e.proxy(this._updateUnderlay,this))},_onScroll:function(){r(e.proxy(function(){this._$underlay.scrollLeft(this.element.scrollLeft())},this))},_onFocus:function(){this._has_focus=true;this._updateSizing();n&&this._syncScrollLeft()},_onBlur:function(){this._has_focus=false;this._updateSizing()},_onMouseEnter:function(){this._mouse_over=true;n&&this._syncScrollLeft()},_onMouseLeave:function(){this._mouse_over=false},_replaceAll:function(e,t,i){if(t instanceof RegExp)return e.replace(t,i);return e.replace(new RegExp(t,"gi"),i)},highlightStr:function(e,t){var i=e.split(" ");i.forEach(function(e,n){if(this._mightBeModifier(e)){var a=e.indexOf(":");var r=e.slice(0,a+1);var s=e.slice(a+1);var l;this.options.modifiers.some(function(a){var c=a.modifier;var d;var u;if(r.toLowerCase()===c){var _=this.options.global_modifier_highlight_class;var m=this.options.global_modifier_incomplete_highlight_class;a.modifierHighlightClass&&(_=_+" "+a.modifierHighlightClass);l="";t&&(l+='<wbr/><span class="no_wrap">');s&&a.keyword_testers.some(function(e){if(e(s)){var t=this.options.global_keyword_highlightClass;a.keyword_highlight_class&&(t=t+" "+a.keyword_highlight_class);u='<span class="'+t+'">'+o(s)+"</span>";return true}return false},this);d=u?'<span class="'+_+'">'+o(r)+"</span>":'<span class="'+_+" "+m+'">'+o(r)+"</span>";l+=d;l+=u||o(s);t&&(l+="</span>");i[n]=l;return true}i[n]=o(e);return false},this)}else i[n]=o(e)},this);return i.join(" ")},_updateUnderlay:function(){var e=this.element.val();var t;if(this._prevVal===e)return;t=this.highlightStr(e);t=this._replaceAll(t,"\n","<br/>");t=this._replaceAll(t,"  ","  ");this._$underlay.html(t);this._ghost_text&&(this._prevVal&&e.length>this._prevVal.length&&e.charAt(e.length-1)===this._ghost_text.charAt(0)?this.setGhostText(this._ghost_text.substring(1)):this._prevVal&&this._ghost_prev_char&&e.length&&e.length===this._prevVal.length-1&&this._ghost_prev_char===this._prevVal.charAt(this._prevVal.length-1)?this.setGhostText(this._ghost_prev_char+this._ghost_text):this.setGhostText(""));this._$ghost_text.appendTo(this._$underlay);this._prevVal=e;if(a||TS.model.is_safari_desktop){this._$underlay.scrollLeft(1e4);var i=this._$underlay.scrollLeft();if(0!==i){this._$underlay.scrollLeft(0);this._$underlay.addClass("hide_highlights")}else this._$underlay.removeClass("hide_highlights")}},_mightBeModifier:function(e){return i.test(e)},_syncScrollLeft:function(){var t=e.proxy(function(){var e=window.devicePixelRatio;var i=Math.floor(e)>1?2:1;var n=e/i;var a=this.element.scrollLeft()*n;if(a!==this._prev_left){this._$underlay.scrollLeft(a);this._prev_left=this._$underlay.scrollLeft()}(this._has_focus||this._mouse_over)&&(this._scroll_raf=r(t))},this);s(this._scroll_raf);this._prev_left=null;this._scroll_raf=r(t)},_updateSizing:function(e){var t=this.element.parent().outerWidth();this._$underlay.width(t);this._$underlay.css("margin-left","-"+t+"px")},_onNewGhostText:function(){this._ghost_text?this._$ghost_text.text(this._ghost_text):this._$ghost_text.html("&nbsp;&nbsp;")},setGhostText:function(e,t){this._ghost_text=e;this._ghost_prev_char=t;this._ghost_text_changed_sig.dispatch(e)}});var a=null;var r=function(){var e=["ms","moz","webkit","o"];var t=window.requestAnimationFrame;var i;for(i=0;i<e.length&&!t;i++)t=window[e[i]+"RequestAnimationFrame"];if(!t){var n=0;return function(e){var t=Date.now();var i=Math.max(0,16-(t-n));var a=window.setTimeout(function(){e(t+i)},i);n=t+i;return a}}return function(e){return t.call(window,e)}}();var s=function(){var e=["ms","moz","webkit","o"];var t=window.cancelAnimationFrame;var i;for(i=0;i<e.length&&!t;i++)t=window[e[i]+"CancelAnimationFrame"]||window[e[i]+"CancelRequestAnimationFrame"];if(!t)return function(e){clearTimeout(e)};return function(e){t.call(window,e)}}();var o=function(e){if(!e)return"";return String(e).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")};var l=function(t){if(/webkit/i.test(navigator.userAgent))return;if(/msie/i.test(navigator.userAgent))return;var i=/Firefox\/(\d+)\b/.exec(navigator.userAgent);if(i&&2===i.length&&parseInt(i[1],10)>=31)return;var n=e('<input type="text">');n.val("MMMMMMMMMMMMMMMMMMMMMMMMMM");n.css({position:"absolute",top:"0",right:"9999px"});n.width(50);n.appendTo(t);n.focus().setCursorPosition(1e4);setTimeout(function(){n.focus().setCursorPosition(1e4);a=0===n.scrollLeft();n.remove()},500)}})(jQuery)},3058:function(e,t){(function(e){"use strict";var t={history:"history",modifier:"modifier",user:"user",group:"group",channel:"channel",conversation:"conversation",time_range:"time-range",date:"date",has:"has"};var i=5;var n=i;var a=i;var r=i;var s=i;var o=i;var l=100;var c="data-replacement";var d="data-matching-keyword";var u=null;var m="modifiers";var f="history";var h="profiles";var p="li";var g="ol";var T="autocomplete_calendar";var S="calendar_visible";var v="Y-m-d";var b=null;var w=534;var y=0;var A=/\{(.+)\}/i;var k=/^[^:]+:([^:]+)?$/i;e.widget("TS.autocomplete",{options:{hidden_class:"hidden deleted",selected_class:"selected",append_to:"body",disabled:false,data:null},_$popover:null,_$menu:null,_$menu_items:null,_$calendar:null,_$ac_menu:null,_$scrollable:null,_menu_index:null,_calendar_modifier:"",_render_data:{},_last_query:null,_recalc_height:true,_open_menu_on_focus:true,_hide_timer:null,_mouse_in_menu:false,_input_has_focus:false,_block_menu:false,_texty_block_menu:false,_caret_position:null,_current_history_query:null,_current_history_items:[],_search_promises:[],_search_pending:false,_create:function(){this.options.selected_class="highlighted";u=this.options.selected_class;b=TS.interop.i18n.t("in:","search_menu")();this._renderUI();function t(){return false}var i={keydown:this._onTextInputKeydown.bind(this),keyup:this._onTextInputKeyup.bind(this),mousedown:t,mouseup:t,focus:t,blur:this._onTextInputBlur.bind(this),cut:this._onTextInput.bind(this),paste:this._onTextInput.bind(this),input:this._onTextInput.bind(this),"on-enter":this._handleEnterKey.bind(this),"on-escape":this._handleEscKey.bind(this),"on-tab":this._handleTabKey.bind(this)};this.options.registerInputEvents&&this.options.registerInputEvents(i);this._on(this._$menu,{"click li":this._onMenuClick,"click .delete_history_item_target_area":this._onClickDeleteHistoryItem,"click .footer_tip_action":this._onClickFooterTipAction,mouseenter:this._onMouseEnter,mouseleave:this._onMouseLeave,mousedown:this._onMouseDownMenu});this.options.data=this.options.data||window.DATA;e(window).bind("resize.recalc_autocomplete_height",e.proxy(function(){this._recalc_height=true},this));if(!TS.model.user.is_restricted&&!TS.model.user.is_ultra_restricted&&!TS.model.user.is_bot){TS.interop.search_autocomplete.warmQuerySuggestionCache();TS.interop.search_autocomplete.warmFileSuggestionCache()}},_destroy:function(){e(window).unbind("resize.recalc_autocomplete_height")},_show:function(){this._$popover.removeClass(this.options.hidden_class);if(this._recalc_height){this._recalc_height=false;var t=e(window).height();var i=this._$menu.offset().top;var n=t-i-25;var a=Math.min(n,w);this._$menu.css("max-height",a)}e(window).unbind("mousedown.close_autocomplete").bind("mousedown.close_autocomplete",e.proxy(this._onMouseDownOutsideAutocomplete,this));TS.ui.utility.updateClosestMonkeyScroller(this._$scrollable)},show:function(){this._show()},_hide:function(){e(p,this._$menu).removeClass(this.options.selected_class);this._$popover.addClass(this.options.hidden_class);this._mouse_in_menu=false;this._$menu_items=null;e("#search_autocomplete_popover .results").remove();this._resetMenuIndex();e(window).unbind("mousedown.close_autocomplete");TS.kb_nav.end()},hide:function(){this._hide()},_requestHide:function(){this._cancelHide();this._hide_timer=setTimeout(e.proxy(this._hide,this),0)},_cancelHide:function(){clearTimeout(this._hide_timer)},_resetMenuIndex:function(){this._menu_index=null},_renderUI:function(){this._$popover=e("<div/>").addClass("popover_menu popover_search_menu").attr("id","search_autocomplete_popover");this._$popover.addClass("unified");this._$popover.append('<span class="arrow"></span><span class="arrow_shadow"></span>');this._$menu&&this._$menu.empty();this._$ac_menu=e('<div id="autocomplete_menu" class="content"/>').appendTo(this._$popover);this._$scrollable=e('<div class="autocomplete_menu_scrollable"/>').appendTo(this._$ac_menu);this._$menu=e("<div/>").appendTo(this._$scrollable);this._initCalendar();this._hide();this._$scrollable.append(this._$menu);e(this.options.append_to).append(this._$popover);TS.environment.supports_custom_scrollbar||this._$scrollable.monkeyScroll();this._$ac_menu.addClass("search_menu");this._$ac_menu.addClass("unified")},_syncUI:function(){TS.kb_nav.end();this._render_data.header?this._$popover.addClass("showing_header"):this._$popover.removeClass("showing_header");this._$menu.html(TS.templates.search_menu_unified_autocomplete(this._render_data));this._$menu_items=e(p,this._$menu);if(this._render_data.show_calendar){this._$calendar.removeClass(this.options.hidden_class);this._$ac_menu.addClass(S);this._$calendar.find(".pmu-selected").removeClass("pmu-selected")}else{this._$calendar.addClass(this.options.hidden_class);this._$ac_menu.removeClass(S)}this._render_data.footer&&this._render_data.footer.tips?this._$popover.attr("data-qa","search_modifier_tips"):this._$popover.removeAttr("data-qa");this._resetMenuIndex();this._$scrollable.data("disable-scroll",!!this._render_data.show_calendar);TS.ui.utility.updateClosestMonkeyScroller(this._$scrollable);TS.kb_nav.start(this._$menu.find(".results"),"li",".search_menu",{allowTabHighlightWhenEmptyInput:true,onMoveHighlight:_.bind(function(){this._highlightModifierAndKeywordInSearchField()},this),allowDisabledAndHiddenItems:false,allowScrolling:false});TS.kb_nav.setAllowHighlightWithoutBlurringInput(true);TS.kb_nav.highlightFirstItem(true);this._truncateLeft()},_truncateLeft:function(){var t=this._$menu_items.find(".truncate-left");var i=t.width();t.find(".truncate-left__size").each(function(t,n){var a=e(n);var r=a.width();r>i&&a.parent().parent().addClass("truncate-left__overflow")})},_conversationsHTML:function(){this._combineChannelsAndGroups();var e=this._render_data;var t,i,n;t=TS.templates.search_menu_channels(e);i=TS.templates.search_menu_dms(e);n=TS.templates.search_menu_groups(e);var a=[];var r=[];e.channels&&e.channels.length?a.push(t):r.push(t);e.dms&&e.dms.length?a.push(i):r.push(i);e.groups&&e.groups.length?a.push(n):r.push(n);return a.join("")+r.join("")},_combineChannelsAndGroups:function(){var t=[];e.isArray(this._render_data.channels)&&(t=this._render_data.channels);e.isArray(this._render_data.groups)&&(t=t.concat(this._render_data.groups));var i=[];e.isArray(this._render_data.channels_archived)&&(i=this._render_data.channels_archived);e.isArray(this._render_data.groups_archived)&&(i=i.concat(this._render_data.groups_archived));t.sort(function(e,t){return t._score-e._score});i.sort(function(e,t){return t._score-e._score});this._render_data.channels=t;this._render_data.channels_archived=i;i.length>0&&0===t.length&&(this._render_data.channels=true);delete this._render_data.groups;delete this._render_data.groups_archived},_initCalendar:function(){this._$calendar&&this._$calendar.pickmeup("destroy").remove();this._$calendar=e("<div/>").addClass(T).addClass(this.options.hidden_class).prependTo(this._$ac_menu);this._$calendar.pickmeup({flat:true,first_day:window.moment.localeData().firstDayOfWeek()||0,format:v,change:e.proxy(this._onCalendarChange,this),max:Date.now(),title_format:"ja-JP"===TS.interop.i18n.locale?"Y\u5e74B":"B Y",locale:{days:window.moment.weekdays(),daysShort:window.moment.weekdaysShort(),daysMin:window.moment.weekdaysMin(),months:window.moment.months(),monthsShort:window.moment.monthsShort()}})},_setCalendarModifier:function(e){this._calendar_modifier=e},_onMenuClick:function(t){var i=e(t.target).closest(p);if(!i.length)return this._hide();if(this._search_promises.length>0)return this._hide();try{this._logAutocompleteResponse(i)}catch(e){}if(i.data("isNavigational")){this._navigateToModel(i.data("id"));return}var n=i.attr(c);var a=i.data("isReplacementFull");if(this._isProfileItemElement(i)){TS.search.skip_next_search=true;this._handleProfileItem(i);return}if(this._isRevealHiddenElement(i)){this._revealHiddenItems(i);return}this._open_menu_on_focus=false;this._texty_block_menu=this._shouldUseTextyAutocomplete(n);this._isHistoryItemElement(i)||a?this._replaceEntireInput(n):this._replaceCurrentWord(n);this._texty_block_menu&&TS.utility.contenteditable.insertTextAtCursor(TS.search.input,"@");this._cancelDelayedSearch();if(this._isModifierItemElement(i)){if(this._isModifierItemElementWithoutKeyword(i)){this._showKeywordAutocompleteMenu();this._texty_block_menu=false;return}this.options.data.triggerSearch&&this.options.data.triggerSearch()}else this.options.data.triggerSearch&&this.options.data.triggerSearch();this._texty_block_menu=false;this._block_menu=true;this._hide()},_logAutocompleteResponse:function(t){var i=t.data("index");var n=t.parent().children("[data-feature-vector]").filter(function(t,i){return e(i).data("index")>=0}).map(function(t,i){return e(i).data("featureVector")}).toArray();if(i<0)TS.interop.clog.track("SEARCH_AUTOCOMPLETE_REJECT",{request_id:TS.search.last_request_id,search_session_id:TS.search.getSearchSessionId(),client_request_id:TS.search.getQuerySessionId(),feature_vector_list:n});else{var a=t.parent().children().length;var r=t.parent().attr("class").replace(" ","_");var s=t.data("type");var o=Boolean(t.data("isNavigational"));var l=o?t.data("id"):null;TS.interop.clog.track("SEARCH_AUTOCOMPLETE_ACCEPT",{request_id:TS.search.last_request_id,accept_module_name:r,accept_module_length:a,accept_item_offset:i,search_session_id:TS.search.getSearchSessionId(),client_request_id:TS.search.getQuerySessionId(),suggestion_type:s,is_navigational:o,navigation_model_id:l,feature_vector_list:n})}},_onClickDeleteHistoryItem:function(t){t.stopPropagation();var i=e(t.target).closest("li");var n=_.unescape(i.attr("data-exact-string"));this.options.data.deleteHistoryItem&&this.options.data.deleteHistoryItem(n);this._current_history_items=this._current_history_items.filter(function(e){return e.text!==n});TS.interop.search_autocomplete.clearQueryHistoryCache();i.remove()},_onClickFooterTipAction:function(t){var i=e(t.target).closest(".footer_tip_action");var n=i.data("replacement");if(!n)return;this._replaceCurrentWord(n);this._showAutocompleteSuggestions()},_onMouseDownOutsideAutocomplete:function(t){e.contains(this.element[0],t.target)||e.contains(this._$popover[0],t.target)||this.element[0]===t.target||this._$popover[0]===t.target||this._hide()},_onMouseDownMenu:function(e){e.preventDefault()},_onMouseEnter:function(){this._mouse_in_menu=true},_onMouseLeave:function(){this._mouse_in_menu=false},preventMenuOnNextFocus:function(){this._open_menu_on_focus=false},_preventNextInputEvent:function(){this._prevent_next_input_event=true},_onTextInputBlur:function(){this._input_has_focus=false;this._mouse_in_menu||this._requestHide()},_onCalendarChange:function(e){var t=this._calendar_modifier+e+" ";this._open_menu_on_focus=false;this._replaceCurrentWord(t);this.options.data.triggerSearch&&this.options.data.triggerSearch();this._hide()},_onTextInputKeydown:function(t){y=t.which;if(t.keyCode===C.enter){var i=e(t.target).closest(p);if(this._isRevealHiddenElement(i)){this._revealHiddenItems(i);return}this._handleEnterKey();return}this._block_menu=false;if(!this._menuShowing())return;if(t.keyCode===C.escape){t.preventDefault();this._handleEscKey();return}if(t.keyCode===C.tab){this._handleTabKey();return}t.keyCode!==C.right||TS.utility.contenteditable.getLength(this.element)!==this._getCaretPosition()||TS.kb_nav.getHighlightedItem()||setTimeout(_.bind(function(){TS.kb_nav.highlightFirstItem();this._highlightModifierAndKeywordInSearchField()},this),0)},_handleTabKey:function(){this._menuShowing()&&1===this._$menu_items.length&&this._selectFirstItem()},_onTextInput:function(e){TS.search.maybeSetQuerySessionId();if(9==y)return;this._saveCaretPosition();this._last_query=TS.utility.contenteditable.value(this.element);if(this._prevent_next_input_event){this._prevent_next_input_event=false;return}this._showAutocompleteSuggestions()},_onTextInputKeyup:function(e){if(e.keyCode===C.escape)return;if(this._block_menu)return;if(this._hideMenuIfTextSelected())return},_selectFirstItem:function(){setTimeout(_.bind(function(){this._highlightModifierAndKeywordInSearchField();this._selectItem()},this),0)},_handleEnterKey:function(){TS.interop.searchActions.openFromKeyDown({query:TS.utility.contenteditable.value(e("#search_terms"))});return false},_handleEscKey:function(){this._menuShowing()&&this._hide()},_selectItem:function(){var t=e("."+this.options.selected_class,this._$menu);if(this._menuShowing())if(t.length>0){if(this._isProfileItemElement(t)){TS.search.skip_next_search=true;this._handleProfileItem(t);return}if(this._isRevealHiddenElement(t)){this._revealHiddenItems(t);return}if(this._modifierAutocompleteShowing()||this._isModifierItemElementWithoutKeyword(t)){this._showKeywordAutocompleteMenu();return}this.options.data.triggerSearch&&this.options.data.triggerSearch();this._hide()}else this._hide()},_handleBackspaceKey:function(e){var t=this._getCurrentModifyingStrDetails();if(t){var i=TS.utility.contenteditable.value(this.element);var n=null;t.caret_in_keyword&&this._keywordIsValid(t.keyword.keyword,t.modifier.modifier)?n=t.keyword:!t.caret_in_keyword&&this._modifierIsValid(t.modifier.modifier)&&(n=t.modifier);if(n){var a=this._replaceRange(i,n.start,n.start+n.length,"");TS.utility.contenteditable.value(this.element,a);e.preventDefault();this.element.setCursorPosition(n.start)}}},_modifierIsValid:function(e){return!!e&&this.options.data.modifiers_by_name[e]},_keywordIsValid:function(e,t){var i=this.options.data.modifiers_by_name[t];if(!i)return false;for(var n=0;n<i.keyword_testers.length;n++)if(i.keyword_testers[n](e))return true;return false},_showAutocompleteSuggestions:function(e){if(this._texty_block_menu)return;var t=TS.utility.contenteditable.value(this.element);this._cancelDelayedSearch();t||this._initCalendar();var i=this._getWordAtCaretPosition();var n=this._getCurrentWordUpToCaret();TS.metrics.mark("autocomplete_response_time_mark");this._getResultsForQueryObj({current_word_up_to_caret:n,current_word:i,query:t}).then(function(e){this._render_data=e;this._$popover.addClass("showing_query_header");this._render_data.header={query:TS.interop.texty.convertContentsStringToDisplayString(t,TS.interop.prefs.getHighlightWords())};this._render_data.show_modifier=true;this._search_promises=[];if(this._resultSetIsEmpty(this._render_data))this._hide();else{this._syncUI();this._show()}TS.metrics.measureAndClear("autocomplete_response_time","autocomplete_response_time_mark")}.bind(this));if(!this._search_pending)if(this._resultSetIsEmpty(this._render_data))this._hide();else{this._syncUI();this._show()}},_showKeywordAutocompleteMenu:function(){if(this._texty_block_menu)return;var e=this._getCurrentModifyingStrDetails();var t=this.options.data.modifiers_by_name[e.modifier.modifier];if(!e)throw this.widgetName+": Lawdy how did you get here?";var i=e.keyword.keyword;if(this._startsWith(i,"+")){this._showSpecialKeywordsAutocompleteMenu(i,e);return}if(!t)return;switch(t.modifier){case"from:":this._showUserAutocompleteMenu(i);break;case"to:":this._showConversationAutocompleteMenu(i,TS.interop.i18n.t("to:","search_menu")());break;case"in:":this._showConversationAutocompleteMenu(i,TS.interop.i18n.t("in:","search_menu")());break;case"during:":case"on:":this._showDateAutocompleteMenu(i,e.modifier.modifier);this._setCalendarModifier(e.modifier.modifier);break;case"after:":case"before:":this._showDateAutocompleteMenu(i,e.modifier.modifier);this._setCalendarModifier(e.modifier.modifier);break;case"has:":this._showHasAutocompleteMenu(i);break;default:this._render_data={footer:true};this._syncUI();break}},_showSpecialKeywordsAutocompleteMenu:function(t,i){var n=this.options.data.modifiers_by_name[i.modifier.modifier];var a=t.substring(1);var r;var s=n.keywords.filter(function(e){e===a&&(r=e);return"+"===t||this._startsWith(e,a)},this);if(r){this._replaceCurrentWord(i.modifier.modifier+r);this._showAutocompleteSuggestions();return}this._render_data={};this._render_data.modifiers=s.map(function(t){return e.extend({},n,{matching_keyword:t})});return},_showConversationAutocompleteMenu:function(e,i){if(e){var n=false;var a=[];var r={menu_type:t.conversation,conversation_modifier:i};a.push(this._getUsersForQuery(e,null,n).then(function(e){r.dms=e}));a.push(this._getUsersForQuery(e,null,n,true).then(function(e){r.dms_deleted=e}));a.push(this._getChannelsForQuery(e,null).then(function(e){r.channels=e}));a.push(this._getChannelsForQuery(e,null,true).then(function(e){r.channels_archived=e}));a.push(this._getGroupsForQuery(e,null).then(function(e){r.groups=e}));a.push(this._getGroupsForQuery(e,null,true).then(function(e){r.groups_archived=e}));var s=Promise.all(a);s.then(function(){0===r.dms.length&&r.dms_deleted.length>0&&(r.dms=true);0===r.channels.length&&r.channels_archived.length>0&&(r.channels=true);0===r.groups.length&&r.groups_archived.length>0&&(r.groups=true);this._render_data=r;this._search_pending=false;if(this._resultSetIsEmpty(this._render_data))this._hide();else{this._syncUI();this._show()}}.bind(this));this._search_promises.push(s);this._search_pending=true}else{this._render_data={menu_type:t.conversation,conversation_modifier:i,special:this.options.data.conversationsStarred(),special_section_header:TS.interop.i18n.t("Starred","search_menu")(),channels:this.options.data.channelsOpen(),dms:this.options.data.usersOpen(),groups:this.options.data.groupsOpen()};this._syncUI()}},_showDateAutocompleteMenu:function(i,n){var a=i.length>0&&/^\D/.test(i);var r=this.options.data.modifiers_by_name[n];var s;if(a){this._render_data={show_calendar:false};s=r.keywords.filter(function(e){return this._startsWith(e,i)},this);this._render_data.modifiers=s.map(function(t){return e.extend({},r,{matching_keyword:t})})}else this._render_data={menu_type:t.date,show_calendar:true,footer:{calendar_tip:true}};this._syncUI()},_showUserAutocompleteMenu:function(i){if(this._texty_block_menu)return;this._render_data={menu_type:t.user};if(!i||1===i.length&&"@"===i.charAt(0)){this._render_data.conversation_modifier=TS.interop.i18n.t("from:","search_menu")();this._render_data.special=this.options.data.usersStarred().concat(this.options.data.usersOpen());this._render_data.special_section_header=TS.interop.i18n.t("Starred and recent","search_menu")();var n=this.options.data.modifiers_by_name["from:"];this._render_data.modifiers=n.keywords.map(function(t){return e.extend({},n,{matching_keyword:t})});this._syncUI()}else{var a=[];var r={menu_type:t.user};a.push(this._getUsersForQuery(i,null).then(function(e){r.users=e}));a.push(this._getUsersForQuery(i,null,false,true).then(function(e){r.users_deleted=e}));var s=Promise.all(a);s.then(function(){0===r.users.length&&r.users_deleted.length>0&&(r.users=true);this._render_data=r;this._search_pending=false;if(this._resultSetIsEmpty(this._render_data))this._hide();else{this._syncUI();this._show()}}.bind(this));this._search_promises.push(s);this._search_pending=true}},_showHasAutocompleteMenu:function(i){this._render_data={menu_type:t.has,has:[]};this.options.data.modifiers_by_name["has:"].keywords.forEach(e.proxy(function(e){if(""===i||this._startsWith(e,i))if("ja-JP"==TS.interop.i18n.locale){var t={star:"\u30b9\u30bf\u30fc",pin:"\u30d4\u30f3",link:"\u30ea\u30f3\u30af",reaction:"\u30ea\u30a2\u30af\u30b7\u30e7\u30f3"};this._render_data.has.push({name:e,jpn_subtitle:t[e]})}else this._render_data.has.push({name:e})},this));this._syncUI()},_showModifierAutocompleteMenu:function(e){var i=this.options.data.modifiers_by_name;if(e&&this._startsWith(e,"+")){e=e.substring(1);if(i[e]){this._replaceCurrentWord(e);this._showAutocompleteSuggestions();return}}if(e)this._render_data={modifiers:this._getModifiersForQuery(e,true),menu_type:t.modifier};else{this._$popover.removeClass("showing_query_header");this._render_data={modifier_groups:true,header:true}}this._syncUI()},_getCurrentModifyingStrDetails:function(){var e=this._getCaretPosition();var t=this._getWordRangeAtCaretPosition(e);if(!t||0===t.length)return null;var i=this._getWordAtCaretPosition();var n=i.indexOf(":");var a=TS.utility.contenteditable.displayValue(this.element).indexOf(":",t.start);var r=i.slice(0,n+1);return{modifier:{start:t.start,length:n+1,modifier:r},keyword:{start:t.start+n+1,length:i.length-r.length,keyword:i.slice(n+1)},caret_in_keyword:e>a+1,caret_is_modifier_adjacent:e===a+1}},_highlightModifierAndKeywordInSearchField:function(){var e=TS.kb_nav.getHighlightedItem();if(!e||!e.length)return;var t=e.attr(c);var i=e.data("isReplacementFull");if(t){this._prevent_next_input_event=true;i?this._replaceEntireInput(t):this._replaceCurrentWord(t)}},_navigateToModel:function(e){TS.search.skip_next_search=true;this._preventNextInputEvent();TS.search.autocomplete.clearInput();this._open_menu_on_focus=true;TS.search.querySessionEnd();e&&"F"==e[0]?TS.client.ui.files.previewFile(e):TS.client.displayModelObById(e,{})},_handleProfileItem:function(e){var t=e.data("member-id");var i=e.data("bot-id");TS.search.autocomplete.clearInput();i?this.options.data.openBotProfile(i):this.options.data.openProfile(t);this._hide()},_revealHiddenItems:function(e){var t=e.nextAll("."+this.options.hidden_class.split(" ").join(", ."));e.addClass(this.options.hidden_class);t.removeClass(this.options.hidden_class)},_deduplicateModifiers:function(e){var t=[];var i=[];e.forEach(function(e){if(-1===i.indexOf(e.modifier)){t.push(e);i.push(e.modifier)}});return t},_getUsersForQuery:function(e,t,i,n){return TS.searcher.search(e,{members:{include_slackbot:true,include_self:!i,include_deleted:true},limit:t,sort:{allow_empty_query:true}}).then(function(e){var t=_.map(e,"model_ob");t=n?_.filter(t,"deleted"):_.filter(t,function(e){return!e.deleted});return t})},_getModifiersForQuery:function(t,i){var n=[];this.options.data.modifiers.forEach(function(i){(this._startsWith(i.modifier,t)||this._startsWith(i.name,t))&&n.push(e.extend({},i))},this);this.options.data.modifiers.forEach(function(a){if(!i){a.keywords.forEach(function(i){this._startsWith(i,t)&&n.push(e.extend({},a,{matching_keyword:i}))},this);a.dynamic_keywords&&a.dynamic_keywords.length>0&&a.dynamic_keywords.forEach(function(i){i(t)&&n.push(e.extend({},a,{matching_keyword:t}))})}},this);n=this._deduplicateModifiers(n);return n},_getChannelsForQuery:function(e,t,i){return TS.searcher.search(e,{channels:{include_archived:true,exclude_mpims:true},limit:t,sort:{allow_empty_query:true}}).then(function(e){var t=_.map(e,function(e){var t=e.model_ob;t._score=e.score;return t});t=i?_.filter(t,"is_archived"):_.filter(t,function(e){return!e.is_archived});return t})},_getGroupsForQuery:function(e,t,i){return TS.searcher.search(e,{groups:true,limit:t,sort:{allow_empty_query:true}}).then(function(e){var t=_.map(e,function(e){var t=e.model_ob;t._score=e.score;return t});t=i?_.filter(t,"is_archived"):_.filter(t,function(e){return!e.is_archived});return t})},_getHistoryForQuery:function(t){if(t===this._current_history_query)return this._current_history_items;this._current_history_query=t;this._current_history_items=[];this.options.data.history(t,e.proxy(this._historyFetched,this));return this._current_history_items},_getResultsForQueryObj:function(e){var i=e.current_word_up_to_caret;if(["before:","during:","on:","after:"].includes(i)){this._setCalendarModifier(i);return Promise.resolve({menu_type:t.date,show_calendar:true,footer:{calendar_tip:true}})}var n=TS.redux.getInstance().dispatch;var a=TS.redux.getState();var r=10;var s="e3_unified";var o=TS.interop.search_autocomplete.suggestions(n,a,e.query,r,s);this._search_promises.push(o);this._search_pending=true;return o.then(function(t){this._search_pending=false;var i=TS.interop.search_autocomplete.AutocompleteQuerySuggestion.fromString(a,e.query);var n=i.toMap(s);return{query:n,unified:_.filter(t,function(e){return!e.is_type_query_history&&e.suggestion_replacement!=n.suggestion_replacement}).slice(0,r),history:_.filter(t,function(e){return e.is_type_query_history}).slice(0,r)}}.bind(this))},_getCurrentWordUpToCaret:function(){var e=this._getCaretPosition();var t=this._getWordRangeAtCaretPosition(e);var i=TS.utility.contenteditable.displayValue(this.element);if(i.length&&t.length)return i.substring(t.start,e);return null},_getCaretPosition:function(){return this._caret_position},_getRealCaretPosition:function(){return TS.utility.contenteditable.cursorPosition(this.element).start},_saveCaretPosition:function(){this._caret_position=this._getRealCaretPosition()},_shouldUseTextyAutocomplete:function(e){if(Array.isArray(e)){if("from:"===e[e.length-1].insert)return true}else if(e.endsWith("from:"))return true;return false},_replaceCurrentWord:function(e){if(!e)throw this.widgetName+": A replacement word must be provided.";var t=this._getWordRangeAtCaretPosition();var i=TS.interop.texty.convertContentsStringToContents(e,{highlightWords:TS.interop.prefs.getHighlightWords(),shouldRenderEmojiAsText:TS.interop.rules.emoji.shouldRenderEmojiAsText(),emojiNames:TS.emoji.legacyGetEmojiNames(),useSonicEmoji:TS.boot_data.feature_sonic_emoji,locale:TS.interop.i18n.locale});var n=TS.interop.texty.convertContentsToStringForDisplay(i).length;TS.utility.contenteditable.cursorPosition(this.element,t.start,t.length);TS.utility.contenteditable.insertContentsAtCursor(this.element,i);TS.utility.contenteditable.cursorPosition(this.element,t.start+n);this._saveCaretPosition()},_replaceEntireInput:function(e){TS.utility.contenteditable.value(this.element,e);TS.utility.contenteditable.setCursorAtEnd(this.element);this._saveCaretPosition()},_startsWith:function(e,t){if(!e||!t||e.length<t.length)return false;return 0===e.indexOf(t)},_getWordAtCaretPosition:function(e){"undefined"===typeof e&&(e=this._getCaretPosition());var t=this._getWordRangeAtCaretPosition(e);var i=TS.utility.contenteditable.displayValue(this.element).slice(t.start,t.start+t.length);return i||null},_getWordRangeAtCaretPosition:function(e){"undefined"===typeof e&&(e=this._getCaretPosition());var t={start:0,length:0};var i=TS.utility.contenteditable.displayValue(this.element);if(!i.length)return t;var n=e-1;if(e>0)while(n>0){if(" "===i.charAt(n)){var a=TS.utility.contenteditable.getFormats(this.element,n);var r=TS.utility.contenteditable.getFormats(this.element,n+1);if(!a.slackmention||!r.slackmention){t.start=n+1;break}}n-=1}if(e===i.length)t.length=e-t.start;else{n=e;while(n<=i.length){n===i.length&&(t.length=Math.max(n-t.start,0));if(" "===i.charAt(n)){var a=TS.utility.contenteditable.getFormats(this.element,n);if(!a.slackmention){t.length=Math.max(n-t.start,0);break}}n+=1}}return t},_replaceRange:function(e,t,i,n){var a=e.substring(0,t);var r=e.substring(i);var s;s=r===e?n:a+n+r;return s},_menuShowing:function(){return this._$menu.is(":visible")},_hasNonWhiteSpace:function(e){return e&&/\S/.test(e)},_modifierAutocompleteShowing:function(){return this._render_data.menu_type===t.modifier},_resultSetIsEmpty:function(e){if(e.show_calendar)return false;if(e.modifier_groups)return false;return!(null!=e&&(e.history&&e.history.length>0||e.unified&&e.unified.length>0||e.query&&e.query.token_list&&e.query.token_list.length>0))},_isHistoryItemElement:function(t){if(!t)throw this.widgetName+": You must pass an AC result list item element to test.";return t&&e(t).closest(g).hasClass(f)},_isModifierItemElement:function(t){if(!t)throw this.widgetName+": You must pass an AC result list item element to test.";return t&&e(t).closest(g).hasClass(m)},_isProfileItemElement:function(e){if(!e)throw this.widgetName+": You must pass an AC result list item element to test.";return e.closest(g).hasClass(h)},_isRevealHiddenElement:function(e){return e.hasClass("reveal_hidden_items")},_modifierItemElementHasKeyword:function(t){if(!t)throw this.widgetName+": You must pass an AC result list item element to test.";return!!e(t).attr(d)},_isModifierItemElementWithoutKeyword:function(e){return this._isModifierItemElement(e)&&!this._modifierItemElementHasKeyword(e)},_historyFetched:function(e,t){if(this._block_menu)return;if(e!==this._current_history_query)return;if(e!==TS.utility.contenteditable.value(this.element))return;if(this._menu_index)return;if(1===t.length&&t[0]===e)return;this._current_history_items=t.map(function(e){var t=TS.interop.texty.convertContentsStringToDisplayString(e,TS.interop.prefs.getHighlightWords());return{text:e,html:t}});this._render_data.history=this._current_history_items;if(!this._resultSetIsEmpty(this._render_data)){this._render_data.noResults=false;this._syncUI();this._show()}},_cancelCurrentHistoryQuery:function(){this._current_history_query=null},_hideMenuIfTextSelected:function(){var e=TS.utility.contenteditable.cursorPosition(this.element);if(e.start!==e.end){this._hide();return true}return false},_cancelDelayedSearch:function(){_.each(this._search_promises,function(e){e.cancel()});this._search_promises=[];this._search_pending=false;this.options.data.cancelSearch()}});var C={backspace:8,tab:9,enter:13,shift:16,escape:27,up:38,right:39,down:40};var x=function(e){e=e||"";e.length>50&&(e=e.substring(0,50));return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&")};var I=function(e,t){t=x(t);var i=t.replace(/:/g,":(@|#)?");var n=new RegExp("^"+i+"(.+)","i");var a=n.exec(e);if(a&&a.length>0)return a[a.length-1];return false}})(jQuery)},3059:function(e,t){(function(){TS.registerModule("search.autocomplete",{last_input_blur_logged:"",input_events:{},onStart:function e(){S();TS.search.search_dispatched_sig.add(TS.search.autocomplete.startSpinner,TS.search.autocomplete);TS.search.all_search_results_fetched_sig.add(d);TS.search.message_search_results_fetched_sig.add(L);TS.search.file_search_results_fetched_sig.add(G);if(TS.client){TS.search.search_channel_set_sig.add(TS.search.autocomplete.updateInput,TS.search.autocomplete);TS.search.search_group_set_sig.add(TS.search.autocomplete.updateInput,TS.search.autocomplete);TS.search.search_member_set_sig.add(TS.search.autocomplete.updateInput,TS.search.autocomplete);TS.client.flexpane_display_switched_sig.add(H)}TS.web&&TS.search.quick_search_results_fetched_sig.add(TS.search.autocomplete.stopSpinner,TS.search.autocomplete);TS.search.autosuggest_search_results_fetched_sig.add(c);TS.search.autocomplete.bindUI();l()},search:function i(n,a){TS.utility.contenteditable.value(e,n);TS.utility.contenteditable.focus(e);a&&t.submit()},bindUI:function n(){t=$("#header_search_form");i=$("#search_container");e=$("#search_terms");TS.search.autocomplete.bindForm()},setUpMenu:_.once(function(){var t=b();e.autocomplete({append_to:"#header_search_form",data:t,registerInputEvents:function e(t){TS.search.autocomplete.input_events=t}})}),triggerInputEvent:function e(t,i){if(!t)return;if(!_.isFunction(TS.search.autocomplete.input_events[t])){TS.warn('TS.search.autocomplete: input event "'+t+'" not found');return}TS.search.autocomplete.input_events[t](i)},bindForm:function i(){var n;TS.client&&t.bind("submit",function(){n=!TS.utility.contenteditable.isEmpty(e,true);n&&s(true);return false});e.find(".ql-editor").off("focus.setupNoDragSearch blur.setupNoDragSearch").on("focus.setupNoDragSearch blur.setupNoDragSearch",l);$(window).off("resize.setupNoDragSearch").on("resize.setupNoDragSearch",l);$("#search_clear").bind("click.clear_input",function(){TS.search.autocomplete.clearInput()}).bind("mousedown.clear_input",function(e){e.preventDefault()})},maybeLogSearchInputBlur:function e(){var t=TS.search.last_search_query;if(!t)return;if(TS.search.autocomplete.last_input_blur_logged==t)return;TS.search.autocomplete.last_input_blur_logged=t;TS.search.saveSearch({terms:t})},clearInput:function t(){o();TS.utility.contenteditable.clear(e);Q("hide");Q("preventMenuOnNextFocus");TS.redux.dispatch(TS.interop.redux.actions.clearSearchInput())},updateInput:function t(){TS.search.query&&TS.utility.contenteditable.value(e,TS.search.query_string)},startSpinner:function e(){clearTimeout(a);a=setTimeout(function(){if(!$("#search_spinner").length){t.find(".icon_search").addClass("hidden");var e=$("#header_search_form .icon_search");var i=TS.templates.loading_indicator({id:"search_spinner"});e.after(i)}},200)},stopSpinner:function e(){clearTimeout(a);$("#search_spinner").remove();t.find(".icon_search").removeClass("hidden");n&&n.stop()},calculateNoDragRegions:function e(){l()}});var e;var t;var i;var n;var a;var r;var s=function t(i){o();var n=TS.utility.contenteditable.value(e).trim();if(!i&&n===TS.search.query_string)return;var a=TS.interop.texty.convertContentsStringForEncodedMembers(n,{highlightWords:TS.interop.prefs.getHighlightWords(),shouldRenderEmojiAsText:TS.interop.rules.emoji.shouldRenderEmojiAsText(),emojiNames:TS.emoji.legacyGetEmojiNames(),useSonicEmoji:TS.boot_data.feature_sonic_emoji,locale:TS.interop.i18n.locale});TS.interop.searchActions.openFromKeyDown({query:a})};var o=function e(){clearTimeout(TS.search.autocomplete.key_tim)};var l=_.debounce(function(){if(!i||!i[0]||!TS.model.is_mac||!TS.model.is_our_app)return;if(_.get(window,"desktop.app.updateDragRegion"))return;if(TS.ui.fs_modal.is_showing)return;TSSSB.nodrag.updateElement(i[0],"search")},250);var c=function e(t,i){var n=i.query;var a=t.suggestions;var s=r;if(!s)return;s(n,a)};var d=function e(){TS.search.autocomplete.stopSpinner()};var u=[TS.interop.i18n.t("monday","search_menu")(),TS.interop.i18n.t("tuesday","search_menu")(),TS.interop.i18n.t("wednesday","search_menu")(),TS.interop.i18n.t("thursday","search_menu")(),TS.interop.i18n.t("friday","search_menu")(),TS.interop.i18n.t("saturday","search_menu")(),TS.interop.i18n.t("sunday","search_menu")(),TS.interop.i18n.t("yesterday","search_menu")()];var m=[TS.interop.i18n.t("january","search_menu")(),TS.interop.i18n.t("february","search_menu")(),TS.interop.i18n.t("march","search_menu")(),TS.interop.i18n.t("april","search_menu")(),TS.interop.i18n.t("may","search_menu")(),TS.interop.i18n.t("june","search_menu")(),TS.interop.i18n.t("july","search_menu")(),TS.interop.i18n.t("august","search_menu")(),TS.interop.i18n.t("september","search_menu")(),TS.interop.i18n.t("october","search_menu")(),TS.interop.i18n.t("november","search_menu")(),TS.interop.i18n.t("december","search_menu")()];var f=[TS.interop.i18n.t("today","search_menu")(),TS.interop.i18n.t("week","search_menu")(),TS.interop.i18n.t("month","search_menu")(),TS.interop.i18n.t("year","search_menu")()];var h=u.concat(f,m);var p=function e(t){return N(t)};var g=function e(t){return N(t,true)};var T=[];var S=function e(){T=[{modifier:"after:",name:TS.interop.i18n.t("after:","search")(),keywords:u.concat(m),dynamic_keywords:[p],keyword_placeholder:TS.interop.i18n.t("a date","search")()},{modifier:"before:",name:TS.interop.i18n.t("before:","search")(),keywords:h,dynamic_keywords:[g],keyword_placeholder:TS.interop.i18n.t("a date","search")()},{modifier:"during:",name:TS.interop.i18n.t("during:","search")(),keywords:h,dynamic_keywords:[p],keyword_placeholder:TS.interop.i18n.t("a month or year","search")()},{modifier:"from:",name:TS.interop.i18n.t("from:","search")(),keywords:[TS.interop.i18n.t("me","search")()],keyword_placeholder:TS.interop.i18n.t("@member","search")()},{modifier:"to:",name:TS.interop.i18n.t("to:","search")(),keywords:[TS.interop.i18n.t("me","search")()],keyword_placeholder:TS.interop.i18n.t("a channel, group or direct message","search")()},{modifier:"has:",name:TS.interop.i18n.t("has:","search")(),keywords:[TS.interop.i18n.t("star","search")(),TS.interop.i18n.t("pin","search")(),TS.interop.i18n.t("link","search")(),TS.interop.i18n.t("reaction","search")()],keyword_placeholder:TS.interop.i18n.t("star, pin, link, or reaction","search")()},{modifier:"in:",name:TS.interop.i18n.t("in:","search")(),keywords:[TS.interop.i18n.t("me","search")()],keyword_placeholder:TS.interop.i18n.t("a channel, group or direct message","search")()},{modifier:"on:",name:TS.interop.i18n.t("on:","search")(),keywords:h,dynamic_keywords:[p],keyword_placeholder:TS.interop.i18n.t("a date","search")()}]};var v;var b=function e(){if(!v){v={modifiers:T,modifiers_by_name:{},users:function e(){return TS.members.getMembersForUser()},usersStarred:function e(){var t=[];var i;TS.model.ims.forEach(function(e){if(TS.interop.rules.channels.isSlackbotOrTeambot(e,TS.boot_data.feature_teambot)||!e.is_open)return;i=TS.interop.members.getMemberById(e.user);if(!i||i.deleted||i.is_self)return;e.is_starred&&t.push(e)});t.sort(w);return t.map(function(e){return TS.interop.members.getMemberById(e.user)})},usersOpen:function e(){var t=[];var i;TS.model.ims.forEach(function(e){if(TS.interop.rules.channels.isSlackbotOrTeambot(e,TS.boot_data.feature_teambot)||!e.is_open)return;i=TS.interop.members.getMemberById(e.user);if(!i||i.deleted||i.is_self)return;e.is_starred||t.push(e)});t.sort(w);return t.map(function(e){return TS.interop.members.getMemberById(e.user)})},channels:function e(){return TS.interop.redux.models.channels.getPublicChannels(TS.redux.getState())},channelsOpen:function e(){var t=TS.interop.redux.models.channels.getPublicChannelsUserIsIn(TS.redux.getState());var i=[];var n;var a;for(n=0;n<t.length;n+=1){a=t[n];if(a.is_starred)continue;if(a.is_archived)continue;if(!a.is_member)continue;i.push(a)}i.sort(y);return i},groups:function e(){return TS.model.groups},groupsOpen:function e(){var t=TS.model.groups;var i=[];var n;var a;for(a=0;a<t.length;a+=1){n=t[a];if(n.is_archived)continue;if(n.is_starred)continue;i.push(n)}i.sort(y);return i},conversationsStarred:function e(){var t=[];var i=v.usersStarred();var n=[];TS.interop.redux.models.channels.getPublicChannelsUserIsIn(TS.redux.getState()).forEach(function(e){!e.is_archived&&e.is_starred&&t.push(e)});TS.model.groups.forEach(function(e){!e.is_archived&&e.is_starred&&n.push(e)});var a=t.concat(i,n);return a},history:function e(t,i){t=t||"";r=i;TS.search.searchSuggest(t)},deleteHistoryItem:function e(t){t=TS.interop.texty.convertContentsStringForEncodedMembers(t,{highlightWords:TS.interop.prefs.getHighlightWords(),shouldRenderEmojiAsText:TS.interop.rules.emoji.shouldRenderEmojiAsText(),emojiNames:TS.emoji.legacyGetEmojiNames(),useSonicEmoji:TS.boot_data.feature_sonic_emoji,locale:TS.interop.i18n.locale});TS.interop.api.call("search.delete",{terms:t,search_session_id:TS.search.getSearchSessionId(),client_request_id:TS.search.getQuerySessionId()})},triggerSearch:function e(){s(true)},triggerDelayedSearch:function e(t){TS.search.autocomplete.key_tim=setTimeout(function(){s()},t||3e3)},cancelSearch:function e(){o()},openProfile:function e(t){TS.client.ui.previewMember(t)},openBotProfile:function e(t,i){TS.apps.promiseToGetFullAppProfile(t,i).then(function(e){TS.client.ui.app_profile.openWithApp(e,t,i)})}};v.modifiers.forEach(function(e){e.keyword_testers=[];if(e.keywords.length>0){var t=new RegExp("^("+e.keywords.join("|")+")$","i");e.keyword_testers=[function(e){return t.test(e)}]}switch(e.modifier){case"from:":e.keyword_testers.push(A);e.keyword_testers.push(C);break;case"before:":e.keyword_testers.push(function(e){return N(e,true)});break;case"after:":case"during:":case"on:":e.keyword_testers.push(N);break;case"in:":case"to:":e.keyword_testers.push(A);e.keyword_testers.push(k);e.keyword_testers.push(x);e.keyword_placeholder=TS.interop.i18n.t("channel or direct message","search")();break;default:break}v.modifiers_by_name[e.modifier]=e;v.modifiers_by_name[e.name]=e;v.modifiers_by_name[TS.interop.i18n.deburr(e.name)]=e})}return v};var w=function e(t,i){var n=TS.ims.getDisplayNameOfUserForImLowerCase(t);var a=TS.ims.getDisplayNameOfUserForImLowerCase(i);if(n>a)return 1;if(a>n)return-1;return 0};var y=function e(t,i){var n=t._name_lc;var a=i._name_lc;if(n<a)return-1;if(n>a)return 1;return 0};var A=function e(t){if(TS.boot_data.feature_deprecate_get_member_by_name){TS.logError("Search autocomplete getting member by name","get_member_by_name","TS.search.autocomplete._matchUser");return null}"@"===t.charAt(0)&&(t=t.substring(1));return TS.interop.members.getMemberByName(t)};var k=function e(t){"#"===t.charAt(0)&&(t=t.substring(1));return TS.redux.channels.getPublicOrPrivateChannelByName(t)};var C=function e(t){var i=E().name_map;t=_.toLower(t);return i[t]};var x=function e(t){if(TS.boot_data.feature_deprecate_get_member_by_name){TS.logError("Search autocomplete getting member by name","get_member_by_name","TS.search.autocomplete._matchMpim");return null}if(-1===t.indexOf(","))return false;var i=t.split(",");return _.every(i,function(e){"@"===e.charAt("0")&&(e=e.substring(1));return!!TS.interop.members.getMemberByName(e)})};var I;var M=0;var E=function e(){if(Date.now()-M>3e4){var t={};var i=[];TS.model.bots.forEach(function(e){var n=_.toLower(e.name);if(!e.deleted&&!t[n]&&"slackbot"!==n&&!("teambot"==n&&TS.boot_data.feature_teambot)){t[n]=true;i.push(e)}});I={bots:i,name_map:t}}return I};var B=/^(\d\d?)[-\/](\d\d?)[-\/](\d\d\d\d)$/;var P=/^(\d\d\d\d)[-\/](\d\d?)[-\/](\d\d?)$/;var U=/^(\d\d)[-\/](\d\d?)[-\/](\d\d?)$/;var D=/^\d\d\d\d$/;var F=/^(\d\d\d\d)[-\/](\d\d?)$/;var O=1900;var R=2999;var N=function e(t,i){var n;var a;var r;var s;var o=new Date;if(D.test(t)){n=parseInt(t,10);if(!i&&n>o.getFullYear())return false;if(n<O)return false;if(i&&n>R)return false;return true}s=B.exec(t);if(s){n=s[3];a=s[1];r=s[2]}s=!n&&P.exec(t);if(s){n=s[1];a=s[2];r=s[3]}s=!n&&U.exec(t);if(s){n=s[1];a=s[2];r=s[3]}s=!n&&F.exec(t);if(s){n=s[1];a=s[2];r="1"}if(!n)return false;n=parseInt(n,10);a=parseInt(a,10);r=parseInt(r,10);if(n<1||a<1||r<1)return false;n<100&&(n+=2e3);if(!i&&n>o.getFullYear())return false;if(n<O)return false;if(i&&n>R)return false;if(a>12)return false;if(!i&&n===o.getFullYear()&&a>o.getMonth()+1)return false;if(r>31)return false;if(!i&&n===o.getFullYear()&&a===o.getMonth()+1&&r>o.getDate())return false;if(r>30&&(4===a||6===a||9===a||11===a))return false;if(2===a&&r>29)return false;if(2===a&&29===r){if(n%4!==0)return false;if(n%100!==0)return true;if(n%400!==0)return false}return true};var L=function e(){"messages"===TS.search.filter&&TS.search.autocomplete.stopSpinner()};var G=function e(){"files"===TS.search.filter&&TS.search.autocomplete.stopSpinner()};var H=function e(){TS.model.ui_state.flex_visible&&"search"===TS.model.ui_state.flex_name||o()};var Q=function t(){TS.search.autocomplete.setUpMenu();e.autocomplete.apply(e,arguments)}})()},3060:function(e,t){(function(){TS.registerModule("ui.purpose_dialog",{div:null,showing:false,model_ob:null,onStart:function e(){},onKeydown:function e(t){if(t.which==TS.utility.keymap.enter){if(t.shiftKey)return;TS.ui.purpose_dialog.go();t.preventDefault()}else t.which==TS.utility.keymap.esc&&TS.ui.purpose_dialog.cancel()},start:function e(t){if(TS.client.ui.checkForEditing())return;_.isString(t)&&(t=TS.redux.channels.getEntityById(t));TS.ui.purpose_dialog.model_ob=t;TS.ui.purpose_dialog.is_group=TS.ui.purpose_dialog.model_ob.is_group;TS.ui.purpose_dialog.div||TS.ui.purpose_dialog.build();var i=TS.ui.purpose_dialog.div;var n=TS.templates.purpose_dialog({model_ob:TS.ui.purpose_dialog.model_ob,is_group:TS.ui.purpose_dialog.is_group});i.empty();i.html(n);var a=i.find("#purpose_input");TS.utility.contenteditable.create(a,{ariaLabel:TS.interop.i18n.t("Channel purpose","channel_pages")(),modules:{tabcomplete:{positionMenu:function e(t){t.style.width=a.outerWidth()+"px";TS.tabcomplete.positionUIRelativeToInput(t,a)},completers:["channels","emoji","members"]}},enableBroadcastKeywords:false,onEnter:function e(t){if(t.shiftKey)return true;TS.ui.purpose_dialog.go();return false},onEscape:function e(){TS.ui.purpose_dialog.cancel()},onTextChange:function e(){TS.client.channel_page.updatePurposeTooLongWarning(a)}});TS.utility.contenteditable.enable(a);TS.utility.contenteditable.value(a,TS.utility.unformatTopicOrPurpose(TS.ui.purpose_dialog.model_ob.purpose.value));i.find(".dialog_cancel").click(TS.ui.purpose_dialog.cancel);i.find(".dialog_go").click(TS.ui.purpose_dialog.go);i.modal("show")},go:function e(){if(!TS.ui.purpose_dialog.showing){TS.error("not showing?");return}var t=TS.ui.purpose_dialog.div;var i=t.find("#purpose_input");if(TS.client.channel_page.isPurposeTooLong(i))return;var n=_.trim(TS.utility.contenteditable.value(i));n=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(n,{enableBroadcastKeywords:false});(TS.ui.purpose_dialog.model_ob.is_channel||TS.ui.purpose_dialog.model_ob.is_group)&&TS.redux.dispatch(TS.interop.channels.submitChannelPurpose({channelId:TS.ui.purpose_dialog.model_ob.id,purpose:n})).then(TS.channels.legacyUpdatePurposeFromAPI).catch(TS.channels.legacyAlertSetPurposeError);t.modal("hide")},cancel:function e(){TS.ui.purpose_dialog.div.modal("hide")},end:function e(){TS.model.dialog_is_showing=false;TS.ui.purpose_dialog.showing=false},build:function e(){$("body").append('<div id="purpose_dialog" class="modal hide fade"></div>');TS.ui.purpose_dialog.div=$("#purpose_dialog");var t=TS.ui.purpose_dialog.div;t.on("hide",function(e){if(e.target!=this)return;TS.ui.purpose_dialog.end();t.removeAttr("data-qa")});t.on("show",function(e){if(e.target!=this)return;TS.model.dialog_is_showing=true;TS.ui.purpose_dialog.showing=true});t.on("shown",function(e){if(e.target!=this)return;setTimeout(function(){TS.utility.contenteditable.focus(t.find("#purpose_input"));t.attr("data-qa","purpose_dialog_ready")},100)})}})})()},3061:function(e,t){(function(){TS.registerModule("ui.growls",{no_notifications:false,permission_changed_sig:new signals.Signal,onStart:function e(){TS.ui.growls.updateTotalUnreadDisplaysSSBThrottled=TS.utility.throttleFunc(TS.ui.growls.updateTotalUnreadDisplaysSSB,500,true);TS.channels.unread_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.channels.unread_highlight_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.groups.unread_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.groups.unread_highlight_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.ims.unread_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.ims.unread_highlight_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.mpims.unread_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.mpims.unread_highlight_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.redux.socket.connectedSig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.prefs.mac_ssb_bullet_changed_sig.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.client.threads.threads_unread_changed.add(TS.ui.growls.updateTotalUnreadDisplays,TS.ui.growls);TS.ui.window_focus_changed_sig.add(TS.ui.growls.windowFocusChanged,TS.ui.growls);if(window.Notification||window.webkitNotifications);else if(!window.desktop){TS.ui.growls.no_notifications=true;return}TS.redux.dispatch(TS.interop.redux.models.environment.setNotificationPermission(TS.ui.growls.getPermissionLevel()))},shouldShowPermissionButton:function e(){if(TS.ui.growls.no_notifications)return false;if(TS.ui.growls.checkPermission())return false;if("denied"===TS.ui.growls.getPermissionLevel())return false;return true},checkPermission:function e(){if(TS.ui.growls.no_notifications)return false;if(window.desktop)return true;return"granted"===TS.ui.growls.getPermissionLevel()},perm_map:{0:"granted",1:"default",2:"denied"},getPermissionLevel:function e(){if(TS.ui.growls.no_notifications)return"na";if(window.desktop)return"na";if(window.webkitNotifications&&window.webkitNotifications.checkPermission)return TS.ui.growls.perm_map[window.webkitNotifications.checkPermission()];if(window.Notification)return window.Notification.permission},promptForPermission:function e(t){if(TS.ui.growls.no_notifications){t&&t(false,-9999999);return}var i=function e(){t&&t(TS.ui.growls.checkPermission(),TS.ui.growls.getPermissionLevel());TS.ui.growls.permission_changed_sig.dispatch(TS.ui.growls.checkPermission(),TS.ui.growls.getPermissionLevel());TS.redux.dispatch(TS.interop.redux.models.environment.setNotificationPermission(TS.ui.growls.getPermissionLevel()))};window.webkitNotifications&&window.webkitNotifications.requestPermission&&window.webkitNotifications.checkPermission?window.webkitNotifications.requestPermission(i):window.Notification&&window.Notification.requestPermission(i)},show:function e(t,i,n,a){a=a||{};var r=a.msg;var s=a.channelId;var o=a.subtitle;var l=a.launchUri;var c=TS.sounds.filenameForSoundName(a.sound_name||"new_message");var d=TS.prefs.getPref("no_text_in_notifications")?void 0:a.imageUri;var u=a.avatarImage;if(TS.utility.calls.isScreenSharing()&&!a.is_call_notification)return;if(!TS.ui.growls.checkPermission())return;var _;if(window.desktop){_={title:t,subtitle:o,content:i,launchUri:l,imageUri:d,channel:s||"",msg:r&&r.ts||"",avatarImage:u,ssbFilename:c};!c&&TS.interop.environment.isSSBAndAtLeastVersion("3.0.0")&&(_.silent=true);r&&r.thread_ts&&(_.thread_ts=r.thread_ts);TS.interop.desktop.notify(_)}else{var m;window.webkitNotifications?m=window.webkitNotifications.createNotification(TS.boot_data.img.app_icon,t,i):window.Notification&&(m=new Notification(t,{body:i,icon:TS.boot_data.img.app_icon,tag:"tag_"+(r&&(r.id||r.ts)||Date.now())}));if(!m)return;try{m.onclick=function(){window.focus();n&&n();this.cancel?this.cancel():this.close&&this.close()}}catch(e){}var f=function e(){setTimeout(function(){m.cancel?m.cancel():m.close&&m.close()},i&&i.length>80?1e4:5e3)};if(m)try{m.onshow=f;setTimeout(f,1e3)}catch(e){f()}m.show&&m.show()}},updateTotalUnreadDisplays:function e(t,i){if(TS.boot_data.feature_incremental_unread_counts)return;window.desktop&&(i&&true===i?TS.ui.growls.updateTotalUnreadDisplaysSSBThrottled():TS.ui.growls.updateTotalUnreadDisplaysSSB());TS.model.all_unread_highlights_cnt?TS.view.changeUnreadStatus("mentions"):TS.model.all_unread_cnt?TS.view.changeUnreadStatus("unreads"):TS.view.changeUnreadStatus("")},updateTotalUnreadDisplaysSSBThrottled:_.noop,updateTotalUnreadDisplaysSSB:function t(){var i=TS.model.all_unread_highlights_cnt;var n=TS.model.all_unread_cnt;if(TS.boot_data.page_needs_enterprise&&TS.model.team&&TS.model.team.enterprise_id&&TS.boot_data.other_accounts){if(TS.model.all_unread_highlights_cnt_to_exclude){TS.has_pri[e]&&TS.log(e,"updateTotalunreadDisplaysSSB: TS.model.all_unread_highlights_cnt_to_exclude = "+TS.model.all_unread_highlights_cnt_to_exclude);i=Math.max(0,i-TS.model.all_unread_highlights_cnt_to_exclude)}if(TS.model.all_unread_cnt_to_exclude){TS.has_pri[e]&&TS.log(e,"updateTotalunreadDisplaysSSB: TS.model.all_unread_cnt_to_exclude = "+TS.model.all_unread_cnt_to_exclude);n=Math.max(0,n-TS.model.all_unread_cnt_to_exclude)}}TS.has_pri[e]&&TS.log(e,"setBadgeCount - all_unread_highlights_cnt = "+i+", all_unread_cnt = "+n+", bullet = "+(!window.desktop||!TS.prefs.getPref("mac_ssb_bullet")?"false":"true"));TS.interop.desktop.setBadgeCount(i,n,window.desktop&&!!TS.prefs.getPref("mac_ssb_bullet"))},no_growl_subtypes:["channel_leave","channel_join","group_leave","group_join"],extractFromNameFromCorGMessage:function e(t){var i=TS.interop.members.getMemberById(t.user);return(i?TS.interop.members.getPrefCompliantMemberName(i):t.user)||TS.templates.builders.getBotName(t)||""},windowFocusChanged:function e(t){t&&!TS.boot_data.feature_incremental_unread_counts&&("!"!==document.title.charAt(0)&&"*"!==document.title.charAt(0)||!TS.model.active_cid||(document.title=document.title.slice(2)));!t&&TS.model.all_unread_highlights_cnt&&TS.prefs.prefs_loaded&&"long"===TS.prefs.getPref("mac_ssb_bounce")&&setTimeout(TS.ui.growls.maybeBounceDockIcon,100)},maybeBounceDockIcon:function e(){var t;window.desktop&&TS.model.is_mac&&(t=window.desktop);if(!t)return;if(!t.dock)return;if(!TS.prefs.getPref("mac_ssb_bounce"))return;"long"===TS.prefs.getPref("mac_ssb_bounce")?t.dock.bounceIndefinitely&&t.dock.bounceIndefinitely():t.dock.bounceOnce&&t.dock.bounceOnce()},showTestNotification:function e(t,i,n,a){a=a||{};if(TS.interop.desktop.shouldAttachSoundToNotification()){var r=TS.sounds.soundForName("new_message");if(r){a.ssbFilename=r.ssbFilename;a.soundUrl=r.url}}else TS.sounds.play("new_message");TS.prefs.getPref("no_text_in_notifications")&&(i="");TS.ui.growls.show(t,i,n,a)}});var e=67})()},3062:function(e,t){(function(){TS.registerModule("chat_history",{onStart:function e(){TS.model.input_history=TS.storage.fetchInputHistory()},add:function e(t){if(TS.prefs.prefs_loaded&&!TS.prefs.getPref("arrow_history")&&(!t||0!==t.indexOf("/")))return;var i=TS.model.input_history;var n=i.indexOf(t);-1!=n&&i.splice(n,1);i.length&&""===i[0]&&i.splice(0,1);i.unshift(t);TS.storage.storeInputHistory(i);if(TS.boot_data.feature_tinyspeck){TS.log(23,"(TS-ONLY log)",t);TS.dir(23,"(TS-ONLY log)",i)}},resetPosition:function e(){TS.model.input_history_index=-1},onArrowKey:function e(t,i){if(TS.prefs.prefs_loaded&&!TS.prefs.getPref("arrow_history"))return;if(!TS.model.input_history.length)return;var n=TS.utility.contenteditable.value(i);if(TS.model.input_history_index<0){TS.chat_history.add(n);TS.model.input_history_index+=1}if(t.which==TS.utility.keymap.up){TS.model.input_history_index+=1;if(TS.model.input_history_index>=TS.model.input_history.length){TS.model.input_history_index=TS.model.input_history.length-1;return}}else{if(t.which!=TS.utility.keymap.down)return;TS.model.input_history_index-=1;if(TS.model.input_history_index<0){TS.model.input_history_index=-1;return}}var a=TS.model.input_history[TS.model.input_history_index];t.preventDefault();TS.utility.contenteditable.deserialize(TS.client.ui.$msg_input,a);t.which==TS.utility.keymap.up&&TS.utility.contenteditable.cursorPosition(i,0)},getCommands:function e(){if(!_.isArray(TS.model.input_history))return;return TS.model.input_history.filter(function(e){return e&&0===e.indexOf("/")})}})})()},3063:function(e,t){(function(){TS.registerModule("ui.channel_prefs_dialog",{showing:false,onStart:function e(){TS.prefs.team_perms_pref_changed_sig.add(n);TS.prefs.muted_channels_changed_sig.add(o);if(TS.boot_data.feature_turn_mpdm_notifs_on)TS.prefs.all_notifications_prefs_changed_sig.add(f);else{TS.prefs.push_changed_sig.add(l);TS.prefs.dtop_notif_changed_sig.add(r)}},start:function t(i){if(TS.boot_data.feature_channel_notif_dialog_update){TS.interop.openChannelNotificationSettingsDialog({channelId:i});return}e||m();if(TS.ui.channel_prefs_dialog.showing)return;TS.ui.channel_prefs_dialog.renderOptions(e,i);e.modal("show");e.find(".dialog_cancel").click(d);e.find(".dialog_go").click(c)},renderOptions:function e(i,n,s){var c=TS.redux.channels.getEntityById(n);if(!c||c.is_im){alert(n+" ???");return}var d="";var u="";var m="";var f=false;if(c.is_mpim){f=true;u=TS.mpims.legacyGetDisplayName(c);m=u}else if(c.is_channel){d="channel";u=_.escape("#"+c.name);m=u;u+=TS.templates.builders.maybeMakeSharedIcon(c);u=new Handlebars.SafeString(u)}else if(c.is_group){d="group";u=c.name;m=u}t=n;var h=TS.templates.channel_prefs_dialog({c_or_g:d,is_mpim:f,display_name:u,display_name_string:m,show_one_suppressed_cb:true,show_two_suppressed_cbs:false,is_muted:TS.notifs.isCorGMuted(n),model_ob:c,embedded:s});i.html(h);l();r();a();o();$("#notifications_not_working").addClass("hidden");$("#notifications_impossible").addClass("hidden");$("#notifications_not_yet_allowed").addClass("hidden");$("#notifications_not_enabled").addClass("hidden");$("#notifications_not_allowed").addClass("hidden");$("#notifications_working").removeClass("hidden");if(TS.ui.growls.shouldShowPermissionButton()){$("#notifications_working").addClass("hidden");$("#notifications_not_working").removeClass("hidden");$("#notifications_not_yet_allowed").removeClass("hidden")}else if(!TS.ui.growls.checkPermission()){$("#notifications_working").addClass("hidden");$("#notifications_not_working").removeClass("hidden");TS.ui.growls.no_notifications?$("#notifications_impossible").removeClass("hidden"):"denied"===TS.ui.growls.getPermissionLevel()&&$("#notifications_not_allowed").removeClass("hidden")}},showMainPrefs:function e(t){d();setTimeout(function(){TS.ui.prefs_dialog.start(t)},500)}});var e=null;var t=null;var i=function e(t){if(!TS.ui.channel_prefs_dialog.showing)return;if(t.which==TS.utility.keymap.enter){if("BODY"===TS.utility.getActiveElementProp("NODENAME")){c();t.preventDefault()}}else t.which==TS.utility.keymap.esc&&d()};var n=function e(t){if("who_can_at_channel"!==t&&"who_can_at_everyone"!==t&&"who_can_post_general"!==t)return;r();l();a()};var a=function e(){if(!t)return;var i=$("#single_suppressed_cb");var n=$("#single_suppressed_label");var a=$("#single_suppressed_disabled_explain");var r=$("#single_suppressed_div");var o=$("#single_suppressed_disabled_explain_tip_link");var l=TS.notifs.hasUserSuppressedCorGChannelMentionsById(t)||TS.notifs.hasUserSuppressedCorGPushChannelMentions(t);var c=TS.notifs.getCalculatedCorGPushNotifySetting(t);var d=TS.notifs.getCalculatedCorGNotifySetting(t);var u=TS.notifs.isCorGMuted(t);var _=u||"everything"!==d||"everything"!==c;s(l,"both",_,i,n,a,r,o);if(!_)return;if("mentions"===c&&"everything"===d){$("#single_suppressed_mobile_qualifier").removeClass("hidden");$("#single_suppressed_desktop_qualifier").addClass("hidden")}else if("mentions"===d&&"everything"===c){$("#single_suppressed_desktop_qualifier").removeClass("hidden");$("#single_suppressed_mobile_qualifier").addClass("hidden")}else{$("#single_suppressed_desktop_qualifier").addClass("hidden");$("#single_suppressed_mobile_qualifier").addClass("hidden")}"mentions"===c?$("#single_suppressed_mobile_disclaimer").removeClass("hidden"):$("#single_suppressed_mobile_disclaimer").addClass("hidden")};var r=function e(){if(!t)return;var i=TS.notifs.getCalculatedCorGNotifySetting(t);$("#all_everything_default").addClass("hidden");$("#all_mentions_default").addClass("hidden");$("#all_nothing_default").addClass("hidden");TS.prefs.getPref("growls_enabled")&&TS.prefs.getPref("all_channels_loud")?$("#all_everything_default").removeClass("hidden"):TS.prefs.getPref("growls_enabled")?$("#all_mentions_default").removeClass("hidden"):$("#all_nothing_default").removeClass("hidden");$('input:radio[name="channel_loud_rd"]').filter('[value="'+i+'"]').prop("checked",true);$('input:radio[name="channel_loud_rd"]').unbind("change").bind("change",function(){var i=$(this).val();"everything"===i?TS.notifs.makeCorGDTopEverything(t):"mentions"===i?TS.notifs.makeCorGDTopMentions(t):TS.notifs.makeCorGDTopNothing(t);if(TS.boot_data.feature_turn_mpdm_notifs_on){"mentions"===i&&(i="mentions_dms");TS.redux.prefs.setChannelNotificationOverrideAndCallApi("desktop",i,t)}else TS.prefs.setMultiPrefsByAPI({loud_channels:TS.model.loud_channels.join(","),never_channels:TS.model.never_channels.join(","),loud_channels_set:TS.model.loud_channels_set.join(",")});e();a()});var n=$("#suppressed_cb");var r=$("#suppressed_label");var o=$("#suppressed_disabled_explain");var l=$("#suppressed_span");var c=$("#suppressed_disabled_explain_tip_link");var d="mentions"===i;s(TS.notifs.hasUserSuppressedCorGChannelMentionsById(t),"at_channel_suppressed_channels",d,n,r,o,l,c);a()};var s=function e(i,n,a,r,s,o,l,c){if(!t)return;a?l.removeClass("hidden"):l.addClass("hidden");var d=false;var u=TS.interop.channels.getPublicChannelById(t,d)||TS.interop.channels.getGroupById(t,d)||TS.interop.channels.getMpimById(t,d);var _=false;"admin"===TS.prefs.getTeamPref("who_can_at_channel")||"owner"===TS.prefs.getTeamPref("who_can_at_channel")?_=true:!u.is_general||"admin"!==TS.prefs.getTeamPref("who_can_at_everyone")&&"owner"!==TS.prefs.getTeamPref("who_can_at_everyone")&&"admin"!==TS.prefs.getTeamPref("who_can_post_general")&&"owner"!==TS.prefs.getTeamPref("who_can_post_general")||(_=true);if(_){s.addClass("subtle_silver");s.css("cursor","default");o.removeClass("hidden");$("#single_suppressed_mobile_disclaimer").addClass("hidden");r.prop("disabled",true);r.prop("checked",false);var m="C"===t.charAt(0)?"channel":"group";var f;f="group"===m?TS.interop.i18n.t("A Workspace Owner has restricted the use of <b>{channel}</b> to admins and/or owners. These notifications cannot be ignored.","channel_prefs")({channel:TS.templates.builders.atLabel("channel")}):u.is_general?TS.interop.i18n.t("A Workspace Owner has restricted who can post to general and/or restricted the use of <b>{channel}</b> and/or <b>{everyone}</b> to admins and/or owners. These notifications can not be ignored.","channel_prefs")({channel:TS.templates.builders.atLabel("channel"),everyone:TS.templates.builders.atLabel("everyone")}):TS.interop.i18n.t("A Workspace Owner has restricted the use of <b>{channel}</b> to admins and/or owners. These notifications cannot be ignored.","channel_prefs")({channel:TS.templates.builders.atLabel("channel")});c.tooltip("destroy").attr("title",f).tooltip({html:true,container:"#channel_prefs_dialog"})}else{s.removeClass("subtle_silver");s.css("cursor","");o.addClass("hidden");r.prop("disabled",false);r.prop("checked",i);r.unbind("change").bind("change",function(){var e=!!$(this).prop("checked");if(TS.boot_data.feature_turn_mpdm_notifs_on)TS.redux.prefs.setChannelNotificationOverrideAndCallApi("suppress_at_channel",e,t);else{if("both"===n||"at_channel_suppressed_channels"===n){e?TS.notifs.makeCorGSuppressed(t):TS.notifs.makeCorGNOTSuppressed(t);TS.prefs.setPrefByAPI({name:"at_channel_suppressed_channels",value:TS.model.at_channel_suppressed_channels.join(",")})}if("both"===n||"push_at_channel_suppressed_channels"===n){e?TS.notifs.makeCorGPushSuppressed(t):TS.notifs.makeCorGNOTPushSuppressed(t);TS.prefs.setPrefByAPI({name:"push_at_channel_suppressed_channels",value:TS.model.push_at_channel_suppressed_channels.join(",")})}}})}};var o=function e(){if(!t)return;var i=TS.notifs.isCorGMuted(t);var n=$("#muting_cb");var a=$("#non_muting_prefs");var r=$("#muting_info");n.prop("checked",i);n.unbind("change").bind("change",function(){TS.notifs.muteOrUnmuteCorG(t)});if(i){a.slideUp(150);r.removeClass("hidden")}else{a.slideDown(150);r.addClass("hidden")}};var l=function e(){if(!t)return;var i=TS.notifs.getCalculatedCorGPushNotifySetting(t);$("#all_push_everything_default").addClass("hidden");$("#all_push_mentions_default").addClass("hidden");$("#all_push_nothing_default").addClass("hidden");TS.prefs.getPref("push_everything")?$("#all_push_everything_default").removeClass("hidden"):TS.prefs.getPref("push_mention_alert")?$("#all_push_mentions_default").removeClass("hidden"):$("#all_push_nothing_default").removeClass("hidden");$('input:radio[name="channel_push_loud_rd"]').filter('[value="'+i+'"]').prop("checked",true);$('input:radio[name="channel_push_loud_rd"]').unbind("change").bind("change",function(){var i=$(this).val();"everything"===i?TS.notifs.makeCorGPushEverything(t):"mentions"===i?TS.notifs.makeCorGPushMentions(t):TS.notifs.makeCorGPushNothing(t);if(TS.boot_data.feature_turn_mpdm_notifs_on){"mentions"===i&&(i="mentions_dms");TS.redux.prefs.setChannelNotificationOverrideAndCallApi("mobile",i,t)}else TS.prefs.setMultiPrefsByAPI({push_loud_channels:TS.model.push_loud_channels.join(","),push_mention_channels:TS.model.push_mention_channels.join(","),push_loud_channels_set:TS.model.push_loud_channels_set.join(",")});e();a()});var n=$("#push_suppressed_cb");var r=$("#push_suppressed_label");var o=$("#push_suppressed_disabled_explain");var l=$("#push_suppressed_span");var c=$("#push_suppressed_disabled_explain_tip_link");var d="mentions"===i;s(TS.notifs.hasUserSuppressedCorGPushChannelMentions(t),"push_at_channel_suppressed_channels",d,n,r,o,l,c);a()};var c=function t(){if(!TS.ui.channel_prefs_dialog.showing){TS.error("not showing?");return}e.modal("hide")};var d=function t(){e.modal("hide")};var u=function e(){t=null;TS.model.dialog_is_showing=false;TS.ui.channel_prefs_dialog.showing=false;$(window.document).unbind("keydown",i)};var m=function t(){$("body").append('<div id="channel_prefs_dialog" tabindex="-1" class="modal hide fade"></div>');e=$("#channel_prefs_dialog");e.on("hide",function(e){if(e.target!=this)return;u()});e.on("hidden",function(t){if(t.target!=this)return;e.remove();e=null});e.on("show",function(e){if(e.target!=this)return;TS.model.dialog_is_showing=true;TS.ui.channel_prefs_dialog.showing=true});e.on("shown",function(e){if(e.target!=this)return;setTimeout(function(){$(window.document).bind("keydown",i)},100)})};var f=function e(){l();r()}})()},3064:function(e,t){(function(){TS.registerModule("ui.upload_dialog",{div:null,filesQ:[],file:null,showing:false,last_share_cb_checked:null,selection:null,onStart:function e(){},onKeydown:function e(t){if(!TS.ui.upload_dialog.showing)return;if(t.which==TS.utility.keymap.enter){if("TEXTAREA"!==TS.utility.getActiveElementProp("NODENAME")){a?TS.ui.upload_dialog.cancel():TS.ui.upload_dialog.go();t.preventDefault()}}else if(t.which==TS.utility.keymap.esc)TS.ui.upload_dialog.cancel();else if(t.which==TS.utility.keymap.tab&&$(document.activeElement).hasClass("dialog_go")){t.preventDefault();TS.ui.upload_dialog.div.find(".title_input").focus()}},shouldShowConfirmation:function e(){return!a&&TS.utility.contenteditable.getDisplayValueLength(TS.ui.upload_dialog.div.find("#file_comment_textarea"))>400},showConfirmation:function e(){var t=TS.ui.upload_dialog.div;var i=t.find(".modal-footer-confirm");t.find(".upload_actions").addClass("hidden");i.removeClass("hidden");i.find(".dialog_cancel").focus();a=true},start:function e(t){if(!t||!t.length){TS.info("no files");return}var i=0;var n;for(var a=0;a<t.length;a+=1){n=t[a];if(n.size>TS.model.upload_file_size_limit_bytes)continue;i+=1;TS.ui.upload_dialog.filesQ.push(n)}if(i<t.length){var r="";r=1==t.length?TS.interop.i18n.t("That file is too large and cannot be uploaded. The limit is {limit_size}.","upload_dialog")({limit_size:TS.interop.utility.convertFilesize(TS.model.upload_file_size_limit_bytes)}):i?TS.interop.i18n.t("We\u2019ll upload what we can, but one or more of those files is too large and cannot be uploaded. The limit is {limit_size}.","upload_dialog")({limit_size:TS.interop.utility.convertFilesize(TS.model.upload_file_size_limit_bytes)}):TS.interop.i18n.t("All of those file are too large and cannot be uploaded. The limit is {limit_size}.","upload_dialog")({limit_size:TS.interop.utility.convertFilesize(TS.model.upload_file_size_limit_bytes)});alert(r)}if(!i)return;TS.ui.upload_dialog.div||TS.ui.upload_dialog.build();TS.ui.upload_dialog.showing||TS.ui.upload_dialog.pullFromQ(true)},startWithCommentFromChatInput:function i(n){e=TS.utility.contenteditable.value(TS.client.ui.$msg_input);t=TS.utility.contenteditable.getDisplayValueLength(TS.client.ui.$msg_input);TS.ui.upload_dialog.start(n);TS.view.clearMessageInput()},pullFromQ:function e(t){if(TS.ui.upload_dialog.filesQ.length){TS.boot_data.feature_lesson_onboarding&&TS.prefs.getPref("lessons_enabled")&&TS.lessons.inOnboarding()&&TS.lessons.file_upload_modal_sig.dispatch(true);TS.ui.upload_dialog._startWithFile(TS.ui.upload_dialog.filesQ.shift(),t);return true}TS.client.ui.resetFiles?TS.client.ui.resetFiles():TS.console&&TS.console.warn&&TS.warn(8675309,"TS.client.ui.resetFiles undefined");return false},_startWithFile:function e(t,i){n=false;TS.ui.upload_dialog.file=t;var a=TS.templates.file_upload_dialog({filename:TS.files.makeFileNameFromFile(t),title:s(t),has_name:!!t.name,sharing_html:TS.templates.builders.buildFileSharingControls(t,null,o(),null,TS.ui.upload_dialog.selection),over_storage_limit:TS.model.team.over_storage_limit&&true!==t.is_dropbox&&true!==t.is_box&&true!==t.is_external,plan:TS.model.team.plan,more_in_queue:TS.ui.upload_dialog.filesQ.length>0,file_retention_type:parseInt(TS.prefs.getTeamPref("file_retention_type"),10),file_retention_duration:TS.interop.datetime.daysToYearsPretty(TS.prefs.getTeamPref("file_retention_duration"))});var c=TS.ui.upload_dialog.div;c.html(a);var d=function e(t){$("#upload_image_preview").removeClass("hidden").find("img").attr("src",t)};if("string"===typeof t)d("data:image/png;base64,"+t);else if(window.FileReader)try{if(window.EXIF){var u=new FileReader;u.onload=function(e){var t=EXIF.readFromBinaryFile(e.target.result);t.Orientation&&"number"===typeof t.Orientation&&1!==t.Orientation&&$("#upload_image_preview").find("img").addClass("orientation_"+t.Orientation)};u.readAsArrayBuffer(t)}var _=new FileReader;_.onload=function(e){var t=e.target.result;if(0!==t.indexOf("data:image/"))return;d(t)};_.onloadstart=function(e){if(e.total>33554432){TS.info("skipping image preview for large file: "+e.total);_.abort()}};_.readAsDataURL(t)}catch(e){TS.info(e)}var m=$("#file_comment_textarea");TS.ui.comments.bindInput(m,TS.ui.upload_dialog.go);TS.utility.contenteditable.value(m,o());m=null;var f=TS.ui.upload_dialog.showing;c.modal("show");TS.ui.upload_dialog.filesQ.length&&c.find(".file_count").text(TS.interop.i18n.t(" (and {num_files_remaining, number} more\u2026)","upload_dialog")({num_files_remaining:TS.ui.upload_dialog.filesQ.length}));if(i){var h=!TS.client.activeChannelIsHidden();c.find("#share_cb").prop("checked",h)}else c.find("#share_cb").prop("checked",true===TS.ui.upload_dialog.last_share_cb_checked);c.find(".modal-header > .close").click(l);c.find(".dialog_cancel_all").click(TS.ui.upload_dialog.cancelAll);c.find(".dialog_cancel").click(TS.ui.upload_dialog.cancel);c.find(".dialog_go").click(TS.ui.upload_dialog.go);var p=!i&&TS.ui.upload_dialog.selection?TS.ui.upload_dialog.selection:null;TS.ui.file_share.bindFileShareDropdowns(null,void 0,p);TS.ui.file_share.bindFileShareShareToggle();TS.ui.file_share.bindFileShareCommentField();var g="TS-lazyFilterSelect";c.find(".lfs_input_container").attr("tabindex","0");c.find("#select_share_channels").data(g).instance.onKeyDown=function(e){if(e.which==TS.utility.keymap.tab){e.preventDefault();e.shiftKey?c.find("#share_cb").focus():TS.utility.contenteditable.focus(c.find("#file_comment_textarea"))}};f&&r(c)},go:function e(){if(n){TS.info("TS.ui.upload_dialog.go stopped because already uploading");return false}if(!TS.ui.upload_dialog.showing){TS.error("not showing?");return}if(!TS.ui.upload_dialog.file){TS.error("no file?");return}if(TS.ui.file_share.shouldBlockUploadDialogSubmission())return;var t=TS.ui.upload_dialog.div;var i=!!t.find("#share_cb").prop("checked");TS.ui.upload_dialog.last_share_cb_checked=!!i;TS.ui.upload_dialog.selection=$("#share_model_ob_id").val();var a=i?TS.ui.upload_dialog.selection:null;var r=TS.utility.contenteditable.value($("#file_comment_textarea"));r=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(r,{enableBroadcastKeywords:false});""===$.trim(r)&&(r="");var s=t.find(".filename_input").val();var o=t.find(".title_input").val();if(TS.ui.upload_dialog.file.is_dropbox||TS.ui.upload_dialog.file.is_box){var l=TS.ui.upload_dialog.file.link;TS.shared.legacyGetShareModelObId(a,function(e){TS.files.upload({link:l,filename:s,title:o,channels:e,initial_comment:r,is_dropbox:TS.ui.upload_dialog.file.is_dropbox,is_box:TS.ui.upload_dialog.file.is_box});a&&c(a)})}else{var d=TS.ui.upload_dialog.file;TS.shared.legacyGetShareModelObId(a,function(e){TS.files.upload({file:d,filename:s,title:o,channels:e,initial_comment:r});a&&c(a)})}n=true;TS.ui.upload_dialog.maybeGoAway()},maybeGoAway:function i(){e="";t=0;if(!TS.ui.upload_dialog.pullFromQ()){TS.ui.upload_dialog.div.modal("hide");TS.ui.upload_dialog.selection=null;return true}return false},cancel:function t(){if(TS.ui.upload_dialog.shouldShowConfirmation()){TS.ui.upload_dialog.showConfirmation();return}TS.ui.upload_dialog.selection=$("#share_model_ob_id").val();var i=e;var n=TS.ui.upload_dialog.maybeGoAway();i&&TS.client.msg_input.populate(i);n&&i&&setTimeout(TS.view.focusMessageInput,10);a=false},cancelAll:function e(){TS.ui.upload_dialog.filesQ=[];TS.ui.upload_dialog.cancel()},end:function i(){TS.model.dialog_is_showing=false;TS.ui.upload_dialog.showing=false;TS.ui.upload_dialog.file=null;e="";t=0;a=false;TS.ui.upload_dialog.div.empty();$(window.document).unbind("keydown",TS.ui.upload_dialog.onKeydown)},build:function e(){$("body").append('<div id="upload_dialog" tabindex="-1" class="modal hide fade" data-keyboard="false" data-backdrop="static"></div>');TS.ui.upload_dialog.div=$("#upload_dialog");var t=TS.ui.upload_dialog.div;t.on("hidden",function(e){if(e.target!=this)return;TS.ui.upload_dialog.end()});t.on("show",function(e){if(e.target!=this)return;TS.model.dialog_is_showing=true;TS.ui.upload_dialog.showing=true});t.on("shown",function(e){if(e.target!=this)return;setTimeout(function(){r(t);$(window.document).bind("keydown",TS.ui.upload_dialog.onKeydown)},100)})}});var e="";var t=0;var i=50;var n=false;var a=false;var r=function n(a){if(e&&t>i){TS.utility.contenteditable.focus(a.find("#file_comment_textarea"));TS.utility.contenteditable.cursorPosition(a.find("#file_comment_textarea"),0,1e5)}else a.find("#upload_file_title").focus().select()};var s=function n(a){if(e&&t<=i)return TS.interop.texty.convertContentsStringToDisplayString(e,TS.interop.prefs.getHighlightWords());return TS.files.makeFileTitleFromFile(a)};var o=function n(){if(e&&t>i)return e;return""};var l=function e(t){t.preventDefault();TS.ui.upload_dialog.cancelAll()};var c=function e(t){var i=false;TS.interop.channels.getPublicChannelById(t,i)?TS.channels.legacyDisplayChannel({id:t}):TS.redux.channels.getImByMemberId(t,i)?TS.ims.legacyStartImByMemberId(t):TS.interop.channels.getMpimById(t,i)?TS.mpims.legacyDisplayMpim({id:t}):TS.interop.channels.getGroupById(t,i)?TS.groups.legacyDisplayGroup({id:t}):TS.error("no valid shared channel/im/mpim/group to display")}})()},3065:function(e,t){(function(){TS.registerModule("ui.snippet_dialog",{editor:null,text_from_input:null,edit_file_id:null,div:null,showing:false,onStart:function e(){},startCreate:function e(t){if(TS.ui.snippet_dialog.showing)return;TS.ui.snippet_dialog.showing=true;TS.ui.snippet_dialog.text_from_input=t||null;TS.ui.snippet_dialog.edit_file_id=null;TS.ui.snippet_dialog.start(t,null,TS.prefs.getPref("last_snippet_type")||"text")},startEdit:function e(t){if(TS.ui.snippet_dialog.showing)return;var i=TS.files.getFileById(t);if(!i)return;TS.files.fetchFileInfo(t,function(e,i){TS.ui.snippet_dialog.edit_file_id=t;TS.ui.snippet_dialog.text_from_input=null;TS.ui.snippet_dialog.start(i.content,i.title,i.filetype)})},start:function r(s,o,l){TS.model.user&&"U1MV5VA73"===TS.model.user.id&&TS.console.logError("TS.ui.snippet_dialog.start called","snippet_on_send");i=s||"";t=o||"";n=l||"";if(!window.CodeMirror){if(e);else{e=true;TS.utility.getCachedScript(_.get(TS,"boot_data.vvv_paths.codemirror","/js/libs/codemirror.min.js")).done(function(){TS.utility.getCachedScript(_.get(TS,"boot_data.vvv_paths.codemirror_addon_simple","/js/libs/codemirror/addon/simple.js")).done(function(){TS.utility.getCachedScript(_.get(TS,"boot_data.vvv_paths.codemirror_load","/js/codemirror_load.js")).done(function(){TS.ui.snippet_dialog.start(s,o,l)})})})}return}TS.ui.snippet_dialog.div||TS.ui.snippet_dialog.build();var c={codemirror_types:TS.boot_data.codemirror_types,wrap_lines:TS.prefs.getPref("snippet_editor_wrap_long_lines")};if(TS.ui.snippet_dialog.edit_file_id)c.is_edit=true;else{c.is_edit=false;c.sharing_html=TS.templates.builders.buildFileSharingControls()}var d=TS.templates.snippet_dialog(c);var u=TS.ui.snippet_dialog.div;u.html(d);u.modal("show");u.find(".modal-footer-action > .cancel, .modal-header > .close").click(TS.ui.snippet_dialog.cancelPrompt);u.find(".dialog_cancel").click(TS.ui.snippet_dialog.cancel);u.find(".dialog_cancel_decline").click(TS.ui.snippet_dialog.cancelDecline);u.find(".dialog_go").click(TS.ui.snippet_dialog.go);TS.ui.snippet_dialog.editor=CodeMirror.fromTextArea(document.getElementById("client_file_snippet_textarea"),{lineNumbers:true,matchBrackets:true,indentUnit:4,indentWithTabs:true,enterMode:"keep",tabMode:"shift",viewportMargin:10,autofocus:false,lineWrapping:TS.prefs.getPref("snippet_editor_wrap_long_lines")});$("#client_file_snippet_select").change(function(){CodeMirror.switchSlackMode(TS.ui.snippet_dialog.editor,$(this).val());TS.prefs.setPrefByAPI({name:"last_snippet_type",value:$(this).val()})}).change();$("#client_file_wrap_cb").bind("change",function(){var e=$(this).is(":checked");TS.ui.snippet_dialog.editor.setOption("lineWrapping",e);TS.prefs.setPrefByAPI({name:"snippet_editor_wrap_long_lines",value:e})});var m=false;if(TS.ui.snippet_dialog.edit_file_id){TS.ui.snippet_dialog.editor.setValue(s);o&&(o=TS.emoji.maybeGetLocalizedEmojiString(TS.format.unFormatMsg(o)));$("#client_file_snippet_title_input").val(o||"")}else{TS.ui.snippet_dialog.editor.setValue(s||"");$("#client_file_snippet_title_input").val("");TS.ui.file_share.bindFileShareDropdowns();TS.ui.file_share.bindFileShareShareToggle();TS.ui.file_share.bindFileShareCommentField();m=!!s}var f=$("#file_comment_textarea");TS.ui.comments.bindInput(f,TS.ui.snippet_dialog.go);$("#client_file_snippet_select").val(l).trigger("change");setTimeout(function(){m?$("#client_file_snippet_title_input").focus():TS.ui.snippet_dialog.editor.focus();TS.ui.snippet_dialog.editor.refresh()},350);$(window.document).on("keydown",TS.ui.snippet_dialog.onKeyDown);$(window.document).on("keyup",a);TS.ui.snippet_dialog.editor.on("change",a)},go:function e(){TS.model.user&&"U1MV5VA73"===TS.model.user.id&&TS.console.logError("TS.ui.snippet_dialog.go called","snippet_on_send");if(!TS.ui.snippet_dialog.showing){TS.error("not showing?");return}var t=TS.ui.snippet_dialog.editor.getValue();if(!$.trim(t))return;if(TS.ui.file_share.shouldBlockUploadDialogSubmission())return;var i=TS.emoji.maybeGetCanonicalEmojiString($("#client_file_snippet_title_input").val());if(TS.ui.snippet_dialog.edit_file_id)TS.interop.api.call("files.edit",{file:TS.ui.snippet_dialog.edit_file_id,title:i,content:t,filetype:$("#client_file_snippet_select").val()});else{var n=!!$("#share_cb").prop("checked");var a=n?$("#share_model_ob_id").val():null;var r=$("#client_file_snippet_select").val();var s=TS.utility.contenteditable.value($("#file_comment_textarea"));s=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(s,{enableBroadcastKeywords:false});""===$.trim(s)&&(s="");TS.shared.legacyGetShareModelObId(a,function(e){TS.files.upload({text:t,title:i,filetype:r,channels:e,initial_comment:s});if(TS.client){var n=TS.redux.channels.getEntityById(e);if(!n)return;TS.client.displayModelOb(n)}})}TS.ui.snippet_dialog.div.modal("hide");TS.ui.snippet_dialog.end()},cancelPrompt:function e(a){if(a){a.preventDefault();a.stopPropagation()}var r=TS.ui.snippet_dialog;var s=TS.emoji.maybeGetCanonicalEmojiString($("#client_file_snippet_title_input").val());var o=TS.ui.snippet_dialog.editor.getValue();var l=$("#client_file_snippet_select").val();if(TS.ui.snippet_dialog.edit_file_id){if(TS.emoji.maybeGetCanonicalEmojiString(t)===s&&i===o&&n===l)return r.cancel()}else if(!o&&!s)return r.cancel();var c=TS.ui.snippet_dialog.div;c.find(".modal-footer-confirm").removeClass("hidden");c.find(".modal-footer-action").addClass("hidden")},cancelDecline:function e(){var t=TS.ui.snippet_dialog.div;t.find(".modal-footer-confirm").addClass("hidden");t.find(".modal-footer-action").removeClass("hidden")},cancel:function e(t){t&&t.preventDefault();if(TS.ui.snippet_dialog.text_from_input){TS.client.msg_input.populate(TS.ui.snippet_dialog.editor.getValue());TS.ui.snippet_dialog.text_from_input=""}setTimeout(TS.view.focusMessageInput,10);TS.ui.snippet_dialog.end();TS.ui.snippet_dialog.div.modal("hide")},end:function e(){$(window.document).off("keydown",TS.ui.snippet_dialog.onKeyDown);$(window.document).off("keyup",a);TS.model.dialog_is_showing=false;TS.ui.snippet_dialog.showing=false;TS.ui.snippet_dialog.editor&&TS.ui.snippet_dialog.editor.cleanup&&TS.ui.snippet_dialog.editor.cleanup();TS.ui.snippet_dialog.editor=null;TS.ui.snippet_dialog.div.empty()},onKeyDown:function e(t){var i=TS.ui.snippet_dialog;if(t.which==TS.utility.keymap.esc){i.div.find(".modal-footer-confirm").is(":visible")?i.cancelDecline():i.cancelPrompt();t.preventDefault()}else if(t.which==TS.utility.keymap.enter){TS.model.user&&"U1MV5VA73"===TS.model.user.id&&TS.console.logError({isFocusOnInput:TS.utility.isFocusOnInput(),activeElement:document.activeElement&&"id: "+document.activeElement.id+" className: "+document.activeElement.className+" tagName: "+document.activeElement.tagName,utilityCmdKey:TS.interop.utility.isCmdKey(t),metaKey:t.metaKey,ctrlKey:t.ctrlKey,shiftKey:t.shiftKey},"snippet_on_send","onKeyDown");if(!TS.utility.isFocusOnInput()||!document.activeElement||"client_file_snippet_title_input"===TS.utility.getActiveElementProp("id")||TS.interop.utility.isCmdKey(t)){i.div.find(".modal-footer-confirm").is(":visible")?i.cancel():i.go();t.preventDefault()}}},build:function e(){$("body").append('<div id="snippet_dialog" class="modal hide fade" data-backdrop="static" data-keyboard="false" tabindex="-1"></div>');TS.ui.snippet_dialog.div=$("#snippet_dialog");var t=TS.ui.snippet_dialog.div;t.on("hidden",function(e){if(e.target!=this)return;TS.ui.snippet_dialog.end()});t.on("show",function(e){if(e.target!=this)return;TS.model.dialog_is_showing=true;TS.ui.snippet_dialog.showing=true})}});var e=false;var t="";var i="";var n="";var a=function e(){var t=TS.ui.snippet_dialog;var i=t.editor.getValue();$.trim(i)?t.div.find(".ts_tip").addClass("ts_tip_hide"):t.div.find(".ts_tip").removeClass("ts_tip_hide")}})()},3066:function(e,t){(function(){TS.registerModule("view.overlay",{onStart:function t(){e=$("#msgs_overlay_div");$(window.document).keydown(function(e){if(!TS.model.overlay_is_showing)return;e.which!=TS.utility.keymap.enter&&e.which!=TS.utility.keymap.esc||(i?i():o())});TS.view.members.unknown_resolution_rebuild_sig.add(_)},cancelIfShowing:function e(){if(!TS.model.overlay_is_showing)return;o()},startWithJoinedChannel:function r(l){s();t=true;e.html(TS.templates.channel_join_overlay({channel:l}));i=function e(){l.needs_joined_message=false;o();i=null};var d=$("#channel_joined");a(d);TS.interop.rules.channels.isOrgShared(l)&&n(d);c(l.id,"joined")},startWithInvitedChannel:function r(l){s();t=true;var d={inviter:TS.interop.redux.models.channelsMeta.inviters.getInviter(TS.redux.getState(),l.id),channel:l};e.html(TS.templates.channel_join_overlay(d));i=function e(){TS.redux.dispatch(TS.interop.redux.models.channelsMeta.inviters.removeInviter(l.id));o();i=null};var u=$("#channel_joined");a(u);TS.interop.rules.channels.isOrgShared(l)&&n(u);c(l.id,"invited")},startWithCreatedChannel:function r(l){s();t=true;var d={channel:l,name_for_url:l.id};e.html(TS.templates.channel_create_overlay(d));i=function e(){TS.redux.dispatch(TS.interop.redux.models.channelsMeta.needsCreatedMessage.setNeedsCreatedMessageState({name:l.name,needsCreatedMessage:false}));o();i=null};TS.boot_data.feature_lesson_onboarding&&TS.onboarding.inOnboarding()&&i();e.find("a.invite_link").bind("click.invite_and_clear_overlay",function(e){TS.ui.channel_invite_modal.startInviteToChannelModal(l.id);i(e)});var u=$("#channel_created");a(u);TS.interop.rules.channels.isOrgShared(l)&&n(u);c(l.id,"created")},startWithInvitedGroup:function n(r){s();t=true;e.html(TS.templates.group_join_overlay({inviter_id:TS.interop.redux.models.channelsMeta.inviters.getInviter(TS.redux.getState(),r.id),group:r}));i=function e(){TS.redux.dispatch(TS.interop.redux.models.channelsMeta.inviters.removeInviter(r.id));o();i=null};a($("#group_joined"));c(r.id,"invited")},startWithGrowlPromptDisplay:function i(){s();t=true;var n=e;n.html(TS.templates.growl_prompt_overlay({}));n.find(".prompt_allow").bind("click",r);n.find(".prompt_cancel_forever").bind("click",function(){window.createCookie("no_growl_prompt","1",3650);$("#growl_prompt_div").addClass("hidden");o()});n.find(".see-apps").bind("click",function(){window.createCookie("no_growl_prompt","1",.5);$("#growl_prompt_div").addClass("hidden");o()});n.find(".prompt_cancel").bind("click",function(){$("#growl_prompt_div").addClass("hidden");o()});n.find(".prompt_test").bind("click",function(){$("#growl_prompt_div").addClass("hidden");TS.sounds.play("new_message");TS.ui.growls.showTestNotification(TS.interop.i18n.t("A Notification from Slack","prefs")(),TS.interop.i18n.t("What do you know? It works.","prefs")())});TS.ui.growls.no_notifications?$("#growl_prompt_overlay_impossible").removeClass("hidden"):$("#growl_prompt_overlay_start").removeClass("hidden")},fadeInAndOut:function e(){s();o()},cancelFromSendingMessage:function e(){if(!TS.model.overlay_is_showing)return;i?i():o()}});var e=null;var t=false;var i=null;var n=function e(t){if(!TS.boot_data.page_needs_enterprise)return;t.off("click","[data-channel-shared-teams]").on("click","[data-channel-shared-teams]",function(){TS.ui.enterprise_teams_dialog.show(TS.shared.legacyGetActiveModelOb())})};var a=function t(n){e.find("a.btn").bind("click.clear_overlay",i);n.wrap('<div id="overlay_wrapper">');$("#overlay_wrapper").monkeyScroll()};var r=function e(){$("#growl_prompt_overlay_start").addClass("hidden");$("#growl_prompt_overlay_tell_to_allow").removeClass("hidden");TS.ui.growls.promptForPermission(function(e,t){$("#growl_prompt_overlay_tell_to_allow").addClass("hidden");if("granted"===t&&e){$("#growl_prompt_overlay_success").removeClass("hidden");TS.prefs.setPrefByAPI({name:"growls_enabled",value:true})}else"default"===t?$("#growl_prompt_overlay_start").removeClass("hidden"):"denied"===t?$("#growl_prompt_overlay_disallowed").removeClass("hidden"):alert("huh allowed:"+e+" permission_level:"+t)})};var s=function t(i){if(TS.model.overlay_is_showing)return;e.stop();e.empty();e.removeClass("hidden");d();if(i){e.css("opacity",0);e.transition({opacity:1},250)}else e.css("opacity",1);TS.model.overlay_is_showing=true};var o=function i(){TS.model.overlay_is_showing=false;var n=e.find("#no_joined_overlays_cb");n.length&&n.prop("checked")&&TS.prefs.setPrefByAPI({name:"no_joined_overlays",value:true});var a=e.find("#no_created_overlays_cb");a.length&&a.prop("checked")&&TS.prefs.setPrefByAPI({name:"no_created_overlays",value:true});u();e.transition({opacity:0},250,function(){l()});if(t){t=false;TS.view.showInterstitialAfterChannelOrImShown()}};var l=function t(){e.addClass("hidden");TS.model.overlay_is_showing=false};var c=function e(t,i){TS.interop.clog.track("CHANNEL_OVERLAY_SHOWN",{channel_id:t,channel_type:t.charAt(0),join_action:i})};var d=function e(){TS.redux.dispatch(TS.interop.redux.features.messagePane.setOverlayVisible(true))};var u=function e(){TS.redux.dispatch(TS.interop.redux.features.messagePane.setOverlayVisible(false))};var _=function t(){if(!TS.model.overlay_is_showing)return;e.find(".unknown_member").each(function(e,t){var i=$(t);var n=i.data("id");if(!n)return;var a=TS.redux.members.getPotentiallyUnknownMemberById(n);i.replaceWith(TS.templates.builders.makeMemberPreviewLink(a))})}})()},3067:function(e,t){(function(){TS.registerModule("ui.invite",{showInviteMembersPreSelected:function t(i,n,a){if(!n||!n.length){TS.warn("showInviteMembersPreSelected requires a non-empty array of preselected ids to invite to a group, ignoring...");return}e(i,n,a)},showInviteMemberToChannelDialog:function e(t){var i=TS.interop.members.getMemberById(t);var n=TS.interop.redux.models.channels.getUnarchivedPublicAndPrivateChannelsUserIsIn(TS.redux.getState());var a=true;var r=true;var s=TS.interop.members.getPrefCompliantMemberName(i,a);var o=TS.interop.i18n.t("Add {name} to a channel","channel_invite")({name:s});TS.interop.clog.track("INVITE_TO_CHANNEL_DIALOG",{contexts:{ui_context:{action:"IMPRESSION"}}});if(TS.model.user.is_ultra_restricted)TS.generic_dialog.start({title:o,body:TS.interop.i18n.t("You are not allowed to add other members to channels.","channel_invite")(),show_cancel_button:false});else if(i.is_ultra_restricted)TS.generic_dialog.start({title:o,body:TS.interop.i18n.t("{name} cannot be added to any new channels.","channel_invite")({name:s}),show_cancel_button:false});else if(i.is_restricted&&!TS.model.user.is_admin)TS.generic_dialog.start({title:o,body:TS.interop.i18n.t("Only a Workspace Admin can add {name} into new channels.","channel_invite")({name:s}),show_cancel_button:false});else{var l=n.sort(TS.interop.i18n.mappedSorter("name"));TS.generic_dialog.start({title:o,body:TS.templates.channel_invite_list({channels:l,name:TS.interop.members.getPrefCompliantMemberName(i,a,r)}),show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Add","channel_invite")(),ladda:true,onGo:function e(){var t=$("#select_invite_channels").lazyFilterSelect("value");if(!t[0])return false;var n=t[0].id;if(i.is_app_user){var a=TS.interop.channels.getPublicChannelById(n);TS.interop.addAppToChannel({appUserId:i.id,channelId:a.id,referringEventId:"INVITE_TO_CHANNEL_DIALOG",referringUiContext:{action:"IMPRESSION"}})}else TS.interop.api.call("conversations.invite",{channel:n,users:i.id})},onShow:function e(){var i={width:"230px",display:"inline-block"};$("#select_invite_channels").hide().lazyFilterSelect({filter:function e(t,i){if(!t||!t.name)return false;var n=t.name.toLowerCase();var a=i.toLowerCase();while("#"===a[0])a=a.slice(1,a.length);if(n.indexOf(a)>-1)return true;return false},onItemAdded:function e(i){TS.generic_dialog.div.find(".warning_already_member").addClass("hidden");if(!_.get(i,"id"))return;TS.generic_dialog.startLadda();TS.interop.membership.ensureChannelMembershipIsKnownForUsers(i.id,[t]).then(function(){var e=TS.interop.membership.getCachedChannelMembershipInfoForUser(i.id,t);var n=e.is_member;if(n){TS.generic_dialog.div.find(".warning_already_member").removeClass("hidden");TS.generic_dialog.stopLadda();TS.generic_dialog.div.find(".dialog_go").addClass("disabled")}else TS.generic_dialog.stopLadda()})},placeholder_text:TS.interop.i18n.t("Select a channel","channel_invite")(),css:i,classes:"select_invite_channels",data:n,template:function e(t){return new Handlebars.SafeString(TS.templates.builders.makeModelObNameForDisplay(t,{inherit_font_size:true}))}});$("#generic_dialog").find(".modal-body").css("overflow","visible")}})}},showLimitedInviteMemberDialog:function e(t,i){TS.generic_dialog.start({title:TS.interop.i18n.t("Anyone you invite will be able to see all of the channel\u2019s contents","channel_invite")(),body:TS.interop.i18n.t("New members will be able to see all of <b>{channel_name}</b>\u2019s history, including any files that have been shared in the channel.","channel_invite")({channel_name:TS.model.group_prefix+t.name}),show_go_button:true,show_cancel_button:true,go_button_text:TS.interop.i18n.t("Invite to channel","channel_invite")(),onGo:i})},showPrivateInviteMemberDialog:function e(t,i){var n=TS.templates.group_member_invite_list({channel_name:TS.model.group_prefix+t.name});TS.generic_dialog.start({title:TS.interop.i18n.t("Anyone you invite will be able to see all of the channel\u2019s contents","channel_invite")(),body:n,show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Continue","channel_invite")(),onGo:i})}});var e=function e(t,i,n){var a=false;var r=TS.interop.channels.getGroupById(t,a);r||(r=TS.interop.channels.getPublicChannelById(t,a));if(!r)return;var s=function e(t){if(n){var a=TS.utility.msgs.findMsg(n,r.id);TS.groups.legacyRemoveMsg(r.id,a)}if(t){_.chunk(i,30).forEach(function(e){TS.interop.api.call("conversations.invite",{channel:r.id,force:true,users:e.join(",")})});return true}TS.groups.createChild(r.id,i,function(e,t){if(!e){var i=TS.interop.i18n.t("Uh oh!","channel_invite")();var n=TS.interop.i18n.t("Sorry! Something went wrong. Please try again.","channel_invite")();t&&"restricted_action"===t.error?n=TS.interop.i18n.t("You don\u2019t have permission to create new private channels. Talk to your Workspace Owner to get permission.","channel_invite")():TS.error(t.error+" error occurred during TS.groups.createChild");setTimeout(function(){TS.generic_dialog.alert(n,i)},500)}})};if(!(TS.permissions.members.canArchiveChannels()&&TS.permissions.members.canCreateGroups())){TS.ui.invite.showLimitedInviteMemberDialog(r,function(){var e=true;s(e)});return}if(TS.interop.rules.channels.isPrivateChannel(r))TS.ui.invite.showPrivateInviteMemberDialog(r,function(){var e=$("input[name=group_invite_action]:checked").val();if(!e)return;var t="use_existing_channel"===e;return s(t)});else{var o=_.map(i,function(e){return TS.interop.members.getPrefCompliantMemberName(TS.interop.members.getMemberById(e))});var l=TS.interop.i18n.listify(o,{noEscape:true}).join("");var c=TS.interop.i18n.t("Invite {who} to {model_ob}","channel_invite")({who:TS.interop.i18n.safeString(l),model_ob:TS.model.group_prefix+r.name});TS.ui.fs_modal.start({title:new Handlebars.SafeString(_.escape(c)),body:TS.templates.group_member_invite_list(),show_cancel_button:false,show_go_button:true,go_button_text:TS.interop.i18n.t("Yes, show channel history","channel_invite")(),show_secondary_go_button:true,secondary_go_button_text:TS.interop.i18n.t("No, start a new channel","channel_invite")(),secondary_go_button_class:"btn_info",onGo:function e(){var t=true;return s(t)},onSecondaryGo:function e(){var t=false;return s(t)},onEnd:function e(){$(".modal-body").css("overflow-y","auto")}})}$("#select_invite_group_members").hide().lazyFilterSelect();$("#select_invite_group_members_holder").css("min-height",235);$(".modal-body").css("overflow-y","visible")}})()},3068:function(e,t){(function(){TS.registerModule("ui.banner",{show_hide_sig:new signals.Signal,onStart:function e(){TS.client.login_sig.add(TS.ui.banner.loggedIn,TS.ui.banner);TS.ui.growls.permission_changed_sig.add(TS.ui.banner.growlsPermissionChanged,TS.ui.banner)},loggedIn:function e(){var t=false;_.forOwn(TS.qs_args,function(e,i){var n=/^show_([\w_]+)_banner$/;if(n.test(i)&&"1"===e){var a=i.replace(n,"$1");if($("#"+a+"_banner").length>0){TS.ui.banner.show(a);t=true;return false}}});if(t)return;var i="nothing"===TS.notifs.getGlobalNotificationSetting();var n=!TS.model.is_iOS&&!TS.ui.growls.no_notifications&&TS.ui.growls.shouldShowPermissionButton()&&"denied"!==TS.ui.growls.getPermissionLevel()&&"1"!=window.readCookie("no_growl_banner")&&!i;if(n){TS.ui.banner.show("notifications");return}var a=TS.model.mac_version&&TS.utility.compareSemanticVersions(TS.model.mac_version,"10.8")<=0;var r=TS.model.is_our_app&&TS.model.is_mac&&a;var s=TS.model.is_mac&&!a&&!TS.model.mac_ssb_version&&!TS.prefs.getPref("no_macssb1_banner");var o=TS.model.is_win_7_plus&&!TS.model.win_ssb_version&&!TS.prefs.getPref("no_winssb1_banner");if(r){TS.ui.banner.show("macssb_osx_deprecated");return}if(s){TS.ui.banner.show("macssb1");return}o&&TS.ui.banner.show("winssb1")},showSSBUpdateBanner:function e(i,n,a){if(t&&TS.utility.compareSemanticVersions(i,t)<=0)return;t=i;var r=$("#ssb_new_version_available_banner");if(!r.length)return;r.find(".old_version_number").text(TS.model.desktop_app_version.major+"."+TS.model.desktop_app_version.minor+"."+TS.model.desktop_app_version.patch);r.find(".new_version_number").text(i);r.find(".can_update").toggleClass("hidden",!n);r.find(".can_not_update").toggleClass("hidden",n);r.find(".update_link").off("click").on("click",function(e){e.preventDefault();TS.interop.desktop.quitAndInstallUpdate()});r.find(".learn_link").attr("href",a);TS.ui.banner.show("ssb_new_version_available")},closeSSBUpdateBanner:function e(){TS.ui.banner.close()},growlsPermissionChanged:function e(t,i){"default"!==i&&TS.ui.banner.close()},growlsPermissionPrompt:function e(){TS.ui.growls.promptForPermission(function(e,t){if("granted"===t&&e){TS.ui.growls.showTestNotification(TS.interop.i18n.t("A Notification from Slack","prefs")(),TS.interop.i18n.t("Nice, notifications are enabled!","prefs")());if(!TS.prefs.getPref("growls_enabled")){TS.prefs.setPrefByAPI({name:"growls_enabled",value:true});TS.prefs.setPrefLocal("growls_enabled",true)}}})},show:function t(n,a){n=n||e;e=n;var r=TS.client.ui.$banner;r.removeClass("hidden");$("body").addClass("banner_showing");r.css("display","block");r.children(".banner").addClass("hidden");TS.ui.banner.show_hide_sig.dispatch("show");var s=false;var o;if("no_banner"===n){$("#notifications_banner").addClass("hidden");$("#notifications_dismiss_banner").addClass("hidden")}else if("notifications_dismiss"===n){$("#notifications_dismiss_banner").removeClass("hidden");r.unbind("click").bind("click",function(){TS.ui.banner.close();TS.ui.banner.show("no_banner")});s=true;o="recommend_desktop_notifications_banner";i+=1}else if("notifications"===n){$("#notifications_banner").removeClass("hidden");r.unbind("click").bind("click",function(e){if(0!==$(e.target).closest('[data-action="dismiss_banner"]').length){$("#notifications_banner").addClass("hidden");TS.ui.banner.show("notifications_dismiss");return}TS.ui.banner.growlsPermissionPrompt();TS.ui.banner.close()});s=true;o="enable_desktop_notifications_banner";i+=1}else if("macssb1"===n){$("#macssb1_banner").removeClass("hidden");r.unbind("click").bind("click",function(e){if($(e.target).closest('[data-action="dismiss_banner"]').length)TS.ui.banner.onClickedMacSSB1Link(this,true);else if(!$(e.target).hasClass("apps_page_link")){var t=$(this).find(".apps_page_link");TS.utility.openInNewTab(t.attr("href"),t.attr("target"));t.click()}});s=true;o="mac_ssb1_banner";i+=1}else if("winssb1"===n){$("#winssb1_banner").removeClass("hidden");r.unbind("click").bind("click",function(e){if($(e.target).closest('[data-action="dismiss_banner"]').length)TS.ui.banner.onClickedWinSSB1Link(this,true);else if(!$(e.target).hasClass("apps_page_link")){var t=$(this).find(".apps_page_link");TS.utility.openInNewTab(t.attr("href"),t.attr("target"));t.click()}});s=true;o="win_ssb1_banner";i+=1}else if("macssb_osx_deprecated"===n){$("#macssb_osx_deprecated_banner").removeClass("hidden");r.unbind("click").bind("click",function(){TS.ui.banner.close()});s=true;o="mac_ssb_osx_deprecated_banner";i+=1}else if("ssb_new_version_available"===n){var l=$("#ssb_new_version_available_banner");l.removeClass("hidden");l.find('button[data-action="dismiss_banner"]').unbind("click").bind("click",function(){TS.ui.banner.close()});s=true;o="ssb_new_version_available_banner";i+=1}else if(TS.ui.banner.isDunningBanner(n)){TS.ui.banner.dunningBannerSetup(r,n);if("dunning_day_21_billing_stakeholders_banner"===n){var c=a.num_days_til_downgrade||"7";r.find(".num_days_til_downgrade").text(c)}s=true;o=n;i+=1}else{var d=r.find("#"+n+"_banner");if(!d.length){TS.error("Tried to show a banner called "+n+", but can\u2019t find an element with that as its ID");return}d.removeClass("hidden");d.find('button[data-action="dismiss_banner"]').unbind("click").bind("click",function(){TS.ui.banner.close()});s=true;o="generic_banner";i+=1}s&&TS.interop.clog.track("BANNER_ACTION",{contexts:{ui_context:{action:"impression",ui_element:o}}});TS.view.resizeForBanner("TS.ui.banner.show")},isDunningBanner:function e(t){return _.includes(["dunning_day_1_banner","dunning_day_3_banner","dunning_day_7_owner_cardholder_banner","dunning_day_7_admin_billing_contacts_banner","dunning_day_14_owner_cardholder_banner","dunning_day_14_admin_billing_contacts_banner","dunning_day_21_billing_stakeholders_banner","dunning_day_21_all_users_banner"],t)},getDunningBannerPrefs:function e(t){var i;var n;switch(t){case"dunning_day_1_banner":i="dunning_day_1_banner_cta_count";n="dunning_day_1_banner_last_ts";break;case"dunning_day_3_banner":i="dunning_day_3_banner_cta_count";n="dunning_day_3_banner_last_ts";break;case"dunning_day_7_owner_cardholder_banner":i="dunning_day_7_owner_cardholder_banner_cta_count";n="dunning_day_7_owner_cardholder_banner_last_ts";break;case"dunning_day_7_admin_billing_contacts_banner":i="dunning_day_7_admin_billing_contacts_banner_cta_count";n="dunning_day_7_admin_billing_contacts_banner_last_ts";break;case"dunning_day_14_owner_cardholder_banner":i="dunning_day_14_owner_cardholder_banner_cta_count";n="dunning_day_14_owner_cardholder_banner_last_ts";break;case"dunning_day_14_admin_billing_contacts_banner":i="dunning_day_14_admin_billing_contacts_banner_cta_count";n="dunning_day_14_admin_billing_contacts_banner_last_ts";break;case"dunning_day_21_billing_stakeholders_banner":i="dunning_day_21_billing_stakeholders_banner_cta_count";n="dunning_day_21_billing_stakeholders_banner_last_ts";break;case"dunning_day_21_all_users_banner":i="dunning_day_21_all_users_banner_cta_count";n="dunning_day_21_all_users_banner_last_ts";break;default:break}return{countPref:i,tsPref:n}},dunningBannerSetup:function e(t,i){var n="#"+i;$(n).removeClass("hidden");var a=TS.ui.banner.getDunningBannerPrefs(i);var r="growth_all_banners_prefs";t.unbind("click").bind("click",function(){TS.ui.banner.close(r,a)})},onClickedMacSSB1Link:function e(t,i){TS.ui.banner.close();TS.prefs.setPrefByAPI({name:"no_macssb1_banner",value:true});var n=$(t);n.closest(".banner").hasClass("hidden")||TS.interop.clog.track("BANNER_ACTION",{click_target:"get_mac_ssb_banner",page_url:n.attr("href"),action:i?"banner_dismiss":"banner_click",contexts:{ui_context:{action:i?"close":"click",ui_element:"mac_ssb1_banner"}}})},onClickedWinSSB1Link:function e(t,i){TS.ui.banner.close();TS.prefs.setPrefByAPI({name:"no_winssb1_banner",value:true});var n=$(t);n.closest(".banner").hasClass("hidden")||TS.interop.clog.track("BANNER_ACTION",{click_target:"get_win_ssb_banner",page_url:n.attr("href"),action:i?"banner_dismiss":"banner_click",contexts:{ui_context:{action:i?"close":"click",ui_element:"win_ssb1_banner"}}})},closeNagAndSetCookie:function e(){TS.ui.banner.close();window.createCookie("no_growl_banner","1",3650)},closeNagAndOpenPrefs:function e(){TS.ui.banner.close();setTimeout(function(){TS.ui.prefs_dialog.start("notifications")},500)},close:function e(t,n){var a=TS.client.ui.$banner;if(n){var r=TS.interop.prefs.getUserPref(TS.redux.getState(),t);r=r?JSON.parse(r):{};var s=r[n.countPref]||0;r[n.countPref]=s+1;r[n.tsPref]=Math.round(Date.now()/1e3);var o=JSON.stringify(r);TS.redux.dispatch(TS.interop.prefs.setUserPrefByApi({pref:t,value:o}))}a.slideUp(200,function(){a.addClass("hidden");$("body").removeClass("banner_showing");TS.view.resizeForBanner("TS.ui.banner.close");TS.ui.banner.show_hide_sig.dispatch("hide");i=Math.max(0,i-1)})},getNumOfActiveBanners:function e(){return i}});var e="notifications";var t;var i=0})()},3069:function(e,t){(function(){TS.registerModule("newxp",{slackbot_response_sent_sig:new signals.Signal,slackbot_skip_or_stop_sig:new signals.Signal,slackbot_continue_sig:new signals.Signal,onboarding:{cancel:{step_name:"onboarding_cancelled",pref_name:"onboarding_cancelled",show:"#unskip_messaging, #star_container, #channel_header_info, #client_header .channel_title_info, #client_header .flex_header",hide:"#team_menu_overlay, #col_channels_overlay, #active_channel_name_overlay, #explore_btn_container > .btn, #pre_skip_messaging, #in_skip_messaging",unstyle:".p-global_nav, #client_header .channel_header, #client_body, #details_toggle, #channel_actions_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div, #col_channels_footer",promiseTo:function e(){return new Promise(function(){$("#end_display_onboarding").on("click.cancel_onboarding",".skip_tutorial_link",l)}).finally(function(){TS.view.unAdjustForWelcomeSlideShow();TS.client.ui.$msg_input.focus();d(TS.newxp.onboarding.cancel);$("#unskip_messaging > .take_tutorial_link").off("click.take_onboarding").on("click.take_onboarding",c);$("#end_display_onboarding").off("click.cancel_onboarding");TS.onboarding.no_longer_in_onboarding_sig.dispatch();return TS.prefs.setPrefByAPI({name:"onboarding_cancelled",value:true})})}},loading:{step_name:"onboarding_loading",pref_name:"",show:"#team_menu_overlay, #col_channels_overlay, #active_channel_name_overlay, #explore_btn_container, #pre_skip_messaging",hide:"#banner, #in_skip_messaging, #unskip_messaging, #star_container, #channel_header_info, #client_header .channel_title_info, #client_header .flex_header",style:".p-global_nav, #client_header .channel_header, #client_body, #details_toggle, #channel_actions_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div, #col_channels_footer",promiseTo:function e(){return new Promise(function(){TS.view.adjustForWelcomeSlideShow();d(TS.newxp.onboarding.loading)})}},start:{step_name:"onboarding_start",pref_name:"seen_onboarding_start",show:"#team_menu_overlay, #col_channels_overlay, #active_channel_name_overlay, #explore_btn_container > .btn, #pre_skip_messaging",hide:"#in_skip_messaging, #unskip_messaging, #star_container, #channel_header_info, #client_header .channel_title_info, #client_header .flex_header",style:".p-global_nav, #client_header .channel_header, #client_body, #details_toggle, #channel_actions_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div, #col_channels_footer",promiseTo:function e(){return new Promise(function(e){TS.view.adjustForWelcomeSlideShow();o=e;d(TS.newxp.onboarding.start);$("#explore_btn_container > .btn").on("click",function(){TS.metrics.mark("onboarding_btn_click");TS.interop.clog.track("GROWTH_ONBOARDING",{action:"onboarding_btn_click",step:s})});$("#explore_btn_container > .btn").on("click.start_onboarding",e)}).then(function(){return TS.prefs.setPrefByAPI({name:"seen_onboarding_start",value:true})}).finally(function(){$("#explore_btn_container > .btn").off("click.start_onboarding");return TS.prefs.setPrefByAPI({name:"seen_welcome_2",value:true})})}},complete:{step_name:"onboarding_complete",pref_name:"seen_onboarding_complete",show:"#star_container, #channel_header_info, #client_header .channel_title_info, #client_header .flex_header, .coachmark_got_it",hide:"#team_menu_overlay, #col_channels_overlay, #active_channel_name_overlay, #explore_btn_container > .btn, #pre_skip_messaging, #in_skip_messaging, #unskip_messaging",unstyle:".p-global_nav, #client_header .channel_header, #client_body, #details_toggle, #channel_actions_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div, #col_channels_footer",promiseTo:function e(){TS.onboarding.no_longer_in_onboarding_sig.dispatch();return Promise.resolve().then(function(){d(TS.newxp.onboarding.complete);$("#end_display_onboarding").off("click.cancel_onboarding");$("#unskip_messaging > .take_tutorial_link").off("click.take_onboarding");TS.client.ui.$msg_input.focus();TS.ims.message_received_sig.has(v)&&TS.ims.message_received_sig.remove(v);return TS.prefs.setPrefByAPI({name:"newxp_slackbot_step",value:"A2"})})}},slackbot:{step_name:"onboarding_slackbot_conversation",pref_name:"seen_onboarding_slackbot_conversation",show:"#team_menu_overlay, #col_channels_overlay, #active_channel_name_overlay, #in_skip_messaging",hide:"#explore_btn_container > .btn, #pre_skip_messaging, #unskip_messaging, #star_container, #channel_header_info, #client_header .channel_title_info, #client_header .flex_header",style:"#client_header .channel_header, #details_toggle, #channel_actions_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div, #col_channels_footer",unstyle:".p-global_nav, #client_body",promiseTo:function e(){var t=null;var i=function e(t,i,n){T(i,n)&&t()};return Promise.resolve().then(function(){d(TS.newxp.onboarding.slackbot);TS.view.unAdjustForWelcomeSlideShow();TS.view.focusMessageInput();$("#footer_overlay").css("opacity",0);TS.ims.message_received_sig.add(S)}).delay(400*$("#footer_overlay").css("opacity")).then(function(){$("#footer_overlay").addClass("hidden")}).then(function(){if(!TS.prefs.getPref("onboarding_slackbot_conversation_step"))return Promise.resolve();if(a)return Promise.resolve();return new Promise(function(e){t=i.bind(null,e);TS.ims.message_received_sig.add(t,TS.newxp);return TS.prefs.setPrefByAPI({name:"greeting_step",value:"go"})}).finally(function(){TS.ims.message_received_sig.remove(t,TS.newxp)})}).then(function(){if(TS.prefs.getPref("onboarding_slackbot_conversation_step")>1)return Promise.resolve();return new Promise(function(e){t=i.bind(null,e);TS.ims.message_received_sig.add(t,TS.newxp);TS.metrics.measure("sending_api_call_to_queue_slackbot","onboarding_btn_click");TS.metrics.mark("onboarding_api_call");return TS.prefs.setPrefByAPI({name:"greeting_step",value:"start"})}).then(function(){var e=TS.interop.i18n.t("Type something","newxp")();TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,e);return TS.prefs.setPrefByAPI({name:"onboarding_slackbot_conversation_step",value:1})}).finally(function(){TS.metrics.measure("received_first_slackbot_msg_from_onboarding_button","onboarding_btn_click");TS.metrics.measure("received_first_slackbot_msg_from_api_call","onboarding_api_call");TS.metrics.clearMarks("onboarding_btn_click");TS.metrics.clearMarks("onboarding_api_call");TS.ims.message_received_sig.remove(t,TS.newxp)})}).then(function(){var e=Promise.resolve().then(function(){var e=TS.prefs.getPref("onboarding_slackbot_conversation_step")>1?0:3e4;return Promise.delay(e).then(function(){return new Promise(function(e){t=i.bind(null,e);TS.ims.message_received_sig.add(t,TS.newxp);return TS.prefs.setPrefByAPI({name:"intro_step",value:"notyping_1"})}).then(function(){var e=TS.interop.i18n.t("Type something","newxp")();TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,e);TS.client.ui.$msg_input.addClass("onboarding");TS.client.ui.files.$file_btn.addClass("onboarding");return TS.prefs.setPrefByAPI({name:"onboarding_slackbot_conversation_step",value:2})}).delay(2e3).finally(function(){TS.ims.message_received_sig.remove(t,TS.newxp);TS.client.ui.$msg_input.removeClass("onboarding");TS.client.ui.files.$file_btn.removeClass("onboarding")})})}).delay(6e5).then(function(){return new Promise(function(e){t=i.bind(null,e);TS.ims.message_received_sig.add(t,TS.newxp);return TS.prefs.setPrefByAPI({name:"intro_step",value:"notyping_2"})}).then(function(){l();r.cancel()}).finally(function(){TS.ims.message_received_sig.remove(t,TS.newxp)})});var n=function e(t){TS.newxp.slackbot_response_sent_sig.add(function(){return t()})};var a=function t(i,n){g(i,n)&&e.cancel()};var r=new Promise(function(e){TS.ims.message_received_sig.add(a,TS.newxp);n=n.bind(null,e);TS.ims.message_received_sig.add(n,TS.newxp);return TS.prefs.setPrefByAPI({name:"greeting_step",value:"expecting"})}).then(function(){TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,"");return TS.prefs.setMultiPrefsByAPI({onboarding_slackbot_conversation_step:10,seen_onboarding_slackbot_conversation:true})}).finally(function(){TS.ims.message_received_sig.remove(n,TS.newxp);TS.ims.message_received_sig.remove(a,TS.newxp)});return Promise.any([r,e]).finally(function(){r&&r.cancel();e&&e.cancel()})}).finally(function(){TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,"");TS.client.ui.$msg_input.removeClass("onboarding");TS.client.ui.files.$file_btn.removeClass("onboarding");TS.ims.message_received_sig.remove(S);TS.ims.message_received_sig.add(v);setTimeout(function(){TS.ims.message_received_sig.has(v)&&TS.ims.message_received_sig.remove(v,TS.newxp)},18e4);return TS.prefs.setMultiPrefsByAPI({intro_step:"",greeting_step:""})})}},channels:{step_name:"onboarding_channels",pref_name:"seen_onboarding_channels",show:"#active_channel_name_overlay, #in_skip_messaging, .coachmark_next_tip",hide:"#in_skip_messaging, #team_menu_overlay, #col_channels_overlay, #explore_btn_container > .btn, #pre_skip_messaging, #unskip_messaging",style:"#client_header .channel_header, #details_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div",unstyle:".p-global_nav, #col_channels_footer",promiseTo:function e(){var t=$("#starred_div, #direct_messages, #channel_list_invites_link, #quick_switcher_btn");return new Promise(function(e){TS.client.ui.$msg_input.blur();d(TS.newxp.onboarding.channels);TS.coachmark.start($.extend({},TS.coachmarks.coachmarks.channels,{resolve:e,reject:l}));t.addClass("translucent")}).then(function(){TS.prefs.setPrefByAPI({name:"seen_onboarding_channels",value:true});return null}).finally(function(){t.removeClass("translucent")})}},direct_messages:{step_name:"onboarding_direct_messages",pref_name:"seen_onboarding_direct_messages",show:"#active_channel_name_overlay, #in_skip_messaging",show_member:".coachmark_got_it",show_admin:".coachmark_next_tip",hide:"#in_skip_messaging, #team_menu_overlay, #col_channels_overlay, #explore_btn_container > .btn, #pre_skip_messaging, #unskip_messaging",hide_member:".coachmark_next_tip",style:"#client_header .channel_header, #details_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div",unstyle:".p-global_nav, #col_channels_footer",promiseTo:function e(){var t=$("#starred_div, #channels, #channel_list_invites_link, #quick_switcher_btn");return new Promise(function(e){d(TS.newxp.onboarding.direct_messages);TS.coachmark.start($.extend({},TS.coachmarks.coachmarks.direct_messages,{resolve:e,reject:l}));t.addClass("translucent")}).then(function(){TS.prefs.setPrefByAPI({name:"seen_onboarding_direct_messages",value:true});return null}).finally(function(){t.removeClass("translucent")})}},invites:{step_name:"onboarding_invites",pref_name:"seen_onboarding_invites",show:"#active_channel_name_overlay, #in_skip_messaging, .coachmark_got_it",hide:"#in_skip_messaging, #team_menu_overlay, #col_channels_overlay, #explore_btn_container > .btn, #pre_skip_messaging, #unskip_messaging, .coachmark_next_tip",style:"#client_header .channel_header, #details_toggle, #recent_mentions_toggle, #stars_toggle, #flex_menu_toggle, #search_container, #channel_members_toggle, #rxn_toast_div",unstyle:".p-global_nav, #quick_switcher_btn",promiseTo:function e(){var t=$("#starred_div, #channels, #direct_messages");return new Promise(function(e){d(TS.newxp.onboarding.invites);TS.coachmark.start($.extend({},TS.coachmarks.coachmarks.invites,{resolve:e,reject:l}));t.addClass("translucent")}).then(function(){TS.prefs.setPrefByAPI({name:"seen_onboarding_invites",value:true});return null}).finally(function(){t.removeClass("translucent")})}},recent_mentions:{step_name:"onboarding_recent_mentions",pref_name:"seen_onboarding_recent_mentions",promiseTo:function e(){var t;var i;return new Promise(function(e,n){t=$("#recent_mentions_toggle");A(t);i=t.find(".starburst");C(TS.coachmark.start.bind(null,$.extend({},TS.coachmarks.coachmarks.recent_mentions,{resolve:e,reject:n.bind(null,new Error("Click-tick onboarding cancelled"))})),t,i)}).then(function(){TS.prefs.setPrefByAPI({name:"seen_onboarding_recent_mentions",value:true});return null}).finally(function(){x(t,i);k(t)})}},starred_items:{step_name:"onboarding_starred_items",pref_name:"seen_onboarding_starred_items",promiseTo:function e(){var t;var i;return new Promise(function(e,n){t=$("#stars_toggle");A(t);i=t.find(".starburst");C(TS.coachmark.start.bind(null,$.extend({},TS.coachmarks.coachmarks.starred_items,{resolve:e,reject:n.bind(null,new Error("Click-tick onboarding cancelled"))})),t,i)}).then(function(){TS.prefs.setPrefByAPI({name:"seen_onboarding_starred_items",value:true});return null}).finally(function(){x(t,i);k(t)})}}},onStart:function e(){},inOnboarding:function t(){return e},startOnboarding:function e(){if(TS.model.seen_welcome_2){TS.onboarding.no_longer_in_onboarding_sig.dispatch();return}M();if(TS.model.seen_welcome_2){TS.onboarding.no_longer_in_onboarding_sig.dispatch();return}I()&&TS.ims.legacyStartImByMemberId("USLACKBOT");if(TS.prefs.getPref("onboarding_cancelled")){d(TS.newxp.onboarding.cancel);$("#unskip_messaging > .take_tutorial_link").off("click.take_onboarding").on("click.take_onboarding",c);$("#end_display_onboarding").removeClass("hidden")}else{TS.model.seen_onboarding_this_session=true;r=!TS.client.ui.$banner.hasClass("hidden");d(TS.newxp.onboarding.loading);c()}},cancelOnboarding:function e(){TS.onboarding.shouldShowFirstWelcome()||$("#end_display_onboarding").addClass("hidden");l()},resumeOnboarding:function e(){c()},startOnboardingClick:function e(){TS.metrics.mark("onboarding_btn_click");TS.interop.clog.track("GROWTH_ONBOARDING",{action:"onboarding_btn_click",step:s});if(_.isFunction(o)){o();o=null}},getCurrentStepName:function e(){return s},test:function e(){return{deferredCancel:l,startOnboarding:c,goToStep:d,getBaseSteps:u,getUserSteps:m,composeUserOnboarding:f,composeCancelOnboarding:h,acceptIMMessage:g,isSlackbot:T,onSkipOrStop:S,restartOnGo:v,waitAllOrCancel:b,enableScrollFadeOut:w,disableScrollFadeOut:y,addClickTickStarburst:A,removeClickTickStarburst:k,addClickTickInteractions:C,removeClickTickInteractions:x,shouldDirectToSlackbotForOnboarding:I}}});var e=false;var t=null;var i=null;var n=null;var a=false;var r=false;var s="";var o=null;var l=function e(){if(i){i.finally(function(){i.isCancelled()&&n&&n.cancel()});i.cancel()}else n&&n.cancel()};var c=function e(){l();TS.model.ui_state.flex_visible&&TS.client.ui.flex.hideFlex();TS.prefs.getPref("onboarding_cancelled")&&TS.prefs.setPrefByAPI({name:"onboarding_cancelled",value:false});TS.prefs.legacyOnPrefChanged({name:"onboarding_cancelled",value:false});w();i=f();n=h();TS.model.user.is_restricted||t||(t=p());$("#end_display_onboarding").removeClass("hidden")};var d=function e(t){s=t.step_name;TS.redux.dispatch(TS.interop.redux.features.messagePane.setNewxpOnboardingStep(s));$(t.show).removeClass("hidden");$(t.hide).addClass("hidden");$(t.style).addClass("onboarding");$(t.unstyle).removeClass("onboarding");if(TS.ui.admin_invites.canInvite()&&TS.members.getActiveMembersWithSelfAndNotSlackbot().length<26){$(t.hide_admin).addClass("hidden");$(t.show_admin).removeClass("hidden")}else{$(t.hide_member).addClass("hidden");$(t.show_member).removeClass("hidden")}TS.interop.clog.track("GROWTH_ONBOARDING",{action:"enter_step",step:s})};var u=function e(){var t=["start","slackbot","channels","direct_messages","complete"];TS.ui.admin_invites.canInvite()&&TS.members.getActiveMembersWithSelfAndNotSlackbot().length<26&&t.splice(4,0,"invites");return t};var m=function e(){return u().filter(function(e){return!TS.prefs.getPref(TS.newxp.onboarding[e].pref_name)})};var f=function t(){e=true;var n;m().forEach(function(e){n=n?n.then(TS.newxp.onboarding[e].promiseTo):TS.newxp.onboarding[e].promiseTo()});if(n){i||TS.client.ui.$banner.addClass("hidden");TS.ui.banner.close();n.finally(function(){e=false;if(r){TS.ui.banner.show();TS.client.ui.$banner.removeClass("hidden")}if(n.isCancelled())return;TS.model.seen_welcome_2=true;$("#end_display_onboarding").addClass("hidden");y()})}else e=false;return n};var h=function e(){return TS.newxp.onboarding.cancel.promiseTo()};var p=function e(){var t=["recent_mentions","starred_items"].filter(function(e){return!TS.prefs.getPref(TS.newxp.onboarding[e].pref_name)}).map(function(e){return TS.newxp.onboarding[e].promiseTo()});return b(t)};var g=function e(t,i){return t.id==TS.model.active_im_id&&TS.interop.members.getMemberById(t.user).is_slackbot&&i&&TS.interop.members.getMemberById(i.user).is_self};var T=function e(t,i){return t&&i&&t.user==i.user&&TS.interop.members.getMemberById(t.user).is_slackbot};var S=function e(){TS.newxp.slackbot_skip_or_stop_sig.add(function(){l()})};var v=function e(){TS.newxp.slackbot_continue_sig.add(function(){TS.ims.message_received_sig.remove(e,TS.newxp);if(TS.prefs.getPref("onboarding_cancelled")&&TS.onboarding.shouldShowFirstWelcome()){c();a=true}})};var b=function e(t){return Promise.all(t).then(_.noop,function(){t.forEach(function(e){e.cancel()})})};var w=function e(){var t=$("#onboarding_fade_out_mask").removeClass("hidden");TS.client.ui.$msgs_scroller_div.on("scroll.onboarding",function(){TS.client.ui.$msgs_scroller_div[0].scrollTop>300?t.hasClass("hidden")||t.addClass("hidden"):t.hasClass("hidden")&&t.removeClass("hidden")})};var y=function e(){TS.client.ui.$msgs_scroller_div.off("scroll.onboarding");$("#onboarding_fade_out_mask").addClass("hidden")};var A=function e(t){t.append($("<div class='starburst_wrapper'><span class='starburst'></span></div>"))};var k=function e(t){t.find("> .starburst_wrapper").remove()};var C=function e(t,i,n,a,r){i=i||$();n=n||$();r=r||i;a=a||n;i.on("mouseenter.onboarding",function(){if(r.hasClass("onboarding"))return;n.css("opacity",1);t&&t()}).on("mouseleave.onboarding",function(){if(i.hasClass("onboarding"))return;if(TS.coachmark.is_showing&&TS.coachmark.is_small){TS.coachmark.end();n.css("opacity",0)}}).addClass("jquery_hover");a!=n&&a.css("height",i.outerHeight(true)).css("width",i.outerWidth(true));a.on("click.onboarding",function(e){e&&e.stopPropagation();TS.coachmark.expand()})};var x=function e(t,i,n){i=i||$();n=n||i;t.off("mouseenter.onboarding mouseleave.onboarding").removeClass("jquery_hover");n.off("click.onboarding")};var I=function e(){return!TS.onboarding.shouldShowFirstWelcome()&&!TS.prefs.getPref("onboarding_cancelled")};var M=function e(){var t=TS.onboarding.shouldShowFirstWelcome();var i=!t&&(TS.prefs.getPref("onboarding_cancelled")||TS.prefs.getPref("seen_onboarding_start"))||t&&(TS.prefs.getPref("onboarding_cancelled")||TS.prefs.getPref("seen_onboarding_start"))&&!TS.model.seen_onboarding_this_session;i&&(TS.model.seen_welcome_2=true)}})()},3070:function(e,t){(function(){TS.registerModule("onboarding",{no_longer_in_onboarding_sig:new signals.Signal,onStart:function e(){if(!TS.client)return;TS.client.login_sig.add(TS.onboarding.onLogin,TS.onboarding,-1);TS.prefs.seen_welcome_2_changed_sig.add(TS.onboarding.setSeenWelcome2)},onLogin:function e(){void 0!==TS.boot_data.prefs_seen_welcome_2?TS.model.seen_welcome_2=TS.boot_data.prefs_seen_welcome_2:TS.onboarding.setSeenWelcome2();TS.onboarding.startOnboarding()},setSeenWelcome2:function e(){TS.model.seen_welcome_2=TS.prefs.getPref("seen_welcome_2")},startOnboarding:function e(){TS.boot_data.feature_tractor_onboarding&&TS.prefs.getPref("tractor_enabled")?TS.team_creation_setup.startOnboarding():TS.boot_data.feature_lesson_onboarding&&TS.prefs.getPref("lessons_enabled")?TS.lessons.startOnboarding():TS.newxp.startOnboarding()},cancelOnboarding:function e(){TS.boot_data.feature_tractor_onboarding&&TS.prefs.getPref("tractor_enabled")?TS.team_creation_setup.cancelOnboarding():TS.boot_data.feature_lesson_onboarding&&TS.prefs.getPref("lessons_enabled")?TS.lessons.cancelOnboarding():TS.newxp.cancelOnboarding()},inOnboarding:function e(){if(TS.boot_data.feature_tractor_onboarding&&TS.prefs.getPref("tractor_enabled"))return TS.team_creation_setup.inOnboarding();if(TS.boot_data.feature_lesson_onboarding&&TS.prefs.getPref("lessons_enabled"))return TS.lessons.inOnboarding();return TS.newxp.inOnboarding()},shouldShowFirstWelcome:function e(){if(TS.boot_data.incremental_boot_data&&(false===_.get(TS.boot_data.incremental_boot_data,"self.prefs.seen_welcome_2",void 0)||false===TS.boot_data.prefs_seen_welcome_2))return true;if(TS.model&&TS.model.seen_welcome_2)return false;if(!(TS.model&&TS.model.welcome_model_ob&&TS.model.welcome_model_ob.id))return false;var t=TS.shared.legacyGetActiveModelOb();if(!t)return false;if(t.id==TS.model.welcome_model_ob.id)return true;return false}})})()},3071:function(e,t){(function(){TS.registerModule("lessons",{lesson_assigned_sig:new signals.Signal,channel_created_sig:new signals.Signal,message_sent_sig:new signals.Signal,file_uploaded_sig:new signals.Signal,coachmark_closed_sig:new signals.Signal,new_channel_modal_opened_sig:new signals.Signal,new_channel_modal_closed_sig:new signals.Signal,file_upload_clicked_sig:new signals.Signal,your_computer_clicked_sig:new signals.Signal,file_upload_modal_sig:new signals.Signal,tractor_send_a_message_clicked_sig:new signals.Signal,tractor_upload_a_file_clicked_sig:new signals.Signal,onStart:function e(){TS.lessons.tractor_send_a_message_clicked_sig.add(A);TS.lessons.tractor_upload_a_file_clicked_sig.add(k)},inOnboarding:function t(){return e},startOnboarding:function t(){e=true;var i=TS.prefs.getPref("seen_welcome_2");if(false===i){TS.channels.legacyDisplayChannel({id:TS.interop.channels.getGeneralChannel().id});TS.prefs.setPrefByAPI({name:"seen_welcome_2",value:true})}TS.lessons.model.populateFromTSModel();var n={only_active:false};TS.interop.api.call("lessons.list",n).then(function(t){var i=t.data;if(!i.ok){TS.lessons.lesson_assigned_sig.add(T);return}if(!i.user_lessons||!i.user_lessons.length){e=false;return}if("completed"!==_.get(i,"user_lessons[0].state"))T(i.user_lessons);else{e=false;TS.onboarding.no_longer_in_onboarding_sig.dispatch()}})},cancelOnboarding:function t(){e=false;TS.interop.api.call("lessons.skip",a);TS.onboarding.no_longer_in_onboarding_sig.dispatch()},postponeOnboardingAndRemindLater:function t(){e=false;TS.interop.api.call("lessons.paused",a);TS.onboarding.no_longer_in_onboarding_sig.dispatch()},onboardingInProgress:function e(){TS.interop.api.call("lessons.inProgress",a)},initiateTask:function e(){s()},skipTask:function e(){r=_.clone(a);i=TS.lessons.model.current_task_index;r.user_task_id=TS.lessons.model.TASKS[i].id;TS.interop.api.call("lessons.tasks.skipped",r).then(function(e){e.data.ok||TS.error(e.data.error)});TS.lessons.model.TASKS[i].task_skipped=true;var t="task"+(i+1)+"_1";TS.lessons.lessonOnboardingClog({step:t,action:"click",ui_element:"skip",ui_properties:{element_type:"button",element_name:"skip_this_task"}});g()},lessonOnboardingClog:function e(t){TS.interop.clog.track("LESSON_ONBOARDING",{contexts:{ui_context:t}})},loadSlackbot:function e(){TS.interop.api.call("slackbot.sendHelpMessage").then(function(e){if(e.data.ok){TS.ui.onboarding_dialog.closeDialog();TS.ims.legacyStartImByMemberId("USLACKBOT")}else TS.error(e.data.error)})}});var e=false;var t;var i=0;var n=0;var a;var r;var s=function e(){TS.ui.onboarding_dialog.closeDialog();r=_.clone(a);i=TS.lessons.model.current_task_index;r.user_task_id=TS.lessons.model.TASKS[i].id;TS.interop.api.call("lessons.tasks.inProgress",r).then(function(e){e.data.ok||TS.error(e.data.error)});t=TS.lessons.model.TASKS[i].steps;m(t[n]);o();$("body").addClass("task_in_progress");var s=_.clone(i);var l="task"+(s+1)+"_1";TS.lessons.lessonOnboardingClog({step:l,action:"click",ui_element:"try_it",ui_properties:{element_type:"button",element_name:"try_it_now"}})};var o=function e(){TS.lessons.new_channel_modal_closed_sig.add(u);TS.lessons.coachmark_closed_sig.add(u);TS.lessons.file_upload_modal_sig.add(d)};var l=function e(){$(".file_upload_btn").on("click",function(){c();TS.lessons.file_upload_clicked_sig.dispatch(true)})};var c=function e(){$('[data-which="choose"], [data-which="gdrive_import"], [data-which="snippet"], [data-which="space"]').on("click",function(){TS.lessons.your_computer_clicked_sig.dispatch(true)})};var d=function e(){TS.coachmark.$coachmark&&TS.coachmark.end();"upload_file"===TS.lessons.model.TASKS[i].task_name&&_.each(TS.lessons.model.TASKS[i].steps,function(e,t){if("upload_file_menu_coachmark"===e.name){n=t;f()}})};var u=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"in_progress";n=0;h();TS.view.clearMessageInput();$("body").removeClass("task_in_progress");TS.ui.onboarding_dialog.start(t)};var m=function e(t){var i=r;i.current_step=t.name;TS.interop.api.call("lessons.tasks.currentStep",i).then(function(e){e.data.ok||TS.error(e.data.error)});switch(t.type){case"coachmark":v(t);break;case"alter_channel_creation_modal":b(t);break;case"prefill_message":w(t);break;case"wait_for_file_upload":y(t);break;default:TS.info("Unmatched step type")}};var f=function e(){n+=1;var a=t[n];h();if(a)m(a);else{var s=_.clone(i);var o="task"+(s+1);TS.lessons.lessonOnboardingClog({step:o,action:"complete",action_status:"success"});TS.lessons.model.TASKS[i].task_completed=true;TS.interop.api.call("lessons.tasks.completed",r).then(function(e){e.data.ok?g():TS.error(e.data.error)})}};var h=function e(){TS.coachmark.$coachmark&&TS.coachmark.end();var i=_.clone(n)-1;if(i>=0){var a=t[i];a&&a.coachmark_highlight_target&&$(a.coachmark_highlight_target).removeClass(a.coachmark_highlight_class_name)}};var p=function e(){TS.lessons.lesson_assigned_sig.remove(T);TS.lessons.channel_created_sig.remove(f);TS.lessons.message_sent_sig.remove(f);TS.lessons.file_uploaded_sig.remove(f);TS.lessons.coachmark_closed_sig.remove(u);TS.lessons.new_channel_modal_closed_sig.remove(u)};var g=function t(){var n=_.some(TS.lessons.model.TASKS,function(e){return!e.task_completed&&!e.task_skipped});if(n){var r=i+1;while(r!==i){r===TS.lessons.model.TASKS.length&&(r=0);if(true!==TS.lessons.model.TASKS[r].task_completed&&true!==TS.lessons.model.TASKS[r].task_skipped){i=r;TS.lessons.model.current_task_index=i;u();break}r+=1}}else TS.interop.api.call("lessons.completed",a).then(function(t){if(t.data.ok){u("completed");p();e=false}else TS.error(t.data.error)})};var T=function e(t){var n=t.shift();S(n);l();a={user_lesson_id:n.user_lesson_id};"paused"===n.state&&TS.lessons.onboardingInProgress();if("in_progress"===n.state||"paused"===n.state){i=-1;g()}TS.ui.onboarding_dialog.start(n.state)};var S=function e(t){TS.lessons.model.current_lesson_id=t.user_lesson_id;_.each(TS.lessons.model.TASKS,function(e,i){TS.lessons.model.TASKS[i].id=t.tasks[i].user_task_id;TS.lessons.model.TASKS[i].task_completed="completed"===t.tasks[i].state;TS.lessons.model.TASKS[i].task_skipped="skipped"===t.tasks[i].state})};var v=function e(t){if("coachmark"===t.type){var i="send_message_input_coachmark"!==t.name;var n={id:"onboarding_coachmark",coachmark_el_id:"onboarding_coachmark_div",no_footer:true,has_close_btn:true,enter_does_not_dismiss:i,place:function e(){t.coachmark_placement($(t.coachmark_class_target),t.coachmark_offset_y,t.coachmark_offset_x,t.coachmark_offset_callout)},content:function e(){var i={title:t.coachmark_title,description:t.coachmark_description};return TS.templates.onboarding_coachmark(i)}};$(t.coachmark_highlight_target).addClass(t.coachmark_highlight_class_name);TS.coachmark.start(n)}t.signal.add(f)};var b=function e(t){$("#fs_modal_close_btn").on("click",function(){TS.lessons.new_channel_modal_closed_sig.dispatch(true)});t.signal.add(f)};var w=function e(t){var i;var n=TS.model.active_channel_id;if(null!==TS.model.active_channel_id){var a=TS.interop.channels.getPublicChannelById(n).name;i="#"+a}else i="";var r=t.message({name_of_channel:i});r=r.replace(/ +(?= )/g,"");if(TS.utility.contenteditable.isEmpty()){TS.utility.contenteditable.value(TS.client.msg_input.$input,r);TS.utility.contenteditable.focus(TS.client.msg_input.$input)}f()};var y=function e(t){t.signal.add(f)};var A=function e(){console.log("_initiateSendAMessage")};var k=function e(){console.log("_initiateUploadAFile")}})()},3072:function(e,t){(function(){TS.registerModule("lessons.model",{populateFromTSModel:function e(){var t=TS.interop.i18n.t("Welcome, {name}","lessons")({name:TS.model.user.real_name});TS.lessons.model.WELCOME.modal_title=t;var i=TS.interop.i18n.t("You just created <strong>{team_name}</strong> on Slack. Next, we\u2019ll show you how to get the conversation going \u2013 it only takes a minute or two!","lessons")({team_name:TS.interop.i18n.safeString(_.escape(TS.interop.rules.teams.getTeamDisplayName(TS.model.team)))});TS.lessons.model.WELCOME.modal_description=i},current_task_index:0,current_lesson_id:0,WELCOME:{modal_media_url:cdn_url+"/28121/img/onboarding/welcome.png",modal_button_text:TS.interop.i18n.t("Let\u2019s go","lessons")()},TASKS:[{task_name:"create_channel",modal_color_class:"blue",modal_media_url:cdn_url+"/adc6a/img/onboarding/CreateChannel.gif",modal_dot_to_highlight_or_mark_as_complete:1,task_completed:false,task_skipped:false,modal_title:TS.interop.i18n.t("Start by creating a channel","lessons")(),modal_description:TS.interop.i18n.t("Channels give each conversation a dedicated home, helping everyone in your team focus on the right thing at the right time.","lessons")(),modal_button_text:TS.interop.i18n.t("Try it now","lessons")(),second_modal_button_text:TS.interop.i18n.t("Skip this step","lessons")(),second_modal_button_skipped_text:TS.interop.i18n.t("Skipped","lessons")(),steps:[{type:"coachmark",name:"create_channel_button_coachmark",coachmark_class_target:'[data-qa-channel-sidebar-section-heading="channels"]',coachmark_placement:TS.coachmark?TS.coachmark.placeRightOf:void 0,coachmark_offset_x:33,coachmark_offset_y:-15,coachmark_offset_callout:0,coachmark_title:TS.interop.i18n.t("Create a new channel","lessons")(),coachmark_description:TS.interop.i18n.t("Click the + to start creating a channel.","lessons")(),coachmark_highlight_target:".client_channels_list_container",coachmark_highlight_class_name:"coachmark_focal_point_sidebar",signal:TS.lessons?TS.lessons.new_channel_modal_opened_sig:void 0},{type:"alter_channel_creation_modal",name:"create_channel_alter_modal_coachmark",signal:TS.lessons?TS.lessons.channel_created_sig:void 0}]},{task_name:"send_message",modal_color_class:"orange",modal_media_url:cdn_url+"/adc6a/img/onboarding/PostMessage.gif",modal_dot_to_highlight_or_mark_as_complete:2,task_completed:false,task_skipped:false,modal_title:TS.interop.i18n.t("Post a message","lessons")(),modal_description:TS.interop.i18n.t("Just like a blank page, an empty channel can be intimidating! Post the very first message in this channel to welcome everyone who joins.","lessons")(),modal_button_text:TS.interop.i18n.t("Try it now","lessons")(),second_modal_button_text:TS.interop.i18n.t("Skip this step","lessons")(),second_modal_button_skipped_text:TS.interop.i18n.t("Skipped","lessons")(),steps:[{type:"prefill_message",name:"send_message_prefill_message",message:TS.interop.i18n.t("Hi everyone. Here\u2019s a space for our {name_of_channel} conversations!","lessons"),message_target:".ql-editor p"},{type:"coachmark",name:"send_message_input_coachmark",coachmark_class_target:'[data-qa="message_input"]',coachmark_placement:TS.coachmark?TS.coachmark.placeAboveOf:void 0,coachmark_offset_x:30,coachmark_offset_y:10,coachmark_offset_callout:-400,coachmark_title:TS.interop.i18n.t("Just type and press Enter","lessons")(),coachmark_description:TS.interop.i18n.t("Feel free to send the prefilled message, or replace it with exactly what you want to say to your team.","lessons")(),coachmark_highlight_target:"#msg_form",coachmark_highlight_class_name:"coachmark_focal_point_messagebar",signal:TS.lessons?TS.lessons.message_sent_sig:void 0}]},{task_name:"upload_file",modal_color_class:"yellow",modal_media_url:cdn_url+"/adc6a/img/onboarding/UploadFile.gif",modal_dot_to_highlight_or_mark_as_complete:3,task_completed:false,task_skipped:false,modal_title:TS.interop.i18n.t("Upload relevant documents","lessons")(),modal_description:TS.interop.i18n.t("Got a project plan, spreadsheet, or design file related to the conversation? Share a file to give your teammates useful context.","lessons")(),modal_button_text:TS.interop.i18n.t("Try it now","lessons")(),second_modal_button_text:TS.interop.i18n.t("Skip this step","lessons")(),second_modal_button_skipped_text:TS.interop.i18n.t("Skipped","lessons")(),steps:[{type:"coachmark",name:"upload_file_button_coachmark",coachmark_class_target:".file_upload_btn",coachmark_placement:TS.coachmark?TS.coachmark.placeRightOf:void 0,coachmark_offset_x:20,coachmark_offset_y:10,coachmark_offset_callout:15,coachmark_title:TS.interop.i18n.t("Add a file here","lessons")(),coachmark_description:TS.interop.i18n.t("Click the + plus icon next to the message input box to add a file to the conversation.","lessons")(),coachmark_highlight_target:".file_upload_btn",coachmark_highlight_class_name:"coachmark_focal_point_fileupload",signal:TS.lessons?TS.lessons.file_upload_clicked_sig:void 0},{type:"coachmark",name:"upload_file_menu_coachmark",coachmark_class_target:"#menu_items",coachmark_placement:TS.coachmark?TS.coachmark.placeRightOf:void 0,coachmark_offset_x:6,coachmark_offset_y:155,coachmark_offset_callout:105,coachmark_title:TS.interop.i18n.t("Browse your computer\u2019s files","lessons")(),coachmark_description:TS.interop.i18n.t("Select Your Computer to open your file browser and find the file you need.","lessons")(),signal:TS.lessons?TS.lessons.your_computer_clicked_sig:void 0},{type:"wait_for_file_upload",name:"upload_file_wait_for_upload",signal:TS.lessons?TS.lessons.file_uploaded_sig:void 0}]}],COMPLETION:{modal_media_url:cdn_url+"/28121/img/onboarding/completion.png",modal_title:TS.interop.i18n.t("Nice work!","lessons")(),modal_description:TS.interop.i18n.t("You\u2019ve set the stage for team discussions. If you\u2019re wondering how to do other things in Slack, you can send questions to Slackbot.","lessons")(),modal_button_text:TS.interop.i18n.t("Ask Slackbot","lessons")(),modal_second_button_text:TS.interop.i18n.t("I\u2019m done","lessons")()}})})()},3073:function(e,t){(function(){TS.registerModule("ui.channel_options_dialog",{c_id:null,params:null,preselected_section:null,start:function t(i,n,a){TS.ui.channel_options_dialog.c_id=i;TS.ui.channel_options_dialog.preselected_section=n;TS.ui.channel_options_dialog.params=a;e()},promiseToGetWhoCanPostListData:function e(t){return function(e,a){"@"===e.charAt(0)&&(e=e.substring(1));return n(i,{user:t},e,a)}}});var e=function e(){var t=TS.redux.channels.getEntityById(TS.ui.channel_options_dialog.c_id);if(!t){var i=TS.interop.i18n.t("Oops! No channel found???","channel_options")();TS.generic_dialog.alert('<p class="no_bottom_margin">'+i+"</p>");return}var n=TS.permissions.channels.canSeeConvertToPrivateOption(t);var a=TS.permissions.channels.canSeeArchiveChannelOption(t);var r=TS.permissions.channels.canSeeDeleteChannelOption(t);var s=TS.permissions.channels.canSeeRenameChannelOption(t);var o=!TS.permissions.members.canPostInModelOb(t);var l=TS.permissions.channels.canSeePurposeChannelOption(t);var c=TS.permissions.channels.canSeeDataRetentionChannelOption(t);var d=TS.interop.rules.user.canUserManagePostingPermissions(t.id);var u=TS.permissions.channels.canSeeManageTeamAccessToChannelOption(t);var _=TS.permissions.channels.canSeeDisconnectChannelOption(t);var m=TS.interop.rules.channels.isExternallySharedChannel(t)||TS.interop.rules.channels.isPendingExternallySharedChannel(t);m&&(m=false);var f=TS.permissions.channels.canSeeShareChannelOption(t);var h=TS.permissions.members.canExportMessageHistory(t);var p=document.getElementById("channel_options_dialog_mount_point");var g={additionalParams:TS.ui.channel_options_dialog.params,channelId:t.id,disableConvertToPrivate:m,disableRename:o,onCancel:function e(){return Promise.resolve().then(function(){p&&TS.interop.unmountChannelOptions(p)})},preselectedSection:TS.ui.channel_options_dialog.preselected_section,showArchive:a,showConvertToPrivate:n,showDataRetention:c,showDelete:r,showExport:h,showManageOrgAccess:u,showPostingPermissions:d,showPurpose:l,showRename:s,showShareExternal:f,showStopShareExternal:_};TS.interop.mountChannelOptions(TS.boot_data.team_id,p,g)};var t="1.";var i={};var n=function e(i,n,a){i.query!==a&&(i=_.merge(i,{query:a,include_org:TS.boot_data.page_needs_enterprise,include_slackbot:false,include_self:true,full_profile_filter:true,include_bots:false,all_of_org:true,org_team_ids:[]}));return Promise.resolve(i).then(function(e){var i=n.user||[];return TS.interop.members.ensureMembersArePresent(i).then(function(){return TS.members.promiseToSearchMembers(e).then(function(e){var n=[];var a={include_bots:false,include_slackbot:false,include_deleted:false,include_self:true};n=""===e.query?TS.members.getMembersWithOptions(a):e.items;e.items=n.map(function(e){if(e.member&&"undefined"!==typeof e.preselected)return e;return{member:e,lfs_id:t+e.id,id:t+e.id,preselected:i&&i.indexOf(e.id)>-1}});e.replace_all_items=true;return e})})})}})()},3074:function(e,t){(function(){TS.registerModule("ui.share_channel_dialog",{start:function e(t){if(!TS.model.team.plan)return;t=t||{};if(!TS.permissions.members.canCreateSharedChannel()){TS.ui.share_channel_dialog.showFindAnAdminDialog({show_slackbot_prompt:true,channel:t.model_ob||null});return}t.model_ob?g(t.model_ob):p(t);D({event:t.model_ob?d.share_existing_modal_open:d.create_new_modal_open,element:t.element})},showFindAnAdminDialog:function e(t){t=t||{};var i=TS.interop.i18n.t("Only admins can share and unshare channels. If you\u2019d like to stop sharing {channel_name} with {team_name}, you\u2019ll need to ask one of the admins below.","shared_channels")({channel_name:"#test",team_name:"Test Team"});var n=TS.interop.i18n.t("Only admins can unshare and archive channels. If you\u2019d like to archive {channel_name} with {team_name}, you\u2019ll need to ask one of the admins below.","shared_channels")({channel_name:"#test",team_name:"Test Team"});var a=TS.interop.i18n.t("Only admins can share and unshare channels. If you\u2019d like to share {channel_name} with another workspace, you\u2019ll need to ask one of the admins below.","shared_channels")({channel_name:"#test"});var r={is_admin_only_mode:true,title:TS.interop.i18n.t("Find an admin","shared_channels")(),subtitle:TS.interop.i18n.t("Only admins can share and unshare channels. If you\u2019d like to share a channel, you\u2019ll need to ask one of the admins below.","shared_channels")()};t.show_slackbot_prompt&&(r.submit_callback=function(){B(t.channel)});TS.ui.im_browser.start(r)},showApproveRequestDialog:function e(t,i){i=i||{};TS.interop.api.callExpedited("channels.sharedInviteInfo",{invite:t}).then(function(e){var t=e.data;s=c.review_shared_channel_request;t.invite.offer_trial&&(r=true);var n={inviter:t.invite.inviting_user,inviting_team:t.invite.inviting_team,team:TS.model.team,channel_name:t.invite.channel_name,custom_message:t.invite.custom_message,show_free_trial:r,disable_private_option:!TS.permissions.members.canCreateGroups()};o.invite_id=t.invite.id;o.channel_id=t.invite.channel;var a;a=r?TS.interop.i18n.t("Start Trial & Accept","shared_channels")():TS.interop.i18n.t("Accept & Add Channel","shared_channels")();var l=TS.templates.channel_share_dialog_request(n);TS.ui.fs_modal.start({body_template_html:l,footer_html:TS.templates.shared_channels_help_content(),modal_class:"fs_modal_footer",show_cancel_button:true,show_go_button:true,go_button_text:a,go_button_class:"ladda-button",onShow:function e(){C(i)},onEnd:h})})},test:function t(){var n={};Object.defineProperty(n,"_generateTemplateArgs",{get:function e(){return E},set:function e(t){E=t}});Object.defineProperty(n,"_onSubmitShare",{get:function e(){return T},set:function e(t){T=t}});Object.defineProperty(n,"_ladda",{get:function e(){return a},set:function e(t){a=t}});Object.defineProperty(n,"$_modal",{get:function t(){return e},set:function t(i){e=i}});Object.defineProperty(n,"$_buttons",{get:function e(){return i},set:function e(t){i=t}});return n}});var e;var t={};var i={};var n={};var a;var r;var s;var o={};var l={};var c={new_shared_channel_create:"new_shared_channel_create",new_shared_channel_invite:"new_shared_channel_invite",share_existing_channel:"share_existing_channel",review_shared_channel_request:"review_shared_channel_request"};var d={create_new_modal_open:"SHARED_CHANNELS_CREATE_NEW_MODAL_OPEN",share_existing_modal_open:"SHARED_CHANNELS_SHARE_EXISTING_MODAL_OPEN",create_new_modal_action:"SHARED_CHANNELS_CREATE_NEW_MODAL_ACTION",share_existing_modal_action:"SHARED_CHANNELS_SHARE_EXISTING_MODAL_ACTION",review_invite_modal_action:"SHARED_CHANNELS_REVIEW_INVITE_MODAL_ACTION",nonadmin_action:"SHARED_CHANNELS_NONADMIN_ACTION",api_error:"SHARED_CHANNELS_INVITE_SENT_ERROR"};var u=["invalid_name_required","invalid_name_punctuation","invalid_name_maxlength","invalid_name_specials","name_taken"];var m={default:"#555459",orange:"#ffa800",green:"#2ab27b"};var f=/^https?:\/\/|www\.|(\.dev(\d+)?)|\.staging|\.qa|(\.slack\.com.*$)/g;var h=function c(){i.cancel&&i.cancel.off();i.submit&&i.submit.off();t.channel_name&&t.channel_name.off();t.email_address&&t.email_address.off();t.team_url&&t.team_url.off();t.free_trial_checkbox&&t.free_trial_checkbox.off();e=null;t={};i={};n={};a=null;r=false;s={};o={};l={}};var p=function e(t){s=c.new_shared_channel_create;var i=E(t);var n=TS.templates.channel_share_dialog_create(i);t.team_url&&(l.team_url=t.team_url);TS.ui.fs_modal.start({body_template_html:n,footer_html:TS.templates.shared_channels_help_content(),onShow:function e(){A();x()},modal_class:"fs_modal_footer",show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Next","shared_channels")(),go_button_class:"ladda-button",modal_contents_container_class:"p-share_channel_dialog__container",onGo:function e(){return false},onEnd:h})};var g=function t(i){s=c.share_existing_channel;var n=new Handlebars.SafeString(TS.templates.builders.makeChannelPrefix(i)+_.escape(i.name));var a=E({channel_name:n});var r=TS.templates.channel_share_dialog_invite_wrapper(a);TS.ui.fs_modal.start({body_template_html:r,onShow:function t(){TS.ui.fs_modal.bindBackButton(function(){TS.ui.fs_modal.close(true);TS.ui.channel_options_dialog.start(i.id)});TS.ui.fs_modal.showBackButton();e=$("#fs_modal");k();x()},modal_class:"channel_options_modal",show_cancel_button:false,show_go_button:false,modal_contents_container_class:"p-share_channel_dialog__container",onEnd:h})};var T=function t(i){e.find("[data-label=shared_channel_form_error]").addClass("hidden");var n={target_domain:i.target_domain,email:i.email};i.custom_message&&(n.custom_message=i.custom_message);i.model_ob?n.channel=i.model_ob.id:i.channel_name&&(n.channel_name=i.channel_name);i.is_private&&TS.permissions.members.canCreateGroups()&&(n.is_private=true);var r=function e(t,i){if(t){TS.interop.channels.upsertChannel(i.channel);TS.teams.upsertTeam(i.team);a.stop();TS.channels.legacyDisplayChannel({id:i.channel.id});l.selected_invite_ids&&l.selected_invite_ids.length&&TS.interop.api.call("conversations.invite",{channel:i.channel.id,users:l.selected_invite_ids.join(",")});s===c.share_existing_channel&&h();TS.ui.fs_modal.close();TS.prefs.getPref("seen_channel_browser_admin_coachmark")||TS.prefs.setPrefByAPI({name:"has_recently_shared_a_channel",value:true})}else v(n,i)};TS.interop.api.call("conversations.inviteShared",n).then(function(e){var t=e.data,i=e.args,n=e.request_id;var a=true;r(a,t,i,n);return{data:t,args:i,request_id:n}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;r(a,t,i,n);return{data:t,args:i,request_id:n}});return false};var S=function i(){e.find("[data-label=shared_channel_form_error]").addClass("hidden");var n={invite_id:o.invite_id};if(r&&t.free_trial_checkbox.length&&t.free_trial_checkbox.is(":checked")){TS.prefs.setTeamPrefByAPI({enable_shared_channels:1});O(n)}else b(n)};var v=function e(i,n){a.stop();var r=TS.ui.validation.getErrorMessage("");D({event:d.api_error,contexts:{core:{shared_channels_invite_target_domain:i.target_domain,shared_channels_invite_error_msg:n.error}}});if(_.includes(u,n.error)&&s===c.new_shared_channel_invite){r=TS.ui.validation.getErrorMessage(n.error,{name:i.channel_name});M();TS.ui.validation.showWarning(t.channel_name,r,{})}else if(n.error)switch(n.error){case"invalid_email":r=TS.ui.validation.getErrorMessage("invalid_email");TS.ui.validation.showWarning(t.channel_name,r,{});break;case"url_in_message":r=TS.ui.validation.getErrorMessage("url_in_message");TS.ui.validation.showWarning(t.custom_message,r,{});break;case"invalid_target_domain":case"shared_channel_invites_disabled":case"not_in_shared_channels_beta":case"target_team_is_enterprise":r=TS.templates.channel_share_dialog_error({error:n.error,target_domain:i.target_domain});y(r,{is_html:true});break;default:r=TS.ui.validation.getErrorMessage(n.error);y(r)}else y(r)};var b=function e(i){var n=t.channel_name.val().trim();n&&(i.channel_name=n);var r=t.invite_people.lazyFilterSelect("value");r=_.map(r,"member.id");var s="private"===t.privacy.filter(":checked").val();s&&TS.permissions.members.canCreateGroups()&&(i.is_private=true);var o=function e(t,n){if(t){a.stop();TS.channels.legacyDisplayChannel({id:n.channel.id});r.length&&TS.interop.api.call("conversations.invite",{channel:n.channel.id,users:r.join(",")});TS.ui.fs_modal.close()}else w(i,n)};TS.interop.api.call("conversations.acceptSharedInvite",i).then(function(e){var t=e.data,i=e.args,n=e.request_id;var a=true;o(a,t,i,n);return{data:t,args:i,request_id:n}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;o(a,t,i,n);return{data:t,args:i,request_id:n}})};var w=function e(i,n){a.stop();var r=TS.ui.validation.getErrorMessage(n.error,{name:i.channel_name});_.includes(u,n.error)?TS.ui.validation.showWarning(t.channel_name,r,{}):y(r)};var y=function t(i,n){n=n||{};n.is_html?e.find("[data-label=shared_channel_form_error_label]").html(i):e.find("[data-label=shared_channel_form_error_label]").text(i);e.find("[data-label=shared_channel_form_error]").removeClass("hidden")};var A=function a(){e=$("#fs_modal");t.privacy=e.find('input[name="channel_privacy"]');t.channel_name=e.find('[data-input="channel_name"]');t.invite_people=$("#invite_people_picker");n.channel_name=e.find('label[for="channel_name"]');n.privacy_alert=e.find($('[data-alert="private_channel"]'));i.cancel=e.find(".dialog_cancel");i.submit=e.find(".dialog_go");t.privacy.bind("change",function(){var i="private"===t.privacy.filter(":checked").val();n.privacy_alert.toggleClass("hidden",!i);e.find(".public_channel_item").toggleClass("hidden",i);e.find(".private_channel_item").toggleClass("hidden",!i)}).trigger("change");TS.utility.disableElement(i.submit,!t.channel_name.val().trim());t.channel_name.bind("input",_.debounce(function(){var e=!TS.ui.validation.validate(t.channel_name,{quiet:true});TS.utility.disableElement(i.submit,e)},500));P(l.selected_invite_ids);t.channel_name.focus()};var k=function a(){var r=s===c.share_existing_channel;t.email_address=e.find('[data-input="email_address"]');t.team_url=e.find('[data-input="team_url"]');t.custom_message=e.find('[data-input="custom_message"]');n.email_address=e.find('label[for="email_address"]');n.team_url=e.find('label[for="team_url"]');i.cancel=r?e.find(".cancel_share"):e.find(".dialog_cancel");i.submit=r?e.find(".submit"):e.find(".dialog_go");r&&i.cancel.click(function(){h();TS.ui.fs_modal.close()});var o=!t.email_address.val().trim()||!t.team_url.val().trim();TS.utility.disableElement(i.submit,o);t.email_address.add(t.team_url).bind("input",function(){var e=!t.email_address.val().trim()||!t.team_url.val().trim();TS.utility.disableElement(i.submit,e)});t.team_url.bind("input",U);t.email_address.focus()};var C=function a(s){s=s||{};e=$("#fs_modal");t.privacy=e.find('input[name="channel_privacy"]');t.channel_name=$('[data-input="channel_name"]');t.invite_people=$("#invite_people_picker");n.channel_name=$('label[for="channel_name"]');i.cancel=e.find(".dialog_cancel");i.submit=e.find(".dialog_go");t.privacy.bind("change",function(){var i="private"===t.privacy.filter(":checked").val();e.find(".public_channel_item").toggleClass("hidden",i);e.find(".private_channel_item").toggleClass("hidden",!i)}).trigger("change");t.channel_name.bind("input",_.debounce(function(){var e=!TS.ui.validation.validate(t.channel_name,{quiet:true});TS.utility.disableElement(i.submit,e)},500));P();x();r&&F();if(s.onBack){TS.ui.fs_modal.bindBackButton(s.onBack);TS.ui.fs_modal.showBackButton()}};var x=function e(){a||(a=Ladda.create(i.submit[0]));i.submit.click(function(){a.start();switch(s){case c.new_shared_channel_create:a.stop();D({element:"SHARED_CHANNELS_CREATE_NEW_MODAL_NEXT_BTN"});I();break;case c.new_shared_channel_invite:D({element:"SHARED_CHANNELS_CREATE_NEW_MODAL_SUBMIT_BTN",contexts:{core:{shared_channels_invite_target_domain:t.team_url.val()}}});T({channel_name:l.channel_name,is_private:l.is_private,target_domain:t.team_url.val(),email:t.email_address.val(),custom_message:t.custom_message.val()});break;case c.share_existing_channel:D({element:"SHARED_CHANNELS_SHARE_EXISTING_MODAL_SUBMIT_BTN",contexts:{core:{shared_channels_invite_target_domain:t.team_url.val(),channel_id:TS.shared.legacyGetActiveModelOb().id}}});T({model_ob:TS.shared.legacyGetActiveModelOb(),target_domain:t.team_url.val(),email:t.email_address.val(),custom_message:t.custom_message.val()});break;case c.review_shared_channel_request:D({element:"SHARED_CHANNELS_REVIEW_INVITE_MODAL_SUBMIT_BTN",contexts:{core:{shared_channels_invite_id:o.invite_id}}});r&&TS.interop.clog.track("UPGRDEXP_FREE_TRIAL_FOR_SC",{contexts:{ui_context:{step:"shared_channels_invitation_modal",action:"click",ui_element:"btn_start_trial_and_accept"}}});S();break;default:a.stop()}})};var I=function n(){l.is_private="private"===t.privacy.filter(":checked").val();l.channel_name=t.channel_name.val();l.selected_invite_ids=_.map(t.invite_people.lazyFilterSelect("value"),"member.id");TS.ui.fs_modal.bindBackButton(M);TS.ui.fs_modal.showBackButton();var a=E({email_address:l.email_address,team_url:l.team_url,custom_message:l.custom_message});var r=TS.templates.channel_share_dialog_invite(a);e.find(".contents").html(r);var o=TS.interop.i18n.t("Create & Invite","shared_channels")();i.submit.find(".ladda-label").text(o);s=c.new_shared_channel_invite;k()};var M=function n(){l.email_address=t.email_address.val();l.team_url=t.team_url.val();l.custom_message=t.custom_message.val();TS.ui.fs_modal.unbindBackButton();TS.ui.fs_modal.hideBackButton();var a=E({channel_name:l.channel_name,is_private:l.is_private&&TS.permissions.members.canCreateGroups()});var r=TS.templates.channel_share_dialog_create(a);e.find(".contents").html(r);var o=TS.interop.i18n.t("Next","shared_channels")();i.submit.find(".ladda-label").text(o);s=c.new_shared_channel_create;A()};var E=function e(t){t=t||{};return{sharing_existing_channel:s===c.share_existing_channel,show_heading:s===c.new_shared_channel_create||s===c.new_shared_channel_invite,inviter:TS.model.user,team:TS.model.team,disable_private_option:!TS.permissions.members.canCreateGroups(),channel_name:t.channel_name||null,is_private:!!t.is_private&&TS.permissions.members.canCreateGroups(),email_address:t.email_address||null,team_url:t.team_url||null,custom_message:t.custom_message||null}};var B=function e(t){var i=TS.interop.i18n.t("Be sure to let your admin know the name of the channel (*{channel_name}*) you\u2019d like to stop sharing.","shared_channels")({channel_name:"test"});var n=TS.interop.i18n.t("Be sure to let your admin know the name of the channel (*{channel_name}*) you\u2019d like to stop sharing and archive.","shared_channels")({channel_name:"test"});var a;a=t?TS.interop.i18n.t("To share this channel, your admin will need:\n\u2022 An invitation to the channel, if they\u2019re not in it already.\n\u2022 The name of the workspace you want to share with, and why.\n\u2022 The email address of an admin at the other workspace.\n\u2022 The other workspace\u2019s Slack URL.","shared_channels","fd00d0f6134f6b703f556fcff38bc9381955ab17")({channel_name:TS.interop.rules.channels.getDisplayNameForChannel(t)}):TS.interop.i18n.t("To share a channel, your admin needs a few pieces of info:\n\u2022 Who you want to share with, and why.\n\u2022 The email address of an admin at the other workspace.\n\u2022 The other workspace\u2019s Slack URL.","shared_channels")();TS.client.ui.addEphemeralBotMsg({text:a})};var P=function e(t){var i=TS.interop.i18n.t("Find people...","shared_channels")();var n={include_self:false,include_slackbot:false,include_bots:false,only_local_team:true,placeholder_text:i};t&&(n.preselected_ids=t);TS.ui.people_picker.make($("#invite_people_picker"),n)};var U=function e(){if(!t.team_url.length)return;var i=t.team_url.val().trim();if(!i)return;if(!f.test(i))return;var n=i.replace(f,"");var a=t.team_url[0];a.style.color=m.orange;a.style.transition="color 0.2s ease-out 0s";setTimeout(function(){a.value=n;a.style.color=m.green;a.style.transition="color 0.2s ease-out 0s"},300);setTimeout(function(){a.style.color=m.default;a.style.transition="color 0.6s ease-out 0.3s"},500)};var D=function e(t){if(!t||!_.isObject(t))return;var i=t.event;if(!t.event)switch(s){case c.new_shared_channel_create:case c.new_shared_channel_invite:i=d.create_new_modal_action;break;case c.review_shared_channel_request:i=d.review_invite_modal_action;break;case c.share_existing_channel:i=d.share_existing_modal_action;break;default:break}if(!i)return;var n={event:i};t.element&&(n.element=t.element);t.contexts&&(n.contexts=t.contexts);TS.interop.clog.trackClickWithContext(n)};var F=function n(){TS.utility.disableElement(i.submit,r);var a=e.find("#free_trial_container");e.find(i.submit).wrap('<div id="scroll_and_flash"></div>');e.find("#scroll_and_flash").click(function(){document.getElementById("free_trial_container").scrollIntoView(true);setTimeout(function(){a.toggleClass("sk_white_bg")},400);setTimeout(function(){a.toggleClass("sk_white_bg")},850)});t.free_trial_checkbox=e.find("#free_trial_checkbox");e.find(t.free_trial_checkbox).change(function(){var t;e.find("#free_trial_checkbox_alert").toggleClass("hidden");TS.utility.disableElement(i.submit,!this.checked);if(this.checked){e.find("#scroll_and_flash").replaceWith(function(){return e.find(i.submit)});t="check"}else{e.find(i.submit).wrap('<div id="scroll_and_flash"></div>');e.find("#scroll_and_flash").click(function(){document.getElementById("free_trial_container").scrollIntoView(true);setTimeout(function(){a.toggleClass("sk_white_bg")},400);setTimeout(function(){a.toggleClass("sk_white_bg")},850)});t="uncheck"}TS.interop.clog.track("UPGRDEXP_FREE_TRIAL_FOR_SC",{contexts:{ui_context:{step:"shared_channels_invitation_modal",action:t,ui_element:"checkbox_confirm_free_trial"}}})});e.find(".shared_channels_help_content_text a").click(function(){TS.interop.clog.track("UPGRDEXP_FREE_TRIAL_FOR_SC",{contexts:{ui_context:{step:"shared_channels_invitation_modal",action:"click",ui_element:"link_help_center"}}})});TS.interop.clog.track("UPGRDEXP_FREE_TRIAL_FOR_SC",{contexts:{ui_context:{step:"shared_channels_invitation_modal",action:"impression"}}})};var O=function e(t){TS.interop.api.call("promocodes.campaigns.redeem",{type:"esc_trial"}).then(function(){b(t)}).catch(function(){a.stop();var e=TS.interop.i18n.t('<b>Couldn\u2019t start trial</b>. For some reason, Slack couldn\u2019t start a free trial for your workspace. You may want to <a href="https://slack.com/help/contact" target="_blank" data-clog-event="UPGRDEXP_FREE_TRIAL_FOR_SC" data-clog-ui-element="link_contact_help" data-clog-ui-action="click" data-clog-ui-step="shared_channels_invitation_modal">contact support</a>.',"shared_channels");y(e,{is_html:true});document.querySelectorAll("[data-label=shared_channel_form_error]")[0].scrollIntoView(true)})}})()},3075:function(e,t){(function(){TS.registerModule("ui.at_channel_warning_dialog",{$div:null,showing:false,onKeydown:function e(t){if(!TS.ui.at_channel_warning_dialog.showing)return;switch(t.which){case TS.utility.keymap.esc:TS.ui.at_channel_warning_dialog.cancel();break;case TS.utility.keymap.enter:t.preventDefault();TS.ui.at_channel_warning_dialog.go();break;default:break}},start:function i(n,a,r,s,o,l){TS.ui.at_channel_warning_dialog.$div||TS.ui.at_channel_warning_dialog.build();if(TS.ui.at_channel_warning_dialog.showing)return;var c=TS.ui.at_channel_warning_dialog.$div;e=o;t=n;var d=TS.format.cleanMsg(a);var u="";TS.interop.messages.atEveryoneRegExp.test(d)?u=TS.templates.builders.atLabel("everyone"):TS.interop.messages.atChannelRegExp.test(d)?u=TS.templates.builders.atLabel("channel"):TS.interop.messages.atGroupRegExp.test(d)&&(u=TS.templates.builders.atLabel("group"));if(r<TS.interop.constants.AT_CHANNEL_WARNING_MINIMUM_MEMBER_COUNT){TS.ui.at_channel_warning_dialog.go();return}var _=TS.templates.at_channel_warning_dialog({keyword:u,member_count:r,timezone_count:s});c.html(_);l?c.addClass("fullsize"):c.removeClass("fullsize");c.modal("show");TS.ui.a11y.saveCurrentFocusAndFocusOnElement(c);c.find(".dialog_cancel").click(TS.ui.at_channel_warning_dialog.cancel);c.find(".dialog_go").click(TS.ui.at_channel_warning_dialog.go);$(window).bind("resize",TS.ui.at_channel_warning_dialog.position);TS.ui.at_channel_warning_dialog.position();TS.prefs.setPrefByAPI({name:"last_seen_at_channel_warning",value:Date.now()})},startInMessagePane:function e(t,n){var a=TS.redux.channels.getEntityById(t);if(!a||a.is_im)return;var r=i(a);var s=function e(){TS.view.clearMessageInput();var i=void 0;var a=void 0;var r=false;TS.shared.legacySendMsg(t,n,i,a,r)};var o=TS.client.ui.$msg_input;var l=true;TS.client.msg_input.populate(n);r.then(function(e){TS.ui.at_channel_warning_dialog.start(o,n,e.member_count,e.timezone_count,s,l)})},startInFlexPane:function e(t,n,a){if(!t){TS.error("no file to warn about!");return}var r=function e(){var t=true;TS.client.ui.files.submitFileComment(t)};var s=$("#file_comment_form #file_comment");var o=false;var l=i(t);l.then(function(e){TS.ui.at_channel_warning_dialog.start(s,a,e.member_count,e.timezone_count,r,o)})},position:function e(){var i=TS.ui.at_channel_warning_dialog.$div;var n=t.offset();i.css({top:n.top-i.height()-8,left:n.left})},go:function t(){TS.ui.at_channel_warning_dialog.$div.modal("hide");e()},cancel:function e(){TS.ui.at_channel_warning_dialog.$div.modal("hide");TS.ui.a11y.restorePreviousFocus()},end:function e(){TS.model.dialog_is_showing=false;TS.ui.at_channel_warning_dialog.showing=false;$(window.document).unbind("keydown",TS.ui.at_channel_warning_dialog.onKeydown);$(window).unbind("resize",TS.ui.at_channel_warning_dialog.position)},build:function e(){$("body").append('<div id="at_channel_warning_dialog" class="modal hide fade"></div>');TS.ui.at_channel_warning_dialog.$div=$("#at_channel_warning_dialog");var t=TS.ui.at_channel_warning_dialog.$div;t.on("hide",function(e){if(e.target!=this)return;TS.ui.at_channel_warning_dialog.end()});t.on("show",function(e){if(e.target!=this)return;TS.model.dialog_is_showing=true;TS.ui.at_channel_warning_dialog.showing=true});t.on("shown",function(e){if(e.target!=this)return;setTimeout(function(){$(window.document).bind("keydown",TS.ui.at_channel_warning_dialog.onKeydown)},100)})}});var e=function e(){};var t;var i=function e(t){var i=false;var n="conversations.info";var a={timezone_count:true,display_counts:true,_x_reasons:"TS.ui.at_channel_warning_dialog._promiseToGetTimezoneCountAndMemberCountForObject"};if(t.is_group)a.channel=t.id;else if(t.is_channel){a.channel=t.id;a.no_members=true}else{i=true;n="files.info";a.file=t.id}return TS.interop.api.call(n,a).then(function(e){var t;var n;if(i){t=_.get(e,"data.display_counts.display_counts")||1;n=e.data.timezone_count}else{t=_.get(e,"data.channel.display_counts.display_counts")||1;n=e.data.channel.timezone_count}t-=1;return{member_count:t,timezone_count:n}}).catch(function(){return{member_count:0,timezone_count:1}})}})()},3076:function(e,t){(function(){TS.registerModule("client.archives",{current_model_ob:null,not_member:false,$scroller:$("#archive_msgs_scroller_div"),$archives_msgs_div:$("#archives_msgs_div"),msgs_are_auto_scrolling:false,active_highlight_count:0,msgs_scrolled_sig:new signals.Signal,onStart:function t(){TS.client.flexpane_display_switched_sig.add(x);TS.view.members.unknown_resolution_rebuild_sig.add(function(){if(!TS.model.archive_view_is_showing)return;var e=TS.shared.legacyGetActiveModelOb();p(e)});w();e=$()},start:function e(){},getCurrentModelOb:function e(){return TS.client.archives.current_model_ob},displayCrossWorkspaceAlertOrDeeplink:function e(t,i){return k(t,i)},maybeHandleArchiveLink:function e(t,i){if(!TS.client)return false;if(!t||!t.length)return false;if(!t.is("a"))return false;var n=t.prop("href");if(!n)return false;var a=TS.utility.normalizeDevHost(n);var r=TS.utility.getPathFromSlackUrl(a);var s=TS.utility.getTeamFromSlackUrl(a);if(!r)return;var o=-1!==a.indexOf("?")&&TS.interop.url.queryStringParse(a.split("?")[1]);if("1"===_.get(o,"force-browser"))return false;var l={messages:true,archives:true}[r[0]];if(l){if(r.length<2)return false;var c=decodeURIComponent(r[1]);if(!c)return false;var d=TS.redux.channels.getEntityById(c)||TS.ims.getImByUsername(c)||TS.redux.channels.getChannelByName(c);var u=!d||TS.interop.rules.channels.isNonExistent(d);var m=!d||TS.interop.rules.channels.isFromAnotherTeam(d);var f=TS.boot_data.page_needs_enterprise&&s!==TS.model.team.domain&&(u||m);if(f){var h=TS.redux.teams.getTeamByDomain(s);if(h&&h.discoverable){k(h,a,_.get(d,"name"));return true}TS.redux.teams.ensureEnterpriseTeamIsKnown({teamId:null,additionalOptions:{domain:s}}).then(function(e){_.get(e,"id")||TS.utility.openInNewTab(a,"_blank");h=e;k(h,a,_.get(d,"name"))}).catch(function(){TS.utility.openInNewTab(a,"_blank")});return true}if(!d&&!TS.boot_data.feature_deprecate_get_member_by_name){var p=TS.interop.members.getMemberByName(c);if(p){TS.ims.legacyStartImByMemberId(p.id);return true}}if(2==r.length||!r[2]){d.is_channel?TS.channels.legacyDisplayChannel({id:d.id}):d.is_mpim?TS.mpims.legacyDisplayMpim({id:d.id}):d.is_group?TS.groups.legacyDisplayGroup({id:d.id}):TS.ims.legacyStartImById(d.id);return d.id==TS.model.active_cid}var g=r[2];if(!g)return false;if(0!==g.indexOf("p"))return false;if(17!=g.length)return false;g=g.replace("p","");if(isNaN(g))return false;var T=g.substr(0,10)+"."+g.substr(10);var S;if(d.id==TS.model.active_cid&&t.hasClass("timestamp")&&(0!==t.closest("#msgs_div").length||0!==t.closest("#archives_msgs_div").length)){S=TS.templates.makeMsgDomId(T);if(0!==t.closest("#"+S).length)return true}var v;if(o&&o.thread_ts){!isNaN(o.thread_ts)&&-1===o.thread_ts.indexOf(".")&&o.thread_ts.length>10&&(o.thread_ts=o.thread_ts.substr(0,10)+"."+o.thread_ts.substr(10,6));/^\d+\.\d+$/.test(o.thread_ts)&&(v=o.thread_ts)}if(v&&v!==T){if(t.hasClass("timestamp")&&0!==t.closest("#convo_container").length){S=TS.templates.makeMsgDomIdInConversation(T);if(0!==t.closest("#"+S).length)return true}TS.ui.replies.openConversation(d,v,T,i);return true}return TS.client.ui.tryToJump(d.id,T,v)}return false},onMsgsScroll:function e(){if(!TS.model.archive_view_is_showing)return;TS.utility.throttle.method(y,"ts_archives_on_msgs_scroll",250)},legacyMaybeLoadScrollBackHistory:function e(){if(TS.client.archives.active_highlight_count||TS.model.ui.is_mouse_down)return;if(r!=a)return;if(i){TS.info("_scrolled_to_bottom _all_loaded_bottom:"+s);s||f()}else if(n){TS.info("_scrolled_to_top _all_loaded_top:"+o);o||m()}},loadMoreBottom:function e(){if(!TS.model.archive_view_is_showing)return;s||f()},loadMoreTop:function e(){if(!TS.model.archive_view_is_showing)return;o||m()},tryToJoin:function e(){if(!TS.model.archive_view_is_showing)return;if(!TS.client.archives.getCurrentModelOb())return;if(!TS.client.archives.getCurrentModelOb().is_channel)return;if(TS.client.archives.getCurrentModelOb().is_archived)return;$("#footer_archives_action_button").trigger("click")},userWantsToCancel:function e(){if(!TS.model.archive_view_is_showing)return;var t=TS.client.archives.getCurrentModelOb();if(t.is_group&&t.is_archived)TS.client.ui.maybePromptForClosingGroup(t.id);else{t.was_archived_this_session&&(t.was_archived_this_session=false);TS.client.archives.cancel()}},cancel:function e(t){if(!TS.model.archive_view_is_showing)return;var i=TS.client.archives.getCurrentModelOb();var n=(TS.client.archives.not_member||TS.interop.channels.isImWithDeletedMember(i))&&!t;b(n)},rebuildMsg:function e(t){if(!TS.model.archive_view_is_showing||!TS.client.archives.getCurrentModelOb())return;if(!t)return;var i=TS.client.archives.$archives_msgs_div.find("#"+TS.templates.makeMsgDomId(t.ts));if(!i.length)return;var n=TS.client.archives.getCurrentModelOb();var a=TS.utility.msgs.getPrevDisplayedMsg(t.ts,n._archive_msgs);var r=TS.templates.builders.msgs.buildHTML({msg:t,model_ob:n,prev_msg:a,container_id:"archives_msgs_div",enable_slack_action_links:false});i.replaceWith(r);TS.utility.makeSureAllExternalLinksAreRefererSafe(i)},adjustFooterForArchiveView:function e(t){TS.model.archive_view_is_showing=true;TS.client.archives.current_model_ob=t;$("#client-ui").addClass("archive_view_is_showing");TS.client.archives.not_member=t.is_channel&&(!t.is_member||t.is_archived)||t.is_group&&t.is_archived;p(t)},unAdjustFooterForArchiveView:function e(){TS.model.archive_view_is_showing=false;T();TS.client.archives.current_model_ob=null;$("#client-ui").removeClass("archive_view_is_showing")}});var e=null;var t=null;var i=false;var n=false;var a=0;var r=0;var s=null;var o=null;var l=false;var c=false;var d=false;var u=function e(){TS.metrics.mark("_displayMsgs");var t=TS.client.archives.getCurrentModelOb();if(!t)return;var i=t._archive_msgs;var n=TS.client.archives.$archives_msgs_div;n.empty();var a;var r;var l;var c=TS.boot_data.team_limit_ts>0;var d;if(t){l=TS.utility.msgs.getOlderMsgsStatus(t);d=l.is_limited||l.more}var u=[];var m;var f;var h="";var p=_.reject(i,TS.interop.rules.messages.isHidden);for(var g=p.length-1;g>-1;g-=1){m&&TS.interop.rules.messages.isHidden(m)||(f=m);m=p[g];if(TS.interop.rules.messages.isHidden(m))continue;var T=TS.utility.msgs.msgRollUpWorker(g,m,p,u);if("continue"===T){m=f;continue}if("swap"===T){m=u[0];u.length=0}if(!f||!TS.utility.msgs.areMsgsSameDay(m,f)){f&&(h+="</div></div>");h+='<div class="day_container">';h+=TS.templates.messages_day_divider({ts:m.ts});h+='<div class="day_msgs" data-date="'+TS.interop.datetime.toCalendarDate(m.ts)+'" data-ts="'+m.ts+'">'}h+=TS.templates.builders.msgs.buildHTML({msg:m,model_ob:t,prev_msg:f,container_id:"archives_msgs_div",enable_slack_action_links:false});0===g&&(h+="</div></div>")}n.html(h);TS.utility.makeSureAllExternalLinksAreRefererSafe(n);var S=!s;$("#archives_bottom_div").toggleClass("hidden",!S);$("#archives_return").toggleClass("hidden",!S);if(c&&o&&d&&!TS.interop.rules.channels.isYou(t)){var v=$("#archive_msg_lim_btn");$(".msg_lim_header_copy").addClass("hidden");if(t.is_im||t.is_mpim||TS.interop.rules.channels.isSlackbotOrTeambot(t,TS.boot_data.feature_teambot)){$(".msg_lim_dm_h1").removeClass("hidden");$(".msg_lim_dm_h2").removeClass("hidden")}else if(t.is_channel||t.is_group){var b=TS.templates.builders.makeChannelPrefix(t);$(".channel_name_msg_lim").html(b+t.name);$(".msg_lim_channel_h1").removeClass("hidden");$(".msg_lim_channel_h2").removeClass("hidden")}TS.interop.rules.channels.isSlackbotOrTeambot(t,TS.boot_data.feature_teambot)?r=35:t.is_mpim||t.is_im?r=33:(t.is_channel||t.is_group)&&(r=34);a=v.attr("href");a=TS.interop.url.setQueryStringValue(a,"ui_element",r);a=decodeURIComponent(a).substr(1);v.attr("href",a);v.data("data-clog-ui-element",r);$("#archives_end_div_msg_lim").removeClass("hidden");TS.interop.clog.track("GROWTH_PRICING",{contexts:{ui_context:{step:"history",action:"impression",ui_element:r}}})}else $("#archives_top_div").removeClass("hidden");TS.client.archives.msgs_are_auto_scrolling=true;y();TS.client.archives.msgs_are_auto_scrolling=false;TS.ui.utility.updateClosestMonkeyScroller(TS.client.archives.$scroller);A();(TS.boot_data.feature_tinyspeck||TS.utility.enableFeatureForUser(5))&&TS.metrics.measure("client_archives_display_msgs","_displayMsgs")};var m=function e(){c=true;v();var t=TS.client.archives.getCurrentModelOb();var i=t._archive_msgs[t._archive_msgs.length-1].ts;a+=1;var n={channel:t.id,latest:i,count:parseInt(TS.model.subsequent_msgs_cnt/2,10),_showing_id:d,ignore_replies:true,no_user_profile:true};var r=function e(t,i,n){if(!h(t,i,n))return;c=false;v();u()};TS.interop.api.callExpedited("conversations.history",n).then(function(e){var t=e.data,i=e.args,n=e.request_id;var a=true;r(a,t,i,n);return{data:t,args:i,request_id:n}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;r(a,t,i,n);return{data:t,args:i,request_id:n}})};var f=function e(){l=true;S();var t=TS.client.archives.getCurrentModelOb();var i=t._archive_msgs[0].ts;a+=1;var n={channel:t.id,oldest:i,count:parseInt(TS.model.subsequent_msgs_cnt/2,10),_showing_id:d,ignore_replies:true,no_user_profile:true};var r=function e(t,i,n){if(!h(t,i,n))return;l=false;S();u()};TS.interop.api.callExpedited("conversations.history",n).then(function(e){var t=e.data,i=e.args,n=e.request_id;var a=true;r(a,t,i,n);return{data:t,args:i,request_id:n}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;r(a,t,i,n);return{data:t,args:i,request_id:n}})};var h=function e(i,n,a){if(!TS.model.archive_view_is_showing)return false;if(a._showing_id!=d)return false;var l=TS.client.archives.getCurrentModelOb();var c=l._archive_msgs;var u=[];var _;var m=false;var f;var h;var p=c&&c.length?c[0]:"";p&&!TS.client.msg_pane.getDivForArchiveMsg(p.ts).length&&(p=null);if(n.messages)for(h=0;h<n.messages.length;h+=1){f=n.messages[h].ts;if(!c||!TS.utility.msgs.getMsg(f,c)){_=n.messages[h];u.push(TS.utility.msgs.processImsgFromHistory(_,l.id))}TS.client.archives.not_member||l.is_im||m||!TS.utility.msgs.getMsg(f,l.msgs)||(m=true)}l._archive_msgs=c?u.concat(c):u;if(m){u=[];for(h=0;h<l._archive_msgs.length;h+=1)if(!TS.utility.msgs.getMsg(l._archive_msgs[h].ts,l.msgs)){_=l._archive_msgs[h];u.push(_)}TS.utility.msgs.setMsgs(l,u.concat(l.msgs));var g;var T;p?T=TS.client.archives.$scroller.scrollTop():g=t;b(false);if(p)TS.client.ui.$msgs_scroller_div.scrollTop(T);else if(g){var w=TS.utility.msgs.getMsg(g,l.msgs);if(w&&TS.interop.messages.isReply(w)){TS.ui.replies.openConversation(l,w.thread_ts,w.ts);return false}if(!w){var y=TS.utility.msgs.getDisplayedMsgAfterTS(g,l.msgs);y&&y.ts&&(g=y.ts)}}return false}TS.utility.msgs.sortMsgs(l._archive_msgs);if(a.latest){o=!n.has_more;v()}else if(a.oldest){s=!n.has_more;S()}else{o=!n.has_more;v();s=true;S()}r+=1;return true};var p=function e(t){var i=t.is_channel?"#":"";var n="";t.is_channel?n='<ts-icon class="ts_icon_bold_hash_small"></ts-icon>':t.is_group&&(n='<ts-icon class="ts_icon_lock"></ts-icon>');var a="";a+=TS.templates.builders.maybeMakeSharedIcon(t);a=TS.interop.i18n.safeString(a);$("#footer_archives_action_button").addClass("btn_outline");var r;var s=TS.interop.channels.isImWithDeletedMember(t);var o=false;if(s){r=TS.interop.members.getMemberById(_.get(t,"user"));o=r&&s&&_.get(r,"is_app_user")}if(TS.client.archives.not_member||s){var l;var c;$("#footer_msgs").addClass("hidden");$("#footer").css("height","auto");$("#footer_archives").removeClass("hidden no_tip");$("#footer_archives_table").removeClass("p-app_user_archive");if(t.is_archived&&!t.is_im){l=1===t.is_moved?TS.interop.i18n.t("You are viewing <strong>{hash}{channel_name}{shared}</strong>, a moved channel","archives")({hash:TS.interop.i18n.safeString(n),channel_name:TS.interop.i18n.safeString(_.escape(TS.utility.ellipsize(t.name,25))),shared:a}):TS.interop.i18n.t("You are viewing <strong>{hash}{channel_name}{shared}</strong>, an archived channel","archives")({hash:TS.interop.i18n.safeString(n),channel_name:TS.interop.i18n.safeString(_.escape(TS.utility.ellipsize(t.name,25))),shared:a});c=TS.interop.i18n.t('<strong aria-label="return">Esc</strong> to close',"archives")();$("#footer_archives_text").html(l);$("#footer_archives_action_button").text(TS.interop.i18n.t("Close Channel","archives")());$("#footer_archives_action_tip").html('<span class="tiny dialog_cancel_hint">'+c+"</span>")}else if(o){l=TS.interop.i18n.t("You are viewing messages from {app_name} which has been removed from your workspace.","archives")({app_name:TS.interop.i18n.safeString(_.escape(_.get(r,"profile.real_name")))});c=TS.interop.i18n.t('<strong aria-label="return">Esc</strong> to close',"archives")();$("#footer_archives_text").html(l);$("#footer_archives_table").addClass("p-app_user_archive");$("#footer_archives_action_button").text(TS.interop.i18n.t("Close Channel","archives")());$("#footer_archives_action_tip").html('<span class="tiny dialog_cancel_hint">'+c+"</span>")}else if(s){l=TS.interop.i18n.t('<ts-icon class="ts_icon_archive"></ts-icon> You are viewing the archives of a deactivated account',"archives")();$("#footer_archives").addClass("no_tip");$("#footer_archives_text").html(l);$("#footer_archives_action_button").text(TS.interop.i18n.t("Close","archives")());$("#footer_archives_action_tip").html("")}else{l=TS.interop.i18n.t("You are viewing <strong>{hash}{channel_name}{shared}</strong>","archives")({hash:TS.interop.i18n.safeString(n),channel_name:TS.interop.i18n.safeString(_.escape(TS.utility.ellipsize(t.name,25))),shared:a});var d="";if(t.creator===TS.model.user.id)d=TS.interop.i18n.t("Created by you on {created_at, date, long}","archives")({created_at:1e3*t.created});else{var u=g(t);d=TS.interop.i18n.t("Created by {name} on {created_at, date, long}","archives")({name:TS.interop.i18n.safeString(u),created_at:1e3*t.created})}$("#footer_archives").addClass("hidden");$("#footer_archives_preview").removeClass("hidden").html(TS.templates.footer_archives_preview({message:new Handlebars.SafeString(l),metadata:new Handlebars.SafeString(d),hide_more_details:TS.model.ui_state.flex_visible&&"details"===TS.model.ui.active_tab_id}))}TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,"")}else TS.utility.contenteditable.placeholder(TS.client.ui.$msg_input,TS.interop.i18n.t("You are viewing the archives of {hash}{channel_name}","archives")({hash:i,channel_name:t.name}))};var g=function e(t){var i=TS.redux.members.getPotentiallyUnknownMemberById(t.creator);if(i&&i.is_unknown)return new Handlebars.SafeString(TS.templates.unknown_member({id:i.id}));if(i&&TS.interop.members.isExternal(i)&&TS.teams.getTeamById(i.team_id))return TS.interop.i18n.t("{creator_name} from {team_name}","channel_pages")({creator_name:TS.interop.i18n.safeString(_.escape(TS.interop.members.getPrefCompliantMemberName(i))),team_name:TS.interop.i18n.safeString(_.escape(TS.teams.getTeamNameById(i.team_id)))});if(i)return _.escape(TS.interop.members.getPrefCompliantMemberName(i));return TS.interop.i18n.t("unknown","channel_pages")()};var T=function e(){$("#footer_msgs").removeClass("hidden");$("#footer").css("height","");$("#footer_archives_table").removeClass("p-app_user_archive");$("#footer_archives").addClass("hidden");$("#footer_archives_preview").addClass("hidden");$("#archives_bottom_div").addClass("hidden");$("#archives_top_div").addClass("hidden");$("#archives_return").addClass("hidden").removeClass("warning");TS.client.archives.$scroller.addClass("hidden");TS.client.msg_input.setPlaceholder();TS.ui.utility.updateClosestMonkeyScroller(TS.client.ui.$msgs_scroller_div)};var S=function e(){var i;i=l?TS.interop.i18n.t("retrieving history...","archives")():s?t?"&nbsp;":"":'<a onclick="TS.client.archives.loadMoreBottom()">'+TS.interop.i18n.t("and more...","archives")()+"</a>";$("#archives_bottom_div").html(i)};var v=function e(){var t;t=c?TS.interop.i18n.t("retrieving history...","archives")():o?TS.interop.i18n.t("~FIN~","archives")():'<a onclick="TS.client.archives.loadMoreTop()">'+TS.interop.i18n.t("and more...","archives")()+"</a>";$("#archives_top_div").html(t)};var b=function i(n){if(!TS.model.archive_view_is_showing)return;var a=TS.interop.redux.features.messagePane.getPrevChannelId(TS.redux.getState());var r=void 0;a&&(r=TS.interop.channels.getEntityById(a));r&&!TS.interop.rules.channels.isArchived(r)||(r=TS.interop.channels.getGeneralChannel()||TS.redux.channels.getImByMemberId("USLACKBOT"));TS.client.archives.$archives_msgs_div.empty();TS.ui.utility.updateClosestMonkeyScroller(TS.client.archives.$scroller);e.addClass("hidden");TS.client.archives.getCurrentModelOb()&&(TS.client.archives.getCurrentModelOb()._archive_msgs=void 0);t=null;TS.client.archives.current_model_ob=null;TS.model.archive_view_is_showing=false;$("#client-ui").removeClass("archive_view_is_showing");T();TS.view.resizeManually("TS.client.archives ended");if(n){var s=r;s.is_channel?TS.channels.legacyDisplayChannel({id:s.id}):s.is_mpim?TS.mpims.legacyDisplayMpim({id:s.id}):s.is_group?TS.groups.legacyDisplayGroup({id:s.id}):TS.ims.legacyStartImById(s.id)}};var w=function e(){$("#footer").on("click","[data-js=join_channel]",function(){if(TS.isPartiallyBooted()){TS.incremental_boot.userDidInteractWithUI();return}var e=TS.client.archives.getCurrentModelOb();if(e.is_channel)e.is_archived?TS.shared.legacyCloseArchivedChannel(e.id):TS.redux.dispatch(TS.interop.channels.joinConversationApi({channelId:e.id})).catch(_.noop).finally(function(){TS.client.msg_pane.maybeSetupCalls()});else if(e.is_im){TS.redux.dispatch(TS.interop.channels.closeChannelApi({channelId:e.id}));b(true)}else TS.shared.legacyCloseArchivedChannel(e.id)});$("#footer").on("click","[data-js=see_more_details]",function(){TS.client.ui.flex.openFlexTab("details");TS.client.channel_page.showAboutSection();var e=TS.shared.legacyGetActiveModelOb().id;TS.interop.clog.track("CHANNEL_SEE_MORE_DETAILS_BUTTON_CLICK",{channel_id:e,channel_type:e.charAt(0)})});TS.client.archives.$scroller.scroll(function(){TS.client.archives.onMsgsScroll()});$("#archives_return .archives_return__link-column__link").bind("click",function(){if(TS.client.archives.not_member){if(!s){b();TS.client.archives.start()}}else b()});TS.client.ui.$msg_input.bind("textchange",function(){if(!TS.model.archive_view_is_showing)return;if(TS.client.archives.not_member)return;var e=$(this);""===e.val()?$("#archives_return").removeClass("warning"):$("#archives_return").addClass("warning")})};var y=function e(){if(!TS.model.archive_view_is_showing)return;TS.client.archives.msgs_scrolled_sig.dispatch();var t;n=false;i=false;if(TS.client.ui.areMsgsScrolledToBottom(0)){t=-1;i=true}else{t=TS.client.archives.$scroller[0].scrollTop;0===t&&(n=true)}var a=TS.client.ui.areMsgsScrolledToBottom(50);$("#archives_return").find(".cancel_archives").toggleClass("hidden",!!a&&s);if(TS.client.archives.msgs_are_auto_scrolling)return;TS.client.ui.checkInlineImgsAndIframes("archives");TS.client.archives.legacyMaybeLoadScrollBackHistory()};var A=function e(){var t=TS.client.archives.$scroller.find(".message");var i=[];if(t.length){var n={shortenMonth:true};i.push(TS.interop.datetime.toCalendarDate(t.eq(0).data("ts"),n));if(t.length>1){var a=TS.interop.datetime.toCalendarDate(t.eq(t.length-1).data("ts"),n);a!=i[0]&&i.push(a)}$("#archives_return_date").text(i.join(" - "))}};var k=function e(t,i,n){if(!t)return TS.utility.openInNewTab(i,"_blank");var a=TS.interop.members.isMemberOnTeam(TS.model.user,t.id);var r=TS.model.user.is_restricted||TS.model.user.is_ultra_restricted;var s;var o;var l;var c=TS.templates.team_icon({team:t,size:20,classes:"small_right_margin"});var d=_.escape(n);var u=_.escape(_.get(t,"name"));if(a){if(TS.model.is_our_app){var m=t.id;var f=TS.interop.desktop.getSignedInTeamIds();var h=_.includes(f,m);var p=h?Promise.resolve():TS.client.userAddedToTeam(m);p.then(function(){return C(i,m)})}else TS.utility.openInNewTab(i,"_blank");return}if(t.is_closed&&!r)if(t.has_join_request){o=TS.interop.i18n.t("Your request to join the <strong>{workspace}</strong> workspace is pending. You\u2019ll receive a message from Slackbot when your request has been approved.","archives")({workspace:TS.interop.i18n.safeString(u)});l=TS.interop.i18n.t("{image} Request sent","archives")({image:TS.interop.i18n.safeString(c)});s={title:'<span class="display_flex align_items_center">'+l+"</span>",body:"<p>"+o+"</p>",show_cancel_button:false,show_close_button:true,go_button_text:TS.interop.i18n.t("Got it","archives")()}}else{o=n?TS.interop.i18n.t("This message was posted in {channel} in the <strong>{workspace}</strong> workspace. To view this message, you\u2019ll need to request to join that workspace.","archives")({channel:TS.interop.i18n.safeString(d),workspace:TS.interop.i18n.safeString(u)}):TS.interop.i18n.t("This message was posted in the <strong>{workspace}</strong> workspace. To view this message, you\u2019ll need to request to join that workspace.","archives")({workspace:TS.interop.i18n.safeString(u)});l=TS.interop.i18n.t("{image} Request to join {workspace}?","archives")({image:TS.interop.i18n.safeString(c),workspace:TS.interop.i18n.safeString(u)});s={title:'<span class="display_flex align_items_center">'+l+"</span>",body:"<p>"+o+"</p>",go_button_text:TS.interop.i18n.t("Request to Join","archives")(),onGo:function e(){var n=TS.utility.getPathFromSlackUrl(i);var a=decodeURIComponent(n[1]);var r=n[2]&&n[2].replace("p","").replace(/(\d{10})(\d{6})/,"$1.$2");var s={link_channel_id:a,link_message_ts:r};TS.enterprise.workspaces.requestToJoinTeam(t.id,s).then(function(){var e=20;var t=TS.model.ui_state.flex_visible?20:$("#footer").height()+20;var i=TS.interop.i18n.t("Request to join {workspace} sent!","archives")({workspace:TS.interop.i18n.safeString(u)});var n={children:i,offsetX:e,offsetY:t};TS.interop.mountToast(n)})}}}else if(t.is_open&&!r){o=n?TS.interop.i18n.t("This message was posted in {channel} in the <strong>{workspace}</strong> workspace. To view this message, you\u2019ll need to join that workspace.","archives")({channel:TS.interop.i18n.safeString(d),workspace:TS.interop.i18n.safeString(u)}):TS.interop.i18n.t("This message was posted in the <strong>{workspace}</strong> workspace. To view this message, you\u2019ll need to join that workspace.","archives")({workspace:TS.interop.i18n.safeString(u)});l=TS.interop.i18n.t("{image} Join {workspace}?","archives")({image:TS.interop.i18n.safeString(c),workspace:TS.interop.i18n.safeString(u)});s={title:'<span class="display_flex align_items_center">'+l+"</span>",body:"<p>"+o+"</p>",show_close_button:true,go_button_text:TS.interop.i18n.t("Join Workspace","archives")(),onGo:function e(){TS.enterprise.workspaces.joinTeam(t.id).then(function(){if(TS.model.is_our_app){C(i,t.id);return}TS.utility.openInNewTab(i,"_blank")})}}}else{o=TS.interop.i18n.t("This message may be from a workspace you\u2019re not a member of, or it may have been deleted.","archives")();s={title:TS.interop.i18n.t("Can\u2019t view message","archives")(),body:"<p>"+o+"</p>",show_close_button:true,show_cancel_button:false,go_button_text:TS.interop.i18n.t("Got it","archives")()}}TS.generic_dialog.start(s)};var C=function e(t,i){var n=-1!==t.indexOf("?")&&TS.interop.url.queryStringParse(t.split("?")[1]);var a=TS.utility.getPathFromSlackUrl(t);var r=decodeURIComponent(a[1]);var s=a[2]&&a[2].replace("p","").replace(/(\d{10})(\d{6})/,"$1.$2");var o=n&&n.thread_ts;var l={team:i,id:r};s&&(l.message=s);o&&(l.thread_ts=o);var c="slack://channel"+TS.interop.url.queryStringEncode(l);var d=document.createElement("iframe");d.src=c;document.body.appendChild(d);setTimeout(function(){d.remove()},1e3)};var x=function e(){if(!TS.client||!TS.model.archive_view_is_showing)return;!TS.model.ui_state.flex_visible&&"details"===TS.model.ui_state.prev_flex_name||TS.model.ui_state.flex_visible&&"details"===TS.model.ui_state.prev_flex_name&&"details"!==TS.model.ui_state.flex_name?$(".c-archive_footer__see_more").removeClass("hidden"):TS.model.ui_state.flex_visible&&"details"===TS.model.ui_state.flex_name&&$(".c-archive_footer__see_more").addClass("hidden")}})()},3077:function(e,t){(function(){TS.registerModule("client.channel_page",{onStart:function e(){A=new TS.PresenceList;TS.client.login_sig.add(H);TS.client.flexpane_display_switched_sig.add(K);TS.redux.socket.connectedSig.add(W);TS.channels.data_updated_sig.add(z);TS.channels.switched_sig.add(V);TS.channels.purpose_changed_sig.add(Y);TS.channels.member_left_sig.add(te);TS.channels.member_joined_sig.add(ee);TS.channels.renamed_sig.add(J);TS.channels.left_sig.add(ue);TS.channels.joined_sig.add(_e);TS.channels.topic_changed_sig.add(Y);TS.channels.converted_to_shared_sig.add(Y);TS.channels.shared_teams_updated_sig.add(Y);TS.channels.unshared_sig.add(Y);TS.channels.shared_invite_pending_sig.add(Y);TS.groups.switched_sig.add(V);TS.groups.member_left_sig.add(X);TS.groups.member_joined_sig.add(Z);TS.groups.converted_to_shared_sig.add(Y);TS.groups.shared_teams_updated_sig.add(Y);TS.ims.switched_sig.add(V);TS.mpims.switched_sig.add(V);TS.members.presence_changed_sig.add(ie);TS.members.changed_name_sig.add(ne);TS.members.changed_profile_sig.add(ne);TS.members.changed_current_status_sig.add(ne);TS.members.changed_account_type_sig.add(ne);TS.members.changed_deleted_sig.add(ae);TS.view.members.unknown_resolution_rebuild_sig.add(ne);TS.view.members.unknown_resolution_rebuild_sig.add(function(){if(!me())return;var e=TS.shared.legacyGetActiveModelOb();we(e)});TS.membership.membership_counts_need_refetch_sig.add(he);TS.prefs.display_real_names_override_changed_sig.add(re);TS.prefs.team_display_real_names_changed_sig.add(re);TS.prefs.push_changed_sig.add(q);TS.prefs.dtop_notif_changed_sig.add(q);TS.prefs.team_perms_pref_changed_sig.add(q);TS.prefs.muted_channels_changed_sig.add(q);TS.ui.growls.permission_changed_sig.add(q);TS.files.channel_files_fetched_sig.add(se);TS.files.team_file_added_sig.add(oe);TS.files.team_file_deleted_sig.add(oe);TS.files.team_file_changed_sig.add(le);TS.files.team_file_comment_edited_sig.add(ce);TS.pins.pinned_status_changed_sig.add(de);TS.pins.pinned_message_changed_sig.add(de);TS.pins.pinned_message_deleted_sig.add(de);TS.pins.pins_fetched_sig.add(de);TS.view.members.unknown_resolution_rebuild_sig.add(function(){if(!me())return;Ce(TS.shared.legacyGetActiveModelOb())});TS.view.channel.unknown_resolution_rebuild_sig.add(function(){if(!me())return;Y(TS.shared.legacyGetActiveModelOb());Ce(TS.shared.legacyGetActiveModelOb())});TS.teams.unknown_resolution_rebuild_sig.add(function(){if(!me())return;Y(TS.shared.legacyGetActiveModelOb())});TS.apps.permissions.xoxa_apps_installed_sig.add(function(){if(!me())return;pe()});TS.client.channel_page.initUI();F();TS.view.resize_sig.add(xe)},initUI:function _(){T=TS.storage.fetchChannelPageState();T&&T instanceof Object||(T={});T.expanded_sections||(T.expanded_sections={about:false,highlights:false,pinned_items:false,members:false,shared_files:false,notif_prefs:false,apps:false});S=T.expanded_sections;e=$("#details_tab");e.append(TS.templates.channel_page_empty_state({state:T}));t=e.find("#channel_page_scroller");s=e.find(".conversation_details");i=e.find(".channel_page_about .section_content.channel_purpose");n=e.find(".channel_page_pinned_items .section_content.pinned_items");a=e.find(".channel_page_member_tabs");r=e.find(".channel_page_member_lists");o=e.find(".channel_page_shared_files .section_content");l=e.find(".channel_page_notif_prefs .section_content");c=e.find(".channel_page_notif_prefs .channel_page_notif_prefs_mute_state");m=e.find('[data-js="channel_page_apps_list"]');d=e.find('[data-js="sli_channel_highlights_section"]');u=e.find(".channel_page_highlights");$(".channel_page_shared_files").on("focus",".file_actions",function(){$(this).closest(".actions").addClass("focused")});$(".channel_page_shared_files").on("blur",".file_actions",function(){$(this).closest(".actions").removeClass("focused")})},showAboutSection:function e(){S.about||R("about");t.find(".channel_page_about").scrollintoview({offset:"top",px_offset:50})},showPinsSection:function e(){S.members&&R("members");S.apps&&R("apps");S.shared_files&&R("shared_files");S.highlights&&R("highlights");S.pinned_items||R("pinned_items");t.find(".channel_page_pinned_items").scrollintoview({offset:"top",px_offset:50})},showMembersSection:function e(){S.apps&&R("apps");S.pinned_items&&R("pinned_items");S.shared_files&&R("shared_files");S.highlights&&R("highlights");S.members||R("members");t.find(".channel_page_members").scrollintoview({offset:"top",px_offset:50})},showMemberSectionAndHighlight:function e(){TS.client.ui.flex.openFlexTab("details");TS.client.channel_page.showMembersSection();$("#channel_page_scroller .channel_page_members").highlight(null,"channel_page_members_highlighter")},showFilesSection:function e(){S.members&&R("members");S.apps&&R("apps");S.pinned_items&&R("pinned_items");S.highlights&&R("highlights");S.shared_files||R("shared_files");t.find(".channel_page_shared_files").scrollintoview({offset:"top",px_offset_:50})},showNotifPrefsSection:function e(){S.notif_prefs||R("notif_prefs");t.find(".channel_page_notif_prefs").scrollintoview({offset:"top",px_offset_:50})},showAppsSection:function e(){S.members&&R("members");S.pinned_items&&R("pinned_items");S.highlights&&R("highlights");S.shared_files&&R("shared_files");S.apps||R("apps");t.find('[data-js="channel_page_apps"]').scrollintoview({offset:"top",px_offset_:50})},showHighlightsSection:function e(){S.members&&R("members");S.pinned_items&&R("pinned_items");S.shared_files&&R("shared_files");S.apps&&R("apps");S.highlights||R("highlights")},pinnedItemHtml:function e(t,i){try{var n={item:t,model_ob:i,can_remove:TS.pins.canUserPinHere(i)};if("message"===t.type){var a=t.message;var r=TS.redux.members.getPotentiallyUnknownMemberById(a.user);var s=TS.utility.msgs.shouldHaveBotLabel(a,r);var o;var l;if(s){var c=TS.interop.bots.getBotInfoByMsg(a);if(c){o=c.appId;l=c.botId}}n.is_message=true;n.member=r;n.permalink=TS.utility.msgs.constructMsgPermalink(i,t.message.ts,t.message.thread_ts);n.is_bot=s;n.is_reply=a.thread_ts&&a.thread_ts!=a.ts;n.is_broadcast="thread_broadcast"===a.subtype;n.app_id=o;n.bot_id=l;n.render_file_thread=TS.interop.messages.shouldRenderFileThread(a);n.files=TS.utility.msgs.getFilesOnMsg(a)}else"file"===t.type?n.is_file=true:"file_comment"===t.type&&(n.is_comment=true);return TS.templates.channel_page_pinned_item(n)}catch(e){TS.info("Problem in pinnedItemHtml:"+e);return""}},clearUnreadPinState:function e(){$(".pinned_item").removeClass("unread_pin")},highlightPinnedItemForRemoval:function e(t){var i=Ze(t);i.addClass("delete_mode")},unHighlightPinnedItemForRemoval:function e(t){var i=Ze(t);i.removeClass("delete_mode")},isPurposeTooLong:function e(t){return TS.utility.contenteditable.getDisplayValueLength(t)>TS.model.channel_purpose_max_length},updatePurposeTooLongWarning:function e(t){var i=TS.client.channel_page.isPurposeTooLong(t);var n=TS.interop.i18n.t("This field can\u2019t be more than {max_length, plural, =1{# character}other{# characters}} ({current_length}/{max_length}).","ui_validation")({current_length:TS.utility.contenteditable.getDisplayValueLength(t),max_length:TS.model.channel_purpose_max_length});var a=$(t).parent().find(".too_long_warning");a.toggleClass("hidden",!i);a.text(n);return!i},handleAppChannelMembershipChange:function e(t){if(!me())return;if(!fe(t))return;Ee(t);He(t)},handleAppWildcardChange:function e(){if(!me())return;var t=TS.shared.legacyGetActiveModelOb();if(!TS.interop.rules.channels.isPublicChannel(t))return;Ee(t);He(t)},test:function e(){var t={initEvents:F,rebuildChannelPage:pe,rebuildChannelDetails:we,rebuildPinnedItems:Ce,rebuildMembersTabs:Ee,rebuildMemberLists:$e,silentlyRebuildMemberLists:Fe,generateMemberListTemplateArgs:Ue,SEE_ALL_MEMBERS_DIALOG_THRESHOLD:x,MAX_SIDEBAR_MEMBERS_COUNT:I};Object.defineProperty(t,"_will_rebuild_count_templates_after_promise_resolves",{get:function e(){return Me},set:function e(t){Me=t}});Object.defineProperty(t,"_expanded_sections",{get:function e(){return S},set:function e(t){S=t}});Object.defineProperty(t,"_renderMemberList",{get:function e(){return De},set:function e(t){De=t}});return t}});var e;var t;var i;var n;var a;var r;var s;var o;var l;var c;var d;var u;var m;var f=false;var h=false;var p=false;var g;var T;var S={};var v=[];var b={};var w={};var y=10;var A;var k;var C;var x=50;var I=20;var M=10;var E=5;var B=x;var P=6e4;var U=2e4;var D="APP_CHANNEL_DETAIL_LIST";var F=function n(){e.on("click",".invite_link",function(){var e=TS.shared.legacyGetActiveModelOb();TS.ui.channel_invite_modal.startInviteToChannelModal(e.id)});e.on("click",".find_files_link",function(){var e=TS.shared.legacyGetActiveModelOb();TS.search.setInputVal("in:"+(e.is_channel&&!e.is_private?"#":"")+e.name);TS.search.setFilter("files");TS.search.submitSearch()});e.on("click",".leave_link",function(){var e=TS.shared.legacyGetActiveModelOb();(e.is_channel||e.is_group)&&TS.channels.leave(e.id)});e.on("click",".member_preview_link[data-member-id]",function(e){e.preventDefault();var t=$(this).data("member-id");TS.menu.member.startWithMember(e,t)});e.on("click",".section_header",function(e){var t=$(e.target).closest("[data-section-name]");var i=t.data("section-name");if(!i)return;if("members"===i&&!S.members)return TS.client.channel_page.showMembersSection();if("pinned_items"===i&&!S.pinned_items)return TS.client.channel_page.showPinsSection();if("shared_files"===i&&!S.shared_files)return TS.client.channel_page.showFilesSection();if("highlights"===i&&!S.highlights)return TS.client.channel_page.showHighlightsSection();if("apps"===i&&!S.apps){TS.interop.clog.track(D,{contexts:{ui_context:{action:S.apps?"COLLAPSE":"EXPAND"},core:{channel_id:TS.shared.legacyGetActiveModelOb().id}}});return TS.client.channel_page.showAppsSection()}if("notif_prefs"===i&&!S.notif_prefs)return TS.client.channel_page.showNotifPrefsSection();R(i)});e.on("click keydown",".edit_purpose, .purpose_cancel",function(e){var t=TS.shared.legacyGetActiveModelOb();if(!TS.permissions.members.canPostInModelOb(t))return;"click"===e.type?N():e.which==TS.utility.keymap.enter&&N()});e.on("click keydown",".purpose_done",function(e){if("click"===e.type)L();else{e.which==TS.utility.keymap.enter&&L();if(e.which==TS.utility.keymap.tab){e.preventDefault();e.stopImmediatePropagation();i.find(".purpose_cancel").focus()}}});e.on("click","[data-app-user-id]",function(e){var t=$(e.currentTarget);var i=t.data("app-user-id");var n=TS.interop.members.getMemberById(i);if(n)if($(e.target).is('[data-action="remove_app"]')){var a=Ve("BTN_REMOVE_APP",n);var r=TS.shared.legacyGetActiveModelOb();n.is_app_user?TS.interop.removeAppFromChannel({appUserId:n.id,channelId:r.id,referringEventId:D,referringUiContext:a}):TS.shared.legacyKickMember(r,n.id)}else{Ve("BTN_APP_NAME",n);var s=_.get(n,"profile.bot_id");if(s){var o=TS.interop.bots.getTeamIdFromBotAppUser(n,TS.boot_data.team_id);TS.interop.apps.openAppProfileCard(s,o,i,t[0],{position:"left-bottom",offsetX:0})}}});e.on("click",'[data-js="channel_page_apps_add"]',function(){var e=Ve("BTN_ADD_APPS");TS.ui.apps_browser.startAddApps(D,e)});e.on("click",".pinned_item .remove_pin",function(e){var t=TS.shared.legacyGetActiveModelOb();var i=$(this).closest(".pinned_item");var n=i.data("ts");var a=i.data("comment-id");var r=i.data("file-id");var s=i.data("type");"message"===s?TS.pins.unPinMessage(n.toString(),t):"file"===s?TS.pins.unPinFile(r,t):"file_comment"===s&&TS.pins.unPinFileComment(a,r,t);e.preventDefault()});e.on("click",".pinned_item .pin_metadata",function(e){TS.client.archives.maybeHandleArchiveLink($(this))&&e.preventDefault()});e.on("click",".pinned_item",function(e){if(e.isDefaultPrevented()||$(e.target).is("a"))return;if($(e.target).closest(".pinned_message_file").length>0)return;e.preventDefault();var t=$(this).data("type");var i=TS.shared.legacyGetActiveModelOb();var n=$(this).attr("data-ts");var a=$(this).data("file-id");var r=$(this).attr("data-thread-ts");var s=$(this).data("is-broadcast");var o="channel_page";i.is_im||i.is_mpim?o="im_page":i.is_group&&(o="group_page");"message"===t?r&&r!=n&&!s?TS.ui.replies.openConversation(i,r,n,o):TS.view.displayMsgInModelOb(i,n):"file"!==t&&"file_comment"!==t||TS.client.ui.files.previewFile(a,o)});e.on("click",".view_all_files_link",function(){TS.interop.searchActions.openFromFilesMenu()});e.on("click",".edit_notif_prefs_btn",function(){var e=TS.shared.legacyGetActiveModelOb();TS.ui.channel_prefs_dialog.start(e.id)});e.on("click",".add_someone",function(e){e.preventDefault();var t=TS.shared.legacyGetActiveModelOb();var i=TS.interop.rules.channels.isPublicChannel(t)||TS.interop.rules.channels.isPrivateChannel(t);i?TS.ui.channel_invite_modal.startInviteToChannelModal(t.id):TS.interop.rules.channels.isMpim(t)&&TS.ui.im_browser.startWithMpim(t)});e.on("click",".creator_link",function(e){var t=TS.shared.legacyGetActiveModelOb();var i=t.created;e.preventDefault();O(i,t)});$(".channel_page_section").delegate(".p-channel_insights__channel .channel_link","click",function(e){var t=$(e.target).closest(".channel_link");var i=TS.client.ui.channel_insights.last_highlights_response.channel;var n=t.data("channel-id");var a={channel_id:i,channel_type:i[0]||"",click_channel_id:n,click_channel_type:n[0]||"",request_id:TS.client.ui.channel_insights.last_highlights_response.response.request_id};TS.interop.clog.track("CHANNEL_INSIGHTS_RELATED_CHANNELS_CLICK",a)});$(".channel_page_section").delegate(".p-channel_insights .c-unified_member__display-name","click",function(e){var t=$(e.target).closest(".c-unified_member");var i=t.data("member-id");var n=TS.client.ui.channel_insights.last_highlights_response.channel;var a={channel_id:n,channel_type:n[0]||"",click_target_user_id:i,request_id:TS.client.ui.channel_insights.last_highlights_response.response.request_id};TS.interop.clog.track("CHANNEL_INSIGHTS_MOST_ACTIVE_USER_CLICK",a)});t.on("scroll",_.debounce(function(){if(!me())return;k=t.scrollTop()},100))};var O=function e(t,i){var n={channel:i.id,oldest:t,count:1,inclusive:1,ignore_replies:true,include_pin_count:true,no_user_profile:true};TS.interop.api.call("conversations.history",n).then(function(e){var t=_.get(e,"data.messages[0].ts");t&&TS.client.ui.tryToJump(i.id,t)}).catch(function(){return TS.warn("Couldn\u2019t find creation message at "+t+" in channel: "+i.id)})};var R=function e(i){var n=TS.shared.legacyGetActiveModelOb();var a=t.find('.channel_page_section[data-section-name="'+i+'"]');if(0===a.length)return;if(S[i]){S[i]=false;"about"===i&&ve(n);"pinned_items"===i&&Ie();"members"===i&&Re();"shared_files"===i&&Ge(n);"notif_prefs"===i&&ke();"apps"===i&&je();"highlights"===i&&dt();a.removeClass("expanded")}else{S[i]=true;a.addClass("expanded");"about"===i&&we(n);"about"===i&&(n.is_im||n.is_mpim)&&Se(n);"pinned_items"===i&&Ce(n);"members"===i&&$e(n);"shared_files"===i&&Le(n);"notif_prefs"===i&&Ae(n);"apps"===i&&He(n);"highlights"===i&&_t(n)}TS.storage.storeChannelPageState(T);TS.ui.utility.updateClosestMonkeyScroller(t);Je()};var N=function e(){i.find(".edit_purpose_label, #channel_purpose_input, .purpose_done, .purpose_cancel, .purpose_label, .channel_purpose_guidance, .channel_purpose_section .channel_purpose_text").toggleClass("hidden");var t=i.find("#channel_purpose_input");if(i.find("#channel_purpose_input").hasClass("hidden")){$("#channel_purpose_input + .too_long_warning").addClass("hidden");TS.utility.contenteditable.blur(t);i.find(".purpose_done, .purpose_cancel").blur()}else{var n=TS.shared.legacyGetActiveModelOb();TS.utility.contenteditable.value(t,TS.utility.unformatTopicOrPurpose(n.purpose.value));TS.utility.contenteditable.focus(t)}};var L=function e(){var t=TS.shared.legacyGetActiveModelOb();var n=i.find("#channel_purpose_input");var a=_.trim(TS.utility.contenteditable.value(n));a=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(a,{enableBroadcastKeywords:false});if(TS.client.channel_page.isPurposeTooLong(n))return;if(t.purpose.value===a){N();return}(t.is_channel||t.is_group)&&TS.redux.dispatch(TS.interop.channels.submitChannelPurpose({channelId:t.id,purpose:a})).then(TS.channels.legacyUpdatePurposeFromAPI).catch(TS.channels.legacyAlertSetPurposeError);N()};var G=function e(t){var i=TS.shared.legacyGetActiveModelOb();var n=t.channels;i.is_group?n=t.groups:i.is_im&&(n=t.ims);return-1!==n.indexOf(i.id)};var H=function e(){f=true};var Q=function e(){C&&clearInterval(C)};var j=function e(){Q();C=setInterval(Oe,P)};var K=function e(t){var i=TS.model.ui_state.flex_name;if(!i||"details"===t&&"details"!==i){ge();p=false;if("details"===t){var n=TS.shared.legacyGetActiveModelOb();var a=n&&n.id?{channel_id:n.id,channel_type:n.id.charAt(0),is_member:n.is_member}:{};TS.interop.clog.track("FLEXPANE_CHANNEL_DETAILS_CLOSE",a)}return}if(!p&&"details"===i){p=true;pe();var r=TS.shared.legacyGetActiveModelOb();var s=r&&r.id?{channel_id:r.id,channel_type:r.id.charAt(0),is_member:r.is_member}:{};TS.interop.clog.track("FLEXPANE_CHANNEL_DETAILS_OPEN",s)}};var W=function e(){if(h){b={};if(!me())return;pe()}else h=true};var V=function e(){if(!f)return;Me=false;var t=TS.shared.legacyGetActiveModelOb();if(!t)return;k=null;"details"===TS.model.ui_state.flex_name&&pe()};var z=function e(t){if(!fe(t))return;"details"===TS.model.ui_state.flex_name&&pe()};var Y=function e(t){if(!me())return;if(!fe(t))return;var i=TS.shared.legacyGetActiveModelOb();we(i);Te(i)};var q=function e(){if(!me())return;var t=TS.shared.legacyGetActiveModelOb();Ae(t)};var J=function e(t){if(!me())return;if(!fe(t))return;var i=TS.shared.legacyGetActiveModelOb();Te(i);we(i)};var Z=function e(t){if(!me())return;if(!fe(t))return;var i=TS.shared.legacyGetActiveModelOb();we(i);Ee(i);S.members&&Oe()};var X=function e(t,i){if(!me())return;if(!fe(t))return;var n=TS.shared.legacyGetActiveModelOb();we(n);Ee(n);if(S.members){$("#channel_page_member_"+i).remove();Oe()}};var ee=function e(t){if(!me())return;if(!fe(t))return;var i=TS.shared.legacyGetActiveModelOb();Ee(i);S.members&&Oe()};var te=function e(t,i){if(!me())return;if(!fe(t))return;var n=TS.shared.legacyGetActiveModelOb();Ee(n);if(S.members){$("#channel_page_member_"+i).remove();Oe()}};var ie=function e(t){var i=true;ne(t,i)};var ne=function e(t,i){if(!TS.redux.socket.isConnected())return;if(!t||"undefined"===typeof t.id)return;if(!me())return;var n=TS.shared.legacyGetActiveModelOb();if(n){var a=TS.interop.membership.getCachedChannelMembershipInfoForUser(n.id,t.id);var r=!a.is_known||a.is_member;if(r){var s=!i;s&&Ee(n);S.members&&Oe()}n.creator&&n.creator===t.id&&we(n)}};var ae=function e(t){if(!me())return;var i=TS.shared.legacyGetActiveModelOb();if(t.is_app_user){TS.client.channel_page.handleAppChannelMembershipChange(i);return}Ee(i);S.members&&Oe()};var re=function e(){if(!me())return;var t=TS.shared.legacyGetActiveModelOb();$e(t)};var se=function e(t){if(!me())return;var i=TS.shared.legacyGetActiveModelOb();if(!i||!t||i.id!==t)return;delete w[i.id];i.is_channel&&!i.is_member||(b[i.id]=true);Le(i)};var oe=function e(t){var i=true;le(t,i)};var le=function e(t,i){if(!me())return;var n=TS.shared.legacyGetActiveModelOb();if(!n)return;var a=t.pinned_to&&-1!==t.pinned_to.indexOf(n.id);var r=G(t);var s=!i&&!TS.interop.files.isObjectFresh(t.id);if(s&&(a||r)){TS.files.getFileById(t.id);return}a&&Ce(n);r&&Le(n)};var ce=function e(t,i){if(!me())return;var n=TS.shared.legacyGetActiveModelOb();if(!n)return;i.pinned_to&&-1!==i.pinned_to.indexOf(n.id)&&Ce(n)};var de=function e(t){if(!me())return;if(!fe(t))return;Ce(t)};var ue=function e(t){delete b[t.id];me()&&TS.model.user.is_restricted&&we(TS.shared.legacyGetActiveModelOb())};var _e=function e(t){if(!me())return;fe(t)?pe():TS.model.user.is_restricted&&we(TS.shared.legacyGetActiveModelOb())};var me=function e(){return p};var fe=function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i||!t||i.id!==t.id)return false;return true};var he=function e(){var t=TS.shared.legacyGetActiveModelOb();if(!t)return;Ee(t);S.members&&$e(t)};var pe=function e(){ge();var i=TS.shared.legacyGetActiveModelOb();if(i.is_im||i.is_mpim){i.is_im?$("#details_tab").addClass("dm_info_pane"):$("#details_tab").removeClass("dm_info_pane");i.is_mpim?$("#details_tab").addClass("mpim_info_pane"):$("#details_tab").removeClass("mpim_info_pane");Se(i)}else $("#details_tab").removeClass("dm_info_pane mpim_info_pane");$('[data-js="channel_page_apps"]').toggleClass("hidden",We(i));Te(i);we(i);Ce(i);Ee(i);$e(i);Le(i);Ae(i);_t(i);TS.apps.permissions.areXoxaAppsInstalled()&&He(i);j();if(!TS.environment.supports_custom_scrollbar){var n=t.data("monkeyScroll");n?TS.ui.utility.updateClosestMonkeyScroller(t):t.monkeyScroll()}Je();k&&t.scrollTop(k)};var ge=function e(){Ye();Ie();Pe();Re();ve();Ge();ke();ut();TS.apps.permissions.areXoxaAppsInstalled()&&je();Q()};var Te=function e(t){var i;if(t.is_channel&&!t.is_mpim||!t.is_channel&&t.is_group&&!t.is_mpim){$("#channel_page_title").text(TS.interop.i18n.t("Channel Details","client")());var n='<span class="channel_name overflow_hidden"><span class="overflow_ellipsis">';n+=TS.templates.builders.makeChannelPrefix(t);n+=_.escape(t.name);n+="</span>";n+=TS.templates.builders.maybeMakeSharedIcon(t);n+="</span>";i=TS.interop.i18n.t("About {formatted_channel_name}","client")({formatted_channel_name:TS.interop.i18n.safeString(n)})}else i='<span class="overflow_ellipsis">'+TS.interop.i18n.t("About this conversation","client")()+"</span>";$("#details_tab_header").html(i)};var Se=function e(t){ve();if(t.is_mpim)return;var i=TS.redux.members.getPotentiallyUnknownMemberById(t.user);A.add(i.id);s.html(TS.templates.channel_page_conversation_details({member:i}));TS.client.flex_pane.startLocalTimeInterval();Ne("about")};var ve=function e(){Ne("about");A.clear();s.empty();TS.client.flex_pane.stopLocalTimeInterval()};var be=function e(t){var i=TS.interop.memberCounts.getOrFetchMemberCounts(t.id);if(i.promise&&!Me){TS.has_pri[at]&&TS.log(at,"Channel member counts ("+t.id+"): Will rebuild member tabs after we get counts from API");Me=true;TS.interop.utility.makeSafeForTimeout(i.promise).timeout(TS.interop.connectivity.getMaximumSocketWait()).then(function(){if(t.id===TS.shared.legacyGetActiveModelOb().id){TS.has_pri[at]&&TS.log(at,"Channel member counts ("+t.id+"): Got counts from API, rebuilding member tabs now");Ee(t);if(TS.interop.rules.channels.isExternallySharedChannel(t)){TS.has_pri[at]&&TS.log(at,"Channel member counts ("+t.id+"): Got counts from API, rebuilding channel details now");we(t)}}else TS.has_pri[at]&&TS.log(at,"Channel member counts ("+t.id+"): Got counts from API, but active model object has changed, so not rebuilding member tabs")}).catch(_.noop).finally(function(){Me=false})}var n=_.get(i,"counts.member_count");var a=_.get(i,"counts.restricted_member_count");var r;r=i.counts?i.promise?"using provisional data while waiting for API response":"have up-to-date data":"waiting for initial data";TS.has_pri[at]&&TS.log(at,"Channel member counts ("+t.id+"): Rebuilding count templates: "+r+"; member count = "+n+"; restricted member count = "+a);return i};var we=function e(t){if(t.is_im||t.is_mpim)return;var n={model_ob:t,show_set_purpose:(t.is_member||t.is_group)&&!TS.model.user.is_ultra_restricted&&(TS.boot_data.feature_announce_only?TS.interop.rules.user.canPostInChannel(t.id):!TS.interop.rules.channels.isRequired(t)||TS.permissions.members.canPostInGeneral()),show_edit_purpose_or_topic:(t.is_member||t.is_group)&&!TS.model.user.is_ultra_restricted&&!TS.model.user.is_restricted&&(TS.boot_data.feature_announce_only?TS.interop.rules.user.canPostInChannel(t.id):(!TS.interop.rules.channels.isRequired(t)||TS.permissions.members.canPostInGeneral())&&TS.permissions.members.canPostInModelOb(t))};if(TS.boot_data.page_needs_enterprise&&(t.is_channel||t.is_group)&&t.is_org_shared&&t.is_global_shared){n.is_globally_shared=true;var a=TS.redux.enterprise.getEnterprise();n.enterprise_org_name=a.name;n.enterprise_org_icon=a.icon}var r=TS.redux.members.getPotentiallyUnknownMemberById(t.creator);r&&r.is_self?n.creator_is_self=true:r&&r.is_unknown?n.creator_name=new Handlebars.SafeString(TS.templates.unknown_member({id:r.id})):r&&TS.interop.members.isExternal(r)&&TS.teams.getTeamById(r.team_id)?n.creator_name=TS.interop.i18n.t("{creator_name} from {team_name}","channel_pages")({creator_name:TS.interop.members.getPrefCompliantMemberName(r),team_name:TS.teams.getTeamNameById(r.team_id)}):n.creator_name=r?TS.interop.members.getPrefCompliantMemberName(r):TS.interop.i18n.t("unknown","channel_pages")();var s=t.msgs&&t.msgs.length&&_.get(t,["msgs",t.msgs.length-1,"ts"],"");n.permalink=s&&TS.utility.msgs.constructMsgPermalink(t,s)||"javascript:void(0)";var o=TS.interop.datetime.toDateObject(t.created);TS.interop.datetime.isToday(o)?n.days_since_creation=0:TS.interop.datetime.isYesterday(o)&&(n.days_since_creation=1);n.creation_date=1e3*t.created;if(TS.boot_data.page_needs_enterprise&&t.is_org_shared&&t.shared_team_ids)_.assign(n,ye(t));else if(TS.interop.rules.channels.isExternallySharedChannel(t)){var l=0;var c=be(t);n.is_loading_members=!c.counts;var d=TS.utility.teams.getTeamsForModelOb(t,{include_pending:true});d=_.map(d,function(e){e=_.clone(e);e.member_count=_.get(c,["counts","teams_member_count",e.id])||0;e.is_pending_ext_shared=_.indexOf(t.pending_shared,e.id)>-1;e.connecting_admin=vt(t,e.id);l+=e.member_count;return e});var u=_.clone(TS.model.team);u.member_count=_.get(c,["counts","member_count"])-l;u.connecting_admin=vt(t,u.id);d.unshift(u);n.is_externally_shared=true;n.workspace_name=TS.interop.rules.teams.getTeamDisplayName(TS.model.team);n.shared_teams=d}i.html(TS.templates.channel_page_details(n)).removeClass("hidden");lt(t);var m=$("#channel_purpose_input");TS.utility.contenteditable.create(m,{ariaLabel:TS.interop.i18n.t("Channel purpose","channel_pages")(),modules:{tabcomplete:{positionMenu:function e(t){t.style.width=m.outerWidth()+"px";TS.tabcomplete.positionUIRelativeToInput(t,m)},completers:["channels","emoji","members"]}},enableBroadcastKeywords:false,onEnter:function e(t){if(t.shiftKey)return true;L();return false},onEscape:function e(){N()},onTextChange:function e(){TS.client.channel_page.updatePurposeTooLongWarning(m)}});TS.utility.contenteditable.enable(m);TS.utility.contenteditable.value(m,TS.utility.unformatTopicOrPurpose(t.purpose.value));m.on("keydown",function(e){e.which!==TS.utility.keymap.up&&e.which!==TS.utility.keymap.down||e.stopPropagation()});Ne("about");if((t.is_channel||t.is_group&&!t.is_mpim)&&st){$(".channel_page_highlights").removeClass("hidden");st=false}n.show_more_teams_link&&i.find("#see_all_teams").off("click").on("click",function(e){e.preventDefault();TS.ui.enterprise_teams_dialog.show(t)})};var ye=function e(t){var i=_.get(t,"shared_team_ids",[]);TS.model.user.is_restricted&&(i=_.intersection(TS.model.user.enterprise_user.teams,i));var n=i.length;var a=n<=M;var r={};r.shared_teams=_(i).map(function(e){return TS.teams.getTeamById(e)}).compact().value();if(!a){r.shared_teams=r.shared_teams.slice(0,E);r.show_more_teams_link=true;r.total_teams_count=n}return r};var Ae=function e(t){ke();if(t.is_im)return;var i=t.id;var n=TS.notifs.isCorGMuted(i);var a=TS.ui.growls.checkPermission();var r=false===a&&TS.ui.growls.no_notifications;var s=false===a&&"denied"===TS.ui.growls.getPermissionLevel();var o=false===a&&TS.ui.growls.shouldShowPermissionButton();var d=TS.notifs.getCalculatedCorGNotifySetting(i);var u=TS.notifs.getCalculatedCorGPushNotifySetting(i);var _="everything"===d;var m="mentions"===d;var f="nothing"===d;var h="everything"===u;var p="mentions"===u;var g="nothing"===u;var T={model_ob:t,is_muted:n,desktop_notifs_enabled:a,notifications_impossible:r,notifications_not_allowed:s,notifications_not_yet_allowed:o,desktop_everything:_,desktop_mentions:m,desktop_nothing:f,push_everything:h,push_mentions:p,push_nothing:g};l.html(TS.templates.channel_page_notif_prefs(T));c.html(TS.templates.channel_page_notif_prefs_mute_state({is_muted:n}));Ne("notif_prefs")};var ke=function e(){Ne("notif_prefs");l.empty()};var Ce=function e(t){Ie();var i=t.pinned_items;var a=t.pinned_items_count;var r="";var s=false;if(S.pinned_items&&!et(t)){tt(t);s=true}a>0?$("#pinned_items_title").text(TS.interop.i18n.t("{pinned_items_count, plural, =1 {# Pinned Item} other {# Pinned Items}}","channel_pages")({pinned_items_count:a})):$("#pinned_items_title").text(TS.interop.i18n.t("Pinned Items","channel_pages")());if(!S.pinned_items)return;i&&i.length>0?i.forEach(function(e){if(e.file&&e.file.is_deleted)return;var i=e.file&&e.file.id;i&&TS.files.getFileById(i);Xe(e);r+=TS.client.channel_page.pinnedItemHtml(e,t)}):r=s?TS.templates.infinite_spinner({color:"white",size:"medium"}):TS.templates.channel_page_empty_pinned_items({model_ob:t});n.toggleClass("loading",!!s);r=TS.format.replaceHighlightMarkers(r);n.html(r);Ne("pinned_items");xe()};var xe=function e(){if(!me())return;if(!S.pinned_items)return;TS.utility.rAF(function(){var e=n.find(".pinned_item");e.each(function(){var e=$(this);if("message"!==e.data("type"))return;var t=e.find(".pinned_message_text");var i=e.find(".pin_truncate_fade");t[0].scrollHeight>t[0].clientHeight+3?i.removeClass("hidden"):i.addClass("hidden")});e.find(".pinned_message_text").addClass("hide_scroll")})};var Ie=function e(){var t=TS.shared.legacyGetActiveModelOb();t&&t.pinned_items&&!TS.pins.havePinsBeenFetched(t)&&delete t.pinned_items;Ne("pinned_items");n.empty()};var Me;var Ee=function e(t){var i;var n;var a;var r;var s=be(t);i=!s.counts;n=null;a=_.get(s,"counts.member_count");r=_.get(s,"counts.restricted_member_count");Ke(_.get(s,"counts.app_count"));t.is_im||Be(t,i,a,n,r)};var Be=function e(t,i,n,r,s){Pe();var o={model_ob:t,member_count:n,online_count:r,restricted_count:s,show_restricted_members:s>0,is_loading_members:i};a.html(TS.templates.channel_page_member_tabs(o))};var Pe=function e(){a.empty()};var Ue=function e(t,i,n){var a;var r=[];var s=i||t.members;for(var o=0;o<s.length;o+=1){a=TS.interop.members.getMemberById(s[o]);a&&(TS.boot_data.page_needs_enterprise?TS.interop.rules.channels.isOrgShared(t)&&a.deleted||r.push(a):a.deleted||r.push(a))}var l=TS.interop.memberCounts.getOrFetchMemberCounts(t.id);var c=_.get(l,"counts.member_count");c<=x&&(r=TS.members.legacyMemberSorterByActiveWithBotsLast(r));var d={model_ob:t};_.isUndefined(n)&&(n=c<=x);if(n)d.members=r;else{d.members=r.slice(0,I);d.show_more_members_link=true;d.total_member_count=c}d.show_channel_invite_link=TS.permissions.members.canUserInviteToChannel(t);d.all_members=r;return d};var De=function e(t,i,n,a){var s=Ue(t,i,a);n&&Re();s.members=TS.members.legacyMemberSorterByActiveWithBotsLast(s.members);if(TS.boot_data.feature_sonic_presence_manager){if(me()){A.clear();A.add(_.map(s.members,"id"))}}else A.add(_.map(s.members,"id"));r.html(TS.templates.channel_page_member_lists(s));r.find("#see_all_members").on("click",function(e){e.preventDefault();TS.client.channel_page.members_dialog.show(t,s.all_members,s.total_member_count)});Ne("members");ze()};var $e=function e(t,i){if(t.is_im)return;i||Re();if(!S.members)return;i||r.addClass("loading").html(TS.templates.infinite_spinner({color:"white",size:"medium"}));var n=Math.max(I,x);var a={count:n,channels:[t.id],present_first:true,index:TS.interop.members.shouldDisplayRealNames()?"users_by_realname":"users_by_name",filter:TS.boot_data.feature_bots_not_members?"people":"everyone",locale:TS.interop.i18n.locale};var s=[TS.members.fetchAndUpsertMembersWithQuery(a)];var o=TS.interop.memberCounts.getOrFetchMemberCounts(t.id);o.promise&&s.push(TS.interop.utility.makeSafeForTimeout(o.promise));Promise.all(s).timeout(TS.interop.connectivity.getMaximumSocketWait()).then(function(e){var n=e[0];if(TS.shared.legacyGetActiveModelOb().id!==t.id)return;var a=TS.interop.memberCounts.getOrFetchMemberCounts(t.id);var r=_.get(a,"counts.member_count");var s=r<=x;var o=s?x:I;var l=_.map(n.objects,"id").slice(0,o);De(t,l,i,s);return null}).catch(function(i){TS.has_pri[at]&&TS.log(at,"Flannel error: failed to fetch all members for channel "+t.id);if(TS.redux.socket.isConnected()){TS.logError(i);TS.logError("failed to fetch all members for channel "+t.id,"Flannel error")}else TS.warn("failed to fetch all members for channel "+t.id+", because we are not connected");r.removeClass("loading");r.html('<div class="align_center subtle_silver">'+TS.interop.i18n.t("Oops, something went wrong.","client")()+' <a href="#">'+TS.interop.i18n.t("Try again","client")()+"</a></div>");r.find("a").click(function(i){i.preventDefault();e(t)})})};var Fe=function e(){if(!TS.redux.socket.isConnected())return;var t=TS.shared.legacyGetActiveModelOb();if(!t)return;var i=true;$e(t,i)};var Oe=_.throttle(Fe,U);var Re=function e(){Ne("members");A.clear();Ye();r.empty()};var Ne=function e(i){var n=310;var a=t.find('.channel_page_section[data-section-name="'+i+'"]');var r=_.sum(a.children(":visible").map(function(e,t){return $(t).outerHeight(true)}).toArray());clearTimeout(a.data("animate"));if(!S){TS.logError("The _expanded_sections array was empty: "+i,"JavaScript error");TS.logError("What is the state for _expanded_sections: "+T.expanded_sections,"JavaScript error")}S&&S[i]?a.css({"max-height":r,height:""}).data("animate",setTimeout(function(){S[i]&&a.css("max-height","none")},n)):a.css({"max-height":r,height:r}).data("animate",setTimeout(function(){a.css("max-height","").data("animate",setTimeout(function(){S[i]||a.css("height","")},n))},10))};var Le=function e(t){Ge();var i=false;var n="";var a;if(S.shared_files&&!it(t)){nt(t);i=true}if(!S.shared_files)return;i&&(n=TS.templates.infinite_spinner({color:"white",size:"medium"}));o.toggleClass("loading",!!i);if(n){o.html(n);Ne("shared_files");return}for(var r=0;r<TS.model.files.length;r+=1){a=TS.model.files[r];if(a.is_deleted)continue;if(G(a)){var s=a.id;TS.files.getFileById(s);if(v.length<y){v.push(a);n+=TS.templates.builders.fileHTML(a)}}}if(v.length>=y)if(t.is_im){var l=TS.redux.members.getPotentiallyUnknownMemberById(t.user);n+=TS.templates.channel_page_view_all_files_link({model_ob:t,member:l})}else n+=TS.templates.channel_page_view_all_files_link({model_ob:t});n?o.html(n):o.html(TS.templates.channel_page_empty_shared_files({model_ob:t}));Ne("shared_files");ze()};var Ge=function e(){Ne("shared_files");v=[];o.empty()};var He=function e(t){if(We(t))return;je();if(!S.apps)return;m.html(TS.templates.infinite_spinner({color:"white",size:"medium"}));var i=_.get(TS.model,"user.is_restricted");var n={count:B,channels:[t.id],index:"users_by_realname",filter:"apps",locale:TS.interop.i18n.locale};TS.members.fetchAndUpsertMembersWithQuery(n).timeout(TS.interop.connectivity.getMaximumSocketWait()).then(function(e){var n=e.objects;var a=n.map(function(e){return{app_user_id:e.id,app_icon:_.get(e,"profile.image_24"),name:e.real_name,can_be_removed:Qe(e,t,i)}});var r=TS.shared.legacyGetActiveModelOb().id;var s=TS.interop.rules.user.canPostInChannel(r);var o=!i&&s;m.html(TS.templates.channel_page_apps_list({apps:a,can_add_app:o}));Ne("apps")}).catch(function(){TS.has_pri[at]&&TS.log(at,"Flannel error: failed to fetch all app members for channel "+t.id);TS.logError("failed to fetch all app members for channel "+t.id,"Flannel error");m.removeClass("loading");m.html('<div class="align_center subtle_silver">'+TS.interop.i18n.t("Oops, something went wrong.","client")()+' <a href="#">'+TS.interop.i18n.t("Try again","client")()+"</a></div>");m.find("a").click(function(i){i.preventDefault();e(t)})})};var Qe=function e(t,i,n){if(n)return false;if(t.is_app_user)return true;if(TS.interop.rules.channels.isMpim(i))return false;return true};var je=function e(){Ne("apps");m.empty()};var Ke=function e(t){var i=t?TS.interop.i18n.t("{app_count, plural, =1 {# App} other {# Apps}}","channel_pages")({app_count:t}):TS.interop.i18n.t("Apps","channel_pages")();$("[data-js=channel_page_apps_title]").text(i)};var We=function e(t){if(!TS.apps.permissions.areXoxaAppsInstalled())return true;if(!TS.interop.rules.channels.isIm(t))return false;var i=TS.interop.rules.channels.getMemberIdFromIm(t);var n=i&&TS.interop.members.getMemberById(i);return n&&(TS.interop.rules.channels.isSlackbot(t)||n.is_app_user||n.is_bot)};var Ve=function e(t,i){var n={action:"CLICK",ui_element:t};TS.interop.clog.track(D,{contexts:{ui_context:n,core:{channel_id:TS.shared.legacyGetActiveModelOb().id,app_id:_.get(i,"profile.api_app_id"),bot_id:_.get(i,"profile.bot_id")}}});return n};var ze=function e(){Ye();g=t.find(".lazy").lazyload({container:t});Je()};var Ye=function e(){if(g&&g.detachEvents){g.detachEvents();g=null}};var qe;var Je=function e(){TS.utility.cancelRAF(qe);qe=TS.utility.rAF(function(){t.trigger("resize-immediate")})};var Ze=function e(t){var i;"message"===t.type?i=n.find('.pinned_item[data-type="message"][data-ts="'+t.message.ts+'"]'):"file"===t.type?i=n.find('.pinned_item[data-type="file"][data-file-id="'+t.file.id+'"]'):"file_comment"===t.type&&(i=n.find('.pinned_item[data-type="file_comment"][data-comment-id="'+t.comment.id+'"]'));return i};var Xe=function e(t){if("file_comment"!==t.type)return;var i=TS.files.getFileCommentById(t.file,t.comment.id);t.comment=i};var et=function e(t){if(false===t.has_pins)return true;if(!_.isEmpty(t.pinned_items))return true;return TS.pins.havePinsBeenFetched(t)};var tt=function e(t){if(TS.pins.arePinsCurrentlyBeingFetched(t))return;TS.pins.fetchPins(t)};var it=function e(t){return!!b[t.id]};var nt=function e(t){if(w[t.id])return;w[t.id]=true;TS.files.fetchChannelFiles(t.id,function(e){delete w[t.id];if(!e)return;b[t.id]=true},y)};var at=1989;var rt={};var st=true;var ot={};var lt=function e(t){if(!S.about)return;var i=$('[data-js="sli_channel_insights_section"]');if(!t.is_channel&&!(t.is_group&&!t.is_mpim)){i.html("");return}if(rt[t.id])return;if(TS.client.ui.channel_insights.last_details_response&&TS.client.ui.channel_insights.last_details_response.channel===t.id)i.html(TS.client.ui.channel_insights.renderInsightsSection(TS.client.ui.channel_insights.last_details_response.response));else{i.html(TS.client.ui.channel_insights.renderLoadingState());rt[t.id]=true;TS.interop.api.call("channels.insights",{channel:t.id,modules:t.is_group&&!t.is_mpim?"top_contributors":"top_contributors,similar_channels"}).then(function(e){return TS.client.ui.channel_insights.ensureChannelMemberCounts(e)}).then(function(e){if(TS.shared.legacyGetActiveModelOb().id===t.id){$('[data-js="sli_channel_insights_section"]').html(TS.client.ui.channel_insights.renderInsightsSection(e));TS.client.ui.channel_insights.last_details_response={channel:t.id,response:e};ct("top_contributors,similar_channels",t.id,e.request_id)}}).catch(function(e){TS.error(e);TS.shared.legacyGetActiveModelOb().id===t.id&&$('[data-js="sli_channel_insights_section"]').html("")}).finally(function(){delete rt[t.id]})}};var ct=function e(t,i,n){TS.interop.clog.track("CHANNEL_INSIGHTS_MODULE_SHOWN",{channel_id:i,request_id:n,module:t})};var dt=function e(){Ne("highlights");d&&d.html("")};var ut=function e(){$("#highlights_title").text(TS.interop.i18n.t("Highlights","channel_page")())};var _t=function e(t){if(!t.is_channel&&!(t.is_group&&!t.is_mpim)){if(!st){u.addClass("hidden");st=true}return}if(!S.highlights||!d)return;if(st){u.removeClass("hidden");st=false}if(ot[t.id])return;if(TS.client.ui.channel_insights.last_highlights_response&&TS.client.ui.channel_insights.last_highlights_response.channel===t.id){St(t,TS.client.ui.channel_insights.last_highlights_response.response);Ne("highlights")}else{d.html(TS.client.ui.channel_insights.renderLoadingState());$("#highlights_title").text(TS.interop.i18n.t("Highlights","channel_page")());Ne("highlights");ot[t.id]=true;TS.interop.api.call("channels.insights",{channel:t.id,modules:"highlights"}).then(function(e){if(TS.shared.legacyGetActiveModelOb().id===t.id){TS.client.ui.channel_insights.last_highlights_response={channel:t.id,response:e};St(t,e);ct("highlights",t.id,e.request_id)}}).catch(function(){TS.shared.legacyGetActiveModelOb().id===t.id&&St(t,{})}).finally(function(){delete ot[t.id]})}};var mt=604800;var ft=2678400;var ht=3*ft;var pt=6*ft;var gt=function e(){return new Date/1e3};var Tt=function e(t,i){return'<div class="p-channel_insights__message">\n\t\t'+TS.templates.builders.msgs.buildHTML({msg:t,model_ob:i,enable_slack_action_links:false,container_id:"channel_page_scroller",prev_msg:null,briefing:true,full_date:true,standalone:true})+"\n\t</div>"};var St=function e(t,i){if(_.get(i,"data.top_messages.messages.length")){var n="";var a=gt();var r=_.reduce(_.reverse([].concat(i.data.top_messages.messages)),function(e,t){t.ts>=a-mt?e.this_week.push(t):t.ts>=a-ft?e.this_month.push(t):t.ts>=a-ht?e.within_past_three_months.push(t):t.ts>=a-pt?e.within_past_six_months.push(t):e.older.push(t);return e},{this_week:[],this_month:[],within_past_three_months:[],within_past_six_months:[],older:[]});var s=!!_.get(i,"data.top_messages.debug");n+='<p class="p-channel_insights__highlights_description">'+TS.interop.i18n.t("Below {count, plural, =1 {is the top message} other {are a few of the top messages}} in <strong>{channel_name}</strong>.","channel_page")({channel_name:TS.interop.rules.channels.getDisplayNameForChannel(t),count:i.data.top_messages.messages.length})+"\n\t\t"+(s?TS.client.ui.channel_insights.buildDebugTooltip("top-messages"):"")+"\n\t\t</p>";if(r.this_week.length){n+='<h4 class="p-channel_insights__date_heading">\n\t\t\t\t<span>'+TS.interop.i18n.t("This week","channel_page")()+"</span>\n\t\t\t</h4>";n+=r.this_week.map(function(e){return Tt(e,t)}).join("")}if(r.this_month.length){n+='<h4 class="p-channel_insights__date_heading">\n\t\t\t\t<span>'+TS.interop.i18n.t("This month","channel_page")()+"</span>\n\t\t\t</h4>";n+=r.this_month.map(function(e){return Tt(e,t)}).join("")}if(r.within_past_three_months.length){n+='<h4 class="p-channel_insights__date_heading">\n\t\t\t\t<span>'+TS.interop.i18n.t("More than a month ago","channel_page")()+"</span>\n\t\t\t</h4>";n+=r.within_past_three_months.map(function(e){return Tt(e,t)}).join("")}if(r.within_past_six_months.length){n+='<h4 class="p-channel_insights__date_heading">\n\t\t\t\t<span>'+TS.interop.i18n.t("More than 3 months ago","channel_page")()+"</span>\n\t\t\t</h4>";n+=r.within_past_six_months.map(function(e){return Tt(e,t)}).join("")}if(r.older.length){n+='<h4 class="p-channel_insights__date_heading">\n\t\t\t\t<span>'+TS.interop.i18n.t("More than 6 months ago","channel_page")()+"</span>\n\t\t\t</h4>";n+=r.older.map(function(e){return Tt(e,t)}).join("")}d.html(n);d.find(".p-channel_insights__message").each(function(e,t){var i=$(t).find(".message_body");i.length&&i.outerHeight()>=260&&$(t).addClass("p-channel_insights__message--truncate")});$("#highlights_title").text(TS.interop.i18n.t("{count, plural, =1 {# Highlight} other {# Highlights}}","channel_page")({count:i.data.top_messages.messages.length}))}else{d.html('\n\t\t\t<p class="p-channel_insights__empty greigh">\n\t\t\t\t'+TS.interop.i18n.t("<strong>Nothing yet.</strong> When this channel gets a bit more active, check back here.","channel_pages")()+"\n\t\t\t</p>\n\t\t");$("#highlights_title").text(TS.interop.i18n.t("Highlights","channel_page")())}};var vt=function e(t,i){if(_.isArray(t.shares)&&_.isObject(t.shares[0])){var n=t.shares[0];if(n){var a=TS.redux.members.getPotentiallyUnknownMemberById(t.creator);var r=a&&!TS.interop.members.isExternal(a);var s=i===TS.model.team.id;var o=s?n.user:n.accepted_user;if(r&&s||!r&&!s)return TS.interop.i18n.t("Shared by {admin_name}","channel_pages")({admin_name:TS.interop.members.getMemberRealName(o)});return TS.interop.i18n.t("Added by {admin_name}","channel_pages")({admin_name:TS.interop.members.getMemberRealName(o)})}}}})()},3078:function(e,t){(function(){TS.registerModule("client.channel_page.members_dialog",{show:l,updateMembers:c,isShowing:o,test:function e(){var t={updateMembersInDialog:c};Object.defineProperty(t,"filterMembersInDialog",{get:function e(){return u},set:function e(t){u=t}});Object.defineProperty(t,"getFilter",{get:function e(){return d},set:function e(t){d=t}});Object.defineProperty(t,"members",{get:function e(){return i},set:function e(t){i=t}});return t}});var e;var t;var i;var n="all_members_dialog";function a(e){$(window.document).bind("keydown",r);var t=new TS.SearchableMemberList({$container:$("#channel_membership_dialog_container"),id:"channel_membership_dialog",model_ob_id:e.id,triggered_by_user_action:true});t.showInitial()}var r=function e(t){t.which==TS.utility.keymap.esc&&""===TS.generic_dialog.div.find("input").val()&&TS.generic_dialog.cancel()};var s=function e(){TS.generic_dialog.cancel()};function o(){if(!TS.generic_dialog.is_showing)return false;return TS.generic_dialog.current_setting.dialog_class==n}function l(o,l,c){var d=TS.templates.channel_page_all_members_dialog();var u=TS.interop.i18n.t("{member_count, number} members in {channel_name}","channel_pages")({member_count:_.isUndefined(c)?l.length:c,channel_name:TS.interop.rules.channels.getDisplayNameForChannel(o)});i=l;TS.generic_dialog.start({dialog_class:n,title:u,body:d,cancel_button_text:TS.interop.i18n.t("Close","channel_pages")(),hide_footer:true,show_cancel_button:true,show_go_button:false,backdrop_click_to_dismiss:true,onShow:function e(){a(o)},onEnd:function n(){var a=TS.SearchableMemberList.get("channel_membership_dialog");a&&a.destroy();TS.generic_dialog.div.remove();TS.generic_dialog.div=void 0;e=void 0;t=void 0;i=void 0;TS.menu.member.member_item_click_sig.remove(s);$(window.document).unbind("keydown",r)}})}function c(e){if(!o())return;i=e;var t=d();var n=true;u(t,n)}function d(){var e=TS.generic_dialog.div.find("#all_members_filter input");return _.toString(e.val()).toLowerCase().trim()}function u(n,a){a&&(e=void 0);if(n&&n===e)return;t=t&&e&&n&&_.includes(n,e)?TS.utility.members.filterMembersByQuery(t,n):TS.utility.members.filterMembersByQuery(i,n);e=n;var r=true;var s=TS.generic_dialog.div.find("#all_members_container");s.longListView("setItems",t,r);s.toggleClass("invisible",!t.length);TS.generic_dialog.div.find("#all_members_no_matches").toggleClass("hidden",t.length>0);TS.utility.rAF(function(){TS.ui.utility.updateClosestMonkeyScroller(s)})}})()},3079:function(e,t){(function(){TS.registerModule("ui.channel_invite_modal",{startInviteToChannelModal:function e(n,a){if(TS.isPartiallyBooted())return;var r=TS.redux.channels.getEntityById(n);if(!r){TS.error("TS.ui.channel_invite_modal.startInviteToChannelModal no channel or group found with id "+n);return}t=r;a=a||[];d=a.map(function(e){u[e]=true;return TS.model.getMemberById(e)});var s=TS.permissions.members.canArchiveChannels()&&TS.permissions.members.canCreateGroups();var o=function e(){var t={model_ob:r,private_shared_channel_warning:r.is_private&&(TS.interop.rules.channels.isExternallySharedChannel(r)||!s),async_data:true,preselected:d};var i=TS.templates.channel_invite_modal(t);TS.ui.fs_modal.start({body_template_html:i,onShow:p,onEnd:g,modal_class:"fs_modal_internal_scroll"});if(TS.model.user.is_admin){var a=TS.interop.i18n.t('Or, <button type="button" class="btn_link do_admin_invite" data-channel-id="{channel_id}">invite a new person to your workspace</button>',"channel_modal","c4eeca53e2e908f3fb92e52aec9d7c56b5f4b137")({channel_id:n});var o='<div class="channel_modal_footer">'+a+"</div>";$("#channel_invite_modal").append(o)}};if(!s){TS.ui.invite.showLimitedInviteMemberDialog(r,function(){o();i=true;S()});return}if(TS.interop.rules.channels.isPrivateChannel(r)){TS.ui.invite.showPrivateInviteMemberDialog(r,function(){var e=$("input[name=group_invite_action]:checked").val();if(!e)return;o();i="use_existing_channel"===e;S()});return}o()}});var e;var t;var i=true;var n=false;var a;var r;var s;var o;var l;var c;var d=[];var u={};var m={};var f=58;var h;var p=function t(){e=$("#channel_invite_modal");e.on("click",".no_create_channel",function(){i=false;S()});e.on("click",".yes_show_history",function(){i=true;S()});e.on("click",".do_admin_invite",function(){TS.ui.fs_modal.close();var e=$(this).data("channel-id");setTimeout(function(){TS.ui.admin_invites.start({initial_channel_id:e})},500)});v()};var g=function _(){e=null;t=null;i=true;n=false;a=null;r=null;s=null;o=null;l=null;c=null;d=[];u={};m._searcher_p&&m._searcher_p.cancel();m={};TS.kb_nav.end();$(window).off("resize",j)};var T=function e(){if(!d.length)return;if(i){var n="conversations.invite";_.chunk(Object.keys(u),30).forEach(function(e){TS.interop.api.call(n,{channel:t.id,force:true,users:e.join(",")})});TS.ui.fs_modal.close()}else{s&&s.start();var a=Object.keys(u);var r=function e(t,i){s&&s.stop();if(!t){if(i&&"restricted_action"===i.error){var n=TS.interop.i18n.t("Uh oh!","channel_invite")();var a=TS.interop.i18n.t("You don\u2019t have permission to create new private channels. Talk to your Workspace Owner to get permission.","channel_invite")();TS.permissions.members.canArchiveChannels()||(a=TS.interop.i18n.t("You don\u2019t have permission to archive channels. Talk to your Workspace Owner to get permission.","channel_invite")());setTimeout(function(){TS.generic_dialog.alert(a,n)},500)}else alert("failed! "+i.error);return}TS.ui.fs_modal.close()};TS.groups.createChild(t.id,a,r)}};var S=function t(){$("#private_channel_invite_step_one").addClass("hidden");$("#channel_invite_container").removeClass("hidden");e.find(".channel_invite_filter_container").removeClass("hidden")};var v=function e(){x();Q()};var b=function e(){y();k()};var w=function e(){A();C()};var y=function e(){var t=document.getElementById("channel_invite_spinner");t&&t.classList&&t.classList.remove("hidden")};var A=function e(){var t=document.getElementById("channel_invite_spinner");t&&t.classList&&t.classList.add("hidden")};var k=function e(){if(!c){c=$("#monkey_scroll_wrapper_for_channel_invite_container");l=$("<div>",{class:"monkey_scroll_mask"});c.append(l);return}l.removeClass("hidden")};var C=function e(){l&&l.addClass("hidden")};var x=function t(){o=$("#channel_invite_container");o.longListView({items:[],approx_item_height:f,preserve_dom_order:true,makeElement:function e(){return $('<div class="channel_invite_row" data-qa="channel_invite_row"></div>')},renderItem:function e(t,i){if(TS.boot_data.feature_invite_user_groups&&i.is_usergroup){t.toggleClass("disabled",!!u[i.id]);t.html(TS.templates.channel_invite_user_group({user_group:i}))}else{TS.boot_data.feature_invite_user_groups||t.data("member-id",i.id);t.toggleClass("disabled",!!(u[i.id]||i.invite_exception_reason));t.html(TS.templates.channel_invite_member({member:i.member,invite_exception_reason:i.invite_exception_reason}))}}});o.monkeyScroll();U();o.on("click",".channel_invite_row",function(e){O($(e.currentTarget))});e.on("keydown","#channel_invite_filter",function(e){var t=$(e.currentTarget).val();if(e.which===TS.utility.keymap.del&&""===t){N();return}if(e.which===TS.utility.keymap.enter&&""===t){TS.kb_nav.getHighlightedItem().hasClass("hidden")&&T();return}e.which===TS.utility.keymap.esc&&TS.ui.fs_modal.close()}).on("input",function(e){K();I($(e.target).val().trim()).then(E).then(P)});e.on("focus","#channel_invite_filter",function(){$("#channel_invite_tokens").addClass("active")}).on("blur","#im_browser_filter",function(){$("#channel_invite_tokens").removeClass("active")});e.on("click","#channel_invite_tokens",function(e){var t=$(e.target).closest(".member_token");t.length?R(t):$("#channel_invite_filter").focus()});setTimeout(function(){TS.kb_nav.start(o.find(".list_items"),".channel_invite_row",o,{use_data_ordering:true,no_blur:true,scrollToStartImmediately:function e(){o.longListView("scrollToTop",true)},scrollToEndImmediately:function e(){o.longListView("scrollToEnd",true)}});TS.kb_nav.setAllowHighlightWithoutBlurringInput(true);TS.kb_nav.setSubmitItemHandler(function(e){O($(this));e.preventDefault()});$("#channel_invite_filter").focus()});I("").then(E).then(P)};var I=function e(i){b();var n=i;"@"===i.charAt(0)&&(n=i.substring(1));if(m.query!==n){m.query=n;TS.boot_data.feature_channel_invite_modal_cannot_join?m.include_org=!!TS.boot_data.page_needs_enterprise||!!TS.interop.rules.channels.isOrgShared(t):m.include_org=!!TS.interop.rules.channels.isOrgShared(t);m.include_slackbot=false;TS.boot_data.feature_bots_not_members&&(m.include_bots=false);m.include_self=false;m.not_member_of=[t.id];m.scroll_mark=0;m.query_for_display=i;o.off("scroll.filter")}if(!TS.boot_data.feature_invite_user_groups)return TS.members.promiseToSearchMembers(m);return TS.members.promiseToSearchMembers(m).then(function(){var e={usergroups:TS.interop.userGroups.getActiveUserGroups()};var t={allow_empty_query:false,frecency:false,limit:20,prefer_exact_match:true};m.user_groups=TS.sorter.search(n,e,t);return m})};var M=function e(t,i,n){var a=_.map(n,"id");var r=i||TS.model.user.is_admin;if(TS.model.user.is_ultra_restricted&&!r)return Promise.resolve([]);return TS.interop.membership.ensureChannelMembershipIsKnownForUsers(t.id,a).then(function(){var e=_(n).map(function(e){if(e.is_ultra_restricted)return;if(TS.interop.rules.members.isSlackbotOrTeambot(e,TS.boot_data.feature_teambot))return;if(e.is_self)return;if(e.deleted)return;if(TS.boot_data.feature_bots_not_members&&e.is_bot)return;if(e.is_app_user)return;if(!r&&e.is_restricted&&!t.is_group)return;var i=TS.interop.membership.getCachedChannelMembershipInfoForUser(t.id,e.id);if(!i.is_member&&TS.permissions.channels.canMemberBeInvitedToChannel(t,e))return e;if(TS.boot_data.feature_channel_invite_modal_cannot_join)return e;return}).compact().uniq().value();return e})};var E=function e(i){var a;var r;var s=[];s.push(M(t,true,i.items));TS.model.user.is_admin||s.push(M(t,false,i.items));return Promise.all(s).then(function(t){if(t.length){a=t[0];r=2===t.length?t[1]:a}n=r.length!=a.length;U();if(r.length!=i.items.length){i.num_new-=i.items.length-r.length;i.items=r}if(!i.num_new&&i.num_found&&i.num_remaining)return I(i.query).then(e);return Promise.resolve(i)})};var B=function e(t){if(!h){var i=TS.frecency&&TS.frecency.getExisting("jumper");h=i&&i.getMostCommon()}if(!h){TS.warn("WTF no frecency module? Sorting alphabetically.");t.sort(TS.interop.i18n.sorter);return t}_.each(t,function(e){var t=_.find(h,{id:e.id});e.score=t&&parseInt(t.score,10)||0});t.sort(function e(t,i){if(t.score<i.score)return 1;if(t.score>i.score)return-1;return 0});return t};var P=function e(i){var n=i.items.map(function(e){if(!TS.boot_data.feature_channel_invite_modal_cannot_join)return{id:e.id,member:e};var i=TS.interop.membership.getCachedChannelMembershipInfoForUser(t.id,e.id);var n=i.is_member;var a;var r;r=!n&&TS.permissions.channels.canMemberBeInvitedToChannel(t,e);n?a=TS.interop.i18n.t("Already in this channel","channel_modal")():r||(a=TS.interop.members.isExternal(e)?TS.interop.i18n.t("From another workspace","channel_modal")():D(e)?TS.interop.i18n.t("Not a member of this workspace","channel_modal")():TS.interop.i18n.t("Cannot join this channel","channel_modal")());return{id:e.id,member:e,invite_exception_reason:a}});n=n.map(function(e){e.member._pref_compliant_name=TS.interop.members.getPrefCompliantMemberName(e.member);return e});n.sort(TS.interop.i18n.mappedSorter("member._pref_compliant_name"));TS.boot_data.feature_invite_user_groups&&i.user_groups&&_.map(i.user_groups,function(e){return n.push(e)});if(TS.boot_data.feature_channel_invite_modal_cannot_join){var a=[];var r=[];_.each(n,function(e){e.invite_exception_reason?r.push(e):a.push(e)});r=B(r);a=B(a);n=a.concat(r)}o.longListView("setItems",n);i._is_new&&o.scrollTop(0);TS.utility.rAF(function(){TS.ui.utility.updateClosestMonkeyScroller(o)});i._is_new&&o.on("scroll.filter",function(){var t=o.scrollTop()+o.height()+f;if(t<=i.scroll_mark)return;var n=o.find(".list_items").height();if(t>n&&m._searcher_p&&m._searcher_p.isResolved()){I(i.query).then(E).then(e);i.scroll_mark=t}});if(!n.length){G(i.query_for_display);w();return}H();w();i.query&&"@"!==i.query&&0!==n.length?i._is_new&&TS.kb_nav.highlightFirstItem():TS.kb_nav.clearHighlightedItem()};var U=function t(){if(n&&!e.find(".ra_not_appear_warning").length){var i=TS.interop.i18n.t("Multi-channel guests may not appear below. Ask a Workspace Admin to invite them.","channel_modal")();var a='<p class="mini subtle_silver no_bottom_margin ra_not_appear_warning">'+i+"</p>";e.find(".kb_nav_label").after(a)}};var D=function e(t){if(!t.enterprise_user)return false;var i=_.get(t,"enterprise_user.teams",[]);if(-1===i.indexOf(TS.model.team.id))return true;return false};var F=function e(){var t=$("#channel_invite_filter");var i=t.val();$("#channel_invite_tokens").replaceWith(TS.templates.channel_invite_tokens({members:d,async_data:true}));t=$("#channel_invite_filter");i?t.val("").trigger("input").focus():t.focus()};var O=function e(t){if(TS.boot_data.feature_channel_invite_modal_cannot_join&&t.hasClass("disabled"))return;var i=[];var n=void 0;if(TS.boot_data.feature_invite_user_groups){var a=void 0;var r=t.find(".channel_invite_user_group");var s=t.find(".channel_invite_member");if(_.isEmpty(r)){if(s){n=s.data("member-id");a=TS.interop.members.getMemberById(n)}}else{n=r.data("user-group-id");a=TS.interop.userGroups.getUserGroupById(n)}if(!a||u[n])return;d.push(a);i.push(a)}else{n=t.data("member-id");var o=TS.interop.members.getMemberById(n);if(!o||u[n])return;d.push(o);i.push(o)}u[n]=true;L(i)};var R=function e(t){var i=t.data("member-id")||t.data("user-group-id");var n=_.remove(d,function(e){return e.id===i});delete u[i];L(n)};var N=function e(){if(!d.length)return;var t=d.pop();delete u[t.id];L([t])};var L=function t(i){i&&i.forEach(function(e){o.longListView("itemUpdatedById",e.id)});F();K();e.find(".invite_go").toggleClass("disabled",!d.length);o.longListView("resizeImmediately")};var G=function e(t){var i=$("#filter_invite_empty");var n=i.find(".filter_invite_empty_message");if(t){var a={query:t};n.html(TS.templates.channel_invite_no_results(a))}else n.empty();i.removeClass("hidden");$("#monkey_scroll_wrapper_for_channel_invite_container").addClass("hidden")};var H=function e(){var t=$("#filter_invite_empty");t.addClass("hidden");$("#monkey_scroll_wrapper_for_channel_invite_container").removeClass("hidden")};var Q=function t(){var i=$("#channel_invite_container");if(a){var n=i.find(".lfs_input_container");n.wrap("<div></div>");n.attr("style","max-width: 85%").addClass("inline_block").addClass("no_padding");n.after(TS.templates.channel_modal_go_button({class_name:"invite_go",label:TS.interop.i18n.t("Invite","channel_modal")()}))}K();var r=e.find(".invite_go");s=Ladda.create(r[0]);r.on("click",T)};var j=function e(){$("#channel_invite_container").lazyFilterSelect("recomputeHeight")};var K=function t(){var i=$("#channel_invite_container");if(a){var n=a.lazyFilterSelect("value");var s=i.find(".enter_to_go_label");r.val()?s.addClass("hidden"):n&&n.length>0?s.removeClass("hidden"):s.addClass("hidden")}else{var o=e.find(".return_hint");$("#channel_invite_filter").val()?o.addClass("hidden"):d.length?o.removeClass("hidden"):o.addClass("hidden")}}})()},3080:function(e,t){(function(){TS.registerModule("ui.mpim_conversion_modal",{onStart:function e(){},startMpimConversionModal:function e(t){i=t;var s=TS.mpims.legacyGetMembersInDisplayOrder(i);var o=_.filter(s,{is_ultra_restricted:true});var l=TS.templates.mpim_conversion_modal({members:s,uras:o});TS.ui.fs_modal.start({body_template_html:l,onShow:n,onEnd:r,modal_class:"mpim_conversion_modal",onGo:a})},go:function n(){var a=e.find(".title_input").val();t&&t.start();TS.redux.dispatch(TS.interop.mpims.convertToPrivateChannel({mpimId:i&&i.id,privateChannelName:a})).then(function(){t&&t.stop();TS.ui.fs_modal.close()}).catch(function(i){t&&t.stop();var n=i.data.error;var r=TS.ui.validation.getErrorMessage(n,{name:a});return TS.ui.validation.showWarning(e.find(".title_input"),r,{custom_for:"channel_create_title"})})}});var e;var t;var i;var n=function t(){e=$(".mpim_conversion_modal");e.on("click",".continue",function(){a()});e.find(".convert_mpim_go").click(TS.ui.mpim_conversion_modal.go);var i=e.find(".title_input");i.keydown(function(e){e.which===TS.utility.keymap.enter?TS.ui.mpim_conversion_modal.go():e.which===TS.utility.keymap.esc&&TS.ui.fs_modal.close()})};var a=function i(){if(!$("#conversion_step").hasClass("hidden")&&e.find(".title_input").val().length>1)return TS.ui.mpim_conversion_modal.go();$("#confirmation_step").addClass("hidden");$("#conversion_step").removeClass("hidden");t=Ladda.create(e.find(".convert_mpim_go")[0]);e.find(".title_input").focus();return false};var r=function e(){s()};var s=function n(){e=null;t=null;i=null}})()},3081:function(e,t){(function(){TS.registerComponent("ui.PdfViewer",{_constructor:function e(t,i){if(!i||!t||!t.length){TS.error("TS.ui.PdfViewer missing either the file or iframe");return}if(!TS.files.fileIsPDF(i)){TS.error("Non-PDF given to TS.ui.PdfViewer");return}TS.metrics.count("pdf_viewer_open");this.file=i;this.$iframe=t;this.$image_wrapper=this.$iframe.parent();this.$pdf_loading_spinner=$("#pdf_loading_spinner");var n=TS.boot_data.abs_root_url;_.endsWith(n,"/")&&(n=n.substring(0,n.length-1));this.iframe_origin=n;this.iframe_ready=false;this.addLoadingSpinner(this.$pdf_loading_spinner);this.loadData();this.boundOnMessage=this.onMessage.bind(this);$(window).on("message",this.boundOnMessage)},addLoadingSpinner:function e(t){t.removeClass("hidden").html(TS.templates.infinite_spinner({color:"blue",size:"medium",speed:"fast"}))},removeLoadingSpinner:function e(t){t.addClass("hidden")},destroy:function e(){this.xhr&&this.xhr.abort();$(window).off("message",this.boundOnMessage);this.$iframe&&this.$iframe.blur()},loadData:function e(){var t=this.file.converted_pdf||this.file.url_private_download;this.xhr=new XMLHttpRequest;this.xhr.onload=this.onLoad.bind(this);this.xhr.onerror=this.onError.bind(this);this.xhr.open("GET",t);this.xhr.responseType="arraybuffer";this.xhr.withCredentials=true;this.xhr.send()},addFallBackImage:function e(){this.$image_wrapper.addClass("broken_image")},onError:function e(){TS.metrics.count("pdf_viewer_xhr_error");TS.warn("Error requesting PDF data!");this.removeLoadingSpinner(this.$pdf_loading_spinner);this.addFallBackImage()},onLoad:function e(){if(4===this.xhr.readyState&&200==this.xhr.status){this.buffer=new Uint8Array(this.xhr.response);this.iframe_ready&&this.sendBuffer()}this.xhr=null},onMessage:function e(t){var i=t.origin||t.originalEvent.origin;if(!i)return;var n=t.data||t.originalEvent.data;if(!_.includes(["pdf_iframe_ready","corrupt_pdf","close_file_viewer"],n))return;if(i!==this.iframe_origin){TS.warn(n+" from unexpected origin: "+i);return}if("pdf_iframe_ready"===n){this.iframe_ready=true;this.$iframe.focus();this.buffer&&this.sendBuffer()}else if("corrupt_pdf"===n){TS.metrics.count("pdf_viewer_corrupt_pdf");this.addFallBackImage()}else"close_file_viewer"===n&&TS.ui.fs_modal_file_viewer.canClose()&&TS.ui.fs_modal.close()},sendBuffer:function e(){TS.model.is_our_app?this.$iframe[0].contentWindow.postMessage(this.buffer,this.iframe_origin,[this.buffer.buffer]):this.$iframe[0].contentWindow.postMessage(this.buffer,this.iframe_origin);this.removeLoadingSpinner(this.$pdf_loading_spinner)}})})()},3082:function(e,t){(function(){var e;var t;var i=6e4;TS.registerModule("ui.jumper",{is_showing:false,k_key_omnibox_auto_hide_count_max:5,onStart:function e(){TS.client.login_sig.add(TS.ui.jumper.onLogin)},onLogin:function e(){v()},start:function e(t){if(TS.isPartiallyBooted())return;if(TS.ui.jumper.is_showing)return;p=true;t=true===t&&t;if(TS.interop.isExperimentAnyOmniSwitcher()){TS.interop.searchActions.openFromQuickSwitcherCmd({key:t?"k":"button"});return}TS.metrics.mark("start_jumper_open");$(window.document).on("keydown.jumper",P);TS.tips.hideAll();r[0].classList.add("active");s.removeAttr("disabled");s.focus();TS.model.dialog_is_showing=true;TS.ui.jumper.is_showing=true;$("#client-ui").attr("aria-hidden",true);TS.metrics.measureAndClear("jumper_open","start_jumper_open");TS.boot_data.feature_cross_workspace_quick_switcher_prototype?r.find("ts-jumper-shortcut-pill").toggleClass("hidden",t):r.find("ts-jumper-shortcut-banner").toggleClass("hidden",t);var i=true;TS.searcher.search("",{members:z(),channels:Y(i),groups:Y(i),enterprise_channels:q(),mpims:true,sort:false,tiered:true,app_actions:TS.interop.apps.isGlobalActionsEnabled()}).then(function(e){if(!TS.ui.jumper.is_showing)return;a=Z(e);x(a,"");return null})},getSessionId:function n(){var a=t&&Date.now()-t>i;t=new Date;e&&!a||(e=TS.interop.utility.uuidv4());return e},expireSession:function t(){e=void 0},end:function e(){b();r[0].classList.remove("active");$(window.document).off("keydown.jumper",P);TS.kb_nav.end();o.off("mousemove");c&&c.cancel();c=null;l={};TS.model.dialog_is_showing=false;TS.ui.jumper.is_showing=false;$("#client-ui").attr("aria-hidden",false);s.blur();TS.tips.unhideAll();var t=TS.interop.redux.features.channelSidebar;"HIDE_BUTTON_PENDING"===t.getJumperCoachmarkState(TS.redux.getState())&&TS.redux.dispatch(t.setJumperCoachmarkState("HIDE_BUTTON"));TS.ui.jumper.expireSession()},debugQuery:function e(t){TS.sorter.printTest(t,{prefer_exact_match:true,frecency:true})}});var n=24;var a=[];var r;var s;var o;var l={};var c;var d=false;var u;var m;var f=200;var h=false;var p=false;var g=580;var T=273;var S=36;var v=function e(){var t={cmd_shortcut:TS.model.is_mac?TS.interop.i18n.t("\u2318K","keys")():TS.interop.i18n.t("Ctrl+K","keys")()};var i=TS.templates.jumper(t);$("body").append(i);r=$("ts-jumper");s=r.find("input");window.bowser&&"Windows"===bowser.osname&&s.attr("role","combobox");o=r.find("ts-jumper-results");w();u=TS.utility.debounceWithPromise(function(e,t){h=true;x(e,t)},f)};var b=function e(){s.val("");_.each(a,function(e){e.model_ob._jumper_previous_name_match&&(e.model_ob._jumper_previous_name_match=void 0)});x(a,"");o.scrollTop(0)};var w=function e(){s.on("input.search",function(){var e=_.trim(s.val()).toLocaleLowerCase();c&&c.cancel();if(e){TS.metrics.mark("start_jumper_search");TS.metrics.mark("start_jumper_remote_search");W(e)}else b()});s.on("keydown",function(e){if(e.which!=TS.utility.keymap.enter)return;var t=o.find('[data-action="new_channel"]');t.length&&K();e.stopPropagation()});s.on("blur",function(){TS.ui.jumper.is_showing&&s.focus()});r.on("click","[data-item-id]",function(e){U($(this));e.preventDefault()});r.on("click",'[data-action="new_channel"]',K);r.on("click.end",function(e){$(e.target).is("ts-jumper")&&TS.ui.jumper.end()});r.on("unhighlighted",function(e){var t=$(e.target);t.removeAttr("aria-selected");t.removeAttr("id");t.removeAttr("tabindex");s.removeAttr("aria-activedescendant")});r.on("highlighted",function(e){if(p){p=false;return}var t=$(e.target);var i=t.data("item-id");t.attr({id:i,"aria-selected":true,tabindex:"-1"});s.attr("aria-activedescendant",i)})};var y=function e(t,i){var n=i.scrollTop;d=!!n};var A=function e(t,i){var n=_.isArray(t)?t.length:0;var a=_.isArray(i)?i.length:0;var r=S*n;1===a?r+=S:a&&(r+=o.hasClass("show_deleted")?S*a:S);return r};var k=function e(t,i,n,a){var r=A(n,a);var s=Math.min(r,T);var o=g;TS.interop.mountScrollbar(TS.boot_data.team_id,t,{safeHtml:i,width:o,height:s,contentHeight:r,onScroll:y})};var C=function e(t){TS.interop.unmountScrollbar(t)};var x=function e(t,i){m&&m.cancel();if(!i&&_.trim(s.val()).length>0)return;var n=I(t,i);var a="";t=_.uniqBy(t,"model_ob.id");if(0==t.length){a=TS.utility.channels.getPermissibleChannelName(i);n&&(a=null)}var c=_.remove(t,function(e){return e.model_ob.deleted});var u={matches:t,query:i,deleted:c,show_new_channel_link:!!a,clean_name:a,show_extended_search:n,threads_has_unreads:TS.model.threads_has_unreads,threads_mention_count:TS.model.threads_mention_count,show_scores:TS.prefs.getPref("show_jumper_scores")};var f=TS.templates.jumper_results(u).trim();t.length||c.length||n?r.removeClass("empty_results"):r.addClass("empty_results");TS.boot_data.feature_cross_workspace_quick_switcher_prototype&&r.toggleClass("p-jumper--loading",n);if(t.length){o.removeAttr("aria-live");o.attr("role","listbox");o.removeClass("show_deleted");l={html:f,matches:t,deleted:c};k(o.get(0),f,t,c)}if(!t.length){C(o.get(0));o.removeAttr("role");o.empty();if(i){o.attr("aria-live","assertive");o.append(f)}}1===c.length&&o.addClass("show_deleted");B(t.concat(c));E();d&&o.find(".c-scrollbar__hider").scrollTop(0)};var I=function e(t,i){if(h){h=false;return true}TS.boot_data.should_use_flannel&&!!i&&t.length<n&&c&&!c.isResolved()&&(m=u(t,i));return false};var M=function e(){o.addClass("show_deleted");var t=r.find("li.deleted").eq(0);t.length&&TS.kb_nav.highlightItemWithKey(t,true);var i=l,n=i.html,a=i.matches,s=i.deleted;k(o.get(0),n,a,s)};var E=function e(){o.one("mousemove",function(){o.one("mousemove",function(){var e=o.find("ol")[0];e&&e.classList.remove("no_pointer_events")})})};var B=function e(t){TS.kb_nav.end();TS.kb_nav.start(r.find("ol"),"li",r.find("ol"),{bindTo:s[0],allowTabHighlightWhenEmptyInput:true});TS.kb_nav.setAllowHighlightWithoutBlurringInput(true);TS.kb_nav.setSubmitItemHandler(function(e){U($(this));e.preventDefault()});if(t.length>0){var i=r.find("li:first");TS.kb_nav.highlightItemWithKey(i,true)}};var P=function e(t){if(!TS.ui.jumper.is_showing)return;t.which==TS.utility.keymap.tab&&t.preventDefault();if(t.which==TS.utility.keymap.esc){TS.ui.jumper.end();t.preventDefault();t.stopPropagation()}else if(!t.altKey&&TS.interop.utility.isCmdKey(t)&&(75==t.which||TS.model.is_our_app&&84==t.which))if(_.trim(s.val()))b();else{TS.ui.jumper.end();t.preventDefault()}};var U=function e(t){t||TS.warn("No $el for Jumper selection");var i=t.data("item-id");i||TS.warn("No ID for Jumper selection");var n;var a=_.trim(s.val());if("deleted_count"===i){M();return}var r=i.charAt(0);n="V"===r?TS.model.getViewById(i):"T"===r?TS.redux.teams.getTeamById(i):TS.interop.utility.looksLikeMemberId(i)?TS.interop.members.getMemberById(i):TS.interop.apps.isGlobalActionsEnabled()&&TS.interop.utility.looksLikeGlobalActionFrecencyId(i)?F(i):D(i);TS.ui.frecency.record(n,a);TS.redux.dispatch(TS.interop.channels.updateChannelLastTrigger({source:"QUICK_SWITCH",objId:i}));n&&n.domain?L(n):TS.interop.apps.isGlobalActionsEnabled()&&TS.interop.utility.looksLikeGlobalActionFrecencyId(i)?G(n):n?R(n).catch(function(){TS.sounds.play("beep")}).finally(function(){TS.ui.jumper.end()}):TS.error("Unknown jumper item "+i)};var D=function e(t){return TS.boot_data.page_needs_enterprise?TS.enterprise.getModelObById(t):TS.redux.channels.getEntityById(t)};var F=function e(t){var i=TS.interop.utility.decodeGlobalActionFrecencyId(t);if(!i)return null;var n=TS.interop.redux.models.appActions.selectGlobalActionsCache(TS.redux.getState());return n[i]};var O=function e(t){var i={item_id:t.id,item_type:t.id.charAt(0),quickswitcher_session_id:TS.ui.jumper.getSessionId()};void 0!==t.is_member&&null!==t.is_member&&(i.is_member=t.is_member);TS.interop.clog.track("QUICKSWITCHER_SELECT",i)};var R=function e(t){TS.boot_data.feature_tinyspeck&&TS.info("jumper: promising to switch to "+t.id);if(t.is_channel){O(t);if(TS.enterprise.getChannelById(t.id)||TS.interop.rules.channels.isFromAnotherTeam(t))return N(t);return TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:t.id}))}if(t.is_mpim&&t.is_group){O(t);return TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:t.id}))}if(t.is_group&&!t.is_mpim){O(t);if(TS.enterprise.getGroupById(t.id)||TS.interop.rules.channels.isFromAnotherTeam(t))return N(t);return TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:t.id}))}if(t.is_view){O(t);return TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:t.id}))}if(t.presence){s.attr("disabled","disabled");O(t);var i=TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:t.id}));var n=setTimeout(function(){Q(TS.interop.members.getPrefCompliantMemberName(t))},500);return i.then(function(){clearTimeout(n)},function(e){j();throw e})}TS.ui.jumper.expireSession();return Promise.reject()};var N=function e(t){var i=t.id;var n=t.team_id||TS.interop.rules.channels.teamIdForChannelFromAnotherTeam(TS.redux.getState(),t);if(TS.interop.environment.isSSBAndAtLeastVersion("2.6")){var a=TS.interop.desktop.getSignedInTeamIds();var r=_.includes(a,n);var s=r?Promise.resolve():TS.client.userAddedToTeam(n);r||Q(t.name);return s.then(H).then(function(){var e=document.createElement("iframe");var t="slack://channel"+TS.interop.url.queryStringEncode({team:n,id:i});e.src=t;document.body.appendChild(e);setTimeout(function(){return e.remove()},1e3)})}TS.ui.jumper.end();var o=_.get(TS.teams.getTeamById(n),"domain");var l=TS.utility.enterprise.buildTeamUrl(o)+"messages/"+i;TS.utility.openInNewTab(l,n);return Promise.resolve()};var L=function e(t){var i=t.id;TS.prefs.setPrefByAPI({name:TS.ui.frecency.isEnterprise()?"frecency_ent_jumper":"frecency_jumper",value:JSON.stringify(TS.model.frecency_jumper)});if(TS.model.is_our_app){var n=_.find(TS.boot_data.other_accounts,{team_id:i});var a=TS.interop.desktop.getSignedInTeamIds();var r=_.includes(a,i);if(!r&&n)return Promise.resolve().then(H).then(function(){var e=n.name,t=n.id,i=n.team_id,a=n.team_name,r=n.team_url;TS.interop.desktop.didSignIn({name:e,id:t,team_id:i,team_name:a,team_url:r})});var s=r?Promise.resolve():TS.client.userAddedToTeam(i);r||Q(t.name);return s.then(H).then(function(){if(TS.interop.environment.isSSBAndAtLeastVersion("2.8"))TS.interop.desktop.displayTeamById(i);else if(n)TS.interop.desktop.displayTeam(n.id);else{var e=document.createElement("iframe");var t="slack://open?team="+i;e.src=t;document.body.appendChild(e);setTimeout(function(){return e.remove()},1e3)}})}TS.ui.jumper.end();var o=t.url||TS.utility.enterprise.buildTeamUrl(_.get(t,"domain"));TS.utility.openInNewTab(o,i);return Promise.resolve()};var G=function e(t){TS.interop.apps.runAppAction({type:t.type,actionId:t.id,appId:t.app.id,channelId:TS.model.active_cid});TS.ui.jumper.end()};var H=function e(){TS.ui.jumper.end();return new Promise(function(e){TS.utility.rAF(e)})};var Q=function e(t){s.attr("disabled","disabled");TS.boot_data.feature_cross_workspace_quick_switcher_prototype?r.addClass("p-jumper--loading"):o.html(TS.templates.jumper_switch_loading({name:t}))};var j=function e(){s.removeAttr("disabled").removeClass("p-jumper--loading").trigger("input.search")};var K=function e(){var t=_.trim(s.val());TS.ui.jumper.end();TS.ui.new_channel_modal.start(t)};var W=function e(t){TS.boot_data.feature_log_quickswitcher_queries&&TS.interop.clog.track("QUICKSWITCHER_QUERY",{quickswitcher_session_id:TS.ui.jumper.getSessionId()});c=TS.searcher.search(t,{members:z(),channels:Y(),groups:Y(),mpims:true,teams:J(),views:true,enterprise_channels:q(),app_actions:TS.interop.apps.isGlobalActionsEnabled(),tiered:true,sort:{search_previous_channel_names:true},limit:n}).then(function(e){TS.boot_data.feature_cross_workspace_quick_switcher_prototype?TS.metrics.measure("jumper_search_xws","start_jumper_search"):TS.metrics.measure("jumper_search","start_jumper_search");TS.metrics.mark("start_jumper_render");x(e,t);if(TS.boot_data.feature_cross_workspace_quick_switcher_prototype){TS.metrics.measureAndClear("jumper_results_xws","start_jumper_search");TS.metrics.measureAndClear("jumper_render_xws","start_jumper_render")}else{TS.metrics.measureAndClear("jumper_results","start_jumper_search");TS.metrics.measureAndClear("jumper_render","start_jumper_render")}return e.promise});c.then(function(e){var i=TS.kb_nav.getHighlightedItem();var n=r.find("li:first");TS.metrics.mark("start_jumper_remote_render");x(e,t);if(TS.boot_data.feature_cross_workspace_quick_switcher_prototype){TS.metrics.measureAndClear("jumper_remote_results_xws","start_jumper_remote_search");TS.metrics.measureAndClear("jumper_remote_render_xws","start_jumper_remote_render")}else{TS.metrics.measureAndClear("jumper_remote_results","start_jumper_remote_search");TS.metrics.measureAndClear("jumper_remote_render","start_jumper_remote_render")}if(i){var a=i.data("item-id");var s=n.data("item-id");var o=a&&s&&a!==s;if(o){var l=TS.kb_nav.getItemByItemId(a);l&&TS.kb_nav.highlightItemWithKey(l,true)}}})};var V=function e(t){var i=TS.shared.legacyGetActiveModelOb().id;return i&&i==t.id};var z=function e(){return{include_org:true,include_slackbot:true,include_self:true,include_deleted:true,full_profile_filter:false,org_team_ids:[]}};var Y=function e(t){return{include_archived:!t,include_from_another_team:TS.boot_data.page_needs_enterprise&&TS.boot_data.feature_legacy_flannel_xws}};var q=function e(){if(!TS.enterprise.isCrossWorkspacePrototypeEnabled())return null;if(TS.boot_data.feature_legacy_flannel_xws)return null;return{runaway:true,remote_limit:2*n}};var J=function e(){return{runaway:true,remote_limit:n}};var Z=function e(t){var i=[];var a=[];var r=[];var s=[];_.forEach(t.members,function(e){var t=TS.redux.channels.getImByMemberId(e.id);t&&t.unread_cnt&&t.unread_cnt>0?i.push({model_ob:e,score:0}):t&&_.trim(t.last_msg_input)&&!V(t)&&!TS.interop.channels.isImWithDeletedMember(t)&&r.push({model_ob:e,score:0})});_.forEach(t.mpims,function(e){e.unread_cnt&&e.unread_cnt>0?i.push({model_ob:e,score:0}):_.trim(e.last_msg_input)&&!V(e)&&r.push({model_ob:e,score:0})});_.forEach(t.groups,function(e){e.unread_highlight_cnt&&e.unread_highlight_cnt>0?i.push({model_ob:e,score:0}):e.unread_cnt&&e.unread_cnt>0&&!TS.notifs.isCorGMuted(e.id)?a.push({model_ob:e,score:0}):!_.trim(e.last_msg_input)||V(e)||e.is_archived||r.push({model_ob:e,score:0})});_.forEach(t.channels,function(e){e.unread_highlight_cnt&&e.unread_highlight_cnt>0&&e.is_member?i.push({model_ob:e,score:0}):e.unread_cnt&&e.unread_cnt>0&&!TS.notifs.isCorGMuted(e.id)&&e.is_member?a.push({model_ob:e,score:0}):_.trim(e.last_msg_input)&&!V(e)&&!e.is_archived&&e.is_member&&r.push({model_ob:e,score:0})});var o=_.find(TS.model.NAMED_VIEWS,{id:"Vall_threads"});TS.model.threads_mention_count&&o?i.push({model_ob:o,score:0}):TS.model.threads_has_unreads&&o&&a.push({model_ob:o,score:0});s=i.concat(a,r);if(!s.length&&t.channels.length+t.groups.length<10){_.forEach(t.channels,function(e){s.push({model_ob:e,score:0})});_.forEach(t.groups,function(e){s.push({model_ob:e,score:0})})}return s.slice(0,n)}})()},3083:function(e,t){(function(){TS.registerModule("utility.box",{onStart:function e(){},launchPopup:function e(){if(!window.BoxSelect)return;var n;try{n=window.open;window.open=function(e,i,a){var r;var s;var o;var l;r=String(a).match(/width\D+(\d+)/);r=parseInt(r&&r[1]||590,10);s=String(a).match(/height\D+(\d+)/);s=parseInt(s&&s[1]||520,10);o=(window.screenX||window.screenLeft)+((window.outerWidth||document.documentElement.offsetWidth)-r)/2;l=(window.screenY||window.screenTop)+((window.outerHeight||document.documentElement.offsetHeight)-s)/2;t=n(e,i,[a,"left="+o,"top="+l].join(","));return t};i().launchPopup();window.focus&&t&&t.focus()}finally{window.open=n}},closePopup:function e(){window.BoxSelect&&i().closePopup()},success:function e(t){window.BoxSelect&&i().success(t)},cancel:function e(t){window.BoxSelect&&i().cancel(t)},unregister:function e(){window.BoxSelect&&i().unregister.apply(i(),arguments)},isBrowserSupported:function e(){if(window.BoxSelect)return i().isBrowserSupported()},test:function e(){return{getBoxSelect:i,setBoxSelect:n}}});var e;var t;var i=function t(){if(e)return e;e=new window.BoxSelect({clientId:TS.boot_data.box_app_key,linkType:"shared",multiselect:"true"});TS.utility.box.SUCCESS_EVENT_TYPE=e.SUCCESS_EVENT_TYPE;TS.utility.box.CANCEL_EVENT_TYPE=e.CANCEL_EVENT_TYPE;return e};var n=function t(i){e=i}})()},3084:function(e,t){(function(){TS.registerModule("files.gdrive",{onStart:function e(){if(!TS.client)return;TS.files.team_file_shared_sig.add(g)},openPickerWindow:function t(i,l){var d=null;return new Promise(function(t,i){var r=TS.utility.window.open({url:e,try_window_open_in_ssb:true,height:n});r||i(new Error("could not open window"));d=o(t,i);window.addEventListener("message",d);a&&i("Promise already made");a=true}).then(function(e){a=false;var t=TS.shared.legacyGetActiveModelOb();TS.boot_data.feature_file_threads&&i&&(t=TS.redux.channels.getEntityById(i));var n=TS.boot_data.feature_file_threads&&t?l:null;return c(e.chosen_files,t,n)}).catch(function(e){if("Promise already made"===e)return;var t=r;var i=TS.shared.legacyGetActiveModelOb();TS.error(e);if(("unidentified_external_url"===e.data.error||"file_type_has_no_handler"===e.data.error)&&e.args.link){t=TS.interop.i18n.t("We don\u2019t currently support importing that type of Google Drive file, but we included the link so that others can access it.","files")();p(i.id,e.args.link)}"filename_too_long"===e.data.error&&(t=s);TS.client.ui.addEphemeralBotMsg({text:t,ephemeral_type:"file_type_has_no_handler",slackbot_feels:"sad_surprise"});a=false}).finally(function(){window.removeEventListener("message",d)})},createAndShare:function e(t,i,n,a){if(TS.boot_data.feature_file_threads){TS.redux.dispatch(TS.interop.redux.actions.openCreateGDocDialog({type:t,displayType:i,initialChannelId:n||TS.model.active_cid,threadTs:a}));return}return m(t,i).then(function(e){TS.files.gdrive.create(t,e)}).catch(function(){TS.menu.file.onGDriveCreateComplete(false)})},create:function e(t,n){if(n&&n.channel){var a=TS.redux.channels.getEntityById(n.channel);a&&a.is_channel?TS.channels.legacyDisplayChannel({id:a.id}):a&&a.is_mpim?TS.mpims.legacyDisplayMpim({id:a.id}):a&&a.is_group?TS.groups.legacyDisplayGroup({id:a.id}):a&&TS.redux.channels.getImByMemberId(n.channel)?TS.ims.legacyStartImByMemberId(n.channel):TS.error("no valid shared channel/im/mpim/group to display")}return TS.interop.api.call("files.createExternal",{service_stub:"gdrive",mime_type:i+"."+t,filename:n.title||"",open_edit:!!n.channel}).then(function(e){TS.utility.window.alwaysOpenInBrowser(e.data.url);var t=n&&n.channel;t?h(e.data.url,n.channel,n.comment,n.thread_ts).then(function(){TS.menu.file.onGDriveCreateComplete(true,e,t)}):TS.menu.file.onGDriveCreateComplete(true,e,t)}).catch(function(e){TS.menu.file.onGDriveCreateComplete(false);var i=r;if("use_auth_url"===e.data.error)return u(t,n);"filename_too_long"===e.data.error&&(i=s);TS.error(e);TS.client.ui.addEphemeralBotMsg({text:i,ephemeral_type:"unhandled_gdrive_create",slackbot_feels:"sad_surprise"})})}});var e=TS.boot_data.team_url+"files/import/gdrive";var t=TS.boot_data.team_url+"files/create/gdrive/auth";var i="application/vnd.google-apps";var n=675;var a=false;var r=TS.interop.i18n.t("Darn, that didn\u2019t work. Try again or <https://my.slack.com/help/requests/new|contact us> if it\u2019s still not working.","files")();var s=TS.interop.i18n.t("Sorry! The name of that file is too long for us to handle. Please try importing a file with a shorter filename.","files")();var o=function e(t,i){return TS.files.getMessageListener({resolve:t,reject:i,method:"gdrive_picker"})};var l=function e(t,i){return TS.files.getMessageListener({resolve:t,reject:i,method:"google_auth"})};var c=function e(t,i,n){var a=t.map(function(e){return d(e,i,n)});return Promise.all(a)};var d=function e(t,i,n){return TS.interop.api.call("files.uploadExternal",{channels:i.id,link:t.url,thread_ts:n}).then(function(e){!TS.boot_data.feature_file_threads&&i.user&&TS.redux.channels.getImByMemberId(i.user)&&TS.model.team.enterprise_id&&p(i.id,e.data.file.url_private,true,true)})};var u=function e(i,a){var r=null;return new Promise(function(e,i){var a=TS.utility.window.open({url:t,try_window_open_in_ssb:true,height:n});a||i(new Error("could not open window"));r=l(e,i);window.addEventListener("message",r)}).then(function(){return TS.files.gdrive.create(i,a)}).catch(function(e){TS.error(e)}).finally(function(){window.removeEventListener("message",r)})};var m=function e(t,n){return new Promise(function(e,a){var r={type:i+t,display_type:n};var s=TS.templates.builders.buildFileSharingControls(r,false,false,true,null);var o=void 0;o="document"===t?TS.interop.i18n.t("Create a Google Document","files")():"presentation"===t?TS.interop.i18n.t("Create a Google Presentation","files")():"spreadsheet"===t?TS.interop.i18n.t("Create a Google Spreadsheet","files")():TS.interop.i18n.t("Create a Google file","files")();TS.generic_dialog.start({title:o,body:TS.templates.gdrive_create_dialog({sharing_html:new Handlebars.SafeString(s)}),show_cancel_button:true,esc_for_ok:false,fullscreen:false,go_button_text:TS.interop.i18n.t("Create","files")(),type:"overflow_visible",onGo:function t(){e(f())},onCancel:a});$("#share_cb").removeAttr("checked");TS.ui.file_share.bindFileShareDropdowns();TS.ui.file_share.bindFileShareShareToggle();TS.ui.file_share.bindFileShareCommentField();TS.ui.comments.bindInput($("#file_comment_textarea"),function(){e(f)})})};var f=function e(){var t=_.trim(TS.utility.contenteditable.value($("#file_comment_textarea")));t=TS.utility.contenteditable.legacySynchronouslyReplacePotentialMentions(t,{enableBroadcastKeywords:false});return{title:_.trim($("#document_title").val())||TS.interop.i18n.t("Untitled","files")(),comment:t,channel:!!$("#share_cb").is(":checked")&&$("#share_model_ob_id").val()}};var h=function e(t,i,n,a){var r=false;!TS.boot_data.feature_file_threads&&TS.redux.channels.getImByMemberId(i)&&(r=true);var s={link:t,channels:r?"":i};TS.boot_data.feature_file_threads&&n&&(s.initial_comment=n);TS.boot_data.feature_file_threads&&a&&(s.thread_ts=a);return TS.interop.api.call("files.uploadExternal",s).then(function(e){r&&p(i,e.data.file.url_private,true,true);!TS.boot_data.feature_file_threads&&n&&TS.interop.api.call("files.comments.add",{file:e.data.file.id,comment:n,channel:i,override_ft:true})}).catch(function(e){TS.error(e);TS.client.ui.addEphemeralBotMsg({text:TS.interop.i18n.t("Oh no! I couldn\u2019t import your newly created file","files")(),ephemeral_type:"gdrive_share_file_error",slackbot_feels:"sad_surprise"})})};var p=function e(t,i,n,a){TS.interop.api.call("chat.postMessage",{channel:t,text:i,unfurl_links:n||false,unfurl_media:a||false}).catch(function(e){TS.error(e)})};var g=function e(t){if("gdrive"!==_.get(t,"external_type"))return;if(_.get(t,"user")!==TS.model.user.id)return;if(!TS.prefs.getTeamPref("gdrive_enabled_team"))return;if(TS.prefs.getPref("seen_gdrive_coachmark"))return;TS.coachmark.start(TS.coachmarks.coachmarks.gdrive);TS.prefs.setPrefLocal("seen_gdrive_coachmark",true);TS.prefs.setPrefByAPI({name:"seen_gdrive_coachmark",value:true})}})()},3085:function(e,t){(function(){TS.registerModule("files.onedrive",{openPickerWindow:function n(s,o){return new Promise(function(e,n){$.get(i).then(function(){t(e,n)}).fail(function(e){n(new Error(e.status))})}).then(function(t){a=false;var i=TS.shared.legacyGetActiveModelOb();TS.boot_data.feature_file_threads&&s&&(i=TS.redux.channels.getEntityById(s));var n=TS.boot_data.feature_file_threads&&i?o:null;l(t.chosen_files,i,n).then(function(){TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{step:"file_successfully_imported",action:"window_open",trigger:"plus_menu_subitem_cloud_onedrive"}}})}).catch(function(t){var i=e(t);TS.client.ui.addEphemeralBotMsg({text:i,ephemeral_type:"file_type_has_no_handler",slackbot_feels:"sad_surprise",c_id:s,thread_ts:o});var n="Could not complete files.uploadExternal. ";TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{step:"file_not_imported",action:"window_open",trigger:"plus_menu_subitem_cloud_onedrive",error_msg:t.message?n+t.message:n}}});a=false})}).catch(function(t){if(t.message&&"Promise already made"===t.message)return;var i=e(t);TS.client.ui.addEphemeralBotMsg({text:i,ephemeral_type:"onedrive_sdk_error",slackbot_feels:"sad_surprise",c_id:s,thread_ts:o});var n="Could not open the picker window, /files/import/onedrive. ";TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{step:"file_not_imported",action:"window_open",trigger:"plus_menu_subitem_cloud_onedrive",error_msg:t.message?n+t.message:n}}});a=false}).finally(function(){$("#onedrive_picker_iframe").remove();window.removeEventListener("message",r)})},test:function a(){var r={_constructEphemeralText:e,_popWindowOrIframe:t,_getMessageListenerForPicker:o,_ONEDRIVE_IMPORT_URL:i,_ONEDRIVE_APP_URL:n,_FALLBACK_EPHEMERAL_MESSAGE:s};Object.defineProperty(r,"_constructEphemeralText",{get:function t(){return e},set:function t(i){e=i}});Object.defineProperty(r,"_popWindowOrIframe",{get:function e(){return t},set:function e(i){t=i}});Object.defineProperty(r,"_getMessageListenerForPicker",{get:function e(){return o},set:function e(t){o=t}});Object.defineProperty(r,"_ONEDRIVE_APP_URL",{get:function e(){return n},set:function e(t){n=t}});Object.defineProperty(r,"_FALLBACK_EPHEMERAL_MESSAGE",{get:function e(){return s},set:function e(t){s=t}});Object.defineProperty(r,"_ONEDRIVE_IMPORT_URL",{get:function e(){return i},set:function e(t){i=t}});return r}});var e=function e(t){var i=s;TS.error(t);t.message&&"403"===t.message&&TS.boot_data.feature_onedrive_picker&&(i=TS.interop.i18n.t("Looks like you\u2019re trying to add a OneDrive file \u2014 first you\u2019ll need to connect <{url}|OneDrive to Slack>.\n\n Once your account is connected, you\u2019ll be able to easily share files, see file previews, and even find your files later as you search in Slack. <{url}|Learn more about using OneDrive in Slack>.","files")({url:n}));return i};var t=function e(t,n){if(TS.interop.desktop.isDesktop){var s=TS.utility.window.open({url:i,show:false,skipTaskbar:true,frame:false,opacity:0,transparent:true,focusable:false});TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{step:"file_picker_open_electron",action:"window_open",trigger:"plus_menu_subitem_cloud_onedrive"}}});s||n(new Error("could not open window"))}else{$("<iframe>",{src:i,id:"onedrive_picker_iframe"}).appendTo("body").hide();TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{step:"file_picker_open_browser",action:"window_open",trigger:"plus_menu_subitem_cloud_onedrive"}}})}r=o(t,n);window.addEventListener("message",r);a&&n(new Error("Promise already made"));a=true};var i=TS.boot_data.team_url+"files/import/onedrive";var n=TS.interop.environment.isDev?TS.boot_data.team_url+"apps/A061CBSP3":TS.boot_data.team_url+"apps/A53TM6XA9";var a=false;var r=null;var s=TS.interop.i18n.t("Darn, that didn\u2019t work. Try again or <https://my.slack.com/help/requests/new|contact us> if it\u2019s still not working.","files")();var o=function e(t,i){return TS.files.getMessageListener({resolve:t,reject:i,method:"onedrive_picker"})};var l=function e(t,i,n){var a=t.map(function(e){return c(e,i,n)});return Promise.all(a)};var c=function e(t,i,n){return TS.interop.api.call("files.uploadExternal",{channels:i.id,link:t,thread_ts:n})}})()},3086:function(e,t){(function(){TS.registerModule("client.unread",{switched_sig:new signals.Signal,switched_away_sig:new signals.Signal,fetched_unreads_sig:new signals.Signal,marked_group_as_read_sig:new signals.Signal,marked_group_as_unread_sig:new signals.Signal,marked_all_as_read:new signals.Signal,marked_all_as_unread:new signals.Signal,bulk_unread_count_change_sig:new signals.Signal,new_messages_in_channels:[],messages_loaded:false,last_request_id:"",onStart:function e(){TS.prefs.enable_unread_view_changed_sig.add(k);TS.prefs.enable_unread_view_changed_sig.add(C);TS.channels.message_received_sig.add(S);TS.groups.message_received_sig.add(S);TS.ims.message_received_sig.add(S);TS.mpims.message_received_sig.add(S);TS.channels.message_changed_sig.add(v);TS.groups.message_changed_sig.add(v);TS.ims.message_changed_sig.add(v);TS.mpims.message_changed_sig.add(v);TS.channels.message_removed_sig.add(b);TS.groups.message_removed_sig.add(b);TS.ims.message_removed_sig.add(b);TS.mpims.message_removed_sig.add(b);TS.files.team_file_changed_sig.add(y);TS.channels.deleted_sig.add(A);TS.client.login_sig.add(I);TS.client.login_sig.add($);TS.prefs.all_unreads_sort_order_changed_sig.add($)},isEnabled:function e(){return!!TS.prefs.getPref("enable_unread_view")},shouldRecordMetrics:function t(){return!!e},debug:function e(t,i){h.push({msg:t,data:i});if(!TS.boot_data.feature_tinyspeck)return;TS.info("[ALL_UNREADS] "+t,i)},showUnreadView:function t(i,n,a){if(!TS.client.unread.isEnabled())return false;i=!!i;n=!!n;var r=!n&&i;var o=TS.client.unreadViewActivated(n,r);if(!o)return false;TS.client.unread.switched_sig.dispatch();TS.msg_edit.editing_in_msg_pane&&TS.msg_edit.resetEditUI();u=a;e=TS.utility.enableFeatureForUser(1);e&&TS.metrics.mark("unread_view_time_to_display");x();s=TS.interop.datetime.makeTsStamp(null,{padder:"0",uniqueNum:9});TS.client.ui.unread.showUnreadView();e&&TS.metrics.count("unread_view_displayed");e&&TS.metrics.mark("unread_view_time_spent");if(m){m=false;TS.interop&&TS.interop.ChannelSidebar&&TS.interop.ChannelSidebar.ensureRowInView("Vall_unreads");TS.metrics.count("unread_view_coachmark_conversion")}return true},destroyUnreadView:function t(){if(!TS.client.ui.unread.isUnreadViewDOMShowing())return;e&&TS.metrics.measureAndClear("unread_view_time_spent","unread_view_time_spent");TS.client.ui.unread.destroyUnreadView();x();TS.client.unread.switched_away_sig.dispatch()},reloadIfPendingMessages:function e(){TS.client.unread.getTotalNewUnreadCount()>0&&TS.client.unread.new_messages_in_channels.length&&TS.client.unread.reload()},reload:function e(){u=void 0;TS.client.ui.unread.removeEmptyState();x();TS.client.ui.unread.restart()},getGroup:function e(i){return _.find(t,{model_ob:{id:i}})},getAllGroups:function e(){return t},collapseGroup:function e(n,a){a&&TS.interop.api.call("unread.collapse",{channel:n.id});n.collapsed=true;n.hidden_msgs=n.msgs;n.msgs=[];if(o&&o.id===n.id){t=t.concat(i);TS.client.ui.unread.addMessageContainerGroups(i);P()}return n},expandGroup:function e(n,r){n.collapsed=false;r&&TS.interop.api.call("unread.expand",{channel:n.id});if(n.msgs.length>0){n.new_unread_msgs=n.msgs;n.new_unread_cnt=n.new_unread_msgs.length;n.msgs=[]}n.msgs=n.msgs.concat(n.hidden_msgs);T(n,"msgs");n.hidden_msgs=[];if(n.has_more){var s=_.findIndex(t,{id:n.id});i=t.splice(s+1);TS.client.ui.unread.removeMessageContainerGroup(_.map(i,"id"));o=n;l=a;a=false}return n},markGroupAsRead:function t(i,n){var a=null;i.previous_read_ts=i.model_ob.last_read;i.marked_as_read_cnt=i.total_unreads;i.marked_as_read=true;i.total_unreads=0;i.manually_marked_unread_msg=null;if(!n){TS.shared.legacyMarkReadMsg(i.model_ob.id,TS.client.unread.getMarkerTS(i),a);e&&TS.metrics.store("unread_view_mark_model_read",i.marked_as_read_cnt,{is_count:true})}TS.client.unread.marked_group_as_read_sig.dispatch(i);return i},markGroupAsUnread:function e(t){TS.shared.legacyMarkReadMsg(t.model_ob.id,t.previous_read_ts,null);t.marked_as_read=false;t.manually_marked_unread_msg=null;n=t.id;t.total_unreads=t.marked_as_read_cnt;t.marked_as_read_cnt=0;TS.client.unread.marked_group_as_unread_sig.dispatch(t);return t},markAllAsRead:function i(){var n=true;var r={};var s=0;t.forEach(function(e){r[e.id]=TS.client.unread.getMarkerTS(e);TS.client.unread.markGroupAsRead(e,n);s+=e.msgs.length});e&&TS.metrics.count("unread_view_mark_all_read");e&&TS.metrics.store("unread_view_mark_all_read_count",s,{is_count:true});if(a){TS.interop.api.call("unread.markRead",{markers:JSON.stringify(r)});TS.client.ui.unread.displayEmptyState(s);TS.client.unread.marked_all_as_read.dispatch()}else TS.interop.api.call("unread.markRead",{markers:JSON.stringify(r)}).then(function(){if(!TS.model.unread_view_is_showing)return;TS.client.unread.reload();TS.client.unread.marked_all_as_read.dispatch()});var o={unread_count:s,request_id:TS.client.unread.last_request_id};TS.interop.clog.track("UNREADS_MARK_ALL_AS_READ",o)},markAllAsUnread:function e(){t.forEach(function(e){TS.client.unread.markGroupAsUnread(e)});TS.client.ui.unread.removeEmptyState();TS.client.unread.marked_all_as_unread.dispatch(t);var i={request_id:TS.client.unread.last_request_id};TS.interop.clog.track("UNREADS_MARK_ALL_AS_UNREAD",i)},getMarkerTS:function e(t){var i=TS.client.unread.getNewestMsgTs(t);(!i||i<s)&&(i=s);return i},updateGroupWithNewMessages:function e(t){if(t.new_unread_msgs){t.msgs=t.new_unread_msgs.concat(t.msgs);T(t,"msgs");t.total_unreads+=t.new_unread_cnt;t.new_unread_cnt=0;t.new_unread_msgs=[];t.marked_as_read=false;t.collapsed=false;TS.client.unread.new_messages_in_channels=_.without(TS.client.unread.new_messages_in_channels,t.id);TS.client.ui.unread.showOrHideRefreshButton()}return t},moveNewUnreadsOntoHiddenMsgs:function e(t){if(t.collapsed&&t.marked_as_read&&t.new_unread_msgs.length){t.hidden_msgs=t.new_unread_msgs;T(t,"msgs");t.new_unread_cnt=0;t.new_unread_msgs=[];t.msgs=[];t.total_unreads=t.hidden_msgs.length;t.marked_as_read=false;TS.client.unread.new_messages_in_channels=_.without(TS.client.unread.new_messages_in_channels,t.id);TS.client.ui.unread.showOrHideRefreshButton()}return t},getNewestMsgTs:function e(t){return t.msgs&&t.msgs.length?t.msgs[0].ts:null},promiseToGetMoreMessages:function t(){TS.client.unread.debug("promiseToGetMoreMessages");if(!u&&!n&&!TS.client.unread.getAllCurrentlyUnreadGroups().length){TS.client.unread.debug("DONE FETCHING: First fetch, not from boot, nothing in global model is unread, marking all msgs as fetched");a=true}if(a){TS.client.unread.debug("NO FETCHING: All messages are fetched");return Promise.resolve({groups:[],has_more:false})}clearTimeout(d);d=setTimeout(function(){TS.client.ui.unread.displaySlowLoadingMessage()},5e3);r=new Promise(function(t,r){var l=[];var c;n&&e&&TS.metrics.count("unread_view_scroll");if(o){var u=o.id;c={channel:o.id,oldest:TS.client.unread.getNewestMsgTs(o)||o.model_ob.last_read,latest:s,always_asc:true,ignore_replies:true,include_pin_count:true,no_user_profile:true};TS.client.unread.debug("Backfilling using api_args: ",_.clone(c));TS.interop.api.call("conversations.history",c).then(function(e){clearTimeout(d);if(!TS.model.unread_view_is_showing)return;TS.client.unread.last_request_id=e.request_id;if(o||o.id!=u){var n={channels:[{channel_id:o.id,messages:e.data.messages,has_more:e.data.has_more}],channels_count:1,total_messages_count:null};e.data.has_more||(n.groups=i);var s=g(n,l);if(!e.data.has_more){P();s.has_more=!a}t(s)}else r(new Error("channels.history rejected because we are no longer backfilling or we are backfilling a different group"));return null}).catch(function(e){TS.console.logError(e,"all_unreads_fatal_error");clearTimeout(d);TS.client.ui.unread.displayFatalError()})}else{c={timestamp:s,sort:TS.client.unread.getSortOrder()};if(n){c.current_channel=n;var m=TS.client.unread.getGroup(n);if(m)if(m.collapsed){c.current_channel_timestamp=s;l.push(n)}else TS.client.unread.getNewestMsgTs(m)&&(c.current_channel_timestamp=TS.client.unread.getNewestMsgTs(m))}(e||TS.boot_data.feature_tinyspeck)&&TS.metrics.mark("unread_history_sort_marker");TS.client.unread.debug("Regular fetch using api_args: ",_.clone(c));TS.interop.api.call("unread.history",c).then(function(i){(e||TS.boot_data.feature_tinyspeck)&&TS.metrics.measureAndClear("unread_history_sort_"+c.sort,"unread_history_sort_marker");clearTimeout(d);if(!TS.model.unread_view_is_showing)return;TS.client.unread.last_request_id=i.request_id;o?r(new Error("unread.history rejected because we are now backfilling")):t(g(i.data,l,!n));return null}).catch(function(e){TS.error(e);clearTimeout(d);TS.client.ui.unread.displayFatalError()})}return null});return r},getMessage:function e(t,i){if(!TS.model.unread_view_is_showing)return null;var n;var a;n=TS.client.unread.getGroup(t.id);n&&(a=TS.utility.msgs.getMsg(i,n.msgs));!a&&TS.highlights_briefing&&(a=TS.highlights_briefing.getMessageFromCache(t.id,i));if(a)return a;return null},getTotalMessagesCount:function e(){return t.reduce(function(e,t){return t.marked_as_read?e:e+t.msgs.length},0)},getCurrentModelID:function e(){return n},areAllMessagesFetched:function e(){return a},getAllCurrentlyUnreadGroups:function e(){return TS.interop.redux.models.channels.getUnarchivedPublicAndPrivateChannels(TS.redux.getState()).concat(TS.model.mpims,TS.model.ims).filter(function(e){return e.unread_cnt>0&&!TS.notifs.isCorGMuted(e.id)})},getTotalNewUnreadCount:function e(){var i=t.reduce(function(e,t){return t.new_unread_msgs?e+t.new_unread_msgs.length:e},0);c&&(i=Object.keys(c).reduce(function(e,t){return e+c[t].length},i));return i},moveActiveMarker:function e(i){var n=0;var a=_.findIndex(t,{active:true});-1!=a&&(n=i?a-1:a+1);if(n>=0&&t[n]){t[a]&&(t[a].active=false);t[n].active=true;return t[n]}},setActiveGroup:function e(t){var i=TS.client.unread.getActiveGroup();i&&(i.active=false);t.active=true;return t},getActiveGroup:function e(){return _.find(t,{active:true})},getSortOrder:function e(){return f},getHighlightsForMessages:function e(t){_.map(t.channels,function(e){var t=TS.redux.channels.getEntityById(e.channel_id);e.messages.length&&e.total_unreads>=10&&TS.client.highlights.getHighlightsForMessages({channel:t,timestamps:_.map(e.messages,"ts"),channel_open_ts:s})})},legacyUpdateSortOrder:function e(){$();TS.client.ui.unread.updateChannelHeader();TS.client.unread.reload()},test:function d(){var _={_current_model_ob_id:null,_processResp:g,_resetData:x,_messageReceived:S,_appendNewUnreadToGroup:w,_messageChanged:v,_messageRemoved:b,_toggleUnreadView:k,_groups:[],_all_messages_fetched:false,_more_messages_p:void 0,_init_timestamp:void 0};Object.defineProperty(_,"_processResp",{get:function e(){return g},set:function e(t){g=t}});Object.defineProperty(_,"_resetData",{get:function e(){return x},set:function e(t){x=t}});Object.defineProperty(_,"_current_model_ob_id",{get:function e(){return n},set:function e(t){n=t}});Object.defineProperty(_,"_should_record_metrics",{get:function t(){return e},set:function t(i){e=i}});Object.defineProperty(_,"_groups",{get:function e(){return t},set:function e(i){t=i}});Object.defineProperty(_,"_all_messages_fetched",{get:function e(){return a},set:function e(t){a=t}});Object.defineProperty(_,"_more_messages_p",{get:function e(){return r},set:function e(t){r=t}});Object.defineProperty(_,"_messageReceived",{get:function e(){return S},set:function e(t){S=t}});Object.defineProperty(_,"_messageChanged",{get:function e(){return v},set:function e(t){v=t}});Object.defineProperty(_,"_messageRemoved",{get:function e(){return b},set:function e(t){b=t}});Object.defineProperty(_,"_appendNewUnreadToGroup",{get:function e(){return w},set:function e(t){w=t}});Object.defineProperty(_,"_toggleUnreadView",{get:function e(){return k},set:function e(t){k=t}});Object.defineProperty(_,"_init_timestamp",{get:function e(){return s},set:function e(t){s=t}});Object.defineProperty(_,"_backfilling_for_group",{get:function e(){return o},set:function e(t){o=t}});Object.defineProperty(_,"_excluded_groups",{get:function e(){return i},set:function e(t){i=t}});Object.defineProperty(_,"_orphan_new_msgs",{get:function e(){return c},set:function e(t){c=t}});Object.defineProperty(_,"_direct_from_boot",{get:function e(){return u},set:function e(t){u=t}});Object.defineProperty(_,"_sortAndDedupe",{get:function e(){return T},set:function e(t){T=t}});Object.defineProperty(_,"_backfilling_was_all_fetched",{get:function e(){return l},set:function e(t){l=t}});return _}});var e;var t=[];var i=[];var n=null;var a=false;var r;var s;var o=null;var l;var c={};var d;var u;var m=false;var f;var h=[];var p=[];var g=function i(r,s,o){s=s||[];var l={groups:[],has_more:true};TS.info("Received unread view response: "+r.channels_count+" channels; "+r.total_messages_count+" total messages ("+(o?"first fetch":"subsequent fetch")+")");TS.client.unread.debug("Process response starting info:",{first_fetch:o,skip_channels:s,channels_count:r.channels_count,total_messages_count:r.total_messages_count,channels:r.channels.map(function(e){return{channel_id:e.channel_id,msg_count:e.messages?e.messages.length:null,collapsed:e.collapsed,total_unreads:e.total_unreads,has_more:e.has_more}})});if(o){e&&TS.metrics.count("unread_view_fetched_channels_first",r.channels_count);e&&TS.metrics.count("unread_view_fetched_messages_first",r.total_messages_count)}r.channels.length&&s.length&&_.remove(r.channels,function(e){return-1!==s.indexOf(e.channel_id)});if(0===r.channels.length||1===r.channels.length&&!r.channels[0].has_more&&(!r.channels[0].messages||0===r.channels[0].messages.length)){a=true;l.has_more=false;TS.client.unread.debug("DONE FETCHING: API response had no messages",r.channels.length);TS.client.unread.messages_loaded=true;return l}if(1===r.channels.length&&0===r.channels[0].messages.length&&r.channels[0].collapsed&&TS.client.unread.getGroup(r.channels[0].channel_id)&&TS.client.unread.getGroup(r.channels[0].channel_id).collapsed&&0===TS.client.unread.getGroup(r.channels[0].channel_id).msgs.length){a=true;l.has_more=false;TS.client.unread.debug("DONE FETCHING: Received only one collapsed group with zero messages");TS.client.unread.messages_loaded=true;return l}var d=_.last(r.channels);var m=d.has_more;r.channels.forEach(function(e){n=e.channel_id;var i=TS.redux.channels.getEntityById(n);var a=TS.client.unread.getGroup(n);var r=[];if(!i)return;p.push(e.channel_id);if(a){r=TS.interop.messages.preprocessImsgs(e.messages,i.id);r=a.msgs.concat(r);if(a.collapsed){a.hidden_msgs=a.hidden_msgs.concat(r);a.marked_as_read_cnt=a.hidden_msgs.length}else a.msgs=r;a.has_more=e.has_more;a.has_more||(a.total_unreads=r.filter(function(e){return!e.no_display}).length)}else{if(!e.has_more&&!e.collapsed&&!e.messages.length){TS.warn("Received model_ob with no messages for unread view: "+n);TS.client.unread.debug("all_unreads_ignored_channel no msgs",{current_model_ob_id:n,unread_obj_id:e.channel_id,has_more:e.has_more,collapsed:!!e.collapsed,msg_count:e.messages.length});return}if(!(o&&u)&&0===i.unread_cnt){TS.client.unread.debug("all_unreads_ignored_channel model_ob has no unreads",{current_model_ob_id:n,unread_obj_id:e.channel_id,model_ob_id:i.id,model_ob_unread_cnt:i.unread_cnt,first_fetch:o,direct_from_boot:u});return}r=TS.interop.messages.preprocessImsgs(e.messages,i.id);a={id:n,order:t.length,msgs:r,hidden_msgs:[],model_ob:i,marked_as_read:false,new_unread_cnt:0,collapsed:e.collapsed,total_unreads:e.total_unreads,has_more:e.has_more};a.has_more||(a.total_unreads=r.filter(function(e){return!e.no_display}).length);t.push(a)}if(!a.has_more&&c[a.id]){c[a.id].forEach(function(e){w(a,e)});delete c[a.id]}T(a,"msgs");l.groups.push(a)});r.groups&&r.groups.forEach(function(e){t.push(e);l.groups.push(e);m=e.has_more});if(!m){a=true;l.has_more=false}o&&t.length&&!TS.client.unread.getActiveGroup()&&(t[0].active=true);TS.client.unread.debug("Process response, processed data",{has_more:l.has_more,touched_groups:l.groups.map(function(e){return{channel_id:e.id,has_more:e.has_more,msg_count:e.msgs.length,marked_as_read:e.marked_as_read,collapsed:e.collapsed}}),all_groups:t.map(function(e){return{channel_id:e.id,has_more:e.has_more,msg_count:e.msgs.length,marked_as_read:e.marked_as_read,collapsed:e.collapsed}})});m||TS.client.unread.debug("DONE FETCHING: Last group has no more messages");TS.client.unread.getHighlightsForMessages(r);TS.client.unread.messages_loaded=true;return l};var T=function e(t,i){i=i||"msgs";TS.utility.msgs.sortMsgs(t[i]);t[i]=_.uniqBy(t[i],"ts");return t};var S=function e(t,i){if(!TS.model.unread_view_is_showing)return;if(TS.interop.rules.messages.isHidden(i))return;if(i.is_ephemeral)return;if(i.user===TS.model.user.id)return;if(_.startsWith(i.subtype,"sh_room"))return;if(TS.interop.rules.messages.isHidden(i))return;if(TS.utility.msgs.msgMightBeRolledUp(i))return;var n=t.is_channel&&t.is_archived||TS.notifs.isCorGMuted(t.id);if(!n&&TS.client.ui.unread.isFatalErrorDisplaying()){TS.client.unread.reload();return}var a=TS.client.unread.getGroup(t.id);if(a&&!n)TS.client.ui.unread.updateNewMessagesMessage(w(a,i));else if(!t.is_channel||!n){c[t.id]||(c[t.id]=[]);c[t.id].push(i)}n||-1===_.indexOf(TS.client.unread.new_messages_in_channels,t.id)&&TS.client.unread.new_messages_in_channels.push(t.id);TS.client.ui.unread.showOrHideRefreshButton()};var v=function e(t,i){if(!TS.model.unread_view_is_showing)return;if(c[t.id]){var n=_.findIndex(c[t.id],{ts:i.ts});c[t.id].splice(n,1,TS.interop.messages.preprocessImsg(i,t.id))}var a=TS.client.unread.getGroup(t.id);if(!a)return;var r=_.findIndex(a.new_unread_msgs,{ts:i.ts});r>=0&&a.new_unread_msgs.splice(r,1,TS.interop.messages.preprocessImsg(i,t.id));var s=_.findIndex(a.msgs,{ts:i.ts});if(s>=0){a.msgs.splice(s,1,TS.interop.messages.preprocessImsg(i,t.id));TS.client.ui.unread.updateMsgs()}};var b=function e(t,i){if(!TS.model.unread_view_is_showing)return;if(c[t.id]){_.remove(c[t.id],{ts:i.ts});c[t.id].length||delete c[t.id]}var n=TS.client.unread.getGroup(t.id);if(!n){c[t.id]||_.pull(TS.client.unread.new_messages_in_channels,t.id);TS.client.ui.unread.showOrHideRefreshButton();return}var a=_.findIndex(n.msgs,{ts:i.ts});var r=_.findIndex(n.new_unread_msgs,{ts:i.ts});if(r>=0){n.new_unread_msgs.splice(r,1);n.new_unread_cnt=n.new_unread_msgs.length;TS.client.ui.unread.updateNewMessagesMessage(n)}if(a>=0){n.msgs.splice(a,1);n.total_unreads-=1;0===n.msgs.length?A(n.model_ob.id):TS.client.ui.unread.updateMsgs()}};var w=function e(t,i){var n=_.find(t.msgs,{ts:i.ts});if(n)return t;t.first_new_unread_ts||(t.first_new_unread_ts=i.ts);i=TS.interop.messages.preprocessImsg(i,t.id);t.new_unread_msgs||(t.new_unread_msgs=[]);t.new_unread_msgs.push(i);T(t,"new_unread_msgs");t.new_unread_cnt=t.new_unread_msgs.length;return t};var y=function e(i){if(!TS.model.unread_view_is_showing)return;var n=[];if(TS.boot_data.feature_file_threads){var a=[];i.shares&&i.shares.public&&(a=a.concat(_.keys(i.shares.public)));i.shares&&i.shares.private&&(a=a.concat(_.keys(i.shares.private)));n=_.intersection(_.map(t,"id"),a)}else n=_.intersection(_.map(t,"id"),i.channels.concat(i.ims,i.groups));var r=_.filter(t,function(e){return-1===n.indexOf(e.id)});r.forEach(function(e){e.msgs.forEach(function(t){"file_mention"===t.subtype&&t.file.id===i.id&&n.push(e.id)})});n=_.uniq(n);if(!n.length)return;var s=!TS.interop.files.isObjectFresh(i.id);if(s){TS.files.getFileById(i.id);return}n.forEach(function(e){var t=TS.client.unread.getGroup(e);t.msgs.forEach(function(e){if(i.is_deleted||"file_share"!==e.subtype&&"file_mention"!==e.subtype&&"file_comment"!==e.subtype||!e.file||e.file.id!=i.id)if(e.attachments&&e.attachments.length&&TS.inline_attachments.getAttachmentBySlackFileId(e.attachments,i.id));else{if(!TS.boot_data.feature_file_threads)return;var n=TS.utility.msgs.getFilesOnMsg(e);if(!n||!_.some(n,{id:i.id}))return}else;if("hosted"===i.mode||"external"===i.mode){if(!i.comments.length&&i.is_tombstoned)return;v(t.model_ob,e)}TS.client.ui.unread.rebuildMsgFile(e,i)})})};var A=function e(i){var a=TS.client.unread.getGroup(i);if(a){TS.client.ui.unread.removeMessageContainerGroup([i]);_.remove(t,{id:i});if(n===i){var r=_.last(t);r&&(n=r.id)}TS.client.ui.unread.updateMsgs()}};var k=function e(){if(!TS.prefs.getPref("enable_unread_view")&&TS.model.unread_view_is_showing){TS.client.displayModelOb(TS.shared.legacyGetActiveModelOb());TS.client.unread.destroyUnreadView()}};var C=function e(){TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{enable_unread_view:TS.prefs.getPref("enable_unread_view").toString()}})};var x=function e(){o=null;l=void 0;i=[];a=false;n=null;t=[];r=void 0;s=TS.interop.datetime.makeTsStamp(null,{padder:"0",uniqueNum:9});TS.client.unread.new_messages_in_channels=[];c={};if(d){clearTimeout(d);d=null}h=[];p=[]};var I=function e(){TS.channels.unread_changed_sig.add(E);TS.groups.unread_changed_sig.add(E);TS.ims.unread_changed_sig.add(E);TS.mpims.unread_changed_sig.add(E);TS.client.unread.bulk_unread_count_change_sig.add(E);TS.client.unread.bulk_unread_count_change_sig.add(B)};var M=function e(){TS.channels.unread_changed_sig.remove(E);TS.groups.unread_changed_sig.remove(E);TS.ims.unread_changed_sig.remove(E);TS.mpims.unread_changed_sig.remove(E);TS.client.unread.bulk_unread_count_change_sig.remove(E);TS.client.unread.bulk_unread_count_change_sig.remove(B)};var E=function e(){U();var t=TS.model.all_unread_cnt>0&&TS.client.unread.getAllCurrentlyUnreadGroups().length>0;TS.redux.all_unreads.updateHasUnreads(t);TS.boot_data.feature_simplify_all_unreads_button&&TS.model.unread_view_is_showing&&TS.client.ui.unread.showOrHideRefreshButton()};var B=function e(){if(!TS.model.unread_view_is_showing)return;TS.client.unread.reload()};var P=function e(){if(o){i=[];o=null;a=l;l=void 0;TS.client.ui.unread.setMessageContainerHasMoreEnd(!a)}};var U=function e(){if(TS.client.unread.isEnabled()||TS.prefs.getPref("seen_unread_view_coachmark"))return;if(TS.client.unread.isEnabled()||TS.prefs.getPref("seen_unread_view_coachmark")){M();return}var t=50;var i=4;if(TS.model.all_unread_cnt>=t){var n=TS.client.unread.getAllCurrentlyUnreadGroups();if(n.length>=i){M();D()}}};var D=function e(){if(TS.client.unread.isEnabled())return;if(TS.prefs.getPref("seen_unread_view_coachmark"))return;TS.prefs.setPrefLocal("seen_unread_view_coachmark",true);TS.prefs.setMultiPrefsByAPI({enable_unread_view:true,seen_unread_view_coachmark:true},function(){TS.metrics.count("unread_view_coachmark_displayed");m=true;TS.coachmark.start(TS.coachmarks.coachmarks.unread_view)});TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{enable_unread_view:"true"}})};var $=function e(){f=TS.prefs.getPref("all_unreads_sort_order")?TS.prefs.getPref("all_unreads_sort_order"):""!==TS.model.team.plan?"priority":"alphabetical"}})()},3087:function(e,t){(function(){TS.registerModule("client.ui.unread",{$scroller:$("#unread_msgs_scroller_div"),$loading_msg_container:null,$unread_msgs_div:null,$container:null,unread_groups:[],msgs_rendered_sig:new signals.Signal,started_sig:new signals.Signal,ended_sig:new signals.Signal,showUnreadView:function i(){TS.channels.renamed_sig.add(T);TS.inline_file_previews.collapse_sig.add(A);TS.inline_file_previews.expand_sig.add(A);TS.inline_others.collapse_sig.add(A);TS.inline_others.expand_sig.add(A);TS.inline_audios.collapse_sig.add(A);TS.inline_audios.expand_sig.add(A);TS.inline_videos.collapse_sig.add(A);TS.inline_videos.expand_sig.add(A);TS.inline_room_previews.toggle_sig.add(A);TS.inline_imgs.expand_sig.add(A);TS.inline_imgs.collapse_sig.add(A);TS.inline_attachments.expand_sig.add(A);TS.inline_attachments.collapse_sig.add(A);TS.highlights_briefing.updated_sig.add(A);TS.client.highlights.updated_sig.add(TS.client.ui.unread.rebuildMsgsWithHighlights);TS.client.highlights.feedback_submitted_sig.add(TS.client.ui.unread.maybeRebuildMsgsWithHighlightsFeedback);TS.redux.dispatch(TS.interop.redux.features.workspace.setPrimaryView({id:"Vall_unreads",fromLegacy:true}));TS.view.members.unknown_resolution_rebuild_sig.add(E);TS.boot_data.feature_lazy_user_groups&&TS.user_groups.unknown_resolution_rebuild_sig.add(B);TS.view.channel.unknown_resolution_rebuild_sig.add(P);d=Date.now();f=false;$("#client-ui").addClass("unread_view_is_showing");"details"===TS.model.ui_state.flex_name&&TS.client.ui.flex.hideFlex(true);TS.client.ui.unread.$scroller.html(TS.templates.unread_main());TS.client.ui.unread.$unread_msgs_div=$("#unread_msgs_div");TS.generic_notification_banner.mountModernBannerInLegacy();if(TS.boot_data.feature_file_threads){var a=$('<div id="unread_upload_banner_root" class="p-unread_view__top_banners"></div>');a.prependTo(TS.client.ui.unread.$scroller);TS.interop.mountFileUploadBanner(TS.boot_data.team_id,a[0])}h=true;TS.client.ui.unread.displayLoadingMessage();if(TS.environment.supports_custom_scrollbar)TS.client.ui.unread.$container=$("#unread_msgs_scroller_div");else{TS.client.ui.unread.$scroller.monkeyScroll();TS.client.ui.unread.$container=$("#monkey_scroll_wrapper_for_unread_msgs_scroller_div")}$("#footer").addClass("hidden");g();TS.view.resize_sig.add(g);TS.client.ui.unread.$unread_msgs_div.on("click.unread",".bottom_mark_all_read_btn",function(){TS.client.unread.markAllAsRead()});TS.client.ui.unread.$unread_msgs_div.on("click.unread",".unread_group_mark",function(e){var t=$(e.target).closest(".unread_group").data("model-id");var i=TS.client.unread.getGroup(t);if(!i||i.marked_as_read)return;TS.client.ui.unread.markGroupAsRead(t)});TS.client.ui.unread.$unread_msgs_div.on("click.unread",".unread_group_undo > a",function(e){TS.client.ui.unread.markGroupAsUnread($(e.target).closest(".unread_group").data("model-id"))});TS.client.ui.unread.$unread_msgs_div.on("click.unread",".unread_group_header_name .channel_link, .unread_group_header_name .mpim_link, .unread_group_header_name .internal_im_link",function(){TS.client.unread.shouldRecordMetrics()&&TS.metrics.count("unread_view_channel_navigation")});TS.client.ui.unread.$unread_msgs_div.on("click.unread",".unread_group_new",function(e){var t=TS.client.unread.getGroup($(e.target).closest(".unread_group").data("model-id"));if(t.collapsed){t.marked_as_read&&TS.client.unread.moveNewUnreadsOntoHiddenMsgs(t);TS.client.ui.unread.expandGroup(t)}else TS.client.ui.unread.updateGroupWithNewMessages(t)});TS.client.ui.unread.$unread_msgs_div.on("click.unread",".unread_group_collapse_toggle",function(e){var t=TS.client.unread.getGroup($(e.target).closest(".unread_group").data("model-id"));if(t){var i={channel_id:t.id,channel_type:t.id[0]||"",request_id:TS.client.unread.last_request_id};if(t.collapsed){TS.client.ui.unread.expandGroup(t,{persist_state:true});TS.interop.clog.track("UNREADS_EXPAND_GROUP",i)}else{var n=w(t);var a=n.find(".unread_group_msgs");TS.client.ui.unread.collapseGroup(t,a,{persist_state:true});TS.interop.clog.track("UNREADS_COLLAPSE_GROUP",i)}}});o=false;$(window).on("keydown.unread",S);if(!TS.environment.supports_sticky_position){$("body").hasClass("banner_showing")&&k();TS.ui.banner.show_hide_sig.add(k);var r=new signals.Signal;n=_.throttle(y,16,{leading:true,trailing:false});TS.client.ui.unread.$scroller.on("scroll",n);r.add(A)}e={name:"unread",container:$("#unread_msgs_div"),scroller:$("#unread_msgs_scroller_div"),page_size:25,sections:[],has_more_beginning:false,has_more_end:false,updated_sig:r,promiseToLoadMoreAtEnd:function e(){return TS.client.ui.unread.promiseToShowNextPage()},buildMsgHTML:function e(i,n,a){var r=$(TS.templates.builders.msgs.buildHTML({msg_dom_id:TS.templates.makeMsgDomIdInUnreadView(i.ts),msg:i,model_ob:a.model_ob,prev_msg:n,container_id:"unread_msgs_div",enable_slack_action_links:true,hide_actions:false,from_all_unreads:true}));t&&r.css("opacity",0);return r},buildSection:function e(t){return TS.templates.unread_group(C(t))},buildDayDivider:function e(i,n){var a=n.ts;var r=TS.interop.datetime.toDateObject(a);var s=TS.interop.datetime.isToday(r);var o=$(TS.templates.unread_day_divider({ts:a,is_today:s}));t&&o.css("opacity",0);return o},updateCallback:function e(t){var i=TS.client.unread.getAllGroups().map(function(e){return e.manually_marked_unread_msg});t.added.forEach(function(e){if(!e.data("ts"))return;var t=e.data("ts");if(i.indexOf(t)>=0){var n=e.data("modelObId");M(t,n,e)}});TS.client.ui.unread.msgs_rendered_sig.dispatch(t)}};_.assign(e,{afterPageDown:function e(t){t||TS.highlights_briefing.hideBriefing()},afterPageUp:function e(t){t&&TS.highlights_briefing.showBriefing()}});TS.ui.message_container.register(e);p();TS.client.ui.unread.$scroller.attr("tabindex","-1");TS.client.ui.rebuildAllButMsgs();Promise.all([TS.client.ui.unread.promiseToShowNextPage(),TS.highlights_briefing.promiseToGetBriefing()]).then(function(e){var t=e[1];TS.client.unread.shouldRecordMetrics()&&TS.metrics.measureAndClear("unread_view_time_to_display","unread_view_time_to_display");if(!TS.model.unread_view_is_showing)return;if(TS.client.unread.getAllGroups().length){t&&TS.highlights_briefing.showBriefingWithResponse(t);I()}else{var i;var n=true;TS.client.ui.unread.displayEmptyState(i,n)}});TS.client.ui.unread.$unread_msgs_div.on("click.unread",".message[data-ts]",function(e){if(e.altKey){var t=$(e.target).closest(".message");var i=t.data("ts");var n=$(e.target).closest(".message").data("modelObId");M(i,n,t)}});TS.interop.clog.track("UNREADS_OPEN",{});TS.client.ui.unread.started_sig.dispatch()},promiseToShowNextPage:function e(){if(s&&s.isPending())return s;s=TS.client.unread.promiseToGetMoreMessages().then(function(e){if(!TS.model.unread_view_is_showing)return;u.unreads_page+=1;TS.client.ui.unread.updateHeaders(e.groups);TS.client.ui.unread.addMessageContainerGroups(e.groups);TS.client.ui.unread.setMessageContainerHasMoreEnd(!!e.has_more);g();x();if(l){var t=false;var i=TS.client.unread.getActiveGroup();var n=TS.client.unread.moveActiveMarker(t);v(n,i,{collapse_current_group:false});l=false}s=null;return null}).catch(function(e){TS.error(e)});return s},removeMessageContainerGroup:function t(i){e.sections=e.sections.filter(function(e){return-1===i.indexOf(e.id)});e.has_more_end=true;return e},addMessageContainerGroups:function t(i){_.forEach(i,function(t){var i=TS.client.unread.getGroup(t.id);var n=_.findIndex(e.sections,{id:i.id});-1===n&&e.sections.push(i)})},updateHeaders:function t(i){_.forEach(i,function(t){var i=TS.client.unread.getGroup(t.id);var n=_.findIndex(e.sections,{id:i.id});-1!==n&&TS.client.ui.unread.updateHeader(i)})},setMessageContainerHasMoreEnd:function t(i){e.has_more_end=i},restart:function t(){TS.client.ui.unread.showOrHideRefreshButton();TS.ui.message_container.cleanup(e);TS.client.ui.unread.$unread_msgs_div.empty();e.sections=[];e.has_more_end=false;TS.ui.message_container.register(e);h=true;TS.client.ui.unread.displayLoadingMessage();p();f=false;Promise.all([TS.client.ui.unread.promiseToShowNextPage(),TS.highlights_briefing.promiseToGetBriefing()]).then(function(e){var t=e[1];if(!TS.model.unread_view_is_showing)return;if(TS.client.unread.getAllGroups().length){if(t){TS.highlights_briefing.showBriefingWithResponse(t);TS.highlights_briefing.showBriefing()}I()}else{var i;var n=true;TS.client.ui.unread.displayEmptyState(i,n)}})},createLoadingMsgHTML:function e(){var t=$('<div class="unread_msgs_loading"><div class="unread_msgs_loading_msg"></div></div>');TS.client.ui.unread.$scroller.after(t);TS.client.ui.unread.$loading_msg_container=t},displayLoadingMessage:function e(t){TS.client.ui.unread.$loading_msg_container||TS.client.ui.unread.createLoadingMsgHTML();TS.client.ui.unread.$loading_msg_container.removeClass("hidden");var i=TS.interop.i18n.t("Loading messages...","unread")();var n=t||i;TS.client.ui.unread.$loading_msg_container.find(".unread_msgs_loading_msg").text(n)},hideLoadingMessage:function e(){TS.client.ui.unread.$loading_msg_container.addClass("hidden")},displaySlowLoadingMessage:function e(){if(!h)return;var t=TS.interop.i18n.t("Still loading... sorry for the long wait!","unread")();TS.client.ui.unread.displayLoadingMessage(t)},isFatalErrorDisplaying:function e(){return $("#messages_container .unread_error_state").length},displayFatalError:function e(){TS.client.ui.unread.hideLoadingMessage();TS.client.ui.unread.$scroller.addClass("invisible");$("#messages_container .unread_empty_state_wrapper").remove();$("#messages_container").prepend(TS.templates.unread_error({emoji:new Handlebars.SafeString(TS.emoji.graphicReplace(":tropical_fish:",{jumbomoji:true}))}));$(".unread_error_state_refresh_button").on("click",function(){TS.client.unread.reload()});_.defer(function(){$("#messages_container .unread_empty_state").addClass("transitioning")})},displayEmptyState:function e(t,i){TS.client.ui.unread.hideLoadingMessage();TS.client.ui.unread.$scroller.addClass("invisible");$("#messages_container .unread_empty_state_wrapper").remove();$("#messages_container").prepend(TS.templates.unread_empty_state({line_one:r.lineOne,line_two:r.lineTwo,emoji:r.emojiUrl,marked_as_read_cnt:t}));_.defer(function(){$("#messages_container .unread_empty_state").addClass("transitioning");var e=$("#messages_container .unread_empty_state_undo");if(e.length){e.addClass("unread_empty_state_undo_visible");_.delay(function(){e.removeClass("unread_empty_state_undo_visible")},10300);$(".unread_empty_state_undo_action").one("click",function(){TS.client.unread.markAllAsUnread();TS.client.ui.unread.updateChannelHeader()})}});if(i)m=false;else{m=true;_.delay(function(){m=false;TS.client.ui.unread.showOrHideRefreshButton()},2e3)}TS.client.ui.unread.updateChannelHeader();TS.client.ui.unread.showOrHideRefreshButton();if(TS.interop.redux.features.allUnreads.hasUnreads(TS.redux.getState())&&!t){var n=[];var a=TS.client.unread.getAllCurrentlyUnreadGroups();a.forEach(function(e){n.push({id:e.id,type:TS.interop.rules.channels.getChannelType(e),unreadCount:e.unread_cnt})});var s="all_unreads_unread_but_empty";var o="all_unreads_unread_but_empty";var l=true;TS.console.logError(n,s,o,l)}},removeEmptyState:function e(){$(window).off("keydown.unread_empty_state");$("#messages_container .unread_empty_state_wrapper").remove();$("#messages_container .unread_empty_state_undo").remove();TS.client.ui.unread.$scroller.removeClass("invisible");m=false},showOrHideRefreshButton:function e(){var t=TS.client.unread.getTotalNewUnreadCount();var i=t>0&&TS.client.unread.new_messages_in_channels.length;var n=$("#messages_container .unread_empty_state");var a=$(".unread_empty_state_refresh");if(n.length&&TS.boot_data.feature_simplify_all_unreads_button){t=TS.model.all_unread_cnt;i=t>0}if(i){$("#channel_header_unread_refresh").removeClass("hidden");$("#channel_header_unread_refresh .text").text(TS.interop.i18n.t("{new_unread_cnt, plural, =1 {# new message} other {# new messages}}","all_unreads")({new_unread_cnt:t}));TS.redux.dispatch(TS.interop.redux.features.globalNav.setNewUnreads(t))}else{$("#channel_header_unread_refresh").addClass("hidden");a&&a.remove();TS.redux.dispatch(TS.interop.redux.features.globalNav.setNewUnreads(0))}if(i&&n.length&&!n.hasClass("unread_error_state")){if(a.length>0)a.html($(TS.templates.unread_empty_state_refresh({unreads_count:t})).html());else{if(m)return;n.append(TS.templates.unread_empty_state_refresh({unreads_count:t}));n.addClass("faded");n.addClass("with_refresh");$(window).on("keydown.unread_empty_state",function(e){TS.model.unread_view_is_showing&&e.which==TS.utility.keymap.enter&&TS.client.ui.isUserAttentionOnChat()&&!TS.utility.isFocusOnInput()&&TS.client.unread.reload()})}$(".unread_empty_state_refresh_button").on("click",function(){TS.client.unread.reload()})}},destroyUnreadView:function t(){if(!TS.client.ui.unread.isUnreadViewDOMShowing())return;if(TS.boot_data.feature_file_threads){var a=$("#unread_upload_banner_root");TS.interop.unmountFileUploadBanner(a[0])}TS.generic_notification_banner.unmountModernBannerInLegacy();$(window).off("keydown.unread");s&&s.isPending()&&s.cancel();TS.client.ui.unread.$scroller.removeAttr("tabindex");var r=$("#client-ui");r.removeClass("unread_view_is_showing");TS.ui.message_container.cleanup(e);e=null;TS.client.ui.unread.removeEmptyState();TS.client.ui.unread.$unread_msgs_div.off("click.unread",".unread_group_mark");TS.client.ui.unread.$unread_msgs_div.off("click.unread",".unread_group_undo > a");if(!TS.environment.supports_sticky_position){TS.client.ui.unread.$scroller.off("scroll",n);TS.ui.banner.show_hide_sig.remove(k)}TS.client.ui.unread.$unread_msgs_div.empty();h=false;TS.client.ui.unread.hideLoadingMessage();$("#footer").removeClass("hidden");TS.view.resize_sig.remove(g);TS.channels.renamed_sig.remove(T);TS.client.ui.unread.unread_groups=null;i=null;var o=TS.client.ui.unread.getTrackingData();TS.interop.clog.track("UNREADS_CLOSE",o);d=0;u={unreads_event_seq_id:0,unreads_elasped_time:0,unreads_page:0,unreads_page_message_index:0};TS.client.ui.unread.ended_sig.dispatch()},isUnreadViewDOMShowing:function e(){return $("#client-ui").hasClass("unread_view_is_showing")},collapseGroup:function e(t,i,n){n=_.extend({persist_state:false,add_classname:true,scroll_group:true},n||{});if(t.collapsed)return Promise.resolve(t);TS.client.unread.collapseGroup(t,n.persist_state);return new Promise(function(e){var a=w(t);var r=a.offset().top;a.addClass("collapsing");TS.client.ui.unread.updateHeader(t);i.animate({opacity:0},300,function(){a.removeClass("collapsing");n.add_classname&&a.addClass("collapsed");TS.client.ui.unread.updateMsgs();n.scroll_group&&r<0&&b(a);A();TS.environment.supports_sticky_position||y();i.css("opacity",1);e(t)})})},expandGroup:function e(i,n){n=_.extend({persist_state:false},n||{});var a=w(i);if(!i.collapsed||a.hasClass("collapsing")||!a.hasClass("collapsed"))return Promise.resolve(i);return new Promise(function(e){TS.client.unread.expandGroup(i,n.persist_state);TS.client.ui.unread.updateHeader(i);a.removeClass("collapsed");a.removeClass("marked_as_read");a.removeClass("with_footer");t=true;TS.client.ui.unread.$unread_msgs_div.css("height",TS.client.ui.unread.$unread_msgs_div.height());var r=TS.client.ui.unread.updateMsgsWithFocus(a);t=false;s?s.then(function(){TS.client.ui.unread.$unread_msgs_div.css("height","auto")}):TS.client.ui.unread.$unread_msgs_div.css("height","auto");TS.client.ui.unread.updateNewMessagesMessage(i);r.added.forEach(function(e){e.animate({opacity:1},300)});A();TS.environment.supports_sticky_position||y();e(i)})},markGroupAsRead:function e(t){var i=TS.client.unread.getGroup(t);if(!i)return;var n={channel_id:i.id,channel_type:i.id[0]||"",unread_count:i.total_unreads,request_id:TS.client.unread.last_request_id};TS.client.unread.markGroupAsRead(i);TS.interop.clog.track("UNREADS_MARK_GROUP_AS_READ",n);TS.client.ui.unread.updateChannelHeader();var a=w(i);var r=a.find(".unread_group_msgs");i.new_unread_cnt<1&&a.addClass("marked_as_read");if(r.length){i.new_unread_cnt||x();if(!i.collapsed){var s={add_classname:i.new_unread_cnt<1};return TS.client.ui.unread.collapseGroup(i,r,s).then(function(e){e.new_unread_cnt>0?TS.client.ui.unread.updateGroupWithNewMessages(e):TS.client.ui.unread.updateHeader(e)})}TS.client.ui.unread.updateHeader(i)}else TS.client.ui.unread.updateMsgs();return Promise.resolve()},markGroupAsUnread:function e(t){var i=TS.client.unread.getGroup(t);if(!i)return;var n={channel_id:i.id,channel_type:i.id[0]||"",unread_count:i.marked_as_read_cnt,request_id:TS.client.unread.last_request_id};TS.client.unread.markGroupAsUnread(i);TS.interop.clog.track("UNREADS_MARK_GROUP_AS_UNREAD",n);TS.client.ui.unread.expandGroup(i);TS.client.ui.unread.updateChannelHeader()},updateNewMessagesMessage:function e(t){if(t.has_more)return;var i=w(t);var n=i.find(".unread_group_footer");if(t.collapsed)TS.client.ui.unread.updateHeader(t);else if(t.new_unread_cnt>0&&t.new_unread_msgs){n.find(".unread_group_new_text").text(TS.interop.i18n.t("{new_unread_cnt, plural, =1 {# new message} other {# new messages}}","all_unreads")({new_unread_cnt:t.new_unread_cnt}));i.addClass("with_footer")}else n&&i.removeClass("with_footer")},updateHeader:function e(t){var i=w(t);i.find(".unread_group_header").html(TS.templates.unread_group_header(C(t)))},updateMsgs:function t(){return TS.ui.message_container.update(e)},updateMsgsWithFocus:function t(i){return TS.ui.message_container.updateWithFocus(e,i)},updateGroupWithNewMessages:function e(i){var n=w(i);var a=n.height();n.height(a);TS.client.unread.updateGroupWithNewMessages(i);t=true;var r=TS.client.ui.unread.updateMsgsWithFocus(n);t=false;n.css("height","auto");var s=n.height();n.removeClass("with_footer");n.height(a).animate({height:s,margin:0},300,function(){n.css("height","");n.css("margin","");r.added.forEach(function(e){e.animate({opacity:1},300)});A()});n.removeClass("collapsed").removeClass("marked_as_read");TS.client.ui.unread.updateHeader(i)},rebuildMsgFile:function e(t,i){var n=TS.client.ui.unread.$unread_msgs_div.find("#"+TS.templates.makeMsgDomIdInUnreadView(t.ts));if(!n||!n.length)return;var a=n.find(".file_container");if(!a||!a.length)return;var r={file:i,is_message:true,msg_dom_id:n.attr("id")};if("post"===i.mode||"space"===i.mode)a.replaceWith(TS.templates.file_post(r));else if("snippet"===i.mode)a.replaceWith(TS.templates.file_snippet(r));else if("email"===i.mode)a.replaceWith(TS.templates.file_email(r));else{if("docs"!==i.mode)return TS.warn("Trying to rebuild message file, but cannot rebuild "+i.mode);a.replaceWith(TS.templates.file_arugula(r))}TS.utility.makeSureAllLinksHaveTargets(n);TS.ui.utility.updateClosestMonkeyScroller(n)},updateChannelHeader:function e(){var t=TS.templates.unread_header_info({is_showing:TS.model.unread_view_is_showing,has_new_messages:TS.model.unread_view_is_showing&&TS.client.unread.new_messages_in_channels.length,messages_loaded:TS.client.unread.messages_loaded,total_unread_count:TS.client.unread.getTotalMessagesCount(),sort_order:TS.client.unread.getSortOrder()});TS.client.channel_header.updateChannelHeaderInfo(t)},setUnreadPoint:function e(t){var i=TS.client.ui.unread.$unread_msgs_div.find('ts-message[data-ts="'+t+'"]');if(!i.length){TS.highlights_briefing.setUnreadPointOnMessage(t);return}var n=i.data("modelObId");M(t,n,i)},getTrackingData:function e(t){var i={is_unreads_view:true,unreads_event_seq_id:u.unreads_event_seq_id,unreads_elasped_time:Date.now()-d,unreads_page:u.unreads_page};t&&(i.unreads_page_message_index=_(TS.client.unread.getAllGroups()).map(function(e){return e.msgs}).flatten().reverse().findIndex({ts:t.toString()}));return i},incrementTrackingSeqId:function e(){u.unreads_event_seq_id+=1},rebuildMsgsIncludingMember:function t(i){if(!TS.model.unread_view_is_showing||!e)return;TS.ui.message_container.maybeUpdateMessages(e,function(e){return TS.utility.msgs.messageIncludesMember(i,e)})},rebuildMsgCurrentStatusIncludingMember:function t(i){if(!TS.model.unread_view_is_showing||!e)return;var n=$(e.container);var a=e.sections;if(!a)return;var r={member:i,for_message:true};_.each(a,function(e){if(!e)return;_.each(e.msgs,function(e){if(TS.utility.msgs.memberSentMessage(i,e)){var t=n.find('ts-message[data-ts="'+e.ts+'"] .message_current_status');t.replaceWith(TS.templates.current_status(r))}})})},rebuildMsgsWithHighlights:function t(i){if(!TS.model.unread_view_is_showing||!e)return;var n=_.reduce(i,function(e,t){_.each(t,function(t,i){e[i]=t});return e},{});TS.ui.message_container.maybeUpdateMessages(e,function(e){return n[e.ts]&&(n[e.ts].show_recap||n[e.ts].is_leaving_feedback||n[e.ts].left_feedback)})},maybeRebuildMsgsWithHighlightsFeedback:function t(i){if(!TS.model.unread_view_is_showing||!e)return;var n=_.reduce(i,function(e,t){_.each(t,function(t,i){e[i]=t});return e},{});TS.ui.message_container.maybeUpdateMessages(e,function(e){var t=n[e.ts]&&("positive"===n[e.ts].feedback||"default_positive"===n[e.ts].feedback);if(t){TS.client.ui.unread.$unread_msgs_div.find('ts-message[data-ts="'+e.ts+'"] .sli_briefing__feedback_controls').addClass("gave_positive_feedback");return false}return n[e.ts]&&(n[e.ts].isHighlight||n[e.ts].feedback||n[e.ts].leftFeedback)})},getDivForMsg:function e(t){return TS.client.ui.unread.$container?TS.client.ui.unread.$container.find("#"+TS.templates.makeMsgDomIdInUnreadView(t)):[]},test:function e(){var t={unknownUserGroupResolution:B};return t}});var e;var t=false;var i=false;var n;var a=0;var r;var s=null;var o=false;var l=false;var c=false;var d=0;var u={unreads_event_seq_id:0,unreads_elasped_time:0,unreads_page:0,unreads_page_message_index:0};var m;var f=false;var h=false;var p=function e(){var t=TS.interop.i18n.locale;var i=TS.prefs.getPref("preferred_skin_tone")||"1";var n=TS.interop.rules.emoji.getEmojiMode({forceDisplay:true});var a=TS.interop.allUnreads.getMessageForLocale({locale:t,preferredSkintone:i,emojiMode:n});var s=new Image;s.src=a.emojiUrl;r=a};var g=function e(){TS.environment.supports_custom_scrollbar||TS.ui.utility.updateClosestMonkeyScroller(TS.client.ui.unread.$scroller);if(!TS.environment.supports_sticky_position){k();A();y()}};var T=function e(t){var i=TS.client.unread.getGroup(t.id);i&&TS.client.ui.unread.updateHeader(i)};var S=function e(t){var i;if(TS.ui.react_emoji_menu.is_showing)return;var n=t.keyCode;var a=[TS.utility.keymap.space,TS.utility.keymap.pageup,TS.utility.keymap.pagedown,TS.utility.keymap.end,TS.utility.keymap.home];var r=a.concat([TS.utility.keymap.left,TS.utility.keymap.right,82]);if(-1===r.indexOf(n))return;var c=t.target;var d=$("#col_flex")[0].contains(c);var u=$(".client_channels_list_container")[0].contains(c);var m=TS.client.ui.unread.$scroller[0];var p=TS.client.ui.isUserAttentionOnChat()&&!TS.utility.isFocusOnInput()&&!d&&!u&&!m.contains(c);-1!==a.indexOf(n)&&p&&m.focus();if(t.metaKey||t.ctrlKey||t.shiftKey)return;if(s&&s.isPending())return;if(!o&&TS.client.ui.isUserAttentionOnChat()&&!TS.utility.isFocusOnInput()&&!$("#messages_container .unread_empty_state").length&&!h&&!TS.client.ui.unread.$scroller.hasClass("transitioning")&&!TS.client.ui.unread.$unread_msgs_div.find(".collapsing").length){var g=TS.client.unread.getActiveGroup();if(n===TS.utility.keymap.right||n===TS.utility.keymap.left){f=true;t.preventDefault();var T=n===TS.utility.keymap.left;i=TS.client.unread.moveActiveMarker(T);if(i)v(i,g,{collapse_current_group:!T});else if(!TS.client.unread.areAllMessagesFetched()&&!T){var S=_.last(TS.client.unread.getAllGroups());if(S.id===g.id){l=true;var b=w(g);var y=b.find(".unread_group_msgs");TS.client.ui.unread.collapseGroup(g,y)}}}else if(82===n){f=true;if(g)if(g.marked_as_read)TS.client.ui.unread.markGroupAsUnread(g.id);else{o=true;TS.client.ui.unread.markGroupAsRead(g.id).then(function(){if(g.marked_as_read){i=TS.client.unread.moveActiveMarker();v(i,g)}else o=false})}}}};var v=function e(t,i,n){n=_.defaults(n,{collapse_current_group:false,scroll_and_expand:true});var a=function e(){var a=w(t);a.toggleClass("active",t.active&&f);TS.client.ui.unread.updateHeader(t);t.marked_as_read||n.scroll_and_expand&&TS.client.ui.unread.expandGroup(t);if(n.scroll_and_expand){var s=a.prev();if(i&&s.length&&s.data("model-id")===i.id){c=true;b(r)}else b(a)}o=false;return null};if(t){l=false;o=true;if(i){var r=w(i);if(n.collapse_current_group){var s=r.find(".unread_group_msgs");TS.client.ui.unread.collapseGroup(i,s,{scroll_group:false}).then(function(){r.toggleClass("active",i.active&&f);TS.client.ui.unread.updateHeader(i);a()})}else{r.toggleClass("active",i.active&&f);TS.client.ui.unread.updateHeader(i);a()}}else a()}else o=false;return null};var b=function e(t){if(!t.length)return;var i=t.closest(".monkey_scroller");i.length||(i=t.closest(":scrollable(vertical)"));i.is("html")&&(i=$("body"));i.scrollTop(Math.round(t[0].offsetTop-8))};var w=function e(t){return TS.client.ui.unread.$unread_msgs_div.find("[data-model-id="+t.model_ob.id+"]")};var y=function e(){var t=TS.client.ui.unread.$scroller.scrollTop();var n=TS.client.ui.unread.unread_groups.toArray();if(!n.length)return;var r=n.reduce(function(e,i){if(t+TS.client.ui.CLIENT_HEADER_OVERHANG>=i.y)return i;return e});if(n.length&&TS.client.ui.CLIENT_HEADER_OVERHANG<n[0].y&&t<n[0].y){if(i){i.find(".unread_group_header").css({top:"0",right:"auto"});i.removeClass("currently_sticky");i=null;if(TS.highlights_briefing.$briefing_header){TS.highlights_briefing.$briefing_header.addClass("sticky");TS.highlights_briefing.$briefing_view.addClass("sticky")}}return}if(!i&&TS.highlights_briefing.$briefing_header&&TS.highlights_briefing.$briefing_view){TS.highlights_briefing.$briefing_header.removeClass("sticky");TS.highlights_briefing.$briefing_view.removeClass("sticky")}if(!r)return;var s=a-1;if(!i){i=r.$node;i.find(".unread_group_header").css({top:s,right:$("#col_flex").outerWidth()});i.addClass("currently_sticky")}if(i!==r.$node){i.find(".unread_group_header").css({top:"0",right:"auto"});i.removeClass("currently_sticky");i=r.$node;i.find(".unread_group_header").css({top:s,right:$("#col_flex").outerWidth()});i.addClass("currently_sticky")}if(!o&&!c){var l=TS.client.unread.getActiveGroup();if(l&&i.data("model-id")!=l.id){var d=TS.client.unread.getGroup(i.data("model-id"));d=TS.client.unread.setActiveGroup(d);v(d,l,{collapse_current_group:false,scroll_and_expand:false})}}c=false};var A=function e(){var t=TS.client.ui.unread.$scroller.find(".unread_group");TS.client.ui.unread.unread_groups=t.map(function(e,t){return{$node:$(t),y:t.offsetTop}})};var k=function e(){a=$("#banner").height()};var C=function e(t){return{model_ob:t.model_ob,model_ob_id:t.model_ob.id,has_new_unreads:t.new_unread_cnt>0,unread_cnt:t.total_unreads||0,new_unread_cnt:t.new_unread_cnt,marked_as_read_cnt:t.marked_as_read_cnt||0,show_footer:t.new_unread_cnt>0,im_member:t.model_ob.is_im?TS.interop.members.getMemberById(t.model_ob.user):{},marked_as_read:t.marked_as_read,collapsed:t.collapsed,active:f&&t.active,is_channel:t.model_ob.is_channel,is_group:t.model_ob.is_group,is_mpim:t.model_ob.is_mpim,is_im:t.model_ob.is_im,im_user:t.model_ob.user?TS.interop.members.getMemberById(t.model_ob.user):null,supports_sticky_position:TS.environment.supports_sticky_position}};var x=function e(){if(!TS.client.unread.areAllMessagesFetched())return;var t=TS.client.unread.getAllGroups();var i=true;t.length&&(i=_.reduce(t,function(e,t){return e&&t.marked_as_read},t[0].marked_as_read));i&&TS.client.ui.unread.displayEmptyState()};var I=function e(){h=false;TS.client.ui.unread.hideLoadingMessage();TS.client.ui.unread.$scroller.addClass("transitioning");TS.client.ui.unread.updateChannelHeader();TS.client.ui.unread.updateMsgs();TS.client.ui.unread.$scroller.removeClass("transitioning")};var M=function e(t,i,n){var a=TS.client.unread.getGroup(i);var r=a.model_ob;var s=TS.utility.msgs.getMarkMsgTSForUnreadPoint(t,a.msgs,r);var o=_.findIndex(a.msgs,{ts:s});var l=n.closest(".unread_group");l.find(".unread_divider").remove();l.find(".unread_day_container").removeClass("unread_day_container");if(!s)return false;a.manually_marked_unread_msg=t;TS.shared.legacyMarkReadMsg(a.model_ob.id,s,TS.model.marked_reasons.back);TS.client.markLastReadsWithAPI();if(t===a.msgs[a.msgs.length-1].ts)return;var c=TS.templates.messages_unread_divider({label:TS.interop.i18n.t("unread messages","all_unreads")()});var d=TS.client.ui.unread.$unread_msgs_div.find('ts-message[data-ts="'+a.msgs[o].ts+'"]');d.after(c);var u=n.closest(".unread_group").find(".unread_divider");if(u.next(".day_divider").length||u.is(":last-child")){u.addClass("adjacent_to_date");u.closest(".day_container").next(".day_container").addClass("unread_day_container")}return true};var E=function t(i){if(TS.model.unread_view_is_showing){var n=i.batch?i.batch:[i];_.each(n,function(t){TS.ui.message_container.maybeUpdateMessages(e,function(e){return TS.utility.msgs.messageIncludesMember(t,e)})})}};var B=function t(i){if(!TS.boot_data.feature_lazy_user_groups)return;if(!TS.model.unread_view_is_showing)return;_.each(i,function(t){TS.ui.message_container.maybeUpdateMessages(e,function(e){var i=TS.utility.msgs.messageIncludesUserGroup(t,e);return i})})};var P=function t(i){if(!TS.model.unread_view_is_showing||!e)return;var n=_.map(i,"id");TS.ui.message_container.maybeUpdateMessages(e,function(e){var t=TS.format.extractIds(e.text).c_ids;var i=[];e.attachments&&e.attachments.length&&(i=_(e.attachments).map(function(e){return TS.format.extractIds(e.text||"").c_ids}).flatten().value());t=_(t).concat(i).uniq().value();if(_.isEmpty(t))return;return _.intersection(n,t).length})}})()},3088:function(e,t){(function(){TS.registerModule("ui.message_container",{register:function e(t){if(!t.container){TS.error("TS.ui.message_container.register requires a container!");return}t.updateCallback||(t.updateCallback=_.noop);t.msg_order||(t.msg_order="asc");C(t);var i=x(t);var n=$(t.container);n.data("message-container-config",t);n.addClass("message_container");f(t,i);TS.attachment_actions.select.decorateNewElements(n);t._state=i;T(t);r(t);TS.client&&t.name&&TS.client.ui.checkInlineImgsAndIframes(t.name)},cleanup:function e(t){var i=$(t.container);var n=i;t.scroller&&(n=$(t.scroller));n.off("scroll.message_container");t._pending_op&&t._pending_op.cancel()},update:function t(i,n){e={added:[],removed:[],replaced:[]};var a=$(i.container);i._known_edits=n;i._range?C(i,i._range.start):C(i);var r=x(i);var s=i._state;var o=S(s,r);var l;w(o,function(e){var t=e.item;if("continue"===e.action){l=a.children('[data-section-id="'+t.id+'"]');d(i,t)}else if("delete"===e.action)a.children('[data-section-id="'+t.id+'"]').remove();else if("insert"===e.action){var n=h(i,t);l&&l.length?l.after(n):a.prepend(n);l=n}else if("append"===e.action){var r=h(i,t);a.append(r);l=r}});i._state=r;T(i);TS.client&&i.name&&TS.client.ui.checkInlineImgsAndIframes(i.name);TS.attachment_actions.select.decorateNewElements(a);var c=a;i.scroller&&(c=$(i.scroller));TS.ui.utility.updateClosestMonkeyScroller(c);i.updated_sig&&i.updated_sig.dispatch(e);if(i.page_size){var u=_.reduce(r,function(e,t){var i=t.msgs.length||1;return e+i},0);if(!i._pending_op&&u<2*i.page_size){var m;i.has_more_end&&i.promiseToLoadMoreAtEnd?m=i.promiseToLoadMoreAtEnd:i.has_more_beginning&&i.promiseToLoadMoreAtBeginning&&(m=i.promiseToLoadMoreAtBeginning);m&&(i._pending_op=m().then(function(){TS.ui.message_container.updateWithFocus(i,a.find(".message_container_item").first());return null}).finally(function(){i._pending_op=null}))}}var f=e;i.updateCallback(f);e=null;i._known_edits=null;return f},updateWithFocus:function e(t,i){if(!i||!i.length)return TS.ui.message_container.update(t);var n=$(i);var a;if(i.is("ts-message")){var r=i.find(".message_body");r.length&&(n=r)}if(i.is("ts-thread")){var s=i.find("ts-message:first");s.length&&(n=s)}TS.ui.utility.preventElementFromScrolling(n,function(){a=TS.ui.message_container.update(t);return null},function(){var e=$(t.container);if($.contains(e[0],n[0]))return n;var a=i.attr("id");i=e.find("#"+a);if(i.is("ts-message")){r=i.find(".message_body");if(r.length)return r}if(i.is("ts-thread")){s=i.find("ts-message:first");if(s.length)return s}return i});return a},maybeUpdateMessages:function e(t,i){var n=$(t.container);var a=t._state;_.forEach(a,function(e){var a=n.children('[data-section-id="'+e.id+'"]');var r=U(t,e.msgs);var s=a.find(".day_container");_.forEach(r,function(n){var a=n.length>0?n[0].ts:null;if(!a)return;var r=s.filter(function(){var e=$(this).attr("data-ts");var i=TS.interop.datetime.toDateObject(a);var n=TS.interop.datetime.toDateObject(e);return t.skip_day_groupings||TS.interop.datetime.isSameDay(i,n)});if(!r.length)return;var o=b(n,n,t.msg_order,i);m(t,e,r,n,o)})})},jumpToTop:function e(t){delete t._range;var i=$(t.container).find(".message_container_item").first();var n=TS.ui.message_container.updateWithFocus(t,i);i=$(t.container).find(".message_container_item").first();i.scrollintoview({offset:"top",px_offset:50});return n},jumpToEnd:function e(t){var i=P(t);C(t,i);var n=TS.ui.message_container.update(t);var a=$(t.container);t.scroller&&(a=$(t.scroller));a.scrollTop(a.prop("scrollHeight"));return n},jumpToTS:function e(t,i,n){var a=B(t);var r=i;if(n){var s=_.findIndex(a,{msg_ts:r});if(s>0){s=Math.max(0,s-n);r=a[s].msg_ts}}var o=_.find(a,{msg_ts:r});C(t,o);return TS.ui.message_container.update(t)},scrollintoview:function e(t,i,n){if(t._scrolling_into_view)return;t._scrolling_into_view=true;n=n||{};var a=n.complete;var r=function e(){t._scrolling_into_view=false;a&&a.call(this)};n.complete=r;$("#"+i).scrollintoview(n)},getRange:function e(t){return t._range},pageUp:function e(t,i){if(!t._range||!t.page_size)return;I(t);TS.ui.message_container.updateWithFocus(t,i);if(t.afterPageUp){var n=G(t);_.invoke(t,"afterPageUp",n)}},pageDown:function e(t,i){if(!t._range||!t.page_size)return;M(t);TS.ui.message_container.updateWithFocus(t,i);if(t.afterPageDown){var n=G(t);_.invoke(t,"afterPageDown",n)}},test:function e(){return{resolveOrderedLists:y}}});var e;var t=false;var i=function t(i){if(!e)return;e.removed.push(i)};var n=function t(i){if(!e)return;e.added.push(i)};var a=function t(i){if(!e)return;e.replaced.push(i)};var r=function e(t){if(!t.page_size)return;var i=$(t.container);var n=L(t);var a=n.parent();var r=_.debounce(function(e){if(t._scrolling_into_view)return;var n=e.scrollTop;var r=e.scrollHeight;var c=a.height();var d=n+c;var u=r>3*c?.9:1;var _=d>.25*r;var m=0===n;var f=d>r*u;_&&o(t);f?l(t,i):m&&s(t,i);TS.client&&TS.client.ui.checkInlineImgsAndIframes(t.name)},250);n.on("scroll.message_container",function(){r(this)})};var s=function e(t,i){var n=B(t);if(!n.length)return;var a=i.find(".message_container_item").first();var r=_.first(n);var s=_.get(t,"_range.start");if(_.isEqual(r,s)){if(t.has_more_beginning&&t.promiseToLoadMoreAtBeginning){t._pending_op=t.promiseToLoadMoreAtBeginning().then(function(){TS.ui.message_container.pageUp(t,a)}).finally(function(){t._pending_op=null});return t._pending_op}}else TS.ui.message_container.pageUp(t,a)};var o=function e(i){if(!i._pending_op&&true!==t&&i.has_more_end&&i.promiseToLoadMoreAtEnd){H("Start pre-emptive load of more messages",i);i._pending_op=i.promiseToLoadMoreAtEnd().then(function(){H("End pre-emptive load of more messages",i);i._pending_op=null;t=true});return i._pending_op}};var l=function e(i,n){var a=n.find(".message_container_item").last();if(t){H("Start appending loaded but not shown messages",i);t=false;c(i,a);H("End appending loaded but not shown messages",i)}else{if(!i._pending_op&&i.has_more_end&&i.promiseToLoadMoreAtEnd){H("Start load of more messages at append point",i);i._pending_op=i.promiseToLoadMoreAtEnd().then(function(){H("End load of more messages at append point",i);H("Start appending loaded messages at append point",i);i._pending_op=null;t=false;c(i,a);H("End appending loaded messages at append point",i)});return i._pending_op}if(i._pending_op)return i._pending_op.then(function(){if(t){H("Start appending loaded but not shown messages after pending",i);i._pending_op=null;t=false;c(i,a);H("End appending loaded but not shown messages after pending",i)}});H("Appending loaded and shown messages hidden by message_container at append point",i);c(i,a)}};var c=function e(t,i){TS.ui.message_container.pageDown(t,i);var n=G(t);if(n)return;var a=L(t);if(0===a.scrollTop()){a.scrollTop(80);t.page_size*=2}};var d=function e(t,i){var n=$(t.container);var a=_.find(t._state,{id:i.id});if(!i){TS.error("TS.ui.message_container.update could not find section "+i.id+" to update.");return}if(!a){TS.error("TS.ui.message_container.update could not find section_state for "+i.id+" to update.");return}var r=n.children('[data-section-id="'+i.id+'"]');if(!r.length){TS.error("TS.ui.message_container.updateSection could not find section "+i.id);return}if(i.completeness){r.removeClass("complete partial_start partial_end");if(i.completeness.start&&i.completeness.end)r.addClass("complete");else{i.completeness.start||r.addClass("partial_start");i.completeness.end||r.addClass("partial_end")}}var s=U(t,i.msgs);var o=U(t,a.msgs);var l=v(o,s,t.msg_order,t.skip_day_groupings);u(t,i,r,s,o,l)};var u=function e(t,i,n,a,r,s){var o;var l=n.find(".msgs_holder");l.length||(l=n);var c=l.find(".day_container");var d=function e(i){return c.filter(function(){var e=$(this).attr("data-ts");var n=TS.interop.datetime.toDateObject(i);var a=TS.interop.datetime.toDateObject(e);return t.skip_day_groupings||TS.interop.datetime.isSameDay(n,a)})};var u=function e(i,n){return _.find(i,function(e){var i=e[0];return t.skip_day_groupings||TS.utility.msgs.areMsgsSameDay(i,n)})};var f=function e(i){if(t._known_edits&&_.includes(t._known_edits,i.ts))return true};w(s,function(e){var n=e.item;var s=u(a,n);if("continue"===e.action){o=d(n.ts);var _=b(u(r,n),s,t.msg_order,f);m(t,i,o,s,_)}else if("delete"===e.action)d(n.ts).remove();else if("insert"===e.action){var h=p(t,i,u(a,n));o&&o.length?o.after(h):c.length?c.first().before(h):l.append(h);o=h}else if("append"===e.action){var g=p(t,i,u(a,n));l.append(g);o=g}})};var m=function e(t,r,s,o,l){var c;var d=s.find(".message_container_item");var u={};d.each(function(){var e=$(this).attr("data-ts");u[e]=this});var _={};var m={};var f;o.forEach(function(e){_[e.ts]=e;m[e.ts]=f;f=e});var h;w(l,function(e){var o=e.item;var l=o.ts;var f=e.action;"edited"===f&&(f="replace");"continue"!==f||"insert"!==h&&"delete"!==h||(f="replace");if("continue"===f)c=$(u[l]);else if("replace"===f){var p=$(u[l]);var T=g(t,_[l],m[l],r);p.replaceWith(T);a(T);c=T}else if("delete"===f){var S=$(u[l]);i(S);S.remove()}else if("insert"===f){var v=g(t,_[l],m[l],r);c&&c.length?c.after(v):d.length?d.first().before(v):s.append(v);n(v);c=v}else if("append"===f){var b=g(t,_[l],m[l],r);s.append(b);n(b);c=b}h=e.action})};var f=function e(t,i){var n=$(t.container);_.forEach(i,function(e){var i=h(t,e);n.append(i)})};var h=function e(t,i){var n=t.buildSection(i);var a=$(n);a.attr("data-section-id",i.id);if(i.completeness)if(i.completeness.start&&i.completeness.end)a.addClass("complete");else{i.completeness.start||a.addClass("partial_start");i.completeness.end||a.addClass("partial_end")}var r=a.find(".msgs_holder");r.length||(r=a);var s=U(t,i.msgs);_.forEach(s,function(e){var n=p(t,i,e);r.append(n)});return a};var p=function e(t,i,a){var r=a[0];var s=$('<div class="day_container" data-ts="'+r.ts+'"></div>');if(!t.skip_day_groupings){var o=$(t.buildDayDivider(i,r));s.append(o);n(o)}var l;var c=_.map(a,function(e){var n=g(t,e,l,i);l=e;return n});c.forEach(function(e){s.append(e);n(e)});return s};var g=function e(t,i,n,a){var r=t.buildMsgHTML(i,n,a);var s=$(r);s.addClass("message_container_item");return s};var T=function e(t){var i=$(t.container);var n=B(t);var a=_.first(n);var r=_.last(n);var s=t._range&&t._range.start;var o=t._range&&t._range.end;var l=t.has_more_beginning;l||a&&s&&!_.isEqual(a,s)&&(l=true);var c=t.has_more_end;c||r&&o&&!_.isEqual(r,o)&&(c=true);var d=TS.interop.i18n.t("Loading more messages...","unread")();var u=i.find(".and_more_beginning");u.remove();l&&i.prepend('<div class="and_more_beginning align_center large_top_margin large_bottom_margin">'+d+"</div>");var m=i.find(".and_more_end");m.remove();c?i.append('<div class="and_more_end align_center large_top_margin large_bottom_margin">'+d+"</div>"):i.find(".unread_group:last").addClass("at_bottom")};var S=function e(t,i){return y(t,i,function(e,t){var i=e.order||0;var n=t.order||0;return i-n})};var v=function e(t,i,n,a){var r=_.map(t,function(e){return e[0]});var s=_.map(i,function(e){return e[0]});return y(r,s,function(e,t){if(a||TS.utility.msgs.areMsgsSameDay(e,t))return 0;return F(n,e.ts,t.ts)})};var b=function e(t,i,n,a){return y(t,i,function(e,t){if(e.ts===t.ts)return 0;return F(n,e.ts,t.ts)},function(e,t){if(a){var i=a(e,t);if(!_.isUndefined(i))return i}return N(e,t)})};var w=function e(t,i){while(t){i(t);t=t.next}};var y=function e(t,i,n,a){var r=k(t,0);var s=k(i,0);return A(r,s,n,a)};var A=function e(t,i,n,a){if(!t&&!i)return null;if(!t)return{action:"append",item:i.item,next:e(t,i.next,n,a)};if(!i)return{action:"delete",item:t.item,next:e(t.next,i,n,a)};var r=n(t.item,i.item);if(0===r){if(a&&a(t.item,i.item))return{action:"edited",item:i.item,next:e(t.next,i.next,n,a)};return{action:"continue",item:i.item,next:e(t.next,i.next,n,a)}}if(r<0)return{action:"delete",item:t.item,next:e(t.next,i,n,a)};if(r>0)return{action:"insert",item:i.item,next:e(t,i.next,n,a)}};var k=function e(t,i,n){if(i>=t.length)return null;var a={item:t[i],prev:n};a.next=e(t,i+1,a);return a};var C=function e(t,i){if(!t.page_size)return;var n=B(t);if(!n.length)return;var a=2*t.page_size;var r={};var s=0;var o=t.msg_order;if(i){var l=false;s=_.findIndex(n,function(e){if(e.section_id===i.section_id){if(-1==e.msg_ts)return true;l||(l=true);return O(o,e.msg_ts,i.msg_ts)}if(l&&e.section_id!==i.section_id)return true;return false});s<0&&(s=0)}var c=Math.min(a+s,n.length);r.start=n[s];r.end=n[c-1];if(s>0&&c-s<a){var d=a-(c-s);s=Math.max(0,s-d);r.start=n[s]}t._range=r};var x=function e(t){if(!t._range)return _.map(t.sections,function(e){var t=_.create(e);t.msgs=_.map(e.msgs,_.clone);t.completeness={start:true,end:true};return t});var i=[];var n=t._range.start;var a=t._range.end;_.forEach(t.sections,function(e){if(!E(e,t))return;var r=_.create(e);var s=D(t,e.msgs);r.msgs=_.filter(s,function(i){var r=t.msg_order;if(n.section_id===a.section_id)return O(r,i.ts,n.msg_ts)&&R(r,i.ts,a.msg_ts);if(e.id===n.section_id)return O(r,i.ts,n.msg_ts);if(e.id===a.section_id)return R(r,i.ts,a.msg_ts);return true});"desc"===t.msg_order?r.completeness={start:_.first(r.msgs)===_.first(s),end:_.last(r.msgs)===_.last(s)}:r.completeness={start:_.last(r.msgs)===_.last(s),end:_.first(r.msgs)===_.first(s)};e===_.first(t.sections)&&t.has_more_beginning&&(r.completeness.start=false);e===_.last(t.sections)&&t.has_more_end&&(r.completeness.end=false);r.msgs=_.map(r.msgs,_.clone);i.push(r)});return i};var I=function e(t){var i=B(t);var n=t._range;var a=t.msg_order;var r=_.takeWhile(i,function(e){return!(e.section_id===n.start.section_id&&O(a,e.msg_ts,n.start.msg_ts))});if(!r.length)return;var s=_.drop(i,r.length);var o=false;s=_.takeWhile(s,function(e){if(o)return false;var t=e.section_id===n.end.section_id&&O(a,e.msg_ts,n.end.msg_ts);t&&(o=true);return true});var l=_.takeRight(r,t.page_size);var c=_.take(s,s.length-l.length);n.start=_.first(l);n.end=_.last(c)};var M=function e(t){var i=B(t);var n=t._range;var a=t.msg_order;i=_.dropWhile(i,function(e){return!(e.section_id===n.start.section_id&&O(a,e.msg_ts,n.start.msg_ts))});var r=false;var s=_.takeWhile(i,function(e){if(r)return false;var t=e.section_id===n.end.section_id&&O(a,e.msg_ts,n.end.msg_ts);t&&(r=true);return true});var o=_.drop(i,s.length);if(!o.length)return;var l=_.take(o,t.page_size);var c=_.drop(s,l.length);n.start=_.first(c);n.end=_.last(l)};var E=function e(t,i){if(!i._range)return true;var n=false;var a;for(var r=0;r<i.sections.length;r+=1){a=i.sections[r];n||a.id!==i._range.start.section_id||(n=true);if(n&&a.id===t.id)return true;if(a.id===i._range.end.section_id)break}return false};var B=function e(t){var i=[];var n=t.msg_order;var a="asc"===n?_.forEachRight:_.forEach;_.forEach(t.sections,function(e){if(e.msgs.length){var n=D(t,e.msgs);a(n,function(t){i.push({section_id:e.id,msg_ts:t.ts})})}else i.push({section_id:e.id,msg_ts:"-1"})});return i};var P=function e(t){var i;_.findLast(t.sections,function(e){if(!e.msgs||!e.msgs.length)return false;var n;var a;if("asc"===t.msg_order){n=_.first(e.msgs);a=n?n.ts:null;i={section_id:e.id,msg_ts:a}}else{n=_.last(e.msgs);a=n?n.ts:null;i={section_id:e.id,msg_ts:a}}return true});return i};var U=function e(t,i){if(!i)return[];var n=t.msg_order;var a="asc"===n?_.forEachRight:_.forEach;var r;var s=[];var o=[];a(i,function(e){if(t.skip_day_groupings||r&&TS.utility.msgs.areMsgsSameDay(e,r))o.push(e);else{o.length&&s.push(o);o=[e]}r=e});o.length&&s.push(o);return s};var D=function e(t,i){if("desc"===t.msg_order)return i;var n=[];var a=[];var r;var s;var o;for(r=i.length-1;r>-1;r-=1){o=i[r];if(o.no_display)continue;if(o._hidden_reply&&!t.show_hidden_replies)continue;s=TS.utility.msgs.msgRollUpWorker(r,o,i,a);if("continue"===s)continue;if("swap"===s){o=a[0];a.length=0}n.unshift(o)}return n};var F=function e(t,i,n){if("asc"===t){if(i<n)return-1;if(i>n)return 1}else{if(i>n)return-1;if(i<n)return 1}return 0};var O=function e(t,i,n){if("asc"===t)return i>=n;return i<=n};var R=function e(t,i,n){if("asc"===t)return i<=n;return i>=n};var N=function e(t,i){if(i.ts in TS.model.display_unsent_msgs)return true;var n=t.edited;var a=i.edited;if(t.is_ephemeral&&t.text!==i.text)return true;return!_.isEqual(n,a)||!_.isEqual(t.reply_count,i.reply_count)||!_.isEqual(t._shown_attachments,i._shown_attachments)};var L=function e(t){var i=$(t.container);var n=i;t.scroller&&(n=$(t.scroller));return n};var G=function e(t){var i=B(t);var n=_.first(i);var a=_.get(t,"_range.start");var r=_.isEqual(n,a);return r};var H=function e(t,i){var n=102;if(!TS.shouldLog(n))return;var a=B(i);var r=a.length;var s=i.sections.length;var o=i._range?_.findIndex(a,{msg_ts:i._range.start.msg_ts}):null;var l=i._range?_.findIndex(a,{msg_ts:i._range.end.msg_ts}):null;var c=i.has_more_end;TS.log(n,"[msg_container] "+t,{sections:s,messages:r,range_start:o,range_end:l,has_more_end:c})}})()},3089:function(e,t){(function(){TS.registerModule("client.ui.app_profile",{onStart:function e(){$('[data-js="app_profile_tab"]').on("click",'[data-js="app_profile_btn"]',TS.client.ui.app_profile.onButtonClick)},active_app:null,openWithApp:function i(a,r,s,o){if(!a)return;void 0==o&&(o=true);TS.client.ui.app_profile.active_app=a;e=TS.apps.constructTemplateArgsForCardAndProfile(a,r,null,s,o);TS.client.ui.flex.openAppProfileFlex(r||a.id);$('[data-js="app_profile_header"]').html(TS.templates.app_profile_title(e));t=$('[data-js="app_profile_scroller"]');t.html(TS.templates.app_profile(e));n();var l=t.find('[data-js="app_auth_settings"]');o&&!_.get(a,"is_slack_integration")?TS.apps.promiseToGetFullAppProfile(r,s,a.id,true).then(function(t){if(t.auth_summary_list){var i={name:e.name,auth_summary_list:t.auth_summary_list};l.html(TS.templates.app_profile_settings(i))}else l.hide()}):l.hide();TS.interop.clog.track("APP_PROFILE_OPEN",{app_id:a.id,bot_id:r,contexts:{core:{app_id:a.id,bot_id:r}}})},onButtonClick:function e(t){var n=$(this);var a=n.data("action");if("open_overflow_menu"===a)TS.client.ui.app_profile.openOverflowMenu(t);else if("desc_expand"===a){i.removeClass("app_desc_expand_showing");setTimeout(function(){i.addClass("app_desc_collapse_showing")},300)}else if("desc_collapse"===a){i.removeClass("app_desc_collapse_showing");i.addClass("app_desc_expand_showing")}},openOverflowMenu:function t(i){if(TS.menu.isRedundantClick(i))return;if(TS.client.ui.checkForEditing(i))return;TS.menu.buildIfNeeded();TS.menu.clean();TS.menu.$menu_items.html(TS.templates.menu_app_profile_items(e));TS.menu.start(i,true);var n=$(i.target);TS.menu.positionAt(n,n.width()-TS.menu.$menu.width(),n.height()+8);TS.menu.$menu_items.on("click.menu","li",TS.client.ui.app_profile.onOverflowMenuClick);TS.menu.keepInBounds()},onOverflowMenuClick:function e(){var t=$(this);var i=t.data("action");var n=TS.client.ui.app_profile.active_app;"app_support"===i&&TS.help_modal.start();var a=n.id;var r=n.bot_user?n.bot_user.id:"";TS.interop.clog.track("USER_PROFILE_CLICK",{app_id:a,bot_id:r});TS.menu.end()}});var e;var t;var i;var n=function n(){i=t.find('[data-js="app_profile_desc"]');e.hide_expand_button||i.find('[data-js="app_profile_desc_inner"]').height()<=1.2*i.height()?i.removeClass("app_desc_expand_showing"):i.css("max-height",i.find('[data-js="app_profile_desc_inner"]').height());t.find(".emoji_replace_on_load").each(function(){var e=$(this).html();e=TS.emoji.graphicReplace(e);$(this).html(e)})}})()},3090:function(e,t){(function(){TS.registerModule("channels_suggestions",{onStart:function e(){if(!TS.client)return;TS.client.login_sig.addOnce(function(){var e=TS.interop.utility.addJitter(75,-.6,.6);window.setTimeout(function(){var e=_.get(window,["desktop","reduxHelper"]);if(e&&_.isFunction(e.isSelectedTeam)&&!e.isSelectedTeam())return;TS.interop.api.call("channels.suggestions",{}).then(_.noop)},1e3*e)})}})})()},3091:function(e,t){(function(){TS.registerModule("ui.replies",{$scroller:$("#convo_scroller"),onStart:function e(){if(!TS.client){TS.warn("TS.ui.replies only works in the client");return}if(TS.boot_data.feature_react_threads){TS.client.login_sig.add(function(){TS.interop.mountThreadsFlexpane(TS.model.team.id,$("#convo_tab")[0])});return}TS.prefs.team_perms_pref_changed_sig.add(D);TS.client.flexpane_display_switched_sig.add(x);TS.ui.window_focus_changed_sig.add(Y);TS.replies.sanity_check_failed_sig.add(H);TS.replies.reply_changed_sig.add(V);TS.replies.reply_deleted_sig.add(z);TS.channels.joined_sig.add(j);TS.channels.left_sig.add(K);TS.channels.archived_sig.add(W);TS.channels.unarchived_sig.add(W);TS.view.members.unknown_resolution_rebuild_sig.add(q);TS.boot_data.feature_lazy_user_groups&&TS.user_groups.unknown_resolution_rebuild_sig.add(J);TS.view.channel.unknown_resolution_rebuild_sig.add(Z);TS.redux.socket.connectedSig.add(p);TS.channels.read_only.list_updated_sig.add(TS.ui.replies.refreshConversation);if(TS.boot_data.feature_file_threads){TS.files.team_file_changed_sig.add(oe);TS.files.team_file_changed_sig.add(le);TS.files.team_file_comment_added_sig.add(se);TS.files.team_file_comment_edited_sig.add(se);TS.files.team_file_comment_deleted_sig.add(se)}TS.boot_data.feature_degraded_send&&TS.replies.thread_synced_sig.add(Q);L=TS.utility.throttleFunc(L,250,true);g()},refreshConversation:function e(){var t=TS.ui.replies.activeConvoModelId();var i=TS.ui.replies.activeConvoThreadTs();if(!t||!i)return;var n=TS.redux.channels.getEntityById(t);var a=TS.replies.getMessage(n,i);if(!a)return;r=TS.permissions.members.canPostInModelOb(n)&&!n.is_archived;TS.boot_data.feature_default_shared_channels&&!r&&(r=TS.permissions.members.canThread(n)&&!n.is_archived);E(n,a)},reloadConversation:function e(){var t=TS.ui.replies.activeConvoModelId();var i=TS.ui.replies.activeConvoThreadTs();if(!t||!i){TS.interop.console.error("Can't reload conversation for "+i+" in "+t);return}TS.ui.replies.openConversation(t,i)},openConversationFromMessagePane:function e(t,i,n,a,r){_.isString(i)&&(i=TS.redux.channels.getEntityById(i));var s=TS.client.ui.areMsgsScrolledToBottom();s?TS.ui.replies.openConversation(i,n,a,r):TS.ui.utility.preventElementFromScrolling(t,function(){TS.ui.replies.openConversation(i,n,a,r)})},openConversation:function e(t,i,n,r,s){try{if(!i){TS.error("openConversation called with bogus data; this is a programming error.");I();return}_.isString(t)&&(t=TS.redux.channels.getEntityById(t));if(!TS.client){var o=TS.utility.msgs.constructConversationPermalink(t,i);window.location=o;return}if(_.isNumber(i)){TS.warn("Thread flexpane opened with non-string thread_ts");i+=""}TS.info("Opening conversation "+i+" in "+t.id);if(TS.boot_data.feature_react_threads){TS.client.ui.flex.openConversationFlex(t,i,r,s);n?TS.redux.dispatch(TS.interop.redux.features.threadsFlexpane.jumpToReply(n)):TS.redux.dispatch(TS.interop.redux.features.threadsFlexpane.clearStartTs());return}var l=!!a;k();C=true;TS.client.ui.flex.openConversationFlex(t,i,r,s);TS.ui.replies.maybeRenderReplies(t,i,n,r,s);TS.utility.msgs.startUpdatingRelativeTimestamps("#convo_container");if(l){F();u=true}else{$("#reply_container .message_input").addClass("hidden");u=false;TS.view.resize_sig.addOnce(function(){$("#reply_container .message_input").removeClass("hidden");F();u=true;m.dispatch()})}}catch(e){TS.error("Something went wrong when trying to open conversation "+i+" in "+_.get(t,"id")+": "+e);I()}finally{C=false}},maybeRenderReplies:function t(i,l,d,u,_){var m=TS.replies.getMessage(i,l);var f=$("ts-conversation");if(f.length){if(f.find("ts-message.selected").attr("data-ts")!=l){TS.warn("maybeRenderReplies called when same convo is already open");return Promise.resolve()}return Promise.reject(new Error("There is already a conversation open; only one can be open at a time"))}f=$(TS.templates.message_conversation({model_ob_id:i.id,thread_ts:l}));n=i.id;a=l;c=void 0;r=TS.permissions.members.canPostInModelOb(i)&&!i.is_archived;TS.boot_data.feature_default_shared_channels&&!r&&(r=TS.permissions.members.canThread(i)&&!i.is_archived);s=[];de(u,_);var h=!!o;TS.ui.replies.toggleBackButton(h);A(i,l,f);N(true);te(m,i,l,f);TS.ui.message_container.register(e);M(f);m&&E(i,m);var p;if(d)p=TS.replies.getThreadAround(i.id,l,d);else{var g=false;p=TS.replies.getThreadLazy(i.id,l,g)}return p.then(function(e){TS.ui.replies.finishRenderingReplies(i,l,m,e,d);return null}).catch(function(e){TS.console.logError(e,"replies_ui_error","threads");TS.error("Unable to get conversation around message thread_ts="+l+" with error: "+e);if(n!==i.id||a!==l)return;I()}).finally(function(){if(n!==i.id||a!==l)return;0===f.closest(".monkey_scroller").width()&&TS.ui.utility.updateClosestMonkeyScroller(TS.ui.replies.$scroller,true);N(false)})},finishRenderingReplies:function t(i,r,o,l,d){var u=l.messages;var _=!!l.has_more_beginning||!!l.has_more_end;if(n!=i.id)return;if(a!=r)return;TS.info("Rendering thread "+r+", "+u.length+" messages (has_more: "+_+")");s=u;if(v()){TS.client.ui.flex.hideFlex();return}if(!o){o=TS.utility.msgs.getMsg(r,u);o=l.root_msg;E(i,o)}var m=TS.utility.msgs.getFileOnMsg(o);if(TS.interop.messages.shouldRenderFileThread(o)&&m&&m.id){c=m.id;re(m.id)}X(u,l.has_more_beginning,l.has_more_end);d?TS.ui.message_container.jumpToTS(e,d,h):l.has_more_beginning&&TS.ui.message_container.jumpToEnd(e);o=y(o,u);P(o);TS.utility.msgs.removeAllEphemeralMsgsByType("threads_temp_slash_cmd_feedback",i.id,r);if(d){var f=TS.templates.makeMsgDomIdInConversation(d);TS.ui.message_container.scrollintoview(e,f,{offset:"bottom",px_offset:-50,complete:function e(){O(f)}});$("#"+f).highlight(2500,"msg_highlighter")}else O();TS.replies.promiseToGetSubscriptionState(i.id,r).then(function(e){if(n!=i.id)return;if(a!=r)return;if(!e)return;TS.ui.replies.checkUnreads();return null});return null},maybeRemoveMessageFromConversation:function e(t,r){if(t.id!==n)return;if(r.thread_ts!=a&&r.ts!=a)return;var o=s&&_.find(s,{ts:r.ts});o&&(o.subtype="tombstone");if(v()){TS.client.ui.flex.hideFlex();return}var l=T();if(l.length&&r.ts==a){TS.ui.replies.maybeUpdateConversationWithMessage(t,r);return}var c=$('ts-conversation[data-thread-ts="'+r.thread_ts+'"]');if(!c.length)return;var d=c.find('ts-relatives ts-message[data-ts="'+r.ts+'"]');_.remove(s,{ts:r.ts});TS.interop.messages.isReply(r)&&_.remove(i.msgs,{ts:r.ts});r.is_pending?ee():d.length?d.addClass("delete_mode").slideUp(200,function(){ee()}):ee();P(_.find(s,{ts:r.thread_ts||r.ts}))},maybeUpdateConversationWithMessage:function r(o,l){if(o.id!==n)return;if(l.thread_ts!=a&&l.ts!=a)return;var c=s&&_.findIndex(s,{ts:l.ts});-1!==c?s[c]=l:s.push(l);var d=false;if(TS.interop.messages.isReply(l)){var u=_.findIndex(i.msgs,{ts:l.ts});if(-1!==u)i.msgs[u]=l;else{d=true;var m=_.findIndex(i.msgs,function(e){return e.ts<l.ts});-1===m?i.msgs.push(l):i.msgs.splice(m,0,l)}}else t.msgs.length?t.msgs[0]=l:t.msgs.push(l);if(v()){TS.client.ui.flex.hideFlex();return}var f=TS.ui.replies.$scroller[0];var h=Math.abs(f.scrollHeight-f.offsetHeight-f.scrollTop);var p=50;var g=TS.ui.replies.$scroller.find("#reply_container");g.length&&(p=g.outerHeight(true));var T=h<p;var S=$('ts-conversation[data-thread-ts="'+(l.thread_ts||l.ts)+'"]');if(!S.length)return;var b=S.find('ts-message[data-ts="'+l.ts+'"]');var w;ee([l.ts]);d&&T&&TS.ui.message_container.jumpToEnd(e);w=S.find('ts-message[data-ts="'+l.ts+'"]');b.length&&b.hasClass("hidden")&&w.addClass("hidden");P(_.find(s,{ts:l.thread_ts||l.ts}));if(!b.length){var y=true;TS.ui.replies.checkUnreads(y)}T&&(f.scrollTop=f.scrollHeight-f.offsetHeight)},updateMessageActions:function e(t,i){if(!TS.replies.canReplyToMsg(t,i)){t.is_channel&&!t.is_member&&G(t,i);return}var n=i.thread_ts||i.ts;var a=$("#reply_container");a.empty();var r=TS.boot_data.feature_file_threads;r?a.addClass("upload_in_threads"):a.append(TS.ui.replies.getReplyInputAvatarHTML());TS.ui.inline_msg_input.make(a,{placeholder:TS.interop.i18n.t("Reply...","threads")(),aria_label:TS.interop.i18n.t("Reply...","threads")(),enableBroadcastKeywords:false,complete_cmds:true,in_thread:true,model_ob:t,thread_ts:n,jumbomoji:TS.utility.contenteditable.isJumbomojiEnabled,include_plus_button:r,onSubmit:function e(a,r){if(!TS.redux.socket.isConnected()&&!TS.boot_data.feature_degraded_send||!TS.interop.connectivity.isOnline()&&TS.boot_data.feature_degraded_send)return;if(t.is_archived){TS.generic_dialog.alert(TS.interop.i18n.t("This channel has been archived; you cannot send messages to it.","threads")());return}var o=_.reject(s,S);if(!o.length)return;var l=_.maxBy(o,"ts");var c=TS.client.ui.maybeHandleReactionCmd(l,r,function(){TS.ui.replies.clearReplyInput(t,n)});if(c)return;if(TS.interop.slashCommand.looksLikeSlashCommand(r)){TS.ui.replies.clearReplyInput(t,n);TS.client.ui.sendSlashCommand(t,r,i)}else{TS.utility.msgs.removeAllEphemeralMsgsByType("threads_temp_slash_cmd_feedback",t.id,n);var d=$("#reply_container .reply_broadcast_toggle").prop("checked");TS.boot_data.feature_default_shared_channels&&d&&(d=TS.permissions.members.canPostInChannel(t));TS.ui.replies.clearReplyInput(t,n);var u=d?"THREADS_REPLY_BROADCAST_CLICKED":"THREADS_REPLY";var m=_.get(i,".reply_count",0)+1;TS.ui.thread.trackEvent(t.id,i.ts,"convo",u,{num_msg_in_thread:m});d&&TS.log(2004,"Submitting broadcast from flexpane for "+t.id+"-"+i.ts);TS.client.ui.sendMessage(t,r,i,d)}},getMsgDivForEditing:function e(){if(!s)return null;var t=_.reject(s,S);_.reverse(t);var i=TS.interop.rules.messages.getLastMessageByMember(t,TS.model.user.id);if(!i)return null;return $('#convo_container ts-message[data-ts="'+i.ts+'"]')},onTextChange:function e(i){var a=TS.ui.replies.getReplyInputValueForStorage(i);TS.storage.storeReplyInput(t.id,n,a);var r=TS.ui.replies.$scroller[0];TS.ui.replies.maybeScrollReplyInputToBottomOfScroller(r)}});TS.ui.replies.bindReplyInputFocusEvents(a);B(t,n,a);var o=TS.storage.fetchReplyInput(t.id,n);o&&TS.ui.replies.populateReplyInput(o)},getReplyInputAvatarHTML:function e(){var t=36;var i=false;var n=true;return TS.templates.builders.makeMemberPreviewLinkImage(TS.model.user.id,t,i,n)},bindReplyInputFocusEvents:function e(t){var i=t.find(".message_input");i.on("focusin",function(){t.addClass("has_focus")}).on("focusout",function(){var e=TS.utility.contenteditable.isEmpty(i,true);var n=document.activeElement===this||TS.utility.contenteditable.isActiveElement(this);e&&!n&&t.removeClass("has_focus")})},maybeScrollReplyInputToBottomOfScroller:function e(t){var i=Math.abs(t.scrollHeight-t.offsetHeight-t.scrollTop);var n=i<50;n&&(t.scrollTop=t.scrollHeight-t.offsetHeight)},getReplyInputValueForStorage:function e(t){var i=TS.utility.contenteditable.value(t);var n=!i.trim();var a=n?"":i;return a},checkReplyInputLengthAndUpdate:function e(t){var i=t.find(".message_input");var n=TS.msg_edit.isMessageTooLong(i);t.find(".reply_container_info").toggleClass("no_opacity",n)},submitReply:function e(t,i){if(!i||0===i.length)return;var n=i.closest("#reply_container, #file_reply_container").find("form");if(0===n.length)return;n.submit()},updateFlexpaneThreadDivider:function e(t,i){if(!t||!t.length)return;if(i){t.removeClass("hidden");var n=t.find(".reply_count");n.text(TS.interop.i18n.t("{count, plural, =1 {# reply} other {# replies}}","threads")({count:i}))}else t.addClass("hidden")},activeConvoModelId:function e(){return n},activeConvoThreadTs:function e(){return a},activeConvoOrigin:function e(){return o},replyInputValue:function e(){var t=$("#reply_container .message_input");return TS.utility.contenteditable.value(t)},isBroadcastChecked:function e(){return $("#reply_container .reply_broadcast_toggle").prop("checked")},populateReplyInput:function e(t,i){var n=$("#reply_container .message_input");TS.utility.populateInput(n,t,t.length);i&&$("#reply_container .reply_broadcast_toggle").prop("checked",true)},clearReplyInput:function e(t,i){TS.ui.replies.populateReplyInput("");TS.utility.contenteditable.clearHistory($("#reply_container .message_input"));var n=t?t.id:TS.ui.replies.activeConvoModelId();TS.storage.storeReplyInput(n,i||TS.ui.replies.activeConvoThreadTs(),"");$("#reply_container .reply_broadcast_toggle").prop("checked",false)},focusReplyInput:function e(t,i){var n=TS.client.ui.isUserAttentionOnChat()&&(!t||R());if(n){TS.utility.contenteditable.focus($("#reply_container .message_input"));return}var a=i?document.getElementById(i):$("#convo_container")[0];var r=TS.interop.utility.firstFocusableChild(a);r&&r.focus()},isReplyInputFocused:function e(){if(!TS.ui.replies.activeConvoModelId()||!TS.ui.replies.activeConvoThreadTs())return false;return TS.utility.contenteditable.isActiveElement($("#reply_container .message_input"))},getActiveMessage:function e(t,i){if(t.id!=n)return null;return TS.utility.msgs.getMsg(i,s)},getActiveMessages:function e(){return s},toggleBackButton:function e(t){$("#convo_tab_back_container").toggleClass("hidden",!t)},joinChannelFromThread:function e(){if(!n||!a)return;var t=TS.redux.channels.getEntityById(n);if(!t)return;var i=_.find(s,function(e){return e.ts===a});if(!i)return;TS.redux.dispatch(TS.interop.channels.joinConversationApi({channelId:t.id,inBackground:true})).then(function(){E(t,i)}).catch(_.noop);$("#reply_container .join_channel_from_thread").addClass("disabled")},checkUnreads:function e(t){if(!TS.client.ui.isUserAttentionOnChat())return;if(!n||!a)return;if(!s||s.length<2)return;var i=TS.replies.getSubscriptionState(n,a);if(!i||!i.subscribed)return;var r=_.chain(s).filter(function(e){return!e.is_ephemeral&&!TS.interop.rules.messages.isTempMsg(e)&&!S(e)}).map("ts").max().value();if(!r)return;if(!i.last_read||r>i.last_read){var o=t;TS.replies.markThread(n,a,r,o)}return null},rebuildMsgsIncludingMember:function t(i){if(!n||!a||!e)return;var r=TS.redux.channels.getEntityById(n);if(!r)return;TS.ui.message_container.maybeUpdateMessages(e,function(e){return TS.utility.msgs.messageIncludesMember(i,e)})},rebuildMsgsIncludingUserGroup:function t(i){if(!TS.boot_data.feature_lazy_user_groups)return;if(!n||!a||!e)return;var r=TS.redux.channels.getEntityById(n);if(!r)return;TS.ui.message_container.maybeUpdateMessages(e,function(e){return TS.utility.msgs.messageIncludesUserGroup(i,e)})},maybeOpenConversationLink:function e(t,i){if(!t||!t.length)return false;var n=t.prop("hostname");var a=t.prop("pathname");if(!n||!a)return false;if(0!==a.indexOf("/conversation/"))return false;if(TS.utility.normalizeDevHost(n)!==TS.utility.normalizeDevHost(document.location.hostname))return false;var r=a.split("/");r=_.drop(r,1);if(3!==r.length)return false;var s=r[1];if(!s)return false;var o=TS.redux.channels.getEntityById(s)||TS.redux.channels.getChannelByName(s);if(!o)return false;if(!(o.is_channel||o.is_group||o.is_im))return false;if(o.is_im&&TS.interop.channels.isImWithDeletedMember(o))return false;var l=r[2];if(!l)return false;if(0!==l.indexOf("p"))return false;if(17!==l.length)return false;l=l.replace("p","");if(isNaN(l))return false;var c=l.substr(0,10)+"."+l.substr(10);TS.ui.replies.openConversation(o,c,null,i);return true},rebuildMsgCurrentStatusIncludingMember:function t(i){if(!n||!a)return;var r=TS.redux.channels.getEntityById(n);if(!r)return;var s={member:i,for_message:true};var o=e._state;_.each(o,function(e){if(!e)return;_.each(e.msgs,function(e){if(TS.utility.msgs.memberSentMessage(i,e)){var t=$('ts-conversation[data-thread-ts="'+(e.thread_ts||e.ts)+'"]');if(!t.length)return;var n=t.find('ts-message[data-ts="'+e.ts+'"] .message_current_status');n.replaceWith(TS.templates.current_status(s))}})})},maybeUploadDroppedFiles:function e(t,i){var s;var o;var l;if(TS.boot_data.feature_react_threads){var c=TS.model.ui_state.flex_name;var d=TS.model.ui_state.flex_extra;if("convo"!==c)return;var u=(d||"").split("-");if(2!==u.length)return;s=u[0];o=u[1];var _=TS.redux.channels.getEntityById(s);if(!_)return;if(_.is_archived||!TS.permissions.members.canThread(_))return;l=TS.interop.message_input_registry.getInputProxy({viewContext:"threads-flexpane",channelId:s,threadTs:o})}else{if(!n||!a)return;if(!r)return;s=n;o=a}TS.client.ui.files.validateFiles(t,i,null,s,o,l)},showDragOverlay:function e(){if(TS.boot_data.feature_react_threads)TS.redux.dispatch(TS.interop.redux.features.threadsFlexpane.setShowDragOverlay(true));else{var t=$("#thread_drag_overlay_mount_point");TS.interop.mountThreadDragOverlay(TS.boot_data.team_id,t[0])}},hideDragOverlay:function e(){if(TS.boot_data.feature_react_threads)TS.redux.dispatch(TS.interop.redux.features.threadsFlexpane.setShowDragOverlay(false));else{var t=$("#thread_drag_overlay_mount_point");TS.interop.unmountThreadDragOverlay(t[0])}},test:function t(){var i={userGroupChanged:J};Object.defineProperty(i,"_active_convo_model_id",{get:function e(){return n},set:function e(t){n=t}});Object.defineProperty(i,"_active_convo_thread_ts",{get:function e(){return a},set:function e(t){a=t}});Object.defineProperty(i,"_msg_container_config",{get:function t(){return e},set:function t(i){e=i}});return i}});var e;var t;var i;var n;var a;var r;var s;var o;var l;var c;var d=["mentions","starred_items","channel_page","group_page","im_page","file_details"];var u;var m=new signals.Signal;var f=false;var h=50;var p=function r(o){if(!f){f=true;return}if(o)return;if(!n||!a)return;var l=TS.redux.channels.getEntityById(n);if(!l)return;var c=a;var d=_.maxBy(s,"ts");var u=_.get(d,"ts");if(!u)return;TS.replies.getThreadAfter(l.id,c,u).then(function(r){if(n!==l.id)return;if(a!==c)return;if(!r.messages.length)return;if(!t||!i)return;r.has_more&&(e.has_more_end=true);ne(i.msgs,r.messages,c);ie();ee()})};var g=function e(){TS.ui.replies.$scroller.scroll(function(){L()});TS.ui.replies.$scroller.click(function(){TS.ui.replies.checkUnreads()});var t=function e(t,i){TS.ui.messages.updateMessageHoverContainer(i);var n=t.shiftKey&&TS.interop.utility.lastFocusableChild(i[0]);n&&$(n).focus().addClass("focus-ring")};var i=false;TS.ui.replies.$scroller.on("keyup",".message",function(e){if(e.keyCode!=TS.utility.keymap.tab)return;var n=$(e.currentTarget);n.hasClass("dirty_hover_container")&&t(e,n);var a=e.target;var r=TS.ui.replies.$scroller.find(".message--focus").get(0);if(r&&r.contains(a)||n.hasClass("message--focus"))return;$(r).removeClass("message--focus");n.addClass("message--focus");i=true});$(document).on("focusin",function(e){var t=document.getElementById("convo_scroller");var n=t.querySelector(".message--focus");if(n&&!t.contains(e.target)){$(n).removeClass("message--focus");i=false}});$(document).on("mousemove",function(){if(i){$("#convo_scroller .message--focus").removeClass("message--focus");i=false}});$("#convo_tab").on("click","#convo_tab_back",function(){"mentions"===o?TS.client.ui.flex.openFlexTab("mentions"):"starred_items"===o?TS.client.ui.flex.openFlexTab("stars"):"channel_page"===o||"group_page"===o||"im_page"===o?TS.client.ui.flex.openFlexTab("details"):TS.boot_data.feature_file_threads&&"file_details"===o&&l&&TS.client.ui.files.previewFile(l)});TS.boot_data.feature_file_threads&&$("#thread_drag_overlay_mount_point").click(function(){TS.ui.replies.hideDragOverlay()})};var T=function e(){return $("ts-conversation ts-message.selected")};var S=function e(t){return"tombstone"===t.subtype};var v=function e(){var t=_.reject(s,S);return 0===t.length};var b=function e(t,i,n,a){if(S(i))return;return TS.templates.builders.msgs.buildHTML({msg:i,prev_msg:n,model_ob:t,is_in_conversation:true,highlight_as_new:a,relative_ts:true,enable_slack_action_links:true})};var w=function e(t,i){return TS.templates.builders.msgs.buildHTML({model_ob:t,msg:i,is_root_msg:true,is_in_conversation:true,full_date:true,enable_slack_action_links:true})};var y=function e(t,i){if(!t||!t.replies)return t;for(var n=0;n<t.replies.length;n+=1){var a=t.replies[n];if(a&&"U00"===a.user){var r=_.find(i,{ts:a.ts});r&&r.bot_id&&(a.bot_id=r.bot_id);t.replies[n]=a}}return t};var A=function e(t,i,n){var a=$("#convo_tab");k();a.find("#convo_container").append(n)};var k=function n(){if(e){TS.ui.message_container.cleanup(e);e=null;t=null;i=null}$("#convo_tab #convo_container, #convo_tab #reply_container").empty();$("#thread_load_error_wrapper").remove();$("#convo_tab .thread_participants").empty();TS.boot_data.feature_file_threads&&TS.ui.replies.hideDragOverlay()};var C=false;var x=function e(t,i){if(C)return;if(!TS.model.ui_state){TS.warn("TS.model.ui_state not available; ignoring this flexpane switch");return}var d=TS.model.ui_state.flex_name;var u=TS.model.ui_state.flex_extra;if("convo"===d&&"convo"===t&&u==i){var _=!$("#flex_contents #convo_container").is(":empty");if(_)return}if("convo"===t){k();n=void 0;a=void 0;r=void 0;s=void 0;o=void 0;l=void 0;c=void 0;TS.utility.msgs.stopUpdatingRelativeTimestamps("#convo_container")}if("convo"!==d)return;var m;var f;var h=(u||"").split("-");if(1==h.length){m=TS.shared.legacyGetActiveModelOb().id;f=h[0]}else{m=h[0];f=h[1]}if(!m||!f){TS.error("convo flex pane opened without thread_ts; ignoring");try{C=true;TS.client.ui.flex.hideFlex()}catch(e){}finally{C=false}return}var p=TS.redux.channels.getEntityById(m);if(!p&&TS._incremental_boot){TS.redux.socket.connectedSig.addOnce(function(){p=TS.redux.channels.getEntityById(m);TS.ui.replies.openConversation(p,f)});return}return TS.ui.replies.openConversation(p,f)};var I=function e(){if("convo"!==TS.model.ui_state.flex_name)return;k();U();$("#reply_container").addClass("hidden");var t={default:cdn_url+"/f5d6f/img/emoji_2016_06_08/apple/1f50d.png",as_text:cdn_url+"/f5d6f/img/emoji_2016_06_08/apple/1f50d.png",google:cdn_url+"/b7f24/img/emoji_2016_06_08/google/1f50d.png",twitter:cdn_url+"/6c9e5/img/emoji_2016_06_08/twitter/1f50d.png",emojione:cdn_url+"/5499/img/emoji_2016_06_08/emojione/1f50d.png"};TS.ui.replies.$scroller.prepend(TS.templates.thread_flexpane_error({emoji:t[TS.interop.rules.emoji.getEmojiMode({forceDisplay:true})]}))};var M=function t(n){var r=_.find(s,{ts:a});if(!r)return;var o=_.get(i,"msgs.length",0);o=Math.max(r.reply_count||0,o);var l=o>0;n.find("ts-relatives.descendants").toggleClass("empty",!l);n.toggleClass("has_replies",l);var c=n.find(".convo_flexpane_divider");TS.ui.replies.updateFlexpaneThreadDivider(c,o);var d=true;if(e.has_more_end)d=false;else{var u=_(i.msgs).reject({no_display:true}).map("ts").max();if(u){var m=TS.ui.message_container.getRange(e);var f=_.get(m,"end.msg_ts");u>f&&(d=false)}}var h=$("#reply_container");h.toggleClass("hidden",!d)};var E=function e(t,i){var n=true;if(!TS.replies.canReplyToMsg(t,i,n))return;r?TS.ui.replies.updateMessageActions(t,i):$("#reply_container").html(TS.templates.reply_limited({channel_name:TS.interop.rules.channels.getDisplayNameForChannel(t),is_archived:t.is_archived}));$("#reply_container").removeClass("hidden")};var B=function e(t,i,n){if(!t||!n||0===n.length)return;var a=TS.permissions.members.canPostInChannel(t);n.append(TS.templates.reply_broadcast_buttons({model_ob:t,label_id:i,view:"convo",can_post_back_to_channel:a}));var r=n.find(".reply_broadcast_label_container, .reply_send");r.mousedown(function(e){e.preventDefault();TS.ui.replies.focusReplyInput()}).click(TS.ui.replies.focusReplyInput);if(TS.console.shouldLog(2004)){var s=n.find(".reply_broadcast_toggle");s.change(function(){var e=$(this).prop("checked");e?TS.log(2004,"Broadcast toggle checked"):TS.log(2004,"Broadcast toggle un-checked")});s.closest("label").mousedown(function(){TS.log(2004,"mousedown on broadcast toggle")}).keydown(function(){TS.log(2004,"keydown on broadcast toggle")})}};var P=function e(t){if(!t)return;if(TS.boot_data.feature_file_threads){var i=TS.redux.channels.getEntityById(n);if(!i)return;var a={model_ob:i,model_ob_name:new Handlebars.SafeString(TS.templates.builders.makeModelObNameForDisplay(i)),permalink:TS.utility.msgs.constructMsgPermalink(i,t.ts)};$("#convo_tab .thread_participants").html(TS.templates.thread_channel_link(a))}else $("#convo_tab .thread_participants").html(TS.templates.builders.buildThreadParticipantListHTML(t))};var U=function e(){$("#convo_tab .thread_participants").text("")};var D=function e(){if(!n)return;var t=TS.redux.channels.getEntityById(n);if(!t)return;var i=TS.permissions.members.canPostInModelOb(t)&&!t.is_archived;TS.boot_data.feature_default_shared_channels&&!i&&(i=TS.permissions.members.canThread(t)&&!t.is_archived);if(i!==r){var s=TS.replies.getMessage(t,a);r=i;$("#reply_container").empty();E(t,s)}};var F=function e(){$("#reply_container .message_input").trigger("autosize-resize")};var O=function e(t){var i=$("#reply_container .message_input");if(TS.utility.isFocusOnInput()&&!TS.utility.contenteditable.isActiveElement(i[0]))return;if(document.activeElement&&document.activeElement.classList.contains("c-toast"))return;var n=true;u?TS.ui.replies.focusReplyInput(n,t):m.addOnce(function(){TS.ui.replies.focusReplyInput(n,t)})};var R=function e(){var t=$("#reply_container .message_input");return TS.client.ui.isElInView(t,0,TS.ui.replies.$scroller.dimensions_rect())};var N=function e(t){$("#convo_loading_indicator").toggleClass("hidden",!t)};var L=function e(){TS.ui.replies.checkUnreads()};var G=function e(t,i){var n=$("#reply_container");n.html(TS.templates.join_channel_from_thread({model_ob_name:t.name,is_convo:true,has_replies:!!i.reply_count}))};var H=function e(t,i,r,s,o){if(n!=t.id)return;if(a!=i.ts)return;X(r,s,o)};var Q=function e(t,i,r,s,o){if(n!==t.id)return;if(a!==i.ts)return;X(r,s,o)};var j=function e(t){if(n!==t.id)return;TS.ui.replies.openConversation(t,a)};var K=function e(t){if(n!==t.id)return;t.is_group?TS.client.ui.flex.hideFlex():TS.ui.replies.openConversation(t,a)};var W=function e(t){if(n!==t.id)return;TS.ui.replies.openConversation(t,a)};var V=function e(t,i){TS.ui.replies.maybeUpdateConversationWithMessage(t,i)};var z=function e(t,i){TS.ui.replies.maybeRemoveMessageFromConversation(t,i)};var Y=function e(){TS.ui.replies.checkUnreads()};var q=function e(t){var i=t.batch?t.batch:[t];_.each(i,TS.ui.replies.rebuildMsgsIncludingMember)};var J=function e(t){if(!TS.boot_data.feature_lazy_user_groups)return;_.each(t,TS.ui.replies.rebuildMsgsIncludingUserGroup)};var Z=function t(i){if(_.isEmpty(i)||!n||!a||!e)return;var r=TS.redux.channels.getEntityById(n);if(!r)return;var s=_.map(i,"id");TS.ui.message_container.maybeUpdateMessages(e,function(e){var t=TS.format.extractIds(e.text).c_ids;if(_.intersection(s,t).length)return true;var i=void 0;e.attachments&&e.attachments.length&&(i=_(e.attachments).map(function(e){return TS.format.extractIds(e.text||"").c_ids}).flatten().uniq().value());return _.intersection(s,i).length})};var X=function n(r,s,o){var l=_.find(r,{ts:a});var c=_.without(r,l);t.msgs.length=0;i.msgs.length=0;l&&t.msgs.push(l);_.forEach(c,function(e){i.msgs.unshift(e)});e.sections.length=0;t.msgs.length&&e.sections.push(t);e.sections.push(i);e.has_more_beginning=!!s;e.has_more_end=!!o;TS.utility.msgs.sortMsgs(i.msgs);ie();ee()};var ee=function t(i){TS.ui.message_container.update(e,i)};var te=function n(a,r,s,o){t={id:"root",order:0,msgs:[]};a&&t.msgs.push(a);i={id:"replies",order:1,msgs:[]};e={name:"replies",container:o,scroller:TS.ui.replies.$scroller,page_size:h,sections:[t,i],has_more_beginning:false,has_more_end:false,skip_day_groupings:true,show_hidden_replies:true,buildSection:function e(t){if("root"===t.id){var i={};if(TS.boot_data.feature_file_threads&&c){var n=TS.files.getFileById(c);n&&!_.isEmpty(n.comments)&&(i.file=n)}return TS.templates.message_conversation_root(i)}return TS.templates.message_conversation_descendants()},buildMsgHTML:function e(t,i,n){if("root"===n.id)return w(r,t);return b(r,t)},updateCallback:function e(){M(o)},promiseToLoadMoreAtBeginning:function n(){var a=i.msgs;var o=_.minBy(a,"ts");var l=_.get(o,"ts");if(!l)return Promise.reject();return TS.replies.getThreadBefore(r.id,s,l).then(function(n){var a=n.root_msg;ne(i.msgs,n.messages,s);if(!n.has_more){e.has_more_beginning=false;t.msgs[0]=a;e.sections[0]!==t&&e.sections.unshift(t)}ie()})},promiseToLoadMoreAtEnd:function t(){var n=i.msgs;var a=_.maxBy(n,"ts");var o=_.get(a,"ts");if(!o)return Promise.reject();return TS.replies.getThreadAfter(r.id,s,o).then(function(t){ne(i.msgs,t.messages,s);t.has_more||(e.has_more_end=false);ie()})}}};var ie=function e(){s=_.flatten([t.msgs,i.msgs]);s=_.sortBy(s,"ts")};var ne=function e(t,i,n){var a=_.groupBy(t,"ts");_.forEach(i,function(e){if(e.ts===n)return;if(a[e.ts])return;t.push(e)});TS.utility.msgs.sortMsgs(t)};var ae=function e(t){if(!t||!t.id)return false;if(_.isUndefined(t.comments_count))return true;if(t.comments_count&&(!t.comments||t.comments_count!==t.comments.length))return true;return false};var re=function e(t){var i=TS.files.getFileById(t);if(!i){TS.error("No file for "+t+" in thread");return}ae(i)?TS.files.fetchFileInfo(i.id):TS.interop.files.isObjectFresh(i.id)?ce(i):TS.files.getFileById(i.id)};var se=function e(t){var i=true;oe(t,i)};var oe=function e(t,i){if(!c)return;if(!t||t.id!==c)return;var n=!i&&!TS.interop.files.isObjectFresh(t.id);if(n){TS.files.getFileById(t.id);return}ce(t)};var le=function e(t){if(!s||!s.length)return;var i=TS.redux.channels.getEntityById(n);if(!i)return;s.forEach(function(e){var n=TS.utility.msgs.getFilesOnMsg(e);if(!n)return;n.forEach(function(n){if(n.id!==t.id)return;if(!TS.interop.files.isObjectFresh(t.id)){TS.files.getFileById(t.id);return}V(i,e)})})};var ce=function e(t){var i=$("ts-conversation .thread_comments_holder");var n="";_.isEmpty(t.comments)||(n=TS.templates.message_conversation_comments({file:t,expanded:i.hasClass("expanded")}));i.replaceWith(n)};var de=function e(t,i){o=null;l=null;if(!t)return;if(!_.includes(d,t))return;if("file_details"===t&&!i)return;o=t;l=i}})()},3092:function(e,t){(function(){TS.registerModule("client.deprecation",{supported:{chrome:51,firefox:47,safari:9,msie:11,msedge:14,electron:"0.0.0"},onStart:function e(){TS.client.login_sig.addOnce(function(){TS.qs_args.deprecate_modal?i():TS.qs_args.deprecate_modal_unsupported?n():TS.qs_args.deprecate_modal_install?a():TS.qs_args.deprecate_modal_install_unsupported?r():TS.qs_args.deprecate_modal_ssb?s():TS.qs_args.deprecate_modal_cert&&o();TS.client.deprecation.isDeprecatedSSB()?s():TS.client.deprecation.isDeprecatedWindowsCert()?o():TS.client.deprecation.isBrowserSupported()||(TS.client.deprecation.canInstallSSB()?TS.client.deprecation.isBrowserFamilySupported()?a():r():TS.client.deprecation.isBrowserFamilySupported()?i():n())})},isBrowserSupported:function e(){if(TS.model.is_electron&&TS.model.desktop_app_version){var t=TS.model.desktop_app_version;var i=t.major+"."+t.minor+"."+t.patch;if(TS.utility.compareSemanticVersions(i,TS.client.deprecation.supported.electron)>=0)return true;TS.info(t," electron app is deprecated!");return false}if(!window.bowser){TS.warn("no bowser???");return true}if(bowser.mobile)return false;if(_.some(TS.client.deprecation.supported,function(e,t){return bowser[t]&&bowser.version>=e}))return true;if(bowser.firefox&&45===Math.floor(bowser.version))return true;TS.warn(bowser,navigator.userAgent,"is deprecated!");return false},isBrowserFamilySupported:function e(){if(!window.bowser)return false;return _.some(TS.client.deprecation.supported,function(e,t){return bowser[t]})},isDeprecatedSSB:function e(){return!TS.client.deprecation.isBrowserSupported()&&TS.model.is_our_app},isDeprecatedWindowsCert:function e(){return TS.boot_data.feature_deprecate_window_cert&&TS.model.is_win&&TS.model.desktop_app_version&&-1===TS.interop.versions.compareVersions(TS.model.desktop_app_version,{major:2,minor:6,patch:5})},canInstallSSB:function e(){if(TS.model.is_win_7_plus)return true;if(TS.model.is_mac&&1===TS.utility.compareSemanticVersions(TS.model.mac_version,"10.8"))return true;if(TS.model.is_lin)return true;return false}})})();var i=function e(){TS.metrics.count("deprecation_modal");var t=TS.interop.i18n.t("This browser is out of date","deprecation")()+" "+TS.emoji.graphicReplace(":spiral_calendar_pad:",{jumbomoji:true}).replace("emoji-sizer","");t=new Handlebars.SafeString(t);TS.ui.fs_modal.start({title:t,body:TS.interop.i18n.t("<p>We know it's a hassle to upgrade, but we want your experience of Slack to be fast, secure, and the best it can possibly be.</p><p><strong>To continue using Slack, please upgrade to one of our <a href='https://get.slack.help/hc/{locale}/articles/201746897?{hcTrackingToken}'>supported browsers</a> soon.</strong> As always, feel free to <a href='mailto:feedback@slack.com'>contact us</a> if you have questions.</p>","deprecation","1ec1399b533d4d0c931958f2e6e28e72f8403545")({locale:TS.interop.i18n.zdLocale(),hcTrackingToken:TS.utility.getHCAttributionQS()}),show_secondary_go_button:true,go_button_text:TS.interop.i18n.t("Learn More","deprecation")(),show_cancel_button:false,secondary_go_button_class:"btn_link",secondary_go_button_text:TS.interop.i18n.t("Skip for now","deprecation")(),modal_class:"deprecate_modal",onGo:function e(){TS.metrics.count("deprecation_button");TS.utility.openInNewTab("https://get.slack.help/hc/"+TS.interop.i18n.zdLocale()+"/articles/201746897?"+TS.utility.getHCAttributionQS(),"_blank")},onShowComplete:function e(){$("#fs_modal .dialog_go").focus()}});$(".deprecate_modal a").on("click",function(){TS.ui.fs_modal.close()})};var n=function e(){TS.metrics.count("deprecation_modal_unsupported");var t=TS.interop.i18n.t("This browser is no longer supported","deprecation")()+" "+TS.emoji.graphicReplace(":construction:",{jumbomoji:true}).replace("emoji-sizer","");t=new Handlebars.SafeString(t);TS.ui.fs_modal.start({title:t,body:TS.interop.i18n.t("<p>We know it's a hassle to change browsers, but we want your experience of Slack to be fast, secure, and the best it can possibly be.</p><p><strong>To continue using Slack, please switch to one of our <a href='https://get.slack.help/hc/{locale}/articles/201746897?{hcTrackingToken}'>supported browsers</a> soon.</strong> As always, feel free to <a href='mailto:feedback@slack.com'>contact us</a> if you have questions.</p>","deprecation","aca33a3838713e33910b803aa8863e8ae616fafd")({locale:TS.interop.i18n.zdLocale(),hcTrackingToken:TS.utility.getHCAttributionQS()}),show_secondary_go_button:true,go_button_text:TS.interop.i18n.t("Learn More","deprecation")(),show_cancel_button:false,secondary_go_button_class:"btn_link",secondary_go_button_text:TS.interop.i18n.t("Skip for now","deprecation")(),modal_class:"deprecate_modal",onGo:function e(){TS.metrics.count("deprecation_button_unsupported");TS.utility.openInNewTab("https://get.slack.help/hc/"+TS.interop.i18n.zdLocale()+"/articles/201746897?"+TS.utility.getHCAttributionQS(),"_blank")},onShowComplete:function e(){$("#fs_modal .dialog_go").focus()}});$(".deprecate_modal a").on("click",function(){TS.ui.fs_modal.close()})};var a=function e(){TS.metrics.count("deprecation_modal_install");var t=TS.interop.i18n.t("This browser is out of date","deprecation")()+" "+TS.emoji.graphicReplace(":spiral_calendar_pad:",{jumbomoji:true}).replace("emoji-sizer","");t=new Handlebars.SafeString(t);TS.ui.fs_modal.start({title:t,body:TS.interop.i18n.t("<p>We know it\u2019s a hassle to upgrade, but we want your experience of Slack to be fast, secure, and the best it can possibly be.</p><p><strong>To continue using Slack, please upgrade to one of our <a href='https://get.slack.help/hc/{locale}/articles/201746897?{hcTrackingToken}'>supported browsers</a> soon.</strong> As always, feel free to <a href='mailto:feedback@slack.com'>contact us</a> if you have questions.</p><p>For the finest Slack experience, we recommend downloading our desktop app: you\u2019ll get greater control over your notifications, easy switching between workspaces, and \u2014 handily \u2014 automatic updates!</p>","deprecation","ffc3c9249f41b3a5f6aab02314aa976a51677eaa")({locale:TS.interop.i18n.zdLocale(),hcTrackingToken:TS.utility.getHCAttributionQS()}),show_secondary_go_button:true,go_button_text:TS.interop.i18n.t("Use the Slack app","deprecation")(),show_cancel_button:false,secondary_go_button_class:"btn_link",secondary_go_button_text:TS.interop.i18n.t("Skip for now","deprecation")(),modal_class:"deprecate_modal",onGo:function e(){TS.metrics.count("deprecation_button_install");TS.utility.openInNewTab("/ssb/redirect","_blank")},onShowComplete:function e(){$("#fs_modal .dialog_go").focus()}});$(".deprecate_modal a").on("click",function(){TS.ui.fs_modal.close()})};var r=function e(){TS.metrics.count("deprecation_modal_install_unsupported");var t=TS.interop.i18n.t("This browser is no longer supported","deprecation")()+" "+TS.emoji.graphicReplace(":construction:",{jumbomoji:true}).replace("emoji-sizer","");t=new Handlebars.SafeString(t);TS.ui.fs_modal.start({title:t,body:TS.interop.i18n.t("<p>We know it\u2019s a hassle to change browsers, but we want your experience of Slack to be fast, secure, and the best it can possibly be.</p><p><strong>To continue using Slack, please switch to one of our <a href='https://get.slack.help/hc/{locale}/articles/201746897?{hcTrackingToken}'>supported browsers</a> soon.</strong> As always, feel free to <a href='mailto:feedback@slack.com'>contact us</a> if you have questions.</p><p>For the finest Slack experience, we recommend <a href='https://slack.com/downloads'>downloading our desktop app</a>: you\u2019ll get greater control over your notifications, easy switching between workspaces, and \u2014 handily \u2014 automatic updates!</p>","deprecation","a6bcd3c3c60dfedb3d1b51d5a2b4434546770511")({locale:TS.interop.i18n.zdLocale(),hcTrackingToken:TS.utility.getHCAttributionQS()}),show_secondary_go_button:true,go_button_text:TS.interop.i18n.t("Use the Slack app","deprecation")(),show_cancel_button:false,secondary_go_button_class:"btn_link",secondary_go_button_text:TS.interop.i18n.t("Skip for now","deprecation")(),modal_class:"deprecate_modal",onGo:function e(){TS.metrics.count("deprecation_button_install_unsupported");TS.utility.openInNewTab("/ssb/redirect","_blank")},onShowComplete:function e(){$("#fs_modal .dialog_go").focus()}});$(".deprecate_modal a").on("click",function(){TS.ui.fs_modal.close()})};var s=function e(){TS.metrics.count("deprecation_modal_ssb");var t=TS.interop.i18n.t("This is an out-of-date version of Slack","deprecation")()+" "+TS.emoji.graphicReplace(":spiral_calendar_pad:",{jumbomoji:true}).replace("emoji-sizer","");t=new Handlebars.SafeString(t);TS.ui.fs_modal.start({title:t,body:TS.interop.i18n.t("<p>We've made some great improvements to our desktop app \u2014 it now runs faster, uses far less memory, and updates automatically.</p><p><strong>To continue using Slack, please <a href='https://slack.com/downloads'>manually download our new desktop app</a> soon.</strong> We want your experience of Slack to be fast, secure, and the best it can possibly be. As always, feel free to <a href='mailto:feedback@slack.com'>contact us</a> if you have questions.</p>","deprecation")(),show_secondary_go_button:true,go_button_text:TS.interop.i18n.t("Update the App","deprecation")(),show_cancel_button:false,secondary_go_button_class:"btn_link",secondary_go_button_text:TS.interop.i18n.t("Skip for now","deprecation")(),modal_class:"deprecate_modal",onGo:function e(){TS.metrics.count("deprecation_button_ssb");TS.utility.openInNewTab(l(),"_blank")},onShowComplete:function e(){$("#fs_modal .dialog_go").focus()}});$(".deprecate_modal a").on("click",function(){TS.ui.fs_modal.close()})};var o=function e(){if(!TS.boot_data.feature_deprecate_window_cert)return;TS.metrics.count("deprecation_modal_cert");var t=TS.interop.i18n.t("This is an out-of-date version of Slack","deprecation")();var i=TS.interop.i18n.t("<p>We\u2019ve released a new version of Slack with an assortment of bug fixes, an update to our certificate, and an all-around smoother experience.</p><p><strong>To continue using Slack, please update your version of the app by September 12th.</strong> Feel free to <a href='mailto:feedback@slack.com'>contact us</a> if you have any questions.</p>","deprecation")();TS.generic_dialog.start({title:t,body:i,go_button_text:TS.interop.i18n.t("Update the App","deprecation")(),cancel_button_text:TS.interop.i18n.t("Skip for Now","deprecation")(),onGo:function e(){TS.metrics.count("deprecation_button_cert");TS.utility.openInNewTab(l(),"_blank")}})};var l=function e(){var t=false;var i="";if(TS.model.is_mac)t="osx";else if(TS.model.is_win){t="windows";i=TS.model.is_win_64?"windows_64":"windows"}else TS.model.is_lin&&(t="linux");if(t)return"https://slack.com/downloads/instructions/"+t+"?os="+t+"&build_architecture="+i;return"https://slack.com/downloads"}},3093:function(e,t){(function(){TS.registerModule("client.ui.app_space",{$scroller:$("#app_space_scroller_div"),$loading_msg_container:null,$container:null,valid_sub_views:["messages","about"],active_view:"messages",screenshots_templates:[],onStart:function e(){if(!TS.interop.apps.isAppSpaceEnabled())return;TS.redux.socket.connectedSig.add(c);TS.ims.switched_sig.add(TS.client.ui.app_space.prepareAppSpace,TS.client.ui.app_space);TS.members.batch_upserted_sig.add(u,TS.client.ui.app_space)},prepareAppSpace:function e(){var t=TS.shared.legacyGetActiveModelOb();var i=t&&t.user;var n=TS.interop.members.getMemberById(i);var r=_.get(n,"profile.bot_id");var s=_.get(n,"profile.team");r&&a(r,s)},toggleView:function t(i){if(TS.client.ui.app_space.valid_sub_views.indexOf(i)<0)return;if(!e)return TS.client.ui.app_space.resetView();TS.client.channel_header.setActiveTab(i);TS.client.ui.app_space.active_view=i;"messages"===i?TS.client.ui.app_space.resetView():"about"===i&&l()},toggleViewAfterAppSpaceIsPrepared:function e(t){TS.client.ui.app_space.active_view=t;var i=TS.shared.legacyGetActiveModelOb();var n=i&&i.user;var a=TS.interop.members.getMemberById(n);var r=_.get(a,"profile.bot_id");TS.client.ui.app_space.app_bot_id===r&&TS.client.ui.app_space.toggleView(t)},resetView:function e(){TS.client.msg_pane.hideCenterWorkspace();TS.client.msg_pane.showMessageContainer();TS.redux.dispatch(TS.interop.redux.features.messagePane.setAppSpaceOpen(false))},renderAppInformation:function t(i,n,a){if(!i)return d();TS.client.ui.app_space.active_app=i;TS.client.ui.app_space.app_bot_id=n;TS.client.ui.app_space.app_team_id=a;e=TS.apps.constructTemplateArgsForCardAndProfile(i,n,null,a);if(!e)return d();TS.environment.supports_custom_scrollbar||TS.client.ui.app_space.$scroller.monkeyScroll();TS.client.ui.app_space.active_view&&TS.client.ui.app_space.toggleView(TS.client.ui.app_space.active_view)},onButtonClick:function e(t){t.preventDefault();var i=$(this);var a=i.data("action");if("desc_expand"===a){n.removeClass("--collapsed");n.addClass("--expanded")}else if("desc_collapse"===a){n.addClass("--collapsed");n.removeClass("--expanded")}},onSettingsButtonClick:function e(t){if(TS.client.ui.app_space.active_app.is_xoxa_app){t.preventDefault();TS.redux.dispatch(TS.interop.openAppManagementModal({appProfile:TS.client.ui.app_space.active_app,serviceId:TS.client.ui.app_space.app_bot_id,referringEventId:"APP_SPACE_ABOUT_OPEN"}))}},resetUI:function e(){t.empty();if("messages"!==TS.client.ui.app_space.active_view){TS.client.ui.app_space.resetView();TS.client.ui.app_space.active_view="messages"}TS.client.ui.app_space.active_app=null;TS.client.ui.app_space.app_bot_id=null;TS.client.ui.app_space.app_team_id=null;TS.client.ui.app_space.screenshots_templates=[]},openScreenshotModal:function t(i){var n=$(i.target);var a=n.data("app-space-screenshot");e.youtube_id&&("youtube"===a?a=0:a+=1);TS.ui.fs_modal.start({body_template_html:TS.templates.fs_modal_simple_gallery({items:TS.client.ui.app_space.screenshots_templates,modal_gallery_index:a}),header_html:TS.templates.fs_modal_app_header(e),modal_bg_class:"off_white_bg",modal_gallery:{index:a,total_items:TS.client.ui.app_space.screenshots_templates.length-1},modal_class:"fs_modal_header fs_modal_footer",modal_contents_container_class:"p-modal_gallery",show_go_button:false,show_cancel_button:false})}});var e;var t=$('[data-js="app_space"]');var i;var n;var a=function e(t,i){var n=TS.interop.apps.promiseToGetLegacyAppProfileByServiceId(t);n.then(function(e){TS.client.ui.app_space.renderAppInformation(e,t,i)})};var r=function e(){i=$('[data-js="app_space_profile"]');i.on("click","[data-app-space-screenshot]",TS.client.ui.app_space.openScreenshotModal);i.on("click",'[data-js="app_profile_btn"]',TS.client.ui.app_space.onButtonClick);TS.boot_data.feature_app_space_links&&i.on("click",'[data-js="app_profile_settings_btn"]',TS.client.ui.app_space.onSettingsButtonClick);i.on("click","[data-member-profile-link]",function(e){e.preventDefault();TS.client.ui.previewMember($(this).data("member-profile-link"))})};var s=function t(){e.youtube_id&&TS.client.ui.app_space.screenshots_templates.push(TS.templates.app_youtube_video({youtube_id:e.youtube_id,disable_autoplay:true}));e.screenshots&&_.each(e.screenshots,function(e){TS.client.ui.app_space.screenshots_templates.push(TS.templates.app_space_screenshot({image_url:e.image_1600}))})};var o=function e(){n=$('[data-js="app_profile_desc"]');t.find(".emoji_replace_on_load").each(function(){var e=$(this).html();e=TS.emoji.graphicReplace(e);$(this).html(e)})};var l=function i(){t.html(TS.templates.app_space_profile(e));o();s();r();TS.client.msg_pane.hideMessageContainer();TS.client.msg_pane.showCenterWorkspace();TS.interop.clog.track("APP_SPACE_ABOUT_OPEN",{app_id:TS.client.ui.app_space.active_app.id,bot_id:TS.client.ui.app_space.app_bot_id,contexts:{core:{app_id:TS.client.ui.app_space.active_app.id,bot_id:TS.client.ui.app_space.app_bot_id}}});TS.redux.dispatch(TS.interop.redux.features.messagePane.setAppSpaceOpen(true))};var c=function e(){TS.client.ui.app_space.resetUI();TS.client.ui.app_space.prepareAppSpace()};var d=function e(){TS.client.ui.app_space.resetUI();TS.client.channel_header.hideTab("about")};var u=function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i||!i.is_im)return;var n=_(t).map("member").find({id:i.user});n&&(n.is_bot||n.is_app_user)&&TS.client.ui.app_space.prepareAppSpace()}})()},3094:function(e,t){(function(){TS.registerModule("ui.shared_channels_open_beta_modal",{onStart:function e(){TS.client&&TS.redux.socket.connectedSig.addOnce(n)},showModal:function t(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!TS.permissions.members.canManageParticipationInSharedChannelsOpenBeta())return;var a=TS.templates.shared_channels_help_content();var r=TS.templates.shared_channels_open_beta_modal();var s;var o;var l;var c;var d;if(1===TS.prefs.getTeamPref("enable_shared_channels")&&n.show_create_button_only){s=TS.interop.i18n.t("Create a Shared Channel","shared")();o="btn_info"}else if(1===TS.prefs.getTeamPref("enable_shared_channels")){s=TS.interop.i18n.t("Create a Shared Channel","shared")();o="btn_info";l=true;c=TS.interop.i18n.t("Leave the Beta","shared")();d="btn_outline"}else{s=TS.interop.i18n.t("Join the Beta","shared")();o="btn_info"}TS.ui.fs_modal.start({modal_class:"fs_modal_footer",body:r,go_button_text:s,go_button_class:o,show_secondary_go_button:l,secondary_go_button_text:c,secondary_go_button_class:d,show_cancel_button:false,footer_html:a,onGo:function t(){if(1===TS.prefs.getTeamPref("enable_shared_channels")){TS.ui.fs_modal.close();setTimeout(function(){TS.ui.share_channel_dialog.start({element:"shared_channels_open_beta_modal_create_btn"})},0)}else{TS.ui.fs_modal.close();TS.prefs.setTeamPrefByAPI({enable_shared_channels:1});setTimeout(e,500)}},onSecondaryGo:i})},test:function a(){var r={};Object.defineProperty(r,"_showSharedChannelsCreateCoachmark",{get:function t(){return e},set:function t(i){e=i}});Object.defineProperty(r,"_showSharedChannelsGetStartedCoachmark",{get:function e(){return t},set:function e(i){t=i}});Object.defineProperty(r,"_maybeShowSharedChannelsGetStartedCoachmark",{get:function e(){return n},set:function e(t){n=t}});Object.defineProperty(r,"_showConfirmLeaveBetaDialog",{get:function e(){return i},set:function e(t){i=t}});return r}});var e=function e(){TS.prefs.setPrefByAPI({name:"seen_shared_channels_coachmark",value:true});TS.coachmark.start(TS.coachmarks.coachmarks.shared_channels_create,false,{reject_on_off_target_click:true})};var t=function e(){TS.prefs.setPrefByAPI({name:"seen_shared_channels_coachmark",value:true});TS.coachmark.start(TS.coachmarks.coachmarks.shared_channels_get_started,false,{reject_on_off_target_click:true})};var i=function e(){var t=TS.interop.i18n.t("Remove {team_name} from the beta?","shared")({team_name:TS.interop.i18n.safeString(_.escape(TS.interop.rules.teams.getTeamDisplayName(TS.model.team)))});var i=TS.templates.shared_channels_leave_open_beta_dialog();var n=TS.interop.i18n.t("Leave Beta","shared")();TS.generic_dialog.start({title:t,body:i,go_button_text:n,go_button_class:"btn_danger",onGo:function e(){TS.prefs.setTeamPrefByAPI({enable_shared_channels:0});TS.utility.rAF(TS.ui.fs_modal.close)}})};var n=function e(){if(!TS.permissions.members.canManageParticipationInSharedChannelsOpenBeta())return;if(1===!TS.prefs.getTeamPref("enable_shared_channels"))return;if(TS.onboarding.inOnboarding())return;if(TS.coachmark.is_showing)return;if(TS.prefs.getPref("seen_shared_channels_coachmark"))return;setTimeout(t,2500)}})()},3095:function(e,t){(function(){TS.registerModule("ui.apps_browser",{onStart:function e(){i()},start:function t(i){if(!TS.interop.apps.isAppSpaceEnabled())return;if(TS.client.ui.checkForEditing())return;if(TS.isPartiallyBooted()){TS.incremental_boot.userDidInteractWithUI();return}var n=TS.templates.apps_browser({showTutorial:TS.prefs.getPref("seen_app_space_tutorial")});TS.ui.fs_modal.start({body_template_html:n,onShow:a,onEnd:r,disable_esc:true,modal_class:"fs_modal_internal_scroll p-apps_browser_modal"});var s=!!TS.redux.enterprise.getEnterpriseId();var o=!TS.model.team.plan&&!s;var l=TS.model.is_IE;var c=TS.model.is_FF&&TS.model.is_win;var d=TS.model.is_FF&&TS.model.is_mac;var u=!!navigator.userAgent.match("MacAppStore");e=document.getElementById("apps_browser_container");TS.interop.mountAppsBrowser(TS.boot_data.team_id,e,{addAppsVariant:i,isUnpaid:o,isInternetExplorer:l,isFirefoxAndWindows:c,isFirefoxAndMac:d,isMacSsbBuild:u});TS.interop.clog.track("APP_INDEX_OPEN");$("[data-manage_apps_link]").click(function(){TS.interop.clog.track("APP_INDEX_MANAGE_CLICK")})},startAddApps:function e(t,i){if(TS.apps.permissions.areXoxaAppsInstalled()){n=TS.shared.legacyGetActiveModelOb();TS.ui.apps_browser.start(true);TS.interop.clog.track("APPS_BROWSER_ADD_TO_CHANNEL",{contexts:{ui_context:{action:"IMPRESSION"},referring_ui_context:i,core:{channel_id:n.id}},referring_event_id:t})}else TS.ui.apps_browser.start()},ensureAppMembershipIsKnown:function e(t){return TS.interop.membership.ensureChannelMembershipIsKnownForUsers(n.id,t)},canAppBeAdded:function e(t){if(!t||!TS.apps.permissions.areXoxaAppsInstalled())return false;var i=TS.interop.members.getMemberById(t);if(!i)return false;if((n.is_im||n.is_mpim)&&!i.is_app_user)return false;var a=TS.interop.membership.getCachedChannelMembershipInfoForUser(n.id,t);return a.is_known&&!a.is_member},routeAppOpen:function e(t){TS.ui.fs_modal.close();t.bot_user_id?TS.ims.legacyStartImByMemberId(t.bot_user_id):t.bot_id?TS.apps.startFlexPaneByBotId(TS.model.team.id,t.bot_id,true):TS.apps.startFlexPaneByAppId(TS.model.team.id,t.app_id,false)},addAppToChannel:function e(t){TS.ui.fs_modal.close();var i=TS.interop.members.getMemberById(t.bot_user_id);if(!i)return;var n=TS.shared.legacyGetActiveModelOb();if(i.is_app_user){TS.interop.addAppToChannel({appUserId:i.id,channelId:n.id,referringEventId:"APPS_BROWSER_ADD_TO_CHANNEL",referringUiContext:{action:"IMPRESSION"},sendEphemeralErrorMessage:true});return}TS.interop.api.call("conversations.invite",{channel:n.id,users:i.id})},showAppTutorial:function e(){TS.interop.clog.track("APP_TUTORIAL_VIEW");TS.ui.card_carousel.start({cards:t,onShow:s,onEnd:o});TS.prefs.getPref("seen_app_space_tutorial")||TS.prefs.setPrefByAPI({name:"seen_app_space_tutorial",value:true},function(){TS.prefs.setPrefLocal("seen_app_space_tutorial",true);$("[data-view_tutorial_link]").removeClass("display_none")})}});var e;var t=[];var i=function e(){t=[{image:cdn_url+"/436da/img/app_space_tutorial_illustration_01.jpg",animation:"",title:TS.interop.i18n.t("Common tasks, done in a jiffy","apps_browser")(),text:TS.interop.i18n.t("Approve requests, schedule meetings, share documents, and more \u2014 all inside Slack.","apps_browser")()},{image:cdn_url+"/436da/img/app_space_tutorial_illustration_02.jpg",animation:"",title:TS.interop.i18n.t("Connect the tools you already use","apps_browser")(),text:TS.interop.i18n.t("Slack works with the systems you use, for everything from accounting to customer support.","apps_browser")()},{image:cdn_url+"/436da/img/app_space_tutorial_illustration_03.jpg",animation:"",title:TS.interop.i18n.t("Discover new ways to work","apps_browser")(),text:TS.interop.i18n.t("Poll your workspace, send kudos, and automate the coffee run. Have a better workday with apps.","apps_browser")()}]};var n=null;var a=function e(){$("[data-view_tutorial_link]").click(function(){TS.ui.apps_browser.showAppTutorial()});$(window.document).on("keydown",l)};var r=function t(){TS.interop.unmountAppsBrowser(e);n=null;$(window.document).off("keydown",l)};var s=function e(){$(window.document).off("keydown",l)};var o=function e(){$(window.document).on("keydown",l)};var l=function e(t){t.which==TS.utility.keymap.esc&&TS.ui.fs_modal.close()}})()},3096:function(e,t){(function(){TS.registerModule("ui.messages_utils",{onStart:function e(){TS.client.ui.unread.started_sig.add(TS.ui.messages_utils.setup);TS.client.ui.unread.ended_sig.add(TS.ui.messages_utils.tearDown);TS.client.ui.threads.started_sig.add(TS.ui.messages_utils.setup);TS.client.ui.threads.ended_sig.add(TS.ui.messages_utils.tearDown)},setup:function e(){$("#messages_container").prepend('<div class="first_hidden_tab_stop" tabindex="0" style="position:absolute;"></div>').append('<div class="last_hidden_tab_stop" tabindex="0" style="position:absolute;"></div>').on("keydown",f).on("focus",".message,.unread_group_header,.bottom_mark_all_read",x).on("mousedown",".message,.unread_group_header,.bottom_mark_all_read",C).on("mousemove",E);$(document).on("keyup",I).on("keydown",M);TS.ui.messages_utils.debouncedIdentifyFirstAndLastTabStopInView=_.debounce(TS.ui.messages_utils.identifyFirstAndLastTabStopInView,50);$(".message_pane_scroller").on("scroll",TS.ui.messages_utils.debouncedIdentifyFirstAndLastTabStopInView);TS.view.resize_sig.add(TS.ui.messages_utils.debouncedIdentifyFirstAndLastTabStopInView)},tearDown:function e(){var t=$("#messages_container");t.find(".first_hidden_tab_stop,.last_hidden_tab_stop").remove();t.off("keydown",f).off("focus",".message,.unread_group_header,.bottom_mark_all_read",x).off("mousedown",".message,.unread_group_header,.bottom_mark_all_read",C).off("mousemove",E);$(".message_pane_scroller").off("scroll",TS.ui.messages_utils.debouncedIdentifyFirstAndLastTabStopInView);$(document).off("keyup",I).off("keydown",M);TS.view.resize_sig.remove(TS.ui.messages_utils.debouncedIdentifyFirstAndLastTabStopInView)},is_navigating_via_keyboard:false,getLastTabStopInView:function e(t){var i=n("reduceRight");return t.reduce(i,null)||$()},getFirstTabStopInView:function e(t){var i=n("reduce");var a=P()?t.concat($("#end_div")):t;return a.reduceRight(i,null)||$()},isAllContentInView:function e(){var t=TS.ui.messages_utils.scrollerForCurrentView();if(!t.length)return;return t.outerHeight()==t[0].scrollHeight},identifyFirstAndLastTabStopInView:function e(){if(!TS.ui.messages_utils.is_navigating_via_keyboard)return;d();var t=$("#messages_container").find(".first_hidden_tab_stop,.last_hidden_tab_stop");t.attr("tabindex","-1");if(TS.ui.messages_utils.isAllContentInView())return;var i=TS.ui.messages_utils.getMessagesInView();if(!i||i&&!i.length)return;i.forEach(function(e){e.hasClass("dirty_hover_container")&&TS.ui.messages.updateMessageHoverContainer(e)});var n=TS.ui.messages_utils.getFirstTabStopInView(i);var a=TS.ui.messages_utils.getLastTabStopInView(i);n.addClass("first_tab_stop_in_view");a.addClass("last_tab_stop_in_view");t.attr("tabindex","0")},nextChannelViewMessage:function e(t){var i=TS.ui.utility.nextWithClass(t,"message");return i.length?i:o(t,".day_container")},prevChannelViewMessage:function e(t){var i=TS.ui.utility.prevWithClass(t,"message");return i.length?i:s(t,".day_container")},nextUnreadViewItem:function e(t){if(t.is(".unread_group_header")&&t.closest(".unread_group.collapsed").length)return t.closest(".unread_group").next(".unread_group").find(".unread_group_header");if(t.is(".unread_group_header"))return t.closest(".unread_group").find(".day_container").first().find("ts-message:first-of-type");var i=t.is(".message")&&TS.ui.messages_utils.nextChannelViewMessage(t);if(i.length)return i;var n=t.closest(".unread_group").next(".unread_group");if(n.length)return n.find(".unread_group_header");return t.closest(".unread_group").find(".bottom_mark_all_read")},prevUnreadViewItem:function e(t){if(t.is(".bottom_mark_all_read"))return t.closest(".unread_group").find(".day_container").last().find("ts-message:last-of-type");var i=t.is(".message")&&TS.ui.messages_utils.prevChannelViewMessage(t);if(i.length)return i;if(t.is(".message"))return t.closest(".msgs_holder").prev(".unread_group_header");var n=t.closest(".unread_group").prev(".unread_group");if(n.hasClass("collapsed"))return n.find(".unread_group_header");return n.find(".day_container").last().find("ts-message:last-of-type")},nextThreadsViewMessage:function e(t){var i=TS.ui.utility.nextWithClass(t,"message");if(i.length)return i;var n=TS.ui.utility.nextWithClass(t,"thread_replies_container").find("ts-message:first-of-type");if(n.length)return n;var a=o(t,"ts-thread",".thread_messages > ts-message:first-of-type");if(a.length)return a;var r="ts-thread:first-of-type .thread_messages > ts-message:first-of-type";return o(t,".threads_section",r)},prevThreadsViewMessage:function e(t){var i=TS.ui.utility.prevWithClass(t,"message");if(i.length)return i;var n=TS.ui.utility.prevWithClass(t.closest(".thread_replies_container"),"message");if(n.length)return n;var a=s(t,"ts-thread",".thread_replies_container > ts-message:last-of-type");if(a.length)return a;var r="ts-thread:last-of-type .thread_replies_container > ts-message:last-of-type";return s(t,".threads_section",r)},getMessagesInView:function e(){var i=TS.ui.messages_utils.scrollerForCurrentView();if(!i.length)return[];if(i.outerHeight()==i[0].scrollHeight)return i.find(".message,.unread_group_header,.bottom_mark_all_read").toArray().reverse().map(function(e){return $(e)});var n=TS.ui.messages_utils.visibleMsgsScrollAreaRect();var a=n.left+n.width/2;var r=n.bottom-10;var s=n.left;var o=n.bottom/2;var l=t();var c=function e(t){var i=t[t.length-1];var n=i[0].getBoundingClientRect().top;if(n>=0&&n<=10)return t;if(n<0)return t;var a=l(i);if(!a.length)return t;return e(t.concat(a))};var d=TS.ui.utility.findNodeInRegion(".message,.unread_group_header,.bottom_mark_all_read",a,r,s,o);if(!d)return;return c([d])},scrollerForCurrentView:function e(){var t={unread_view_is_showing:"#unread_msgs_scroller_div",threads_view_is_showing:"#threads_msgs_scroller_div",archive_view_is_showing:"#archive_msgs_scroller_div",app_space_view_is_showing:"#app_space_scroller_div"};var i=Object.keys(t).reduce(function(e,i){return TS.model[i]?t[i]:e},"#msgs_scroller_div");var n=$(i);n.length||TS.warn("Could not find a scroller for the current view");return n},getFirstMessageInDom:function e(t){var i={unread_view_is_showing:"first",threads_view_is_showing:"first"};var n=Object.keys(i).reduce(function(e,t){return TS.model[t]?i[t]:e},"last");var a=t.find(".message,.unread_group_header,.bottom_mark_all_read");return a[n]()},getFirstMessageInView:function e(t){var i={unread_view_is_showing:".first_tab_stop_in_view",threads_view_is_showing:".first_tab_stop_in_view"};var n=Object.keys(i).reduce(function(e,t){return TS.model[t]?i[t]:e},".last_tab_stop_in_view");TS.ui.messages_utils.identifyFirstAndLastTabStopInView();return t.find(n).closest(".message,.unread_group_header,.bottom_mark_all_read")},establishInitialFocus:function e(t,i){B(i.find(".message--focus"));var n=TS.ui.messages_utils.isAllContentInView()?TS.ui.messages_utils.getFirstMessageInDom(i):TS.ui.messages_utils.getFirstMessageInView(i);l(n);if(TS.ui.messages_utils.isAllContentInView())return;var a=38==t.keyCode;c(a,n,i)},visibleMsgsScrollAreaRect:function e(){var t=document.getElementById("messages_container").getBoundingClientRect();var i=8;var n=t.top+i;return{top:n,left:t.left,bottom:t.bottom,right:t.right,width:t.width,height:t.bottom-n}}});var e=function e(t){var i="prev"==t?"prev":"next";var n={unread_view_is_showing:"UnreadViewItem",threads_view_is_showing:"ThreadsViewMessage"};return function(){var e=Object.keys(n).reduce(function(e,t){return TS.model[t]?n[t]:e},"ChannelViewMessage");return TS.ui.messages_utils[i+e]}};var t=e("prev");var i=e("next");var n=function e(t){return function(e,i){if(e)return e;var n=i.hasClass("message--focus");n||i.addClass("message--focus");var a=r(i,t);n||i.removeClass("message--focus");if(a)return $(a)}};var a=function e(){var t=TS.ui.messages_utils.visibleMsgsScrollAreaRect();var i=t.top;var n=t.bottom;return function(e){var t=e.getBoundingClientRect().top;return t>=i&&t<=n}};var r=function e(t,i){var n=a();var r="reduceRight"==i?"lastFocusableChild":"firstFocusableChild";return TS.interop.utility[r](t[0],n)};var s=function e(t,i,n){var a=n||"ts-message:last-of-type";return t.closest(i).prev(i).find(a)};var o=function e(t,i,n){var a=n||"ts-message:first-of-type";return t.closest(i).next(i).find(a)};var l=function e(t){if(!t.length)return;t.is(".message")&&TS.ui.messages.updateMessageHoverContainer(t);t.attr("tabindex",-1).focus()};var c=function e(t,i,n){if(!i.length)return;var a=TS.ui.messages_utils.visibleMsgsScrollAreaRect();var r=i[0].getBoundingClientRect();var s=r.top;var o=r.height;var l=i.find(".action_hover_container");var c=function(){if(!l.length)return 0;var e=l[0].getBoundingClientRect().top;var t=parseInt(l.css("right"),10);return e-t}();var d=a.top+(s-c);var u=n.scrollTop();if(t&&s>=d)return;(t||o>=a.height)&&n.scrollTop(u-(d-s))};var d=function e(){var t=TS.ui.messages_utils.scrollerForCurrentView();if(!t.length)return;t.find(".first_tab_stop_in_view").removeClass("first_tab_stop_in_view");t.find(".last_tab_stop_in_view").removeClass("last_tab_stop_in_view")};var u=function e(){var t=TS.ui.messages_utils.scrollerForCurrentView();if(!t.length)return;B(t.find(".message--focus"));TS.ui.messages_utils.identifyFirstAndLastTabStopInView();t.find(".first_tab_stop_in_view").focus().addClass("focus-ring")};var m=function e(){var t=TS.ui.messages_utils.scrollerForCurrentView();if(!t.length)return;B(t.find(".message--focus"));TS.ui.messages_utils.identifyFirstAndLastTabStopInView();t.find(".last_tab_stop_in_view").focus().addClass("focus-ring")};var f=function e(t){var i=t.keyCode;var n=$(t.target);if(i==TS.utility.keymap.esc&&n.hasClass("message--focus")){n.blur();return}if(i==TS.utility.keymap.tab&&TS.client.ui.isUserAttentionOnChat()){w(t);return}!n.is("#messages_container")&&h(t)&&b(t)};var h=function e(t){var i=t.keyCode;var n=TS.utility.keymap;var a=i==n.up||i==n.down;var r=t.metaKey||t.ctrlKey||t.altKey||t.shiftKey;return a&&!TS.utility.isFocusOnInput()&&!r&&TS.client.ui.isUserAttentionOnChat()};var p=0;var g=0;var T=0;var S=function e(t){if(!t)return false;var i=a();var n=TS.ui.messages_utils.visibleMsgsScrollAreaRect();var r=t.getBoundingClientRect();var s=r.bottom;return i(t)||s>n.top&&s<=n.bottom||r.height>=n.height};var v=function e(n,a,r){var s=n.keyCode;var o={38:t,40:i}[s]();var d=o(a);if(!d.length)return;n.preventDefault();l(d);var u=38==s;c(u,d,r);p=Date.now()};var b=function e(t,i){var n=TS.ui.messages_utils.scrollerForCurrentView();if(!n.length)return;TS.ui.messages_utils.is_navigating_via_keyboard=true;var a=n.find(".message--focus");var r=i||!i&&!S(a[0]);if(r){TS.ui.messages_utils.establishInitialFocus(t,n);return}v(t,a,n);var s=TS.prefs.getPref("seen_keyboard_shortcuts_coachmark");TS.interop.clog.track("KBSHORTCUTS_MESSAGE_NAV",{seen_coach_mark:s})};var w=function e(t){g=Date.now();var i=t.target;var n=$(i);if(n.is(".message .ql-editor"))return;var r=n.closest(".message");r.hasClass("dirty_hover_container")&&TS.ui.messages.updateMessageHoverContainer(r);var s=t.shiftKey;var o=a();var l=function e(t){var i=TS.ui.messages_utils.visibleMsgsScrollAreaRect();var n=t.getBoundingClientRect();var a=n.bottom;return o(t)||a>i.top&&a<=i.bottom};TS.ui.messages_utils.is_navigating_via_keyboard=true;if(!s&&n.is(".last_tab_stop_in_view")){t.preventDefault();if($("#client-ui").hasClass("flex_pane_showing")){y();return}if(window.desktop){TS.utility.contenteditable.focus(TS.client.msg_input.$input);return}$("#messages_container .last_hidden_tab_stop").focus();return}if(s&&n.is(".first_tab_stop_in_view")){t.preventDefault();A("#client_header .flex_header");return}if(!l(i)){t.preventDefault();u()}};var y=function e(){var t=$("#col_flex .panel.active")[0];var i=TS.interop.utility.firstFocusableChild(t);$(i).addClass("focus-ring").focus()};var A=function e(t){var i=$(t)[0];var n=TS.interop.utility.lastFocusableChild(i);$(n).addClass("focus-ring").focus()};var k=false;var C=function e(){k=true};var x=function e(t){if(k){k=false;return}var i=t.target;var n=$(i);var a=$(".message--focus");var r=a.get(0);if(r&&r.contains(i)||n.is(".message--focus"))return;B(a);n.closest(".message,.unread_group_header,.bottom_mark_all_read").addClass("message--focus").append('<div class="messagefocusindicator"></div>')};var I=function e(t){if(t.target==document)return;var i=t.target;var n=$(i);if(9!=t.keyCode)return;var a=TS.ui.messages_utils.scrollerForCurrentView();if(!a.length)return;var r=!t.shiftKey&&n.is("#messages_container .first_hidden_tab_stop");var s=t.shiftKey&&n.is("#messages_container .last_hidden_tab_stop");TS.ui.messages_utils.is_navigating_via_keyboard=a[0].contains(i)||r||s;if(r){TS.ui.messages_utils.identifyFirstAndLastTabStopInView();if(a.find(".first_tab_stop_in_view").length){u();return}if($("#client-ui").hasClass("flex_pane_showing")){y();return}if(window.desktop){TS.utility.contenteditable.focus(TS.client.msg_input.$input);return}$("#messages_container .last_hidden_tab_stop").focus();return}if(s){TS.ui.messages_utils.identifyFirstAndLastTabStopInView();if(a.find(".last_tab_stop_in_view").length){m();return}A("#client_header .flex_header");return}var o=a.find(".message--focus");var l=o.get(0);l&&!l.contains(i)&&B(o)};var M=function e(t){if(t.target==document)return;var i=t.keyCode;var n=t.target;var a=$(n);var r=$("#messages_container");var s=a.is(r);var o=TS.utility.keymap;var l=i==o.tab;(TS.utility.isPageKey(t)||i==o.space)&&(T=Date.now());if(l&&!t.shiftKey&&a.is("#col_flex")){y();t.preventDefault();return}if(!h(t))return;var c=!s&&r[0].contains(n);var d=$("#col_flex")[0].contains(n);var u=$(".client_channels_list_container")[0].contains(n);if(c||d||u)return;t.preventDefault();s&&r.blur();b(t,true)};var E=function e(){if(!TS.ui.messages_utils.is_navigating_via_keyboard)return;if(U())return;$("#messages_container").attr("tabindex",-1).focus();var t=TS.ui.messages_utils.scrollerForCurrentView();var i=t.find(".message--focus");i.removeAttr("tabindex");B(i);TS.ui.messages_utils.is_navigating_via_keyboard=false};var B=function e(t){t.removeClass("message--focus");t.find(".messagefocusindicator").remove()};var P=function e(){var t=document.getElementById("end_div");if(!t)return false;var i=TS.ui.messages_utils.visibleMsgsScrollAreaRect();var n=t.getBoundingClientRect();var a=n.bottom;return a>i.top&&a<=i.bottom};var U=function e(){var t=Date.now();var i=[p,g,T];return i.reduce(function(e,i){if(true===e)return true;return t-i<=1e3})}})()},3097:function(e,t){(function(){TS.registerModule("ui.macro_keyboard_nav",{onStart:function e(){$(document).on("keydown",r).on("blur",".focusablesection",a).on("mousemove",".focusablesection",TS.ui.macro_keyboard_nav.blurSection)},blurSection:function e(t){$(t.currentTarget).blur()},focusSection:function e(t){if(t===i)TS.interop.a11y.focusableSectionManager.get(TS.boot_data.team_id,1).focus();else if(t===n)TS.interop.a11y.focusableSectionManager.get(TS.boot_data.team_id,2).focus();else if($(t).attr("data-is-focusable-section"))$(t).attr("tabindex",-1).focus();else{$(t).append('<div class="sectionfocusindicator"></div>');$(t).addClass("focusablesection").attr("tabindex",-1).focus()}document.body.scrollTop=0;var a=TS.prefs.getPref("seen_keyboard_shortcuts_coachmark");TS.interop.clog.track("KBSHORTCUTS_SECTION_NAV",{seen_coach_mark:a})},moveNext:function e(t){var i=t.which===TS.interop.i18n.keyCodeEquivalent(192,{kb:TS.i18n.keyboard(),featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR})&&!t.shiftKey||"ja"===TS.i18n.keyboard()&&219===t.which;var n=t.which===TS.interop.i18n.keyCodeEquivalent(192,{kb:TS.i18n.keyboard(),featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR})&&t.shiftKey;var a=t.which===TS.utility.keymap.f6;if((t.altKey||t.metaKey)&&!a)return;if(!i&&!n&&!a)return;if(!TS.client.ui.isUserAttentionOnChat())return;if(i&&!t.ctrlKey)return;if(n&&!t.ctrlKey)return;if(!TS.model.is_our_app&&TS.model.is_mac&&a&&!t.metaKey)return;if(!TS.model.is_our_app&&!TS.model.is_mac&&a&&!t.ctrlKey)return;if(TS.model.is_our_app&&a&&(t.altKey||t.metaKey||t.ctrlKey))return;var r=$(t.target);var s=c();var d=r.is(s.join(","));t.preventDefault();if(!d){TS.ui.macro_keyboard_nav.focusSection(s[0]);return}var u=n?"prev":"next";a&&(u=t.shiftKey?"prev":"next");var _=function e(t,i,n){return r.is(i)?n+1:t};var m=function e(t,i,n){return r.is(i)?n-1:t};var f="next"==u?_:m;var h=s.reduce(f,0);var p="next"==u?o(h):l(h);TS.ui.macro_keyboard_nav.focusSection(p)}});var e=".p-message_pane";var t=".p-threads_flexpane";var i=".p-message_pane .c-virtual_list__item--focus";var n=".p-threads_flexpane .c-virtual_list__item--focus";var a=function e(t){var a=$(t.target);if(a.is(i))return;if(a.is(n))return;if(a.attr("data-is-focusable-section")||!a.hasClass("focusablesection"))return;a.removeClass("focusablesection").removeAttr("tabindex").find("> .sectionfocusindicator").remove()};var r=function e(t){var a=t.target;var r=$(a);var o=t.keyCode;var l=o==TS.utility.keymap.esc;var c=r.is(i);var d=r.is(n);var u=r.hasClass("focusablesection")||c||d;if(l&&u){c?TS.interop.a11y.focusableSectionManager.get(TS.boot_data.team_id,1).blur():d?TS.interop.a11y.focusableSectionManager.get(TS.boot_data.team_id,2).blur():r.blur();return}var _=TS.utility.isPageKey(o)||TS.utility.isArrowKey(o)||o==TS.utility.keymap.space;var m=t.ctrlKey||t.altKey||t.metaKey;if(_&&!m){s(a);return}TS.ui.macro_keyboard_nav.moveNext(t)};var s=function e(t){var i=$(t);var n=$("#col_flex")[0].contains(t);var a=$(".client_channels_list_container")[0].contains(t);var r=TS.utility.contenteditable.isActiveElement(t);if(!((n||a)&&!r))return;if(i.is("#col_flex")){$("#col_flex .panel.active .flex_content_scroller").attr("tabindex",-1).focus();return}var s=".c-scrollbar__hider";i.attr("data-is-focusable-section")&&i.find(s).attr("tabindex",-1).focus()};var o=function a(r){var s=c().map(function(a){if(a===i)return e;if(a===n)return t;return a});var o=s[r];if(!o)return a(0);var l=$(o)[0];if(TS.interop.utility.isVisible(l)){if(o===e)return i;if(o===t)return n;return o}return a(r+1)};var l=function a(r){var s=c().map(function(a){if(a===i)return e;if(a===n)return t;return a});var o=s[r];if(!o)return a(s.length-1);var l=$(o)[0];if(TS.interop.utility.isVisible(l)){if(o===e)return i;if(o===t)return n;return o}return a(r-1)};var c=function e(){var t=TS.client.activeChannelIsHidden();var a=t?"#messages_container":i;var r=TS.boot_data.feature_react_threads&&"convo"===TS.model.ui_state.flex_name;var s=r?n:"#col_flex";return[a,".p-message_pane__unread_banner","#msg_form","#connection_div",s,"#team_menu",".p-channel_sidebar","#banner","#client_header","#header_search_form"]}})()},3098:function(e,t){(function(){TS.registerModule("client.quick_promo",{onStart:function e(){4===TS.client.quick_promo&&TS.onboarding.no_longer_in_onboarding_sig.addOnce(a)},test:function e(){var t={_showModal:s};Object.defineProperty(t,"_showModal",{get:function e(){return s},set:function e(t){s=t}});return t}})})();var i;var n;var a=function e(){TS.interop.api.call("promo.show",{team_id:TS.model.team.id,user_id:TS.model.user.id,previous_login:TS.boot_data.last_login_timestamp}).then(function(e){if(!e.data||!e.data.ok||!e.data.show_modal)return;i=e.data.invite_count||0;r();var t=new Image;t.onload=s;t.src=cdn_url+"/436da/img/quick_promo/ill_team@2x.png"})};var r=function e(){n=i>0?"contextual":"contextual_no_invites"};var s=function e(){TS.generic_dialog.start({type:"quick_promo",body:TS.templates.quick_promo_invite_nudge({copy_is_contextual_with_invites:"contextual"===n,invite_count:i}),dialog_class:"quick_promo",force_small:true,show_close_button:true,show_cancel_button:true,cancel_button_text:TS.interop.i18n.t("Remind Me Later","quick_promo")(),fullscreen:false,show_go_button:true,onGo:o,go_button_text:TS.interop.i18n.t("Invite People","quick_promo")(),onCancel:l});c()};var o=function e(){TS.prefs.setPrefByAPI({name:"promo_dismissed",value:true});m("invite_people_button")};var l=function e(){TS.prefs.setPrefByAPI({name:"promo_snoozed",value:Date.now()/1e3});m("remind_me_later_button")};var c=function e(){d();u();_()};var d=function e(){var t=$(".c-modal_footer__go--quick_promo");t.attr("data-action","admin_invites_modal")};var u=function e(){var t=$(".c-modal_close--quick_promo");t.one("click",function(){TS.prefs.setPrefByAPI({name:"promo_dismissed",value:true});m("exit_button")})};var _=function e(){var t=$(".modal-backdrop");t.on("click",function(){m("outside_click")})};var m=function e(t){TS.interop.clog.track("INAPP_INVITES",{contexts:{ui_context:{step:"invite_nudge",action:"click",ui_element:t},growth:{trigger:n}}})}},3099:function(e,t){(function(){TS.registerModule("ui.card_carousel",{onStart:function e(){},start:function a(s){if(!s.cards){TS.warn("Card carousel requires cards to show.");return}e=s;t=s.cards;i=0;n=t.length;r();e.onShow&&e.onShow()}});var e;var t;var i;var n;var a=function e(i){var n=new Image;n.onload=function(){if(0===i){c(i);var e=setTimeout(function(){if(!TS.generic_dialog.is_showing)return;$(window.document).bind("keydown",s);clearTimeout(e)},100)}n.onload=null;n.src=null;n=null};n.src=t[i].image};var r=function e(){for(var t=0;t<n;t++)a(t)};var s=function e(t){t.which==TS.utility.keymap.enter||t.which==TS.utility.keymap.right?l():t.which==TS.utility.keymap.esc?u():t.which==TS.utility.keymap.left&&0!==i&&o()};var o=function e(){TS.generic_dialog.end();i-=1;if(i<0||i>=n){u();return}c(i)};var l=function e(){TS.generic_dialog.end();i+=1;if(i<0||i>=n){u();return}c(i)};var c=function e(a){var r=false;var s=false;0===a&&(r=true);i+1===n&&(s=true);var c={display_card_index:i+1,number_of_cards:n,first_card:r,last_card:s};var _={card:t[i],allow_animations:TS.prefs.getPref("a11y_animations")};TS.generic_dialog.start({body:TS.templates.card_carousel(_),body_cls:"c-card_carousel__body",show_go_button:false,show_cancel_button:false,dialog_class:"c-card_carousel",backdrop_click_to_dismiss:true,onCancel:d});var m=$(".c-card_carousel");m.append(TS.templates.card_carousel_buttons(c));m.find(".c-card_carousel__body").click(l);m.find("[data-card_left_button]").click(o);m.find("[data-card_right_button]").click(l);m.find("[data-card_close_button]").click(u)};var d=function t(){$(window.document).unbind("keydown",s);e.onEnd&&e.onEnd()};var u=function e(){d();TS.generic_dialog.cancel()}})()},3100:function(e,t){(function(){TS.registerModule("client.ui.highlights",{openNegativeFeedbackMenu:function i(n,a,r,s){var o=TS.client.highlights.getHighlight(a,r);if(!o)return;var l=$("<ul></ul>");var c=o.feedbackOptions||o.feedback_options;_.each(c.negative,function(e){l.append('<li role="menuitem" data-js="highlights_feedback_item"><a href="#">'+TS.format.formatWithOptions(e.text,"",{no_linking:true})+"</a></li>")});TS.menu.startWithList(n,l,{close_on_click:true,menu_class:"sli_briefing__menu",position_by_click:true,onClick:function e(t){t.preventDefault();var i=$(t.target).parents("li[data-js=highlights_feedback_item]").index();TS.client.highlights.setNegativeFeedbackForHighlight(a,r,i,s)}});TS.menu.positionAt($(n.target),e,t)}});var e=0;var t=18})()},3101:function(e,t){(function(){TS.registerModule("highlights_briefing",{sli_recaps_debug_group:null,updated_sig:new signals.Signal,$briefing_header:null,$briefing_view:null,last_request_id:null,last_cached_request_id:void 0,onStart:function e(){if(!TS.client)return;TS.client.ui.unread.started_sig.add(l);TS.client.unread.switched_away_sig.add(S);TS.channels.switched_sig.add(C);TS.groups.switched_sig.add(C);TS.mpims.switched_sig.add(C);TS.ims.switched_sig.add(C);TS.client.threads.switched_sig.add(x);TS.channels.marked_sig.add(Q);TS.groups.marked_sig.add(Q);TS.channels.message_changed_sig.add(K);TS.groups.message_changed_sig.add(K);TS.channels.message_removed_sig.add(W);TS.groups.message_removed_sig.add(W);TS.pins.pinned_status_changed_sig.add(j);TS.client.highlights.feedback_submitted_sig.add(B);TS.highlights_briefing.sli_recaps_debug_group=TS.interop.experiments.getGroupForUser("sli_recaps_debug")},showBriefing:function t(){if(!TS.model.team.plan||!e||!n)return;e.removeClass("hidden");n.toggleClass("hidden",!r.expanded)},hideBriefing:function t(){if(!TS.model.team.plan||!e||!n)return;e.addClass("hidden");n.addClass("hidden")},clogBackButton:function e(){var t=_.get(r,["last_jump","model_ob_id"]);var i=_.get(r,["last_jump","ts"]);var n={channel_id:t,channel_type:t[0]||"",message_timestamp:i};var a;var s=TS.client.highlights.getHighlight(t,i);if(s){n.request_id=s.request_id;a=s.cached_request_id}a&&(n.cached_request_id=a);TS.interop.clog.track("BRIEFING_BACK_TO_BRIEFING",n)},jumpToMessageInChannel:function e(t,i){O(t,i)},setUnreadPointOnMessage:function e(t){if(!TS.model.team.plan)return;t=String(t);var i=$('.sli_briefing__message ts-message[data-ts="'+t+'"]');if(i.length){var n=i.data("model-ob-id");TS.shared.legacyMarkReadMsg(n,t,TS.model.marked_reasons.back);TS.client.markLastReadsWithAPI();Q(TS.redux.channels.getEntityById(n))}},getMessageFromCache:function e(t,i){return _.get(a,[t,i],null)},promiseToGetBriefing:function e(){if(""===TS.model.team.plan)return Promise.resolve(null);return TS.interop.api.call("highlights.briefing").then(function(e){var t={};_.each(e.data.messages,function(i){t[i.channel_id]||(t[i.channel_id]={});t[i.channel_id][i.ts]={sliHighlight:{loading:false,isHighlight:i.score&&i.score.show_recap,feedbackOptions:i.feedback_options,justification:i.justification,request_id:e.request_id}}});TS.redux.dispatch(TS.interop.redux.models.messagesMeta.setHighlightsForMessages(t));return e}).catch(function(){return Promise.resolve(null)})},showBriefingWithResponse:function e(t){c(t)},handleFeedback:function e(t){B(t)}});var e=null;var t=null;var i=null;var n=null;var a={};var r={expanded:false,scroll_top:0,last_jump:{ts:null,model_ob_id:null},show_briefing_back_button:false,last_open_ts:null,loading:true};var s={};var o=3;var l=function e(){if(!TS.model.team.plan)return;(r.show_briefing_back_button||_.get(r,["last_jump","model_ob_id"]))&&M();r.briefing_opens_count=TS.storage.fetchBriefingOpensCount();r.loading=true;u()};var c=function e(t){Promise.resolve(t).then(d).then(m).catch(function(e){TS.error("A call to highlights.briefing failed:");TS.logError(e,"Highlights in All Unreads either failed to render or got an error from the API");p(null,0,false,true)});E()};var d=function e(t){_.get(t,"data.messages.length")&&(t.data.messages=_.map(t.data.messages,function(e){var t=e.channel_id;var i=TS.interop.messages.preprocessImsg(e,t);i.channel_id=t;i.cached_request_id=e.cached_request_id;return i}));return t};var u=function e(){$("#unread_msgs_div").before(TS.templates.sli_briefing({show_onboarding:r.briefing_opens_count<o}));$("#unread_msgs_scroller_div").prepend(TS.templates.sli_briefing_header())};var m=function i(n){var o=_.get(n,"data.messages[0].cached_request_id");var l=!_.isUndefined(o)&&(o===TS.highlights_briefing.last_request_id||o===TS.highlights_briefing.last_cached_request_id);TS.highlights_briefing.last_cached_request_id=o;TS.highlights_briefing.last_request_id=n.request_id;r.loading=false;(null!==r.last_open_ts&&r.last_open_ts<Date.now()-6e5||!l)&&(r.expanded=false);if(_.get(n,"data.messages.length")){var c=_.groupBy(n.data.messages,"channel_id");var d=_(c).map(function(e,t){var i=TS.interop.channels.getPublicChannelById(t);if(!i){i=TS.interop.channels.getGroupById(t);if(!i)return null}var n="";i.is_mpim?n="mpim":i.is_im?n="im":i.is_group?n="group":i.is_channel&&(n="channel");var a=TS.templates.builders.buildStarWithTip(n,i);var r={channel:i,star:new Handlebars.SafeString(a),messages:_(e).map(h).compact().value()};if(!r.messages.length)return null;return r}).compact().value();if(d.length){T(n.data.messages);t.find(".sli_briefing_view__messages").html(TS.templates.sli_briefing_message_view({groups:d}))}}else a={};if(n.data.headline){s={header:TS.format.formatWithOptions(n.data.headline.header||"","",{no_linking:true}),subheader:TS.format.formatWithOptions(n.data.headline.subheader||"","",{no_linking:true})};g(n.data.headline.users)}else s={header:"",subheader:""};var u=v();if(u)if(r.expanded&&u)U(false);else{var m=A();p(m,v())}else e.hide();var f=_.get(r,["last_jump","model_ob_id"]);var S=_.get(r,["last_jump","ts"]);if(_.get(a,[f,S])){r.scroll_top=0;r.last_jump.ts=null;r.last_jump.model_ob_id=null}if(u){r.briefing_opens_count+=1;TS.storage.storeBriefingOpensCount(r.briefing_opens_count)}TS.highlights_briefing.updated_sig.dispatch()};var f=function e(t){var i=TS.redux.channels.getEntityById(t.channel_id);var n=$(TS.templates.builders.msgs.buildHTML({msg:t,model_ob:i,enable_slack_action_links:true,container_id:"sli_briefing",prev_msg:null,briefing:true}));(t.pinned_to&&t.pinned_to.length||_.get(t,"file.pinned_to.length"))&&n.removeClass("is_pinned");n.addClass("is_sli_briefing");return n[0].outerHTML};var h=function e(t){var i=TS.client.highlights.getHighlight(t.channel_id,t.ts);if(i.feedback&&"positive"!==i.feedback)return null;var n=k(i.feedback);var a=i.feedbackOptions;var r=_.map(a.negative,function(e){return _.assign({},e,{text:new Handlebars.SafeString(TS.format.formatWithOptions(e.text,null,{no_linking:true}))})});var s=i.justification;s=TS.format.formatWithOptions(s||"",void 0,{no_linking:true});return{message_markup:f(t),message:t,justification:s,feedback_class:n,negative_feedback_options:r}};var p=function e(t,n,a,s){if(t&&n){i.removeClass("sli_briefing_preview--loading").addClass("sli_briefing_preview--has_briefings");i.find('[data-js="sli_briefing_preview_title"]').html(t.header);r.briefing_opens_count>=o&&i.find('[data-js="sli_briefing_preview_description"]').html(t.subheader);i.find('[data-js="sli_briefing_preview_action"]').removeClass("hidden");r.briefing_opens_count>=o&&i.find('[data-js="sli_briefing_preview_facepile"]').removeClass("hidden")}else if(a){i.removeClass("sli_briefing_preview--loading sli_briefing_preview--has_briefings").addClass("sli_briefing_preview--empty");i.find('[data-js="sli_briefing_preview_title"]').text(TS.interop.i18n.t("Done and done","highlights")());i.find('[data-js="sli_briefing_preview_description"]').text(TS.interop.i18n.t("That\u2019s it for the highlights! The rest of your unreads are below.","highlights")());i.find('[data-js="sli_briefing_preview_action"]').addClass("hidden");i.find('[data-js="sli_briefing_preview_facepile"]').addClass("hidden")}else if(s){i.removeClass("sli_briefing_preview--loading sli_briefing_preview--has_briefings").addClass("sli_briefing_preview--empty");i.find('[data-js="sli_briefing_preview_title"]').removeClass("small_bottom_margin").addClass("error no_bottom_margin").text(TS.interop.i18n.t("Couldn\u2019t load highlights","highlights")());i.find('[data-js="sli_briefing_preview_description"]').addClass("hidden");i.find('[data-js="sli_briefing_preview_action"]').addClass("hidden")}else{i.removeClass("sli_briefing_preview--loading sli_briefing_preview--has_briefings").addClass("sli_briefing_preview--empty");i.find('[data-js="sli_briefing_preview_title"]').text(TS.interop.i18n.t("No new highlights","highlights")());i.find('[data-js="sli_briefing_preview_description"]').text(TS.interop.i18n.t("But we\u2019ll keep an ear to the ground.","highlights")());i.find('[data-js="sli_briefing_preview_action"]').addClass("hidden")}TS.highlights_briefing.updated_sig.dispatch()};var g=function e(t){var n=_.map(t,function(e){var t=TS.interop.members.getMemberById(e);return TS.templates.builders.makeMemberPreviewLinkImage(t,32,false,false,false,false)}).join("");i.find('[data-js="sli_briefing_preview_facepile"]').html(n)};var T=function e(t){a={};_.forEach(t,function(e){a[e.channel_id]=a[e.channel_id]||{};a[e.channel_id][e.ts]=e})};var S=function a(){if(!TS.model.team.plan)return;F();e=null;t=null;i=null;n=null;TS.highlights_briefing.$briefing_header=null;TS.highlights_briefing.$briefing_view=null;TS.highlights_briefing.last_request_id=null;s=null;r.last_open_ts=Date.now()};var v=function e(){return _.reduce(a,function(e,t,i){return e+b(i)},0)};var b=function e(t){return _.reduce(a[t],function(e,t){if(!y(t))return e;return e+1},0)};var w=function e(){return _(a).flatMap(function(e){return _.map(e,function(e){if(!y(e))return null;return e})}).compact().value()};var y=function e(t){var i=TS.client.highlights.getHighlight(t.channel_id,t.ts)||{};return!(t._removed||"dismiss"===i.feedback||i.left_feedback)};var A=function e(){return s};var k=function e(t){if("negative"===t)return"gave_negative_feedback";if("positive"===t)return"gave_positive_feedback";if("dismiss"===t)return"sli_briefing__feedback--dismiss";return""};var C=function e(){TS.model.active_cid===_.get(r,["last_jump","model_ob_id"])&&r.show_briefing_back_button?I():r.last_jump&&r.show_briefing_back_button&&M()};var x=function e(){if(!TS.model.team.plan)return;r.last_jump&&r.show_briefing_back_button&&M()};var I=function e(){TS.redux.dispatch(TS.interop.redux.features.messagePane.setHighlightsBackButtonVisible(true))};var M=function e(){r.show_briefing_back_button=false};var E=function s(){e=$("#sli_briefing");t=$("[data-js=sli_briefing_view]");i=$('[data-js="sli_briefing_preview_container"]');n=$('[data-js="sli_briefing_header"]');TS.highlights_briefing.$briefing_header=n;TS.highlights_briefing.$briefing_view=t;e.on("click",".sli_briefing__message ts-message, .sli_briefing_target",function(e){if(!$(e.target).is("ts-message, .message_content, .message_body, .message_content_header_left, .sli_briefing_target, .comment, .rxn_panel")&&!$(e.target).parents(".message_body").length||$(e.target).parents(".msg_inline_file_preview_toggler").length||$(e.target).is("a")&&$(e.target).closest(".message_body").length||$(e.target).closest(".attachment_media").length)return;var t=$(this).is("ts-message")?$(this):$(this).parents("ts-message");var i=""+t.data("ts");var n=""+t.data("model-ob-id");O(n,i)});e.on("click",".sli_briefing__channel_link .channel_link",function(e){var t=$(e.target).closest("[data-channel-id]").data("channel-id");"G"===t[0]&&TS.groups.legacyDisplayGroup({id:t})});e.on("click",'[data-js="sli_briefing_preview"]',function(){if(r.loading)return;r.expanded=true;U(true);var e={request_id:TS.highlights_briefing.last_request_id};var t=_.keys(a)[0];var i=_.keys(_.get(a,[t]))[0];var n=TS.client.highlights.getHighlight(t,i);var s=n.cached_request_id;s&&(e.cached_request_id=s);TS.interop.clog.track("BRIEFING_REVEAL",e);TS.highlights_briefing.updated_sig.dispatch()});n.off("click").on("click",'[data-js="sli_briefing_header_dismiss_all"]',function(){r.expanded=false;D();var e=w();var t=_.map(e,function(e){return{channel_id:e.channel_id,ts:e.ts}});TS.interop.api.call("highlights.dismissAll",{request_id:TS.highlights_briefing.last_request_id,source:"briefing",messages:JSON.stringify(t)}).catch(function(e){TS.error(e)})});e.on("click",'[data-js="sli_briefing_feedback_item"] a',function(e){e.preventDefault();var t=($(e.target).closest(".sli_briefing__feedback_leavebehind").data("feedback-for-cache-id")||"").split("-");var i=Number($(e.target).closest("li").data("index"));var n=t[0];var a=t[1];TS.client.highlights.setNegativeFeedbackForHighlight(n,a,i,"briefing")});e.on("click","[data-feedback]",function(e){e.preventDefault();var t=$(e.target).data("feedback");var i=$(e.target).closest(".sli_briefing__message");var n=(i.data("cache-id")||"").split("-");var a=n[0];var r=n[1];TS.client.highlights.setDefaultFeedbackForHighlight(a,r,{feedback:t},"briefing");$("#ts_tip_float_floater .ts_tip_tip").text(TS.interop.i18n.t("Thank you!","highlights")())})};var B=function e(t){if(!TS.model.unread_view_is_showing)return;if(a[t.channelId]&&a[t.channelId][t.ts]){var i=$('[data-cache-id="'+t.channelId+"-"+t.ts+'"]');i.length&&P(i,t.channelId,t.ts,t)}};var P=function e(t,i,n,a){var r=a.is_leaving_feedback||a.isLeavingFeedback;var s=a.left_feedback||a.leftFeedback;if("dismiss"===a.feedback||!r&&s)R(t,i,function(){G()&&H()});else if("negative"!==a.feedback&&"default_negative"!==a.feedback||!r){if("positive"===a.feedback||"default_positive"===a.feedback){t.addClass("gave_positive_feedback");t.find('[data-feedback="positive"]').addClass("sli_briefing__feedback_control--pulse")}}else{t.find("ts-message").addClass("hidden");t.addClass("gave_negative_feedback");t.find('[data-feedback="negative"]').addClass("sli_briefing__feedback_control--pulse");$('[data-feedback-for-cache-id="'+i+"-"+n+'"]').removeClass("hidden")}};var U=function i(a){var r=e.outerHeight();var s=$('[data-js="sli_briefing_preview_container"]');var o=61;t.removeClass("hidden");n.removeClass("hidden");TS.client.ui.checkInlineImgsAndIframes("unread");if(a){s.css({height:0,"margin-top":(TS.environment.supports_sticky_position?-o:0)+"px"});var l=e.outerHeight();e.css({height:r,"padding-top":o+20+"px","margin-top":-o+"px"});e.animate({height:l+o},300,function(){e.css({height:"auto","margin-top":"","padding-top":TS.environment.supports_sticky_position?o+20+"px":""});t.find(".sli_briefing__channel, .sli_briefing_view__footer").each(function(e,t){setTimeout(function(){$(t).css("opacity",1)},100*e+200)});if(!TS.prefs.getPref("seen_highlights_warm_welcome")){setTimeout(function(){TS.coachmark.start(TS.coachmarks.coachmarks.highlights_feedback,true)},800);TS.prefs.setPrefLocal("seen_highlights_warm_welcome",true);TS.prefs.setPrefByAPI({name:"seen_highlights_warm_welcome",value:true});TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{seen_highlights_warm_welcome:"true"}})}TS.highlights_briefing.updated_sig.dispatch()})}else{s.css({transition:"none",height:0,"margin-top":(TS.environment.supports_sticky_position?-o:0)+"px"});n.css("transition","none");t.find(".sli_briefing__channel, .sli_briefing_view__footer").css("opacity",1);e.css({height:"auto","margin-top":"","padding-top":TS.environment.supports_sticky_position?o+20+"px":""})}s.addClass("go-away");n.addClass("expand");a||setTimeout(function(){n.css("transition","");s.css("transition","")},0)};var D=function i(){var a=$('[data-js="sli_briefing_preview_container"]');n.removeClass("expand").addClass("go-away");var r=e.outerHeight();t.css({opacity:0,"pointer-events":"none"});p(null,0,true);var s=166;e.css({height:r,"margin-top":TS.environment.supports_sticky_position?"-61px":""});e.animate({height:s},300,function(){TS.highlights_briefing.updated_sig.dispatch()});a.css({transition:"none",transform:"translateY(118px)"});setTimeout(function(){a.css({transition:"",transform:"translateY(0)",opacity:1,"pointer-events":""})},0)};var F=function t(){e&&e.off("click");n&&n.off("click")};var O=function e(t,i){var n;var a;var s=TS.client.highlights.getHighlight(t,i);n=s.request_id;a=s.cached_request_id;r.scroll_top=TS.client.ui.unread.$scroller.scrollTop();r.last_jump={ts:i,model_ob_id:t};r.show_briefing_back_button=true;TS.client.ui.tryToJump(t,i);var o={channel_id:t,channel_type:t[0]||"",message_timestamp:i,request_id:n};a&&(o.cached_request_id=a);TS.interop.clog.track("BRIEFING_JUMP_TO_CHANNEL",o)};var R=function e(t,i,n){var a=0===b(i);if(a)N(t.closest(".sli_briefing__channel"),n);else{t.addClass(k("dismiss"));setTimeout(function(){t.css({transition:"margin-bottom 0.3s","margin-bottom":0});t.animate({height:0},300,function(){var e=t.parents('.sli_briefing__channel[data-channel-id="'+i+'"]');t.remove();if(L(i)){e.css({transition:"opacity 0.2s",opacity:.5});e.find(".sli_briefing__channel_link .star").css("pointer-events","none")}n&&n()})},300)}};var N=function e(t,i){t.addClass("dismiss");setTimeout(function(){t.css({transition:"margin-bottom 0.3s","margin-bottom":0});t.animate({height:0},300,function(){t.remove();i&&i()});v()||$(".sli_briefing_view__footer").css("opacity",0)},300)};var L=function e(t){return _.every(a[t],function(e,i){var n=TS.client.highlights.getHighlight(t,i);var a=true===n.leftFeedback||true===n.left_feedback;return!n||"dismiss"===n.feedback||"negative"===n.feedback&&a})};var G=function e(){return _.every(a,function(e,t){return _.every(a[t],function(e,i){var n=TS.client.highlights.getHighlight(t,i);if(!n)return true;var a=true===n.leftFeedback||true===n.left_feedback;return"dismiss"===n.feedback||"negative"===n.feedback||a})})};var H=function t(){e.replaceWith(TS.templates.sli_briefing());n.addClass("hidden");E();p(null,0,true);r.expanded=false};var Q=function e(t){if(!TS.model.team.plan)return;if(!TS.model.unread_view_is_showing)return;if(!t||!a||_.isEmpty(a)||!a[t.id])return;_.each(a[t.id],function(e,i){i<t.last_read&&!e._removed&&TS.client.highlights.setDefaultFeedbackForHighlight(t.id,i,{feedback:"dismiss"},"briefing-mark-as-read")})};var j=function e(t){if(!TS.model.team.plan)return;if(!TS.model.unread_view_is_showing)return;if(!t||!a||_.isEmpty(a)||!a[t.id])return;_.each(a[t.id],function(e,i){var n=$('.sli_briefing__message[data-cache-id="'+t.id+"-"+i+'"]');if(n.length){var a=n.find("ts-message");a.hasClass("is_pinned")&&a.removeClass("is_pinned")}})};var K=function e(t,i,n){if(!TS.model.unread_view_is_showing)return;if(!TS.model.team.plan)return;if(!a||_.isEmpty(a)||!a[t.id]||!a[t.id][i.ts]||!(_.includes(n,"text")||_.includes(n,"reply_count")))return;var r=_.assign({},i,{channel_id:t.id});a[t.id][i.ts]=r;var s=$('.sli_briefing__message[data-cache-id="'+t.id+"-"+i.ts+'"]');if(!s.length)return;var o=s.find("ts-message");o.replaceWith(f(r))};var W=function e(t,i){if(!TS.model.unread_view_is_showing)return;if(!TS.model.team.plan)return;if(!a||_.isEmpty(a)||!a[t.id]||!a[t.id][i.ts])return;TS.client.highlights.setDefaultFeedbackForHighlight(t.id,i.ts,{feedback:"dismiss"})}})()},3102:function(e,t){(function(){TS.registerModule("client.ui.channel_insights",{ensureChannelMemberCounts:function e(t){if(!t.data||!t.data.similar_channels)return t;return Promise.all(t.data.similar_channels.channels.map(function(e){return TS.interop.memberCounts.promiseToGetMemberCounts(e)})).then(function(e){t.data.similar_channels.channels=_.map(t.data.similar_channels.channels,function(t,i){return{id:t,counts:e[i]}});return t})},renderLoadingState:function e(){return TS.templates.infinite_spinner({color:"white",size:"medium"})},renderInsightsSection:function e(t){return TS.client.ui.channel_insights.maybeRenderMostActiveMembers(t)+"\n\t\t\t"+TS.client.ui.channel_insights.maybeRenderRelatedChannels(t)},buildDebugTooltip:function e(t){var i="p-channel_insights__"+t+"-debug";return'<button type="button" class="ts_icon ts_icon_info_circle btn_unstyle ts_tip ts_tip_top '+i+'">\n\t\t\t\t<span class="ts_tip_tip">View in SLI Debugger</span>\n\t\t\t</button>'},maybeRenderMostActiveMembers:function e(t){if(!_.get(t,"data.top_contributors.users.length"))return"";var i=!!_.get(t,"data.top_contributors.debug");return'<div class="p-channel_insights__drawer_section">\n\t\t\t\t<h4 class="p-channel_insights__drawer_title">\n\t\t\t\t\t'+TS.interop.i18n.t("Questions? Try asking\u2026","highlights","cca984e2e83633ce7251363c7048d9ec3db10035")()+"\n\t\t\t\t\t"+(i?TS.client.ui.channel_insights.buildDebugTooltip("top-contributors"):"")+"\n\t\t\t\t</h4>\n\t\t\t\t"+t.data.top_contributors.users.map(function(e){var t=TS.interop.members.getMemberById(e);return TS.templates.channel_insights_user({member:t})}).join("")+"\n\t\t\t</div>"},maybeRenderRelatedChannels:function e(t){if(!_.get(t,"data.similar_channels.channels.length"))return"";var i=!!_.get(t,"data.similar_channels.debug");return'<div class="p-channel_insights__drawer_section">\n\t\t\t\t<h4 class="p-channel_insights__drawer_title">\n\t\t\t\t\t'+TS.interop.i18n.t("Related channels","highlights")()+"\n\t\t\t\t\t"+(i?TS.client.ui.channel_insights.buildDebugTooltip("similar-channels"):"")+"\n\t\t\t\t</h4>\n\t\t\t\t"+t.data.similar_channels.channels.map(function(e){return'<div class="p-channel_insights__channel">\n\t\t\t\t\t\t'+TS.templates.builders.makeChannelLink(TS.redux.channels.getEntityById(e.id))+'\n\t\t\t\t\t\t<div class="p-channel_insights__member_count">\n\t\t\t\t\t\t\t<ts-icon class="ts_icon_user"></ts-icon> '+e.counts.member_count+"\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>"}).join("")+"\n\t\t\t</div>"}})})()},3103:function(e,t){(function(){TS.registerModule("client.ui.teams",{onStart:function e(){TS.teams.rename_sig.add(TS.client.ui.teams.updateSharedChannelIcons);TS.teams.added_sig.add(TS.client.ui.teams.updateSharedChannelIcons)},updateSharedChannelIcons:function e(t){if(t.id===TS.model.team.id)return;$(".ts_icon_shared_channels[data-shared-team-ids]").each(function(e,i){var n=$(i);var a=n.data("shared-team-ids");a=a&&TS.utility.parseJSONOrElse(a,a);if(!a.length||-1===a.indexOf(t.id))return;var r=n.data("tooltip-position");n.replaceWith(TS.templates.shared_channels_icon({shared_team_ids:a,tooltip:true,tooltip_position:r}))})}})})()},3104:function(e,t){(function(){TS.registerModule("ui.react_keyboard_shortcuts",{onStart:function i(){$("#shortcuts_tab").length&&TS.client.login_sig.addOnce(t);TS.prefs.enable_unread_view_changed_sig.add(function(){$("#shortcuts_tab").html("");t()});TS.i18n.keyboard_changed_sig.add(e)},executeShortcut:function e(t){if("quick_switcher"===t)TS.key_triggers.getFromCode(75).func();else if("browse_dms"===t)TS.ui.im_browser.start();else if("section_nav_next"===t||"section_nav_prev"===t){var i=jQuery.Event("keydown",{which:96,key:"`",ctrlKey:true,shiftKey:"section_nav_prev"===t});$("#client_header").trigger(i)}else"open_preferences"===t?TS.ui.prefs_dialog.start("a11y"):"file_upload"===t?TS.key_triggers.getFromCode(85).func():"open_all_unreads"===t?TS.key_triggers.getFromCode(65).func():"open_all_threads"===t?TS.client.threads.showThreadsView():"set_a_status"===t&&TS.redux.dispatch(TS.interop.redux.actions.openCustomStatusDialog())},prefLink:function e(){TS.ui.fs_modal.close();TS.ui.react_keyboard_shortcuts.showShortcutsFlexpane()},showShortcutsFlexpane:function e(){t();TS.redux.dispatch(TS.interop.actions.showKeyboardShortcuts())}});var e=function e(){$("#shortcuts_tab").length&&t()};var t=function e(){var t={is_mac:"mac",is_win:"windows",is_lin:"linux",is_cros:"linux"};var i=Object.keys(t).reduce(function(e,i){if(e)return e;return TS.model[i]?t[i]:null},null);var n={is_IE:"ie",is_FF:"ff",is_chrome_desktop:"chrome_desktop",is_chrome_mobile:"chrome_mobile",is_edge:"edge",is_our_app:"ssb"};var a=Object.keys(n).reduce(function(e,t){if(e)return e;return TS.model[t]?n[t]:null},null);var r={os:i,browser:a,keyboardLocale:TS.i18n.keyboard()};var s=document.getElementById("shortcuts_tab");TS.interop.mountKeyboardShortcuts(TS.boot_data.team_id,s,r)}})()},3105:function(e,t){(function(){TS.registerModule("ui.keyboard_shortcuts_prompt",{showing:false,onStart:function e(){if(!TS.boot_data.feature_shortcuts_prompt)return;$(document).on("keydown",t)},show:function t(){var i=TS.model.is_mac?TS.interop.i18n.t("Cmd","keys")():TS.interop.i18n.t("Ctrl","keys")();var o=TS.interop.i18n.keyEquivalent("/",{kb:TS.i18n.keyboard(),featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR});var l=TS.interop.i18n.keyEquivalent("`",{kb:TS.i18n.keyboard(),featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR});TS.generic_dialog.start({title:a,body:TS.templates.keyboard_shortcuts_prompt({cmd_key:i,slash_key:o,backtick_key:l}),show_close_button:true,show_cancel_button:false,onGo:n,onCancel:n,enter_always_gos:true,esc_for_ok:true,backdrop_click_to_dismiss:true,onShow:e,onEnd:function e(){TS.ui.keyboard_shortcuts_prompt.showing=false},show_go_button:true,go_button_class:"p-shortcuts_prompt__open_button",go_button_text:r,show_secondary_go_button:true,secondary_go_button_class:"btn_outline p-shortcuts_prompt__dismiss_button",secondary_go_button_text:s,onSecondaryGo:function e(){TS.ui.react_keyboard_shortcuts.showShortcutsFlexpane();TS.metrics.count("opened_keyboard_shortcuts_fp_from_coachmark")}});TS.prefs.setPrefLocal("seen_keyboard_shortcuts_coachmark",true);TS.prefs.setPrefByAPI({name:"seen_keyboard_shortcuts_coachmark",value:true})}});var e=function e(){TS.ui.keyboard_shortcuts_prompt.showing=true;$(document).off("keydown",t);TS.metrics.count("displayed_keyboard_shortcuts_coachmark")};var t=function e(t){if(t.which===TS.utility.keymap.tab&&TS.client.ui.isUserAttentionOnChat()&&!TS.utility.isTabCompleteShowing()){i(t);return}o=false};var i=function e(t){clearTimeout(c);l>0&&!o&&(l=0);l+=1;o=true;if(5==l&&!TS.prefs.getPref("seen_keyboard_shortcuts_coachmark")){t.preventDefault();TS.ui.keyboard_shortcuts_prompt.show();return}c=setTimeout(function(){l=0},1e3)};var n=function e(){TS.metrics.count("dismissed_keyboard_shortcuts_coachmark")};var a=TS.boot_data.feature_shortcuts_prompt?TS.interop.i18n.t("Navigating Slack with a keyboard?","keyboard_shortcuts")():"";var r=TS.boot_data.feature_shortcuts_prompt?TS.interop.i18n.t("Got it","keyboard_shortcuts")():"";var s=TS.boot_data.feature_shortcuts_prompt?TS.interop.i18n.t("View More","keyboard_shortcuts")():"";var o=false;var l=0;var c})()},3106:function(e,t){(function(){TS.registerModule("ui.onboarding_dialog",{onStart:function e(){},start:function e(t){c();if(TS.generic_dialog.is_showing){d(t);return}if(!TS.lessons.model)return;i=TS.lessons.model.TASKS.length;if("pending"===t||"completed"===t){a=false;n="pending"===t?TS.lessons.model.WELCOME:TS.lessons.model.COMPLETION;B(n.modal_media_url).then(function(){var e={image_src:n.modal_media_url,greeting:n.modal_title,description:new Handlebars.SafeString(n.modal_description),go_button_text:n.modal_button_text};"completed"===t&&(e.second_go_button_text=n.modal_second_button_text);u(TS.templates.onboarding_dialog_welcome_and_completion(e));"pending"===t?p():g()})}else{a=true;u(E());b();$(".c-modal_body--onboarding_dialog").on("click",".c-modal__media--onboarding_dialog",y)}},closeDialog:function e(){P()}})})();var i;var n;var a=true;var r=false;var s;var o;var l;var c=function e(){void 0===o&&(o=TS.interop.experiments.getGroupForUser("onboarding_2_skip"))};var d=function e(t){if("in_progress"===t||"paused"===t)l.html(E());else{w();a=false;n=TS.lessons.model.COMPLETION;var i={image_src:n.modal_media_url,greeting:n.modal_title,description:new Handlebars.SafeString(n.modal_description),go_button_text:n.modal_button_text,second_go_button_text:n.modal_second_button_text};l.html(TS.templates.onboarding_dialog_welcome_and_completion(i));g()}};var u=function e(t){TS.generic_dialog.start({type:"onboarding_dialog",dialog_class:"c-modal--onboarding_dialog",force_small:true,hide_footer:true,body:t,esc_for_ok:false,show_cancel_button:false,show_go_button:false});f();$(".modal-backdrop").on("click",m);l=$(".c-modal_body--onboarding_dialog")};var m=function e(){$(".c-modal__close--onboarding_dialog").trigger("click",{trigger:"backdrop_click"})};var f=function e(){$(".c-modal_body--onboarding_dialog").on("click",".c-modal__close--onboarding_dialog",h)};var h=function e(t,i){if(n!==TS.lessons.model.COMPLETION){if(TS.boot_data.feature_lesson_onboarding){if(!t.isTrigger||false===r){$(".c-modal--onboarding_dialog").addClass("below_menu");r=true}TS.menu.startWithGeneric(t,[{value:"remind",label:TS.interop.i18n.t("Remind me next time","prefs")()},{value:"skip",label:TS.interop.i18n.t("Skip completely","prefs")()}],function(e){if("remind"==e){TS.lessons.postponeOnboardingAndRemindLater();TS.lessons.lessonOnboardingClog({step:"close_menu",action:"click",ui_element:"remind_me",ui_properties:{element_type:"tile",element_name:"remind_me"}})}else{TS.lessons.cancelOnboarding();TS.lessons.lessonOnboardingClog({step:"close_menu",action:"click",ui_element:"skip",ui_properties:{element_type:"tile",element_name:"skip"}})}P()},{header_text:TS.interop.i18n.t("Close the tutorial","onboarding")(),menu_class:"onboarding_close_menu"})}}else P();"backdrop_click"===_.get(i,"trigger")?TS.lessons.lessonOnboardingClog({step:U(),action:"click",ui_element:"outside_click"}):TS.lessons.lessonOnboardingClog({step:U(),action:"click",ui_element:"exit",ui_properties:{element_type:"button",element_name:"exit"}});TS.menu.menu_closed_sig.add(function(){$(".c-modal--onboarding_dialog").removeClass("below_menu");r=true;clearTimeout(s);s=setTimeout(function(){r=false},250)})};var p=function e(){$("#onboarding_go_button").one("click",v);$(window.document).keydown(M)};var g=function e(){$("#onboarding_go_button").on("click",T);$("#onboarding_secondary_go_button").on("click",S)};var T=function e(){TS.lessons.loadSlackbot();TS.lessons.lessonOnboardingClog({step:"finished",action:"click",ui_element:"ask_slackbot",ui_properties:{element_type:"button",element_name:"ask_slackbot"}})};var S=function e(){P();TS.lessons.lessonOnboardingClog({step:"finished",action:"click",ui_element:"im_done",ui_properties:{element_type:"button",element_name:"im_done"}})};var v=function e(){a=true;l.html(E());b();$(".c-modal_body--onboarding_dialog").on("click",".c-modal__media--onboarding_dialog",y);TS.lessons.onboardingInProgress();TS.lessons.lessonOnboardingClog({step:"welcome",action:"click",ui_element:"lets_go",ui_properties:{element_type:"button",element_name:"lets_go"}})};var b=function e(){$(".c-modal_body--onboarding_dialog").on("click",".c-modal__left_navigation--onboarding_dialog",A);$(".c-modal_body--onboarding_dialog").on("click",".c-modal__right_navigation--onboarding_dialog",k);$(".c-modal_body--onboarding_dialog").on("click",".c-modal__lesson_circle_button",C);$(".c-modal_body--onboarding_dialog").on("click",".js_onboarding_go",TS.lessons.initiateTask);$(".c-modal_body--onboarding_dialog").on("click",".js_onboarding_second_go",TS.lessons.skipTask);$(window.document).keydown(x);$(window.document).keydown(I)};var w=function e(){$(".c-modal_body--onboarding_dialog").off("click",".c-modal__left_navigation--onboarding_dialog",A);$(".c-modal_body--onboarding_dialog").off("click",".c-modal__right_navigation--onboarding_dialog",k);$(".c-modal_body--onboarding_dialog").off("click",".c-modal__lesson_circle_button",C);$(".c-modal_body--onboarding_dialog").off("click",".js_onboarding_go",TS.lessons.initiateTask);$(".c-modal_body--onboarding_dialog").off("click",".js_onboarding_second_go",TS.lessons.skipTask);$(window.document).off("keydown",x);$(window.document).off("keydown",I)};var y=function e(){var t=$(this);var i=t.attr("src");if(bowser.msie){var n=i.length;"?"===i[n-1]?t.attr("src",i.slice(0,-1)):t.attr("src",i+"?")}else if(bowser.msedge){t.attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");setTimeout(function(){t.attr("src",i)},100)}else{t.attr("src","data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7");t.attr("src",i)}};var A=function e(){TS.lessons.model.current_task_index-=1;-1===TS.lessons.model.current_task_index&&(TS.lessons.model.current_task_index=i-1);l.html(E());TS.lessons.lessonOnboardingClog({step:"task"+(TS.lessons.model.current_task_index+1)+"_1",action:"carousel_back",ui_element:"back",ui_properties:{element_type:"button",element_name:"back"}})};var k=function e(){TS.lessons.model.current_task_index+=1;TS.lessons.model.current_task_index===i&&(TS.lessons.model.current_task_index=0);l.html(E());TS.lessons.lessonOnboardingClog({step:"task"+(TS.lessons.model.current_task_index+1)+"_1",action:"carousel_next",ui_element:"forward",ui_properties:{element_type:"button",element_name:"forward"}})};var C=function e(){var t=$(this).index();if(t!==TS.lessons.model.current_task_index){TS.lessons.model.current_task_index=t;l.html(E())}TS.lessons.lessonOnboardingClog({step:"task"+(TS.lessons.model.current_task_index+1)+"_1",action:"click",ui_element:"center_menu",ui_properties:{element_type:"menu",element_name:"step"+(t+1)}})};var x=function e(t){t.keyCode===TS.utility.keymap.left&&A()};var I=function e(t){t.keyCode===TS.utility.keymap.right&&k()};var M=function e(t){t.keyCode===TS.utility.keymap.esc&&(n===TS.lessons.model.COMPLETION?P():$(".c-modal__close--onboarding_dialog").trigger("click"))};var E=function e(){var t=_.get(TS.lessons.model,"TASKS["+TS.lessons.model.current_task_index+"]");if(!t){TS.info("Something went wrong! Could not get TS.lessons.model.TASKS[TS.lessons.model.current_task_index]");return}var i=t.modal_color_class;var a=true;var r=_.map(TS.lessons.model.TASKS,function(e,t){var n;if(t===TS.lessons.model.current_task_index&&e.task_completed){n="ts_icon_check_circle_o_large c-modal__lesson_circle--"+i;a=false}else n=e.task_completed?"ts_icon_check_circle_o_large":t===TS.lessons.model.current_task_index?"ts_icon_circle_fill c-modal__lesson_circle--"+i:"ts_icon_circle_fill";return"c-modal__lesson_circle "+n});var s=TS.lessons.model.current_task_index;B(t.modal_media_url).then(function(){if(s===TS.lessons.model.current_task_index&&n!==TS.lessons.model.COMPLETION&&0===l.find(".c-modal__media--onboarding_dialog").length){var e=$('<img class="c-modal__media--onboarding_dialog full_max_width position_relative cursor_pointer" src="'+t.modal_media_url+'" />');$("#onboarding_media_infinite_spinner").addClass("hidden");$(".c-modal__media_container--onboarding_dialog").append(e)}});return TS.templates.onboarding_dialog_lesson({modal_color_class:"c-modal__media_container--onboarding_dialog_"+i,modal_title:t.modal_title,lesson_circle_classes:r,modal_description:t.modal_description,modal_button_show:a,modal_button_text:t.modal_button_text,second_modal_button_text:t.second_modal_button_text,second_modal_button_skipped_text:t.second_modal_button_skipped_text,task_skipped:t.task_skipped,show_skip_button:"show_skip"===o})};var B=function e(t){return new Promise(function(e,i){var n=new Image;n.onload=function(){e()};n.onerror=function(){i(new Error("failed to load image"))};n.src=t})};var P=function e(){w();$(".c-modal_body--onboarding_dialog").off("click",".c-modal__close--onboarding_dialog",h);$(".modal-backdrop").off("click",m);$(".c-modal_body--onboarding_dialog").off("click",".c-modal__media--onboarding_dialog",y);$("#start_lesson_onboarding").off("click",v);$("#onboarding_go_button").off("click",T);$("#onboarding_secondary_go_button").off("click",S);TS.generic_dialog.cancel();$("c-modal--onboarding_dialog").removeClass("c-modal--onboarding_dialog");n===TS.lessons.model.COMPLETION&&TS.onboarding.no_longer_in_onboarding_sig.dispatch()};var U=function e(){if(a)return"task"+(TS.lessons.model.current_task_index+1)+"_1";if(n===TS.lessons.model.WELCOME)return"welcome";return"finished"}},3107:function(e,t){(function(){TS.registerModule("client.ui.search_in_react",{onStart:function e(){if(!TS.useGlobalNav()){TS.prefs.seen_new_search_ui_changed_sig.add(function(){TS.prefs.getPref("seen_new_search_ui")?$(".search_new_pill").addClass("hidden"):$(".search_new_pill").removeClass("hidden")});var t=$("#search_container");t.addClass("c-react_search_input");var i=t.find(".ql-editor");i.attr("aria-label",TS.interop.i18n.t("Search","search")());i.attr("contenteditable","false");t.on("click",function(e){if(!$(e.target).is("#search_clear")&&!$(e.target).is(".ts_icon_times_small")){TS.interop.searchActions.openFromClick();TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"CHANNEL_HEADER",ui_element:"NAV_SEARCH"}}})}});t.on("keydown",function(e){if(TS.interop.searchUi.getVisible())return;if($(e.target).is("#search_clear"))return;var t=e.metaKey||e.ctrlKey;var i=e.key.length>1;var n=i&&"Backspace"!==e.key&&"Space"!==e.key;if(n||t)return;e.preventDefault();var a=TS.interop.searchInputBox.getSearchInputBoxDisplayQuery();var r=a;"Backspace"===e.key?r=r.substr(0,a.length-1):"Space"===e.key?r+=" ":r+=e.key;TS.interop.searchActions.openFromKeyDown({query:r})});var n={channel_actions_toggle:true,recent_mentions_toggle:true,search_clear:true};i[0].addEventListener("focusin",function(e){var t=e.relatedTarget&&e.relatedTarget.id;TS.interop.searchActions.setFocusedViaTabKey({wasFocusedViaTabKey:!!n[t]})})}},primarySearchIsEnabled:function e(){return TS.interop.usePrimarySearch()},startPrimarySearch:function e(t,i){t=!!t;i=!!i;var n=!i&&t;if(!TS.client.searchViewActivated(t,n))return;TS.interop.mountPrimarySearch(TS.boot_data.team_id,document.getElementById("primary_search_mount_point"));TS.redux.dispatch(TS.interop.redux.features.workspace.setPrimaryView({id:"Vsearch",fromLegacy:true}));TS.client.channel_header.start();$("#client-ui").addClass("search_view_is_showing");$("#footer").addClass("hidden");TS.model.search_view_is_showing=true},stopPrimarySearch:function e(){$("#client-ui").removeClass("search_view_is_showing");$("#footer").removeClass("hidden");TS.interop.unmountPrimarySearch(document.getElementById("primary_search_mount_point"));TS.model.search_view_is_showing=false}})})()},3108:function(e,t){(function(){TS.registerModule("generic_notification_banner",{banner_to_show_sig:new signals.Signal,is_showing:false,current_settings:null,start:function e(t){if(TS.generic_notification_banner.is_showing){TS.warn('"'+t.h1_copy+'" banner was not shown because another banner is already being shown.');return}TS.generic_notification_banner.current_settings=_.defaults({},t,c);l=TS.generic_notification_banner.current_settings;d();m(l.imgSrc,l.imgAlt);f(l.h1_copy);h(l.h2_copy);p(l);g(l);T(l);S(l);u()},mountModernBannerInLegacy:function e(){var t=$("#message_pane_banner_legacy_mount_point");TS.interop.mountMessagePaneBanner(TS.model.team.id,t[0]);t.removeClass("hidden")},unmountModernBannerInLegacy:function e(){var t=$("#message_pane_banner_legacy_mount_point");TS.interop.unmountMessagePaneBanner(t[0]);t.addClass("hidden")},close:function t(){e&&e.addClass("hidden").removeClass(l.className);TS.generic_notification_banner.is_showing=false},getPref:function e(t){var i=TS.prefs.getPref("growth_all_banners_prefs");if(!i)return null;i=JSON.parse(i);if(null===i[t])return 0;return i[t]},setPrefs:function e(t){var i=TS.prefs.getPref("growth_all_banners_prefs");if(!i)return null;i=JSON.parse(i);$.each(t,function(e,t){i[e]=t});i=JSON.stringify(i);return TS.prefs.setPrefByAPI({name:"growth_all_banners_prefs",value:i})}});var e;var t;var i;var n;var a;var r;var s;var o;var l=null;var c={h1_copy:"",h2_copy:"",show_go_button:false,go_button_text:TS.interop.i18n.t("Show Me","notification_banner")(),go_button_class:"",onGo:null,show_go_link_button:true,go_link_button_text:TS.interop.i18n.t("Learn More","notification_banner")(),go_link_button_url:"",go_link_button_class:"",onLinkGo:null,show_close_button:true,close_button_text:TS.interop.i18n.t("Skip for Now","notification_banner")(),close_button_class:"",onClose:null,show_close_x_icon:false,onXClose:null,name:"",data:"",imgSrc:"",imgAlt:"",className:""};var d=function l(){e=$("#notification_banner");t=$("#notification_banner ts-icon");i=e.find(".messages_banner_image_wrapper:first");n=$("#notification_banner_h1");a=$("#notification_banner_h2");r=$("#notification_banner_go_link_button");s=$("#notification_banner_go_button");o=$("#notification_banner_close_button")};var u=function t(){e.removeClass("hidden");e.addClass(l.className);TS.generic_notification_banner.is_showing=true};var m=function e(t,n){if(!t){i.addClass("hidden");return}var a={src:t,alt:n};i.find("img:first").attr(a);i.removeClass("hidden")};var f=function e(t){if(!t){n.addClass("hidden");return}n.removeClass("hidden");n.text(t)};var h=function e(t){if(!t){a.addClass("hidden");return}a.removeClass("hidden");a.html(t)};var p=function e(t){if(t.show_go_link_button){r.removeClass("hidden");r.text(t.go_link_button_text);t.go_link_button_url&&r.attr("href",t.go_link_button_url);t.go_link_button_class&&r.addClass(t.go_link_button_class);t.onLinkGo&&r.on("click",t.onLinkGo);r.on("click",function(){TS.generic_notification_banner.close()})}else r.addClass("hidden")};var g=function e(t){if(t.show_go_button){s.removeClass("hidden");s.text(t.go_button_text);t.go_button_class&&s.addClass(t.go_button_class);t.onGo&&s.on("click",t.onGo);s.on("click",function(){TS.generic_notification_banner.close()})}else s.addClass("hidden")};var T=function e(t){if(t.show_close_button){o.removeClass("hidden");t.close_button_class&&o.addClass(t.close_button_class);t.onClose&&o.on("click",t.onClose);o.text(t.close_button_text);o.on("click",function(){TS.generic_notification_banner.close()})}else o.addClass("hidden")};var S=function e(i){if(i.show_close_x_icon){t.removeClass("hidden");i.onXClose&&t.on("click",i.onXClose);t.on("click",function(){TS.generic_notification_banner.close()});t.keydown(function(e){var t=e.keyCode||e.which;t===TS.utility.keymap.enter&&TS.generic_notification_banner.close()})}else t.addClass("hidden")}})()},3109:function(e,t){(function(){TS.registerModule("client.trial_expiration_banners",{onStart:function e(){if(!TS.boot_data.feature_shared_channel_free_trial_flow)return;TS.generic_notification_banner&&TS.generic_notification_banner.banner_to_show_sig.add(d)}})})();var i;var n;var a;var r;var s;var o;var l;var c=function e(t){a=t.data.no_of_days_left;r=t.data.pay_date_next;l={two_weeks_left_esc_trial_banner:{h1_copy:TS.interop.i18n.t("Heads up: you have {num_of_days} more days on your free trial","trial_expiration_banners")({num_of_days:a}),h2_copy:TS.interop.i18n.t("When the trial ends, this channel will <b>no longer be shared</b> with {shared_team_name}. Upgrade by {expiration_date} to keep all the features of the Standard plan.","trial_expiration_banners")({expiration_date:r,shared_team_name:TS.interop.i18n.safeString(_.escape(o))}),step:168},one_week_left_esc_trial_banner:{h1_copy:TS.interop.i18n.t("Only {num_of_days} days left on your free trial","trial_expiration_banners")({num_of_days:a}),h2_copy:TS.interop.i18n.t('<b class="sk_warning_red">You won\u2019t be able to use this channel with {shared_team_name}</b> afterward, even if you upgrade later. To keep sharing this channel, upgrade before {expiration_date}.',"trial_expiration_banners")({expiration_date:r,shared_team_name:TS.interop.i18n.safeString(_.escape(o))}),step:167}}};var d=function e(t){n=n||t;if(!n)return;i=n.name;if("two_weeks_left_esc_trial_banner"!==i&&"one_week_left_esc_trial_banner"!==i)return;TS.generic_notification_banner.close();if(!n.data)return;m();if(TS.model.threads_view_is_showing)return;if(TS.model.unread_view_is_showing)return;s=TS.shared.legacyGetActiveModelOb();if(!TS.interop.rules.channels.isExternallySharedChannel(s))return;if(!s||!s.creator)return;o=TS.teams.getTeamNameByMemberId(s.creator);if(!o)return;c(n);u(l[i])};var u=function e(t){TS.generic_notification_banner.start({h1_copy:t.h1_copy,h2_copy:t.h2_copy,show_close_x_icon:true,onXClose:h,show_go_link_button:true,go_link_button_text:TS.interop.i18n.t("Upgrade Now","trial_expiration_banners")(),go_link_button_url:"/admin/billing",onLinkGo:p,show_close_button:false,show_go_button:false});var i={step:t.step,action:"impression"};T("UPGRDEXP_FREE_TRIAL_FOR_SC",i);T("GROWTH_PRICING",i)};var m=function e(){TS.channels.switched_sig.add(d);TS.groups.switched_sig.add(TS.generic_notification_banner.close);TS.ims.switched_sig.add(TS.generic_notification_banner.close);TS.mpims.switched_sig.add(TS.generic_notification_banner.close);TS.client.threads.switched_sig.add(TS.generic_notification_banner.close);TS.client.unread.switched_sig.add(TS.generic_notification_banner.close)};var f=function e(){TS.channels.switched_sig.remove(d);TS.groups.switched_sig.remove(TS.generic_notification_banner.close);TS.ims.switched_sig.remove(TS.generic_notification_banner.close);TS.mpims.switched_sig.remove(TS.generic_notification_banner.close);TS.client.threads.switched_sig.remove(TS.generic_notification_banner.close);TS.client.unread.switched_sig.remove(TS.generic_notification_banner.close)};var h=function e(){g();f();var t={step:l[i].step,action:"close",element:"btn_close"};T("UPGRDEXP_FREE_TRIAL_FOR_SC",t);T("GROWTH_PRICING",t)};var p=function e(){g();f();var t={step:l[i].step,action:"click",element:"billing_link"};T("UPGRDEXP_FREE_TRIAL_FOR_SC",t);T("GROWTH_PRICING",t)};var g=function e(){var t={};var n=Math.floor(Date.now()/1e3);var a={one_week_left_esc_trial_banner:{num_times_seen:"one_week_left_esc_trial_cta_count",timestamp:"one_week_left_esc_trial_cta_last_ts"},two_weeks_left_esc_trial_banner:{num_times_seen:"two_weeks_left_esc_trial_cta_count",timestamp:"two_weeks_left_esc_trial_cta_last_ts"}};var r=a[i];var s=TS.generic_notification_banner.getPref(a[i].num_times_seen);s||(s=0);s+=1;t[r.num_times_seen]=s;t[r.timestamp]=n;TS.generic_notification_banner.setPrefs(t)};var T=function e(t,i){TS.interop.clog.track(t,{contexts:{ui_context:{step:i.step,action:i.action,ui_element:i.element}}})}},3110:function(e,t){(function(){TS.registerModule("client.message_limit_banners",{onStart:function e(){TS.generic_notification_banner&&TS.generic_notification_banner.banner_to_show_sig.addOnce(n)}})})();var i;var n=function e(t){var n={};if("activation_msg_limit_banner"===t.name){n.pref_ts=TS.generic_notification_banner.getPref("activation_msg_limit_banner_cta_last_ts");n.pref_count=TS.generic_notification_banner.getPref("activation_msg_limit_banner_cta_count");if(null===n.pref_ts||null===n.pref_count)return;n.date_today=Math.floor(Date.now()/1e3);a(t.data,n);r(i[t.name],t.data,n)}else{if("thirty_days_after_msg_limit_banner"===t.name&&t.data.messages_count){n.num_msgs_beyond_limit=t.data.messages_count-1e4;n.num_msgs_beyond_limit=o(n.num_msgs_beyond_limit);if(!n.num_msgs_beyond_limit)return}a(t.data,n);if(i[t.name]){n.pref_ts=TS.generic_notification_banner.getPref(t.name+"_cta_last_ts");n.pref_count=TS.generic_notification_banner.getPref(t.name+"_cta_count");if(null===n.pref_ts||null===n.pref_count)return;n.date_today=Math.floor(Date.now()/1e3);s(i[t.name],t,n)}}};var a=function e(t,n){i={activation_msg_limit_banner:{go_button_text:TS.interop.i18n.t("Show Me","client")(),h1_copy:TS.interop.i18n.t("{name_of_workspace} is on a roll","client")({name_of_workspace:TS.interop.i18n.safeString(t.team_name)}),h2_copy:TS.interop.i18n.t("Your team\u2019s now <b>{num_of_members} members</b> strong, with <b>{num_of_messages} messages</b> sent across <b>{num_of_channels} channels</b>. You can track your team\u2019s progress via the main menu.","client")({num_of_messages:t.messages_count,num_of_members:t.total_users,num_of_channels:t.total_channels}),step:143},approaching_msg_limit_banner:{h1_copy:TS.interop.i18n.t("Your workspace is getting close to the 10k message limit","client")(),h2_copy:TS.interop.i18n.t("All of your messages are saved in Slack, but on the Free plan you can only see and search the 10,000 most recent. For your full message history, upgrade to a paid plan.","client")(),step:63},just_reached_msg_limit_banner:{h1_copy:TS.interop.i18n.t("You\u2019ve just reached the 10k message limit","client")(),h2_copy:TS.interop.i18n.t("Your workspace has over 10,000 messages in it! That\u2019s a lot of conversation and history. Upgrade to a paid plan to make sure you can access all of it whenever you need it.","client")(),step:64},thirty_days_after_msg_limit_banner:{h1_copy:TS.interop.i18n.t("Your workspace has {num_msgs_beyond_limit} messages more than the 10k limit","client")({num_msgs_beyond_limit:n.num_msgs_beyond_limit}),h2_copy:TS.interop.i18n.t("That\u2019s more than {num_msgs_beyond_limit} messages you can\u2019t see or search. Upgrade to a paid plan for access to your full history \u2014 plus features like guest accounts for contractors, group video calls, and unlimited apps.","client")({num_msgs_beyond_limit:n.num_msgs_beyond_limit}),step:65}}};var r=function e(t,i,n){var a={activation_msg_limit_banner_cta_last_ts:n.date_today,activation_msg_limit_banner_cta_count:n.pref_count+=1};var r=function e(n){var r;var s;var o=TS.model.user.is_admin;var l=TS.ui.admin_invites.canInvite();TS.menu.startWithTeamAndUser(n);$("body").append('<div id="overlay_except_team_menu" class="msg_lim_activation_banner_overlay"></div>');if(o||l){if(!o&&l||o&&!l){r="non_admin_invite";s="bottom_non_admin_invite"}else if(o&&l){r="admin_invite";s="bottom_admin_invite"}}else{r="non_admin_no_invite";s="bottom_non_admin_no_invite"}$(".menu_content").append('<div class="msg_lim_activation_banner_menu_overlay top '+r+'"></div>');$(".menu_content").append('<div class="msg_lim_activation_banner_menu_overlay '+s+'"></div>');$("#menu_items_scroller").css("overflow-y","hidden");TS.interop.clog.track("UPGRDEXP_MSG_LIM_ACTIVATION_BANNER",{limit_meter_messages_count:i.messages_count,num_members_minus_bots:i.total_users,num_of_channels:i.total_channels,contexts:{ui_context:{step:t.step,action:"click",ui_element:"btn_show_me"}}});TS.generic_notification_banner.setPrefs(a);var c=function e(){$("#overlay_except_team_menu").remove();$(".msg_lim_activation_banner_menu_overlay").remove();$("#menu_items_scroller").css("overflow-y","initial")};$(window.document).bind("keydown",c);$("html").bind("mousedown touchstart",c)};var s=function e(){TS.interop.clog.track("UPGRDEXP_MSG_LIM_ACTIVATION_BANNER",{limit_meter_messages_count:i.messages_count,num_members_minus_bots:i.total_users,num_of_channels:i.total_channels,contexts:{ui_context:{step:t.step,action:"close",ui_element:"btn_close"}}});TS.generic_notification_banner.setPrefs(a)};TS.generic_notification_banner.start({h1_copy:t.h1_copy,h2_copy:t.h2_copy,show_go_button:true,go_button_text:t.go_button_text,onGo:r,show_close_x_icon:true,onXClose:s,show_go_link_button:false,show_close_button:false});TS.interop.clog.track("UPGRDEXP_MSG_LIM_ACTIVATION_BANNER",{limit_meter_messages_count:i.messages_count,num_members_minus_bots:i.total_users,num_of_channels:i.total_channels,contexts:{ui_context:{step:t.step,action:"impression"}}})};var s=function e(t,i,n){var a={};var r=function e(){TS.interop.clog.track("GROWTH_PRICING",{limit_meter_messages_count:TS.model.team.messages_count,contexts:{ui_context:{step:t.step,action:"click",ui_element:"pricing_button"}}});n.pref_count+=1;a[i.name+"_cta_last_ts"]=n.date_today;a[i.name+"_cta_count"]=n.pref_count;TS.generic_notification_banner.setPrefs(a)};var s=function e(){TS.interop.clog.track("GROWTH_PRICING",{limit_meter_messages_count:TS.model.team.messages_count,contexts:{ui_context:{step:t.step,action:"close",ui_element:"skip_for_now_button"}}});n.pref_count+=1;a[i.name+"_cta_last_ts"]=n.date_today;a[i.name+"_cta_count"]=n.pref_count;TS.generic_notification_banner.setPrefs(a)};TS.generic_notification_banner.start({h1_copy:t.h1_copy,h2_copy:t.h2_copy,show_go_link_button:true,go_link_button_text:TS.interop.i18n.t("Learn More","client")(),go_link_button_url:"/pricing?ui_element=11&ui_step="+t.step,onLinkGo:r,show_close_button:true,close_button_text:TS.interop.i18n.t("Skip for Now","client")(),onClose:s});TS.interop.clog.track("GROWTH_PRICING",{limit_meter_messages_count:TS.model.team.messages_count,contexts:{ui_context:{step:t.step,action:"impression"}}})};var o=function e(t){if(!t||t<=0)return t;if(t>9&&t<100)return 10*Math.floor(t/10);if(t>100&&t<=999999){t=100*Math.floor(t/100);return TS.interop.i18n.number(t)}if(t>999999)return TS.utility.number.formatNumberWithAbbreviation(t,{precision:3})}},3111:function(e,t){(function(){TS.registerModule("client.file_limit_banners",{onStart:function e(){TS.generic_notification_banner&&TS.generic_notification_banner.banner_to_show_sig.add(TS.client.file_limit_banners.onReceiveBannerData)},onReceiveBannerData:function e(t){if("approaching_file_limit_banner"===t.name){var i=TS.client.file_limit_banners.getPrefs();TS.client.file_limit_banners.arePrefsValid(i)&&TS.client.file_limit_banners.showBannerWithData(t.data,i.pref_count)}},showBannerWithData:function e(t,i){var n=function e(){TS.client.file_limit_banners.updatePrefs(i);TS.interop.clog.track("UPGRDEXP_ENFORCE_FILE_LIMITS",{contexts:{ui_context:{step:"banner_approaching_file_limit",action:"click",ui_element:"pricing_button"}}});TS.interop.clog.track("GROWTH_PRICING",{contexts:{ui_context:{step:"banner_approaching_file_limit",action:"click",ui_element:"pricing_button"}}})};var a=function e(){TS.client.file_limit_banners.updatePrefs(i);TS.interop.clog.track("UPGRDEXP_ENFORCE_FILE_LIMITS",{contexts:{ui_context:{step:"banner_approaching_file_limit",action:"close",ui_element:"btn_close"}}})};var r=TS.interop.experiments.getGroupForUser("approaching_file_limit_banner_v2");var s="treatment"===r?TS.interop.i18n.t('If your workspace goes over the free plan\u2019s <span class="bold">5 GB storage limit,</span> older files will no longer be viewable. To access all your files, you can upgrade to a paid plan.',"notification_banner"):TS.interop.i18n.t('Your workspace is getting close to the free plan\u2019s <span class="bold">5 GB storage limit</span>. To get some more space, you can either {open_button_tag}delete older files</button> or upgrade to a paid plan.',"notification_banner")({open_button_tag:TS.interop.i18n.safeString('<button class="c-link--button" onClick="TS.client.file_limit_banners.onDeleteFilesLinkClicked('+i+');" tabindex="5">'),note:"open_button_tag is an html button but will have attributes that may need to change more frequently than the text. This is not user-readable."});TS.generic_notification_banner.start({h1_copy:TS.interop.i18n.t("{name_of_workspace} is almost out of space","notification_banner")({name_of_workspace:TS.redux.teams.getCurrentTeam().name}),h2_copy:s,show_go_link_button:true,go_link_button_text:TS.interop.i18n.t("See Plans","notification_banner")(),go_link_button_url:"/pricing?ui_element=11&ui_step=200",onLinkGo:n,show_close_button:false,show_close_x_icon:true,onXClose:a});TS.interop.clog.track("UPGRDEXP_ENFORCE_FILE_LIMITS",{contexts:{ui_context:{step:"banner_approaching_file_limit",action:"impression"}}})},onDeleteFilesLinkClicked:function e(t){TS.generic_notification_banner.close();TS.client.ui.files.showFileList();TS.client.ui.files.filterFileList("user");TS.view.files.setButtonState("user");TS.client.file_limit_banners.updatePrefs(t);TS.interop.clog.track("UPGRDEXP_ENFORCE_FILE_LIMITS",{contexts:{ui_context:{ui_element:"file_storage_link",step:"banner_approaching_file_limit",action:"click"}}})},getPrefs:function e(){return{pref_ts:TS.generic_notification_banner.getPref("approaching_file_limit_banner_cta_last_ts"),pref_count:TS.generic_notification_banner.getPref("approaching_file_limit_banner_cta_count")}},arePrefsValid:function e(t){return null!==t&&null!==t.pref_ts&&null!==t.pref_count},updatePrefs:function e(t){var i={approaching_file_limit_banner_cta_last_ts:Math.floor(Date.now()/1e3),approaching_file_limit_banner_cta_count:t+1};TS.generic_notification_banner.setPrefs(i)}})})()},3112:function(e,t){(function(){TS.registerModule("client.free_trial_banners",{onStart:function e(){TS.generic_notification_banner&&TS.generic_notification_banner.banner_to_show_sig.add(s)}})})();var i;var n;var a;var r;var s=function e(t){n=t.name;if("in_prod_trial_banner"!==t.name&&"in_prod_trial_reminder_banner"!==t.name)return;o(t);l(r[t.name])};var o=function e(t){a=t.data.expiration_date;r={in_prod_trial_banner:{h1_copy:TS.interop.i18n.t("Start your free trial of the Standard plan","free_trial_banners")(),h2_copy:TS.interop.i18n.t("With unlimited searchable messages, you\u2019ll never lose access to your conversations \u2014 or to things like project details, important docs, and key decisions made along the way.","free_trial_banners")(),step:205},in_prod_trial_reminder_banner:{h1_copy:TS.interop.i18n.t("Your free trial offer is about to expire","free_trial_banners")(),h2_copy:TS.interop.i18n.t("You still have time to try out the <b>Standard plan</b>. Start your trial by <b>{expiration_date}</b> to explore features like unlimited searchable messages, guest accounts, screen sharing, and more \u2014 free for 30 days. ","free_trial_banners")({expiration_date:a}),step:207}}};var l=function e(t){if(!t)return;TS.generic_notification_banner.start({h1_copy:t.h1_copy,h2_copy:t.h2_copy,show_close_x_icon:true,onXClose:c,show_go_link_button:true,go_link_button_url:"/trial",onLinkGo:d,show_close_button:false,show_go_button:false});i=t.step;var n={step:i,action:"impression"};_("UPGRDEXP_FREE_TRIAL_IN_PROD",n)};var c=function e(){u();var t={step:i,action:"close",element:"btn_close"};_("UPGRDEXP_FREE_TRIAL_IN_PROD",t)};var d=function e(){u();var t={step:i,action:"click",element:"learn_more_btn"};_("UPGRDEXP_FREE_TRIAL_IN_PROD",t)};var u=function e(){var t={};var i=Math.floor(Date.now()/1e3);var a={in_prod_trial_banner:{num_times_seen:"in_prod_trial_banner_cta_count",timestamp:"in_prod_trial_banner_cta_last_ts"},in_prod_trial_reminder_banner:{num_times_seen:"in_prod_trial_reminder_banner_cta_count",timestamp:"in_prod_trial_reminder_banner_cta_last_ts"}};var r=a[n];var s=TS.generic_notification_banner.getPref(a[n].num_times_seen);s||(s=0);s+=1;t[r.num_times_seen]=s;t[r.timestamp]=i;TS.generic_notification_banner.setPrefs(t)};var _=function e(t,i){TS.interop.clog.track(t,{contexts:{ui_context:{step:i.step,action:i.action,ui_element:i.element}}})}},3113:function(e,t){TS.registerModule("codemirror",{legacyLoadCodemirror:function e(){return new Promise(function(e){if(window.CodeMirror)e();else if(i);else{i=true;TS.utility.getCachedScript(_.get(TS,"boot_data.vvv_paths.codemirror","/js/libs/codemirror.min.js")).done(function(){TS.utility.getCachedScript(_.get(TS,"boot_data.vvv_paths.codemirror_addon_simple","/js/libs/codemirror/addon/simple.js")).done(function(){TS.utility.getCachedScript(_.get(TS,"boot_data.vvv_paths.codemirror_load","/js/codemirror_load.js")).done(function(){e()})})})}})},legacyAttachToTextArea:function e(t,i){if(!window.CodeMirror){TS.console.error("CodeMirror not loaded before trying to use");return null}return CodeMirror.fromTextArea(t,i)}});var i=false},318:function(e,t,i){e.exports={default:i(410),__esModule:true}},327:function(e,t,i){e.exports={default:i(328),__esModule:true}},328:function(e,t,i){i(148);i(125);e.exports=i(329)},3284:function(e,t,i){"use strict";i.r(t);var n=i(1409);var a=i(3);var r=i.n(a);(function(){TS.registerModule("client",{before_login_sig:new signals.Signal,login_sig:new signals.Signal,flexpane_display_switched_sig:new signals.Signal,core_url:null,onStart:function e(){var t=null;var i=Infinity;TS.channels.deleted_sig.add(function(e){e!==TS.model.active_channel_id&&e!==TS.model.active_group_id||TS.client.activeChannelDisplayGoneAway()},t,i);TS.channels.left_sig.add(function(e){e.id===TS.model.active_channel_id&&(e.was_archived_this_session||TS.client.activeChannelDisplayGoneAway())});TS.client.core_url=document.location.href.split(/\/+messages/)[0]+"/messages";TS.model.ui_state=TS.storage.fetchUIState();TS.model.initial_ui_state_str=TS.model.ui_state?JSON.stringify(TS.model.ui_state):"none";TS.model.flex_name_in_url=TS.utility.getFlexNameFromUrl(location.href).toLowerCase();TS.model.flex_extra_in_url=TS.utility.getFlexExtraFromUrl(location.href);if(-1==TS.model.flex_names.indexOf(TS.model.flex_name_in_url)){TS.model.flex_name_in_url="";TS.model.flex_extra_in_url=""}if(TS.model.flex_name_in_url&&"search"!==TS.model.flex_name_in_url){TS.model.ui_state.flex_name=TS.model.flex_name_in_url;TS.model.ui_state.flex_extra=TS.model.flex_extra_in_url||""}"list"===TS.model.ui_state.flex_name&&(TS.model.ui_state.flex_name="files");"activity"===TS.model.ui_state.flex_name&&(TS.model.ui_state.flex_name="mentions");TS.boot_data.feature_file_threads&&"files"===TS.model.ui_state.flex_name&&(TS.model.ui_state.flex_extra_type=TS.utility.getFlexExtraTypeFromUrl(location.href).toLowerCase());TS.model.ui_state.flex_visible=!!TS.model.ui_state.flex_name;TS.storage.storeUIState(TS.model.ui_state);TS.members.user_added_to_team_sig.add(function(e){return TS.client.userAddedToTeam(e)});TS.members.user_removed_from_team_sig.add(TS.client.userRemovedFromTeam);TS.members.batch_upserted_sig.add(u);TS.boot_data.feature_webclient_load_status_site&&P();var n=TS.interop.a11y.isScreenReaderEnabled();TS.redux.dispatch(TS.interop.redux.features.accessibility.setScreenReaderEnabled(n))},gogogo:function e(){$(window).bind("popstate",p)},updateTeamIcon:function e(){TS.model.team.icon&&TS.model.team.icon.image_68&&true!==TS.model.team.icon.image_default?TS.interop.desktop.setTeamIcon(TS.model.team.icon):TS.warn("updateTeamIcon was called, but missing an image to set")},markLastReadsWithAPI:function e(){if(TS.isPartiallyBooted())return;TS.redux.dispatch(TS.interop.actions.markDelayedWithAPI())},activeChannelDisplayGoneAway:function e(){TS.model.active_history.pop();var t;var i;var n;var a=function e(t){TS.model.active_history.push(t.id);TS.model.active_channel_id=null;TS.model.active_im_id=null;TS.model.active_group_id=null;TS.model.active_mpim_id=null;t.is_im?TS.model.active_im_id=t.id:t.is_mpim&&t.is_group?TS.model.active_mpim_id=t.id:t.is_group?TS.model.active_group_id=t.id:t.is_channel&&(TS.model.active_channel_id=t.id);TS.model.active_cid=TS.model.active_channel_id||TS.model.active_im_id||TS.model.active_group_id||TS.model.active_mpim_id};while(TS.model.active_history.length&&!n){t=TS.model.active_history.pop();i=TS.redux.channels.getEntityById(t);if(i.is_im&&i.is_open){n=true;TS.has_pri[x]&&TS.log(x,"switching to im "+i.id);if(TS.client.activeChannelIsHidden())return a(i);TS.ims.legacyDisplayIm(i.id);TS.client.channelDisplaySwitched({id:i.id})}else if(i.is_mpim&&i.is_group&&i.is_open){n=true;TS.has_pri[x]&&TS.log(x,"switching to mpim "+i.id);if(TS.client.activeChannelIsHidden())return a(i);TS.mpims.legacyDisplayMpim({id:i.id,replace_history_state:true})}else if(!i.is_group||i.is_archived||i.is_mpim){if(i.is_channel){n=true;TS.has_pri[x]&&TS.log(x,"switching to channel "+i.id);if(TS.client.activeChannelIsHidden())return a(i);TS.channels.legacyDisplayChannel({id:i.id,replace_history_state:true})}}else{n=true;TS.has_pri[x]&&TS.log(x,"switching to group "+i.id);if(TS.client.activeChannelIsHidden())return a(i);TS.groups.legacyDisplayGroup({id:i.id})}}if(!TS.model.active_history.length){var r=TS.interop.redux.models.channels.getUnarchivedPublicAndPrivateChannelsUserIsIn(TS.redux.getState());if(r.length>0){var s=_.find(r,TS.interop.rules.channels.isPublicChannel)||r[0];if(TS.client.activeChannelIsHidden())return a(s);s.is_group?TS.groups.legacyDisplayGroup({id:s.id}):TS.channels.legacyDisplayChannel({id:s.id,replace_history_state:true})}TS.error("WTF no channel or group to display?")}},flexDisplaySwitched:function e(t,i,n,a,r,s){TS.interop.clog.track("FLEXPANE_DISPLAY_SWITCHED",{flex_name:t,flex_origin:r});i=T(i);n=true;if(!a&&(TS.model.c_name_in_url||TS.client.activeChannelIsHidden())){var o=function(){if(TS.model.unread_view_is_showing)return"/unreads";if(TS.model.threads_view_is_showing)return"/threads";if(TS.model.search_view_is_showing)return"/search";return"/messages/"+TS.model.c_name_in_url}();var l=TS.utility.refashionUrl(window.location.href,o,t,i);S(l,n)}var c=TS.model.ui_state.flex_name;var d=TS.model.ui_state.flex_extra;TS.model.flex_name_in_url=t;TS.model.flex_extra_in_url=i;TS.model.ui_state.flex_name=t;TS.model.ui_state.flex_extra=i;TS.model.ui_state.prev_flex_name=c;TS.model.ui_state.prev_flex_extra=d;TS.storage.storeUIState(TS.model.ui_state);TS.client.flexpane_display_switched_sig.dispatch(c,d);TS.redux.dispatch(TS.interop.redux.features.workspace.setSecondaryView({flexName:TS.model.ui_state.flex_name,flexParams:_.pickBy({flexExtra:TS.model.ui_state.flex_extra,flexExtraType:TS.model.ui_state.flex_extra_type}),flexOrigin:r,flexOriginId:s}))},channelDisplaySwitched:function e(t){var i=_.defaults({},t,{from_history:false,replace_history_state:false});var n=i.id;if(!n){TS.error("no model id supplied");return}var a=i.replace_history_state;var r=i.no_history_add;if(!n){TS.error("no model_ob_id?");return false}var s=TS.redux.channels.getEntityById(n);if(!s){TS.error("unknown model_ob id: "+n);return false}var o=s.id;var l=i.channel_path||"/messages/"+o;if(!r){var c=T(TS.model.flex_extra_in_url);var d=TS.utility.refashionUrl(window.location.href,l,TS.model.flex_name_in_url,c);S(d,!TS.model.c_name_in_url||a)}TS.model.c_name_in_url=o;if(!TS.client.activeChannelIsHidden()){if(s.is_channel&&n==TS.model.active_channel_id){TS.warn("not switching, it is the active channel already");return false}if(s.is_im&&n==TS.model.active_im_id){TS.warn("not switching, it is the active im already");return false}if(s.is_mpim&&n==TS.model.active_mpim_id){TS.warn("not switching, it is the active mpim already");return false}if(s.is_group&&n==TS.model.active_group_id){TS.warn("not switching, it is the active group already");return false}}TS.utility.msgs.checkForMsgsToTruncate();TS.model.last_active_cid=TS.model.active_channel_id||TS.model.active_im_id||TS.model.active_group_id||TS.model.active_mpim_id;TS.model.active_channel_id=null;TS.model.active_im_id=null;TS.model.active_group_id=null;TS.model.active_mpim_id=null;TS.model.unread_view_is_showing=false;TS.model.threads_view_is_showing=false;s.is_im?TS.model.active_im_id=n:s.is_channel?TS.model.active_channel_id=n:s.is_mpim&&s.is_group?TS.model.active_mpim_id=n:s.is_group&&(TS.model.active_group_id=n);TS.model.active_cid=TS.model.active_channel_id||TS.model.active_im_id||TS.model.active_group_id||TS.model.active_mpim_id;TS.interop.desktop.displayChannel(TS.model.active_cid);TS.view.updateTitleWithContext();s.last_made_active=Date.now();var u=n;TS.has_pri[x]&&TS.log(x,u+" is now active");var m=TS.model.active_history;var f=m.indexOf(u);-1!=f&&m.splice(f,1);m.push(u);TS.has_pri[x]&&TS.log(x,m);TS.storage.storeActiveHistory(m);return true},unreadViewActivated:function e(t,i){if(!i){var n=T(TS.model.flex_extra_in_url);var a=TS.utility.refashionUrl(window.location.href,"/unreads",TS.model.flex_name_in_url,n);t||TS.model.unread_view_is_showing||TS.model.c_name_in_url||(t=true);S(a,t)}if(TS.model.unread_view_is_showing){TS.warn("not switching, unread view is already active");return false}TS.client.threads.destroyThreadsView();TS.model.threads_view_is_showing=false;TS.interop.apps.isAppSpaceEnabled()&&TS.client.ui.app_space.resetUI();TS.client.ui.search_in_react.primarySearchIsEnabled()&&TS.interop.redux.features.searchUi.getVisible(TS.redux.getState())&&TS.client.ui.search_in_react.stopPrimarySearch();TS.client.archives.cancel(true);TS.model.unread_view_is_showing=true;TS.view.updateTitleWithContext();TS.redux.dispatch(TS.interop.redux.features.messagePane.hideMessagePane());return true},threadsViewActivated:function e(t,i){if(!i){var n=T(TS.model.flex_extra_in_url);var a=TS.utility.refashionUrl(window.location.href,"/threads",TS.model.flex_name_in_url,n);t||TS.model.threads_view_is_showing||TS.model.c_name_in_url||(t=true);S(a,t)}if(TS.model.threads_view_is_showing){TS.warn("not switching, threads view is already active");return false}if(TS.client.unread.isEnabled()){TS.client.unread.destroyUnreadView();TS.model.unread_view_is_showing=false}TS.client.ui.search_in_react.primarySearchIsEnabled()&&TS.client.ui.search_in_react.stopPrimarySearch();TS.model.threads_view_is_showing=true;TS.client.archives.cancel(true);TS.view.updateTitleWithContext();TS.interop.apps.isAppSpaceEnabled()&&TS.client.ui.app_space.resetUI();TS.redux.dispatch(TS.interop.redux.features.messagePane.hideMessagePane());return true},searchViewActivated:function e(t,i){if(!i){var n=T(TS.model.flex_extra_in_url);var a=TS.utility.refashionUrl(window.location.href,"/search",TS.model.flex_name_in_url,n);t||TS.model.search_view_is_showing||TS.model.c_name_in_url||(t=true);S(a,t)}if(TS.model.search_view_is_showing){TS.warn("not switching, search view is already active");return false}TS.client.threads.destroyThreadsView();TS.client.unread.destroyUnreadView();TS.model.threads_view_is_showing=false;TS.model.unread_view_is_showing=false;TS.interop.apps.isAppSpaceEnabled()&&TS.client.ui.app_space.resetUI();TS.model.search_view_is_showing=true;TS.client.archives.cancel(true);TS.view.updateTitleWithContext();TS.redux.dispatch(TS.interop.redux.features.messagePane.hideMessagePane());return true},calculateInitialCid:function e(){return v()},calculateInitialMessage:function e(){return b()},startCheckingForCleanup:function e(){h()},complianceExportStartChanged:function e(){d()},onFirstLoginMS:function e(){k("timing-www-perceived-load");g();h();TS.redux.socket.connectedSig.add(a);TS.redux.socket.connectedSig.addOnce(I);TS.channels.renamed_sig.add(t);TS.members.changed_name_sig.add(n);TS.members.changed_account_type_sig.add(i);TS.view.members.unknown_resolution_rebuild_sig.add(n);TS.prefs.box_enabled_changed_sig.add(l);TS.prefs.dropbox_enabled_changed_sig.add(c);TS.prefs.compliance_export_start_changed_sig.add(d);TS.prefs.team_disallow_public_file_urls_changed_sig.add(f);TS.prefs.getTeamPref("compliance_export_start")&&d();TS.model.mac_ssb_version&&!TS.prefs.getPref("no_macssb1_banner")&&TS.prefs.setPrefByAPI({name:"no_macssb1_banner",value:true});window.desktop&&!TS.prefs.getPref("no_winssb1_banner")&&TS.prefs.setPrefByAPI({name:"no_winssb1_banner",value:true});if(1==TS.qs_args.halt_at_loading_screen)throw new Error("Intentionally halting at loading screen");TS._incremental_boot&&TS.client.ui&&TS.client.ui.$messages_input_container&&TS.client.ui.$messages_input_container.addClass("pretend-to-be-online");$("#loading_welcome").transition({opacity:0},200,function(){$("#col_channels_bg").css("z-index",0);$("#loading-zone").transition({opacity:0},200,function(){$("body").removeClass("loading");TS.view.resizeManually("onFirstLoginMS");$("#loading-zone, #loading_zone_styles").remove();s();if(TS.model.initial_msg_ts){var e=TS.shared.legacyGetActiveModelOb();e&&e.id&&TS.client.ui.tryToJump(e.id,TS.model.initial_msg_ts,TS.model.initial_thread_ts)}})});var r=TS.shared.legacyGetActiveModelOb();var o=r&&r.msgs&&(r.msgs.length>0||null===r.latest);if(TS.client.archives.current_model_ob);else if(o){TS.metrics.mark("content_visible");TS.metrics.measure("client_content_visible_4","start_nav","content_visible")}else r&&(TS.client.ui.record_content_visible_metric_after_fetching_model_ob=r.id)},onEveryLoginMS:function e(){TS.interop.i18n.locale===TS.prefs.getPref("locale")||TS.qs_args.locale||TS.prefs.locale_changed_sig.dispatch(TS.prefs.getPref("locale"));window.desktop&&desktop.teams&&desktop.teams.setTeamLocale&&desktop.teams.setTeamLocale(TS.prefs.getPref("locale"));if(!TS.model.ms_logged_in_once){TS.log(850,Date.now()-TS.boot_data.start_ms+"ms from first html to login_sig.dispatch()");TS.client.before_login_sig.dispatch();TS.client.login_sig.dispatch()}},handleDeepLink:function e(t){t=decodeURIComponent(t);TS.info("handleDeepLink url:"+t);if(!t)return;if(!t.indexOf)return;if(-1==t.indexOf("://"))return;if(-1==t.indexOf("?"))return;var i=t.split("?");var n=i[0].split("://")[1];TS.info("handleDeepLink cmd:"+n);if(!n)return;var a=i[1];TS.info("handleDeepLink qs:"+a);var r=TS.interop.url.queryStringParse(a);TS.info("handleDeepLink qs_args:"+JSON.stringify(r,null,2));TS.client._handleParsedDeepLink(n,r)},handleDeepLinkWithArgs:function e(t){var i="handleDeepLinkWithArgs:";D(i+' got str "'+t+'"');var n=TS.utility.parseJSONOrElse(t,null);if(!n){D(i+" failed to parse str");return}var a=n.cmd;if(!a){D(i+" no cmd? ("+a+")");return}delete n.cmd;TS.client._handleParsedDeepLink(a,n)},_handleParsedDeepLink:function e(t,i){var n="_handleParsedDeepLink:";D(n+' got cmd "'+t+'"');D(n+' got qs_args "'+i+'"');if(!i.team)return;if(i.team!=TS.model.team.id){TS.generic_dialog.alert(TS.interop.i18n.t("Sorry, you tried to perform an action on a workspace you\u2019re not yet logged into!","client")());return}var a=false;var r=i.id;var o;if("channel"===t){var l=function e(t){return TS.redux.channels.getEntityById(t,a)||TS.ims.getImByUsername(t)||TS.redux.channels.getChannelByName(t)};var c=function e(){o=l(r);if(!o){if(TS.interop.utility.looksLikeMemberId(r)){TS.ims.legacyStartImByMemberId(r);return}return TS.error(r+" is not a recognized channel/dm/group")}"false"===i.thread_ts&&delete i.thread_ts;TS.client.ui.tryToJump(o.id,i.message,i.thread_ts)};if(TS.useGlobalNav()&&("Vall_unreads"===r||"Vall_threads"===r))return TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:r}));var d=void 0;o=l(r);d=o?Promise.resolve():TS.interop.utility.looksLikeChannelId(r)?TS.interop.channels.fetchAndUpsertChannelsById({ids:[r]}):TS.interop.channels.fetchAndUpsertChannelsWithQuery({query:{query:r,count:1}}).timeout(TS.interop.connectivity.getMaximumSocketWait()).catch(_.noop);d.then(function(){return c()});return}if("user"===t){D(n+" got cmd === user");var u=function e(){var t="handleUserCmd:";var s=TS.interop.members.getMemberById(r,a);D(t+" found member "+!!s);if(!s)return TS.error(r+" is not a recognized member");s.is_bot||TS.client.ui.previewMember(r);var l=TS.redux.channels.getImByMemberId(r);if(!l){D(n+" got no im channel from member ID");TS.ims.legacyStartImByMemberId(r);return}o=TS.redux.channels.getEntityById(l.id,a);if(!o)return TS.error(l+" is not a recognized dm");TS.client.ui.tryToJump(o.id,i.message)};var m=void 0;var f=TS.interop.members.getMemberById(r,a);D(n+" found member: "+!!f);m=f?Promise.resolve():TS.interop.utility.looksLikeMemberId(r)?TS.interop.members.fetchAndUpsertMembersById({ids:[r]}):TS.interop.members.fetchAndUpsertMembersWithQuery({query:{query:r,count:1}}).timeout(TS.interop.connectivity.getMaximumSocketWait()).catch(_.noop);m.then(function(){return u()});return}if("file"===t){TS.client.ui.files.previewFile(r);return}if("files"===t){var h=i.user_id||"all";var p=i.file_type||"all";var g;TS.interop.utility.looksLikeMemberId(h)?g=TS.interop.members.ensureMembersArePresent([h]):"all"===h&&(g=Promise.resolve());g.then(function(){TS.client.ui.files.filterFileList(p);TS.view.files.setButtonState(p);TS.client.ui.files.toggleFileList(h);TS.client.ui.files._displayFileList();TS.client.flexDisplaySwitched("files",null,false,true)})}"team"===t&&(r?TS.client.ui.showTeamFromHistory(r):TS.client.ui.showTeamFromHistory());"invite"===t&&s("invite_members");"notifications"===t&&s("notifications");if("preferences"===t){var T=i.section;s("preferences",T)}if("create"===t){var S=i.item;"channel"===S&&s("create_channel")}if("browse"===t){var v=i.item;"channels"===v&&s("browse_channels")}},manualReconnectNow:function e(){TS.interop.SocketManager.reconnectImmediately()},apiPaused:function t(i){var n;var a="";if(i.reason.API_ERROR){n=TS.interop.i18n.t('We\u2019re having trouble connecting to Slack. We\u2019ll try again shortly, or you can <a onclick="TS.client.manualReconnectNow()">try now</a>.',"client")();a=e(i)}else if(i.reason.SERVICE_DOWN){var r=TS.prefs.getTeamPref("custom_status_site");var s="https://status.slack.com/"+_.escape(r);n=TS.interop.i18n.t('Slack is unavailable, but don\u2019t worry \u2014 we\u2019re on the case. <a href="{status_uri}">Check our status page</a> for updates.',"client")({status_uri:TS.interop.i18n.safeString(s)});a=e(i)}else if(i.reason.OFFLINE){n=TS.interop.i18n.t('Your computer seems to be offline. We\u2019ll keep trying to reconnect, or you can <a onclick="TS.client.manualReconnectNow()">try now</a>.',"client")();a=e(i)}if(TS.model.ms_logged_in_once){$("#connection_div").html(n).removeClass("hidden resync_banner");TS.client.msg_pane.topMessagesBannerShown();a&&TS.ui.a11y.ariaLiveAnnounce(a,true)}else{$("#loading_message_attribution").empty();$("#loading_message_attribution_img").remove();$("#loading_welcome_msg").html(n)}},apiUnpaused:function e(){if(TS.model.ms_logged_in_once){$("#connection_div").html("").removeClass("resync_banner").addClass("hidden");TS.client.msg_pane.topMessagesBannerHidden()}else{$("#loading_message_attribution").empty();$("#loading_message_attribution_img").remove();$("#loading_welcome_msg").html(TS.interop.i18n.t("Trying to log in again.","client")())}},displayModelObById:function e(t,i){var n=TS.interop.utility.looksLikeMemberId(t)?TS.interop.members.getMemberById(t):TS.redux.channels.getEntityById(t);if(n)return Promise.resolve(TS.client.displayModelOb(n,i));return Promise.reject("displayModelObById: model_ob is "+n)},displayModelOb:function e(t,i){if(t.presence)return TS.ims.legacyStartImByMemberId(t.id,i&&i.from_history);if(t.is_im)return TS.ims.legacyStartImById(t.id,i&&i.from_history);if(t.is_channel)return TS.channels.legacyDisplayChannel(r()({id:t.id},_.pick(i,"from_history","replace_history_state")));if(t.is_mpim)return TS.mpims.legacyDisplayMpim(r()({id:t.id},_.pick(i,"from_history","replace_history_state")));if(t.is_group)return TS.groups.legacyDisplayGroup(r()({id:t.id},_.pick(i,"from_history","replace_history_state")))},activateMsgRateLimit:function e(t){if(TS.model.is_msg_rate_limited)return;t||(t={});TS.model.is_msg_rate_limited=true;t.notify_user&&TS.client.ui.addEphemeralBotMsg({text:TS.interop.i18n.t("To stop overzealous bots from flooding channels, Slack sets a limit on flurries of messages. You are reading this, so you are not a bot. And yet \u2014 somehow \u2014 you hit this limit.","client")(),ephemeral_type:"disconnected_feedback",slackbot_feels:"sad_surprise"})},deactivateMsgRateLimit:function e(){if(!TS.model.is_msg_rate_limited)return;TS.model.is_msg_rate_limited=false},userAddedToTeam:function e(t){var i=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];TS.info("You have been added to a team with the ID of "+t+".");if(!TS.model.is_our_app||!TS.model.is_electron)return Promise.resolve();var n=TS.redux.enterprise.getEnterpriseId();var a={user_id:TS.model.user.id,enterprise_id:n,team_ids:t};if(!TS.shared.isRelevantTeam()){TS.info("This team is not relevant, ignoring user_added_to_team for "+t+".");return Promise.resolve()}TS.info("Attempting to sign in to team with ID of "+t,a);var r=TS.interop.desktop.getSignedInTeamIds();if(!r||!r.length){TS.warn("WTF no signed-in team IDs from app?",r);return Promise.resolve()}if(-1!==r.indexOf(t)){TS.info("User is already signed into team "+t+". Exiting.");C=_.union(C,[t]);return Promise.resolve()}TS.info("calling enterprise.teams.signin for team_id = "+t,a);return TS.interop.api.call("enterprise.teams.signin",a).then(function(e){var n=e.data.teams;if(!n||!n.length){TS.warn("WTF no authed_teams from enterprise.teams.signin?");return Promise.resolve()}var a;_.each(n,function(e){if(e&&e.team_id==t){var i=document.domain.split(".").splice(1).join(".");a={name:TS.model.user.name,id:TS.model.user.id,team_id:t,team_name:e.team_name,team_url:"https://"+e.team_domain+"."+i}}});if(a){TS.info("Calling didSignIn with app_params",a);TS.interop.desktop.didSignIn(a,!i);TS.prefs.removeTeamFromEnterpriseExcludeTeamPref(t)}else TS.warn("WTF did not find matching authed team?",n)})},userRemovedFromTeam:function e(t){if(t!==TS.model.team.id){TS.info("You have been removed from the team with ID = "+t+".");return}if(TS.model._user_removed_from_team)return;TS.model._user_removed_from_team=true;TS.generic_dialog.start({body:"<p>"+TS.interop.i18n.t("You have been removed from <strong>{team_name}</strong>.","client")({team_name:TS.interop.i18n.safeString(_.escape(TS.interop.rules.teams.getTeamDisplayName(TS.model.team)))})+"</p>",show_cancel_button:false,esc_for_ok:true,go_button_text:TS.interop.i18n.t("OK","client")(),onGo:function e(){if(_.includes(C,t)){TS.info("Was going to remove this team, but we were told to add them before the user hit ok to the original removal event.");C=_.remove(C,function(e){return e===t});return}if(TS.boot_data.feature_leave_workspace_improvements)TS.client.reloadOrRemoveTeam(t);else if(TS.model.is_our_app){TS.info("calling TS.client.signOutTeam because user_removed_from_team with team_id = "+t);TS.client.signOutTeam(t)}else TS.reload(null,"user_removed_from_team with team_id = "+t)}})},reloadOrRemoveTeam:function e(t){if(TS.model.is_our_app){TS.info("calling TS.client.signOutTeam because user_removed_from_team with team_id = "+t);TS.client.signOutTeam(t)}else TS.reload(null,"user_removed_from_team with team_id = "+t)},signOutTeam:function e(t){window.TS&&window.TS.client&&TS.client.windows.closeAll();$("html").addClass("hidden");var i=$('<form method="POST" action="/account-remove-api">');$('<input type="hidden">').attr("name","team_id").attr("value",t).appendTo(i);$('<input type="hidden">').attr("name","crumb").attr("value",window.logout_crumb).appendTo(i);i.appendTo($("body"));i.submit()},activeChannelIsHidden:function e(){return TS.model.unread_view_is_showing||TS.model.threads_view_is_showing||TS.model.search_view_is_showing},setClientLoadWatchdogTimer:function e(){if(null!==w){A("www-load-watchdog-v2",y);y*=2}y<3e5&&(w=window.setTimeout(TS.client.setClientLoadWatchdogTimer,y))},test:function e(){var t={};Object.defineProperty(t,"_getFirstChannelYouAreIn",{get:function e(){return U},set:function e(t){U=t}});return t}});var e=function e(t){if(!TS.boot_data.feature_degraded_send)return"";if(t.reason.API_ERROR){if(TS.interop.desktop.isDesktop)return TS.interop.i18n.t("We\u2019re having trouble connecting to Slack. We\u2019ll try again shortly, or you can press F6 to navigate to the status banner and click try now.","client")();if(TS.model.is_mac)return TS.interop.i18n.t("We\u2019re having trouble connecting to Slack. We\u2019ll try again shortly, or you can press Cmd + F6 to navigate to the status banner and click try now.","client")();return TS.interop.i18n.t("We\u2019re having trouble connecting to Slack. We\u2019ll try again shortly, or you can press Ctrl + F6 to navigate to the status banner and click try now.","client")()}if(t.reason.SERVICE_DOWN){if(TS.interop.desktop.isDesktop)return TS.interop.i18n.t("Slack is unavailable, but don\u2019t worry \u2014 we\u2019re on the case. Press F6 to navigate to the status banner and link to our status page for updates.","client")();if(TS.model.is_mac)return TS.interop.i18n.t("Slack is unavailable, but don\u2019t worry \u2014 we\u2019re on the case. Press Cmd + F6 to navigate to the status banner and link to our status page for updates.","client")();return TS.interop.i18n.t("Slack is unavailable, but don\u2019t worry \u2014 we\u2019re on the case. Press Ctrl + F6 to navigate to the status banner and link to our status page for updates.","client")()}if(t.reason.OFFLINE){if(TS.interop.desktop.isDesktop)return TS.interop.i18n.t("Your computer seems to be offline. We\u2019ll keep trying to reconnect, or you can press F6 to navigate to the status banner and click try now.","client")();if(TS.model.is_mac)return TS.interop.i18n.t("Your computer seems to be offline. We\u2019ll keep trying to reconnect, or you can press Cmd + F6 to navigate to the status banner and click try now.","client")();return TS.interop.i18n.t("Your computer seems to be offline. We\u2019ll keep trying to reconnect, or you can press Ctrl + F6 to navigate to the status banner and click try now.","client")()}};var t=function e(t){if(t.id!==TS.model.active_channel_id&&t.id!==TS.model.active_group_id)return;if(TS.client.activeChannelIsHidden())return;TS.client.channelDisplaySwitched({id:t.id,replace_history_state:true})};var i=function e(t){if(!t||t.id!=TS.model.user.id)return;var i;i=t.is_ultra_restricted?TS.interop.i18n.t("Your account permissions have changed! You are now a single-channel guest of the workspace. You must now reload for the changes to take effect.","client")():t.is_restricted?TS.interop.i18n.t("Your account permissions have changed! You are now a multi-channel guest of the workspace. You must now reload for the changes to take effect.","client")():TS.interop.i18n.t("Your account permissions have changed! You are now a full member of the workspace. You must now reload for the changes to take effect.","client")();TS.generic_dialog.start({title:TS.interop.i18n.t("Reload required","client")(),body:"<p>"+i+"</p>",show_cancel_button:false,esc_for_ok:true,go_button_text:TS.interop.i18n.t("Reload","client")(),onGo:function e(){TS.reload()}})};var n=function e(t){if(TS.model.active_im_id&&t&&t.id){var i=TS.redux.channels.getImByMemberId(t.id);if(!i||i.id!=TS.model.active_im_id)return;TS.client.channelDisplaySwitched({id:i.id,replace_history_state:true})}else if(TS.model.active_mpim_id&&t&&t.id){var n=TS.interop.channels.getMpimById(TS.model.active_mpim_id);if(!n||!t)return;var a=TS.interop.membership.getCachedChannelMembershipInfoForUser(n.id,t.id);var r=a.is_known&&!a.is_member;if(r)return;TS.client.channelDisplaySwitched({id:n.id,replace_history_state:true})}};var a=function e(){TS.shared.legacyCheckForOldImsToClose()};var s=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;var n=t||TS.qs_args.open;var a=i||TS.qs_args.section;if(!n)return;switch(n){case"create_channel":(TS.redux.socket.isConnected()||TS.model.change_channels_when_offline)&&(TS.permissions.members.canCreateChannels()||TS.permissions.members.canCreateGroups())&&TS.ui.new_channel_modal.start();break;case"invite_members":TS.permissions.members.canUserInviteToWorkspace()&&TS.ui.admin_invites.start();break;case"help":TS.help_modal.start();break;case"channel_membership":TS.client.channel_page.members_dialog.show(TS.shared.legacyGetActiveModelOb());break;case"notifications":TS.ui.prefs_dialog.start("notifications");break;case"preferences":TS.ui.prefs_dialog.start(a);break;case"browse_channels":TS.ui.channel_browser.start();break;default:break}var r=TS.interop.url.removeUrlQueryStringValue(location.href,"open");r=TS.interop.url.removeUrlQueryStringValue(r,"section");S(r,true)};var o=function e(t,i,n,a){var r;var s;var o=t;var l=document.getElementById(o);var c="data-app-key";if(l)return;s=document.getElementsByTagName("head");s=s&&s[0]?s[0]:document.body;r=document.createElement("script");r.setAttribute("async",true);i&&r.setAttribute(c,i);r.id=o;r.src=n;s?s.appendChild(r):TS.logError&&TS.logError({message:a},"No target_node for TS.client._dynamicallyLoadJS")};var l=function e(){if(window.BoxSelect||!TS.prefs.getPref("box_enabled")||!boot_data.box_js_url)return;var t="boxjs";var i=boot_data.box_app_key;var n=boot_data.box_js_url;var a="_boxEnabledChanged: Could not append box script node";o(t,i,n,a)};var c=function e(){if(window.Dropbox)return;if(!TS.prefs.getPref("dropbox_enabled"))return;if(!boot_data.dropbox_js_url)return;var t="dropboxjs";var i=boot_data.dropbox_app_key;var n=boot_data.dropbox_js_url;var a="_dropboxEnabledChanged: Could not append dropbox script node";o(t,i,n,a)};var d=function e(){var t;var i;var n=$(".show_when_ce_enabled");var a=$(".show_when_ce_disabled");var r=$(".js_compliance_export_start");if(TS.prefs.getTeamPref("compliance_export_start")){r.html(TS.interop.datetime.toDate(TS.prefs.getTeamPref("compliance_export_start")));n.removeClass("hidden");a.addClass("hidden")}else{n.addClass("hidden");a.removeClass("hidden")}t=TS.shared.legacyGetActiveModelOb();if(!t)return;i=TS.interop.members.getMemberById(t.user);if(!i)return;m(t,i)};var u=function e(t){var i=TS.shared.legacyGetActiveModelOb();if(!i||!i.is_im)return;var n=_(t).map("member").find({id:i.user});if(!n)return;m(i,n)};var m=function e(t,i){if(!i||!t||!t.is_im||t.user!==i.id)return;$("#im_meta").html(TS.templates.dm_badge({member:i,model_ob:t,compliance_exports_enabled_for_team:!!TS.prefs.getTeamPref("compliance_export_start")}))};var f=function e(){if(TS.prefs.getTeamPref("disallow_public_file_urls")){$(".file_public_link").remove();$("#file_public_link_revoker").remove()}};var h=function e(){setInterval(function(){TS.redux.socket.isConnected()&&TS.shared.legacyCheckForOldImsToClose();TS.utility.msgs.checkForMsgsToTruncate()},9e5)};var p=function e(){TS.ui.fs_modal.is_showing&&TS.ui.fs_modal.close();TS.ui.jumper.is_showing&&TS.ui.jumper.end();var t=history.location||document.location;TS.qs_args=TS.interop.url.queryStringParse(t.search.substring(1));var i=TS.utility.isUnreadViewPath(t.pathname);var n=TS.utility.isThreadsViewPath(t.pathname);var a=TS.client.ui.search_in_react.primarySearchIsEnabled()&&TS.utility.isSearchViewPath(t.pathname);var r=TS.utility.getFlexNameFromUrl(t.href);var s=TS.utility.getFlexExtraFromUrl(t.href);if(i||n||TS.model.ui_state.flex_name||!TS.model.ui_state.details_tab_active){r=TS.model.ui_state.flex_name;s=TS.model.ui_state.flex_extra}else{r="details";s=""}if((i||n)&&"details"===r){r="";s=""}var o=TS.utility.getChannelNameFromUrl(t.href);var l=o.split(":");o=l[0];var c=l.length>1?l[1]:"";if(!TS.model.channels)return;var d;var u;var _;var m;var f;var h;var p=false;var g=false;_=TS.redux.channels.getEntityById(o,g);if(_){d=_.id;_.is_im?u=_:_.is_mpim?h=_:_.is_channel?m=_:_.is_group&&(f=_)}if(!d&&o){m=TS.redux.channels.getChannelByName(o);!m||TS.interop.rules.channels.isMpim(m)&&!m.is_open||(d=m.id)}TS.info("_onPopState\nc_extra from new url:"+c+"\nflex_name from new url:"+r+"\nflex_extra from new url:"+(s?"[redacted]":"null"));if(d){p=true;TS.info("c_name from new url is good, using id = "+d)}else if(!i&&!n&&!a){if(TS.model.channels.length){m=U();if(m){d=m.id;TS.info("got getFirstChannelYouAreIn:"+d)}}if(!d&&TS.model.ims.length){u=TS.ims.getFirstOpenIm();if(u){d=u.id;TS.info("got getFirstOpenIm:"+d)}}}u?TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:u.id,from_history:true,cancelUnsavedEdits:true})):m?TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:m.id,from_history:true,replace_history_state:!p,cancelUnsavedEdits:true})):f?TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:f.id,from_history:true,replace_history_state:!p,cancelUnsavedEdits:true})):h?TS.redux.dispatch(TS.interop.actions.displayModelOrViewById({id:h.id,from_history:true,replace_history_state:!p,cancelUnsavedEdits:true})):i?TS.client.unread.showUnreadView(true,true):n?TS.client.threads.showThreadsView(true,true):a?TS.client.ui.search_in_react.startPrimarySearch(true,true):TS.error("WTF DONT KNOW WHAT TO DO");TS.client.ui.flex.setFlexStateFromHistory(r,s);var T=function(){if(i)return"/unreads";if(n)return"/threads";if(a)return"/search";return"/messages/"+o}();var v=TS.utility.refashionUrl(window.location.href,T,r,s);var b=true;S(v,b)};var g=function e(){if(!TS.model.initial_cid){TS.error("TS.model.initial_cid was empty when _switchToInititalModelOb was called, which should be impossible");return}var t=false;var i=TS.redux.channels.getEntityById(TS.model.initial_cid,t);i||TS.error("TS.model.initial_cid ("+TS.model.initial_cid+") referred to a channel that does not exist in _switchToInititalModelOb, which should be impossible");var n=true;i.is_im?i.is_open?TS.client.channelDisplaySwitched({id:i.id,replace_history_state:n}):TS.ims.legacyStartImByMemberId(i.user,n):i.is_mpim&&i.is_group?TS.mpims.legacyDisplayMpim({id:i.id,replace_history_state:n}):i.is_group&&!i.is_mpim?TS.groups.legacyDisplayGroup({id:i.id,replace_history_state:n}):i.is_channel&&TS.client.channelDisplaySwitched({id:i.id,replace_history_state:n});if(TS.model.initial_unread_view&&TS.prefs.getPref("enable_unread_view")){var a=true;TS.client.unread.showUnreadView(false,n,a)}TS.model.initial_threads_view&&TS.client.threads.showThreadsView(false,n);TS.client.ui.search_in_react.primarySearchIsEnabled()&&TS.model.initial_search_view&&TS.client.ui.search_in_react.startPrimarySearch(false,n)};var T=function e(t){if(!t)return t;-1!=t.indexOf("#")&&(t=t.replace(/#/g,"%23"));-1!=t.indexOf("/")&&(t=t.replace(/\//g,"%252F"));return t};var S=function e(t,i){if(!history.pushState){TS.warn("This browser does not support pushState.");return}window.location.href.replace(/%20/g," ")!==t.replace(/%20/g," ")&&(i?window.history.replaceState(null,null,t):window.history.pushState(null,null,t))};var v=function e(){if(TS.model.initial_cid){TS.client.calculateInitialMessage();return}var t=TS.storage.fetchActiveHistory();var i=false;var n;var a;var r;var s;var o;var l=function e(){if(TS.model.welcome_model_ob&&TS.model.welcome_model_ob.id)return;var t=TS.redux.channels.getImByMemberId("USLACKBOT");if(t)TS.model.welcome_model_ob=t;else{TS.error("Tried to lookup Slackbot but failed");TS.interop.api.callExpedited("conversations.open",{users:"USLACKBOT"}).finally(function(){var e=TS.interop.i18n.t("Slack has encountered a problem and needs to reload.","client")();var t=TS.interop.i18n.t("Reload required","client")();var i=TS.interop.i18n.t("Reload","client")();return TS.generic_dialog.alert(e,t,i)}).then(function(){TS.reload()})}};!window.location.pathname.match(/^\/(message|unreads|threads|search|app-space|dashboard)/)&&window.history&&window.history.replaceState(null,null,window.location.origin+"/messages");l();for(a=0;a<t.length;a+=1){n=t[a];if(TS.model.active_history.indexOf(n)>-1)continue;o=TS.redux.channels.getEntityById(n,i);if(!o)continue;o.is_im&&o.is_open?TS.model.active_history.push(n):o.is_mpim&&o.is_open?TS.model.active_history.push(n):o.is_group&&!o.is_archived?TS.model.active_history.push(n):!o.is_channel||o.is_archived||TS.model.user.is_restricted||TS.model.active_history.push(n)}TS.model.c_name_in_url=TS.utility.getChannelNameFromUrl(location.href);var c=TS.model.c_name_in_url;var d=TS.utility.isUnreadViewPath(location.pathname);var u=TS.utility.isThreadsViewPath(location.pathname);var m=TS.utility.isSearchViewPath(location.pathname);d&&(TS.model.initial_unread_view=true);u&&(TS.model.initial_threads_view=true);m&&(TS.model.initial_search_view=true);var f=function e(){if(c){r=TS.redux.channels.getChannelByName(c);if(r)return r.id;if(TS.redux.channels.getEntityById(c,i))return c}if(TS.model.active_history.length){n=TS.model.active_history[TS.model.active_history.length-1];o=TS.redux.channels.getEntityById(n,i);if(o)return n}var t;if(TS.model.user.is_restricted){var l=TS.model.channels;l.sort(function(e,t){if(e._name_lc>t._name_lc)return 1;if(t._name_lc>e._name_lc)return-1;return 0});for(a=0;a<l.length;a+=1){r=l[a];if(r.is_archived)continue;if(!r.is_member)continue;return r.id}var d=TS.model.groups;d.sort(function(e,t){if(e._name_lc>t._name_lc)return 1;if(t._name_lc>e._name_lc)return-1;return 0});for(a=0;a<d.length;a+=1){s=d[a];if(d.is_archived)continue;return s.id}t=TS.redux.channels.getImByMemberId("USLACKBOT");if(t)return t.id}else{if(TS.model.user.is_primary_owner&&!TS.prefs.getPref("newxp_seen_last_message")){t=TS.redux.channels.getImByMemberId("USLACKBOT");if(t)return t.id}var u=TS.interop.channels.getGeneralChannel();if(u)return u.id;TS.info("No general channel?! Known channel IDs:",_.map(TS.model.channels,"id"));var m=TS.redux.channels.getImByMemberId("USLACKBOT");if(m){TS.info("Using IM with Slackbot ("+m.id+") as our initial model object");return m.id}}alert(TS.interop.i18n.t("ERROR could not find starting channel","client")())};TS.model.initial_cid=f();if(!TS.model.initial_cid){var h="TS.client.calculateInitialCid() failed to find a channel";TS.error(h);throw new Error(h)}TS.client.calculateInitialMessage()};var b=function e(){if(TS.model.initial_msg_ts)return;TS.model.initial_msg_ts=TS.utility.getMessageTimestampFromUrl(location.href);TS.model.initial_thread_ts=TS.qs_args.thread_ts};var w=null;var y=1e4;var A=function e(t,i){};var k=function e(t){window.clearTimeout(w);if(!window.performance)return;if(!performance.timing)return;A(t,Date.now()-window.performance.timing.navigationStart)};var C=[];var x=4;var I=function e(){var t=100;var i=TS.boot_data.page_needs_enterprise?"W":"U";var n=_.map(TS.model.members,"id");_(TS.ui.frecency.getMostCommonWithPrefix(i,t)).map("id").difference(n).map(function(e){return TS.interop.members.getMemberById(e)}).value()};var M=void 0;var E=void 0;var B=function e(t){setTimeout(function(){if(M){M();M=void 0}TS.interop.api.call("api.statusSite").then(function(t){var i=t.data;if(!i)return;if(i.fetch){var n=$('<iframe src="https://status.slack.com" class="hidden">').appendTo(document.body);M=function e(){n.remove();M=void 0;clearTimeout(E);E=void 0};E=setTimeout(M,6e4)}if(i.delay){var a=1e3*_.random(i.delay[0],i.delay[1]);e(a)}}).catch(_.noop)},t)};var P=function e(){var t=6e5;B(t)};var U=function e(){var t=TS.model.channels;if(!t)return null;return _.find(t,"is_member")};function D(){var e;(e=TS.console).info.apply(e,["DM_DEEPLINK"].concat(Array.prototype.slice.call(arguments)))}})();var s=i(3029);var o=i(3030);var l=i(3031);var c=i(3032);var d=i(3033);var u=i(3034);var m=i(3035);var f=i(3036);var h=i(3037);var p=i(3038);var g=i(3039);(function(){TS.registerModule("client.ui",{test:function e(){var t={_getMemberSharedTeamsContext:I};Object.defineProperty(t,"_displayUserGroupInFlight",{get:function e(){return w},set:function e(t){w=t}});return t},CLIENT_HEADER_OVERHANG:8,CLIENT_LINE_HEIGHT:16,POSSIBLE_REBUILD_OMISSIONS:["channel_header","user_current_status","channel_pane_channels","channel_pane_apps","channel_pane_ims","channel_pane_starred"],$msgs_scroller_div:$("#msgs_scroller_div"),$msgs_div:$("#msgs_div"),$msg_input:$("#msg_input"),$emo_menu:null,$banner:$("#banner"),$msgs_unread_divider:null,file_dropped_sig:new signals.Signal,file_pasted_sig:new signals.Signal,did_rebuild_all_sig:new signals.Signal,did_rebuild_all_but_msgs_sig:new signals.Signal,msgs_scrolled_sig:new signals.Signal,onStart:function t(){TS.channels.data_updated_sig.add(T);TS.ui.window_focus_changed_sig.add(TS.client.ui.windowFocusChanged);TS.membership.membership_counts_need_refetch_sig.add(TS.client.ui.rebuildMemberListToggle);TS.channels.joined_sig.add(TS.client.ui.rebuildMemberListToggle);TS.channels.switched_sig.add(TS.client.ui.channelOrImOrGroupDisplaySwitched);TS.ims.switched_sig.add(TS.client.ui.channelOrImOrGroupDisplaySwitched);TS.groups.switched_sig.add(TS.client.ui.channelOrImOrGroupDisplaySwitched);TS.mpims.switched_sig.add(TS.client.ui.channelOrImOrGroupDisplaySwitched);TS.prefs.color_names_in_list_changed_sig.add(TS.client.ui.prefColorNamesInListChanged);TS.prefs.team_display_email_addresses_changed_sig.add(y);TS.prefs.team_allow_calls_changed_sig.add(b);TS.user_groups.updated_info_sig.add(TS.client.ui.previewUserGroup);TS.view.members.unknown_resolution_rebuild_sig.add(function(){TS.model.ui_state.flex_extra&&Q(TS.model.ui_state.flex_extra)});TS.view.channel.unknown_resolution_rebuild_sig.add(function(){TS.model.ui_state.flex_extra&&Q(TS.model.ui_state.flex_extra)});TS.boot_data.feature_legacy_cfm&&TS.redux.socket.connectedSig.add(H);setInterval(D,15e3);e=new TS.PresenceList;$("html").bind("mousedown",function(){TS.model.ui.is_mouse_down=true;TS.interop.SocketManager.maybeTickleMS()});$("html").bind("dragend",function(){TS.model.ui.is_mouse_down=false});$("html").bind("mouseup",function(){TS.model.ui.is_mouse_down=false});TS.client.login_sig.add(TS.client.ui.loggedIn,TS.ui);TS.client.msg_input.bind(TS.client.ui.$msg_input);function i(){TS.client.ui.enhanceComponents();TS.client.ui.bindCommentInput();$(window.document).keydown(TS.client.ui.onWindowKeyDown).keyup(TS.client.ui.onWindowKeyUp);$("#team_menu .notifications_menu_btn").bind("click",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;TS.menu.startWithNotificationsMenu(e)});$("#team_menu").bind("click",function(e){if(TS.client.ui.shouldIgnoreClick(e))return false;if($(e.target).closest(".notifications_menu_btn_react").length)return;if($(e.target).closest(".notifications_menu_btn").length)return false;TS.interop.clog.track("GLOBAL_NAV",{contexts:{ui_context:{action:"CLICK",ui_component:"GLOBAL_NAV",ui_element:"NAV_TEAM_MENU"}}});TS.menu.startWithTeamAndUser(e)});$("#file_comment_form").bind("submit",function(){TS.client.ui.files.submitFileComment();return false});$(window).on("click",g);TS.qs_args.ignore_mm||$("#header, #footer, #col_channels, #client_body, #col_flex").on("mouseenter",g);var e="ontouchstart"in document.documentElement;e?$("html").addClass("touch"):$("html").addClass("no_touch");TS.client.archives.$scroller.scroll(function(){TS.model.ui.cached_archive_scroll_result=null});TS.client.ui.$msgs_scroller_div.scroll(function(){TS.model.ui.cached_msgs_scroll_result=null});var t=_.throttle(function(e){var t=$(e.target);if(!t.closest("body").length)return;var i=t.closest("button");var n=i.attr("data-emoji");if(!n||!n.length)return;var a=t.closest(".rxn_panel").data("rxnKey");var r=TS.rxns.getExistingRxnsByKey(a);var s=_.find(r,{name:n});var o=s.users;var l={count:s.count,user_reacted:TS.rxns.doesRxnsHaveRxnFromUser(r,n),name:n,url:s.url,rxn_key:a,member_ids:o};TS.tips.updateTipTitle(i,TS.interop.i18n.t("Loading members\u2026","client")());TS.interop.members.ensureMembersArePresent(o).then(function(){var e=TS.templates.builders.buildRxnTitle(l,true);TS.tips.updateTipTitle(i,e)}).catch(function(e){TS.console.logError(e,"couldnt_load_reactors","unknown_member_error",false);TS.tips.updateTipTitle(i,TS.interop.i18n.t("Couldn\u2019t load members","client")())})},300);$("BODY").delegate(".rxn_panel button","mouseover",t);$(window).on("copy cut",function(e){if(TS.utility.isFocusOnInput()){var t=document.activeElement;if(!TS.interop.utility.isContentEditableElement(t))return}try{var i=window.getSelection();var n;var a=TS.format.formatSelection(i,{customFn:function e(t){if(t.hasAttribute("data-member-id"))return t.getAttribute("data-member-label")||t.getAttribute("data-member-id");if(t.hasAttribute("data-user-group-id"))return t.getAttribute("data-stringify-text");if(t.hasAttribute("data-broadcast-id"))return t.getAttribute("data-stringify-text")}});var r;r=TS.format.formatSelection(i,{customFn:function e(t){if(t.hasAttribute("data-member-id"))return"<@"+t.getAttribute("data-member-id")+"|"+t.getAttribute("data-member-label")+">";if(t.hasAttribute("data-user-group-id"))return"<@"+t.getAttribute("data-user-group-id")+"|"+t.getAttribute("data-stringify-text")+">";if(t.hasAttribute("data-broadcast-id"))return"<@"+t.getAttribute("data-broadcast-id")+"|"+t.getAttribute("data-stringify-text")+">"}});if($(e.target).closest(".ql-editor").length){var s=$(e.target).closest(".ql-editor");var o=TS.utility.contenteditable.cursorPosition(s);var l=TS.utility.contenteditable.getContentsForRange(s,o.start,o.length);a=TS.interop.texty.convertContentsToStringForDisplay({contents:l.ops});n=JSON.stringify(l)}if(!a)return;var c={"text/plain":a,text:a,"public.utf8-plain-text":a,Text:a};n&&(c["slack/texty"]=n);r&&(c["slack/plain"]=r);TS.clipboard.writeTextFromEvent(e,c)}catch(e){TS.error("window copy handler error: "+e)}})}TS.has_pri[P]&&TS.log(P,"deferring UI bind until login_sig");TS.client.login_sig.add(i);TS.interop.setAppElementForReactModal();TS.interop.mountMessagePane(TS.boot_data.team_id,document.querySelector(".p-history_container"));TS.boot_data.feature_message_spacing&&$("html").addClass("feature_message_spacing");L();var n=document.getElementById("modal_container_mount_point");TS.interop.modalContainer.mountModalContainer(TS.boot_data.team_id,n);if(TS.useGlobalNav()){var a=document.getElementById("legacy_global_nav_mount_point");TS.interop.globalNav.mountGlobalNav(TS.boot_data.team_id,a)}if(TS.useGlobalNav()&&TS.boot_data.feature_global_nav_layout){TS.interop.globalNav.mountGlobalNavChannel(TS.boot_data.team_id,document.getElementById("legacy_global_nav_channel_mount_point"));TS.interop.globalNav.mountGlobalNavFlex(TS.boot_data.team_id,document.getElementById("legacy_global_nav_flex_mount_point"))}$("BODY").on("mouseover",".current_status_with_expiration",TS.client.ui.rebuildCustomStatusExpirationInTooltip)},spaces_tooltip:{state:"hide",pending_change:null},loggedIn:function e(){if(TS.isPartiallyBooted()){TS.boot_data.feature_degraded_send?TS.ensureFullyBooted().then(TS.client.ui.loggedIn):TS.redux.socket.connectedSig.addOnce(TS.client.ui.loggedIn);TS.model.ui_state.flex_name&&TS.client.ui.flex.showFlex();$("#main_emo_menu").removeClass("hidden").bind("click.incremental_boot",function(e){e.preventDefault();TS.incremental_boot.userDidInteractWithUI()});return}TS.client.ui.flex.setFlexStateFromHistory(TS.model.ui_state.flex_name,TS.model.ui_state.flex_extra,true);if(TS.model.ui_state.flex_name){TS.client.flexDisplaySwitched(TS.model.ui_state.flex_name,TS.model.ui_state.flex_extra,true);TS.client.ui.flex.showFlex()}$("#main_emo_menu").removeClass("hidden").off("click.incremental_boot").bind("click.open_dialog",function(e){TS.client.msg_input.removePrecedingAtSign();TS.ui.react_emoji_menu.start({e:e,input_to_fill:TS.client.ui.$msg_input,offset_y:4});TS.interop.clog.track("PFP_ACTION",{contexts:{growth:{action:"click",trigger:"emoji_menu_button"}}})});window.extraCmds&&window.extraCmds();G()},rebuildAllButMsgs:function e(a,r){a=a||{};if(r){TS.client.ui.POSSIBLE_REBUILD_OMISSIONS.forEach(function(e){a[e]||(n[e]=false)});i+=1;if(t)return;c(n);t=true;setTimeout(function(){t=false;if(i>1){c(n);TS.metrics.count("rebuild_all_but_msgs_throttles",i)}i=0;n={}},1e3)}else c(n)},rebuildAll:function e(t){if(t){TS.utility.enableFeatureForUser(10)&&TS.statsd.count("client_rebuild_throttled");s+=1;if(a)return;d();a=true;setTimeout(function(){a=false;if(s>1){d();TS.metrics.count("rebuild_all_throttles",s)}s=0},1e3)}else d()},windowFocusChanged:function e(t){if(t){TS.interop.SocketManager.maybeTickleMS();TS.model.ui.is_mouse_down=false}},cal_key_checker:{tim:null,tim_ms:200,prevent_enter:false,space_pressed_last:false,reset:function e(){clearTimeout(TS.client.ui.cal_key_checker.tim);TS.client.ui.cal_key_checker.space_pressed_last=false;TS.client.ui.cal_key_checker.prevent_enter=false},check:function e(t){if(TS.client.ui.cal_key_checker.space_pressed_last&&32!=t){TS.client.ui.cal_key_checker.reset();if(73==t){TS.client.ui.cal_key_checker.prevent_enter=true;TS.client.ui.cal_key_checker.tim=setTimeout(TS.client.ui.cal_key_checker.reset,TS.client.ui.cal_key_checker.tim_ms)}}else if(32==t){TS.client.ui.cal_key_checker.reset();TS.client.ui.cal_key_checker.space_pressed_last=true;TS.client.ui.cal_key_checker.tim=setTimeout(TS.client.ui.cal_key_checker.reset,TS.client.ui.cal_key_checker.tim_ms)}else TS.client.ui.cal_key_checker.reset()}},keyPressIsValidForFocusOnNextOrPreviousMessage:function e(t){if(!t)return false;var i=TS.utility.keymap;var n=-1!==[i.left_square_bracket,i.right_square_bracket,i.minus_sign,i.equals_sign].indexOf(t.which);var a=t.altKey&&TS.interop.utility.isCmdKey(t);return n&&a&&TS.client.ui.isUserAttentionOnChat()&&!TS.client.activeChannelIsHidden()},keyPressIsValidForGotoNextOpenChannelOrIM:function e(t){var i=TS.utility.keymap;if(!t)return false;if(!t.altKey)return false;if(t.which!=i.up&&t.which!=i.down)return false;if(!TS.client.ui.isUserAttentionOnChat())return false;if(TS.utility.isFocusOnInput()){var n=$(document.activeElement);var a=TS.utility.contenteditable.getLength(n);if(a){var r=TS.utility.contenteditable.isTextSelected(n);if(r)return false;var s=TS.utility.contenteditable.cursorPosition(n).start;if(t.which==i.up&&0!==s)return false;if(t.which==i.down&&s!=a)return false}}return true},page_scroll_dest:null,onWindowKeyDown:function e(t){if(TS.isPartiallyBooted()){if(TS.interop.utility.isCmdKey(t)){t.preventDefault();t.stopPropagation()}return}o=false;if(TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1){var i=16===t.keyCode?" SHIFT":"";var n=27===t.keyCode?" ESC":"";var a=t.shiftKey?" shiftKey":"";var r=t.metaKey?" metaKey":"";var s=t.ctrlKey?" ctrlKey":"";TS.interop.console.action("CLIENT-UI","Window key down handler (isUserAttentionOnChat: "+TS.client.ui.isUserAttentionOnChat()+")"+i+n+a+r+s);if(t.keyCode!==t.which){TS.interop.console.action("CLIENT-UI","e.keyCode not matching e.which");16===t.which&&TS.interop.console.action("CLIENT-UI","e.which SHIFT");27===t.which&&TS.interop.console.action("CLIENT-UI","e.which ESC")}t.originalEvent&&t.originalEvent.code&&"Escape"===t.originalEvent.code&&TS.interop.console.action("CLIENT-UI","e.originalEvent.code Escape")}var l=Date.now();var c=TS.utility.keymap;var d=t.which==c.enter;TS.model.last_key_down_e=t;TS.client.ui.cal_key_checker.check(t.which);var u=TS.key_triggers.getFromCode(t.which);if(!TS.client.ui.isUserAttentionOnChat()||!u||u.isDisabled&&u.isDisabled(t)||(!t.metaKey||t.ctrlKey&&TS.model.is_mac)&&(!t.ctrlKey||t.altKey||TS.model.is_mac)||!(!u.no_shift&&(t.shiftKey||u.shift_optional)||u.no_shift&&!t.shiftKey))if(TS.boot_data.feature_a11y_keyboard_shortcuts&&TS.client.ui.keyPressIsValidForFocusOnNextOrPreviousMessage(t)){t.preventDefault();t.stopPropagation();TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window a11y message focus handler (feature_a11y_keyboard_shortcuts: "+TS.boot_data.feature_a11y_keyboard_shortcuts+", valid: "+TS.client.ui.keyPressIsValidForFocusOnNextOrPreviousMessage(t)+", which: "+t.which+")");switch(t.which){case c.left_square_bracket:TS.ui.a11y.focusOnPreviousMessage();break;case c.right_square_bracket:TS.ui.a11y.focusOnNextMessage();break;case c.minus_sign:TS.ui.a11y.focusOnOldestUnreadMessage();break;case c.equals_sign:TS.ui.a11y.focusOnMessageInput();break;default:break}}else if(!TS.client.ui.isUserAttentionOnChat()||TS.client.activeChannelIsHidden()||TS.utility.isFocusOnInput()||!TS.interop.utility.isCmdKey(t)||t.altKey||t.which!=c.up)if(!TS.client.ui.isUserAttentionOnChat()||t.which!=c.left_square_bracket&&t.which!=c.right_square_bracket&&t.which!=c.left&&t.which!=c.right)if((TS.client.ui.isUserAttentionOnChat()||TS.ui.shortcuts_dialog.showing||TS.ui.keyboard_shortcuts_prompt.showing)&&t.which==TS.interop.i18n.keyCodeEquivalent(TS.utility.keymap.slash,{kb:TS.i18n.keyboard(),featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR})&&!t.altKey&&!t.shiftKey&&TS.interop.utility.isCmdKey(t)){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window keyboard shortcut handler");TS.ui.keyboard_shortcuts_prompt.showing&&TS.generic_dialog.cancel();TS.redux.dispatch(TS.interop.actions.toggleKeyboardShortcuts());t.preventDefault()}else if(TS.client.ui.isUserAttentionOnChat()&&t.which==TS.interop.i18n.keyCodeEquivalent(TS.utility.keymap.period,{kb:TS.i18n.keyboard(),featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR})&&!t.shiftKey&&!t.altKey&&TS.interop.utility.isCmdKey(t)){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window toggle flexpane handler");"whats_new"===TS.model.ui_state.flex_name&&TS.interop.clog.track("WHATSNEW_ACTION",{action:"close_pane",trigger:"keyboard_cmd_dot",step:TS.client.whats_new.getNewestID()});TS.client.ui.flex.toggleFlex();t.preventDefault()}else if(TS.client.ui.isUserAttentionOnChat()&&TS.interop.utility.isCmdKey(t)&&t.shiftKey&&(75==t.which||84==t.which&&TS.model.is_our_app)){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window quickswitcher handler");if(TS.ui.fs_modal.is_showing)TS.ui.fs_modal.close();else{84==t.which?TS.client.threads.showThreadsView():TS.ui.im_browser.start();t.preventDefault()}}else if(t.which==c.space){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window space scrolling handler");TS.prefs.prefs_loaded&&TS.prefs.getPref("pagekeys_handled")&&!TS.utility.isFocusOnInput()&&TS.model.is_FF&&TS.client.ui.$msgs_scroller_div.focus()}else if(t.which==c.esc){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window escape handler");TS.client.ui.onEscKey(t)}else{if(TS.utility.isPageKey(t.which)&&TS.prefs.prefs_loaded&&TS.prefs.getPref("pagekeys_handled")&&!t.shiftKey&&!t.ctrlKey&&!t.altKey&&!t.metaKey){if(TS.model.unread_view_is_showing||TS.model.threads_view_is_showing)return;var _=t.target;var m=$("#col_flex")[0].contains(_);var f=$(".client_channels_list_container")[0].contains(_);var p=TS.utility.contenteditable.isActiveElement(_);if((m||f)&&!p)return;return}if(TS.utility.isFocusOnInput()||!TS.client.ui.isUserAttentionOnChat()||TS.client.activeChannelIsHidden()||TS.utility.isArrowKey(t.which)||TS.utility.isPageKey(t.which)||t.metaKey||t.ctrlKey||t.altKey||TS.ui.react_emoji_menu.is_showing)if(window.desktop&&!TS.utility.isFocusOnInput()&&TS.client.ui.isUserAttentionOnChat()&&!TS.client.activeChannelIsHidden()&&t.which==c.V&&!t.altKey&&TS.interop.utility.isCmdKey(t)){var g;var T;var S=window.desktop;if(S.clipboard&&S.clipboard.readString&&S.clipboard.readImage)if(TS.boot_data.feature_file_threads){T=S.clipboard.readImage();if(T){TS.ui.paste.startUploadFromMacSSBReadImage(T,t.shiftKey);t.preventDefault()}else{g=S.clipboard.readString();if(g){TS.client.msg_input.populate(TS.utility.contenteditable.value(TS.client.ui.$msg_input)+g);t.preventDefault()}}}else{g=S.clipboard.readString();if(g){TS.client.msg_input.populate(TS.utility.contenteditable.value(TS.client.ui.$msg_input)+g);t.preventDefault()}else{T=S.clipboard.readImage();if(T){TS.ui.paste.startUploadFromMacSSBReadImage(T,t.shiftKey);t.preventDefault()}}}TS.view.focusMessageInput()}else(!TS.model.archive_view_is_showing||t.which!=c.enter||t.metaKey||t.ctrlKey||t.altKey)&&(TS.client.ui.isUserAttentionOnChat()&&d&&t.shiftKey&&TS.interop.utility.isCmdKey(t)?TS.client.msg_input.startSnippet():TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","onWindowKeyDown Did not match any if cases"));else{if(t.keyCode==c.shift||t.which==c.tab)return;if($(t.target).hasClass("focus-ring")&&d){if("BUTTON"==t.target.tagName&&bowser&&bowser.msedge){t.preventDefault();t.target.click()}return}if(TS.model.archive_view_is_showing&&d){TS.client.archives.tryToJoin();return}if(d)return;if(TS.model.is_our_app&&t.keyCode===c.f6)return;TS.interop.i18n.isLocaleCJK?setTimeout(TS.view.focusMessageInput,0):TS.view.focusMessageInput()}}else{TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window navigate history handler");h(t)}else{TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window edit last message handler");TS.client.ui.maybeEditLast(t)}else{t.preventDefault();t.stopPropagation();TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","Window key_triggers handler (which: "+t.which+")");TS.model.ms_logged_in_once&&TS.prefs.prefs_loaded&&!$("body").hasClass("loading")&&u.func(t)}TS.model.profiling_keys&&TS.model.addProfilingKeyTime("onWindowKeyDown",Date.now()-l);(t.which==c.shift||t.shiftKey)&&(TS.model.shift_key_pressed=true);t.which==c.insert&&(TS.model.insert_key_pressed=true);(t.which==c.alt||t.altKey)&&(TS.model.alt_key_pressed=true);t.shiftKey&&t.metaKey&&t.which!=c.V&&(TS.model.shift_key_pressed=false)},onWindowKeyUp:function e(t){TS.model.last_key_down_e=null;var i=TS.utility.keymap;t.which==i.shift&&(TS.model.shift_key_pressed=false);t.which==i.insert&&(TS.model.insert_key_pressed=false);if(t.which==i.alt&&!t.ctrlKey&&!o){TS.model.alt_key_pressed=false;TS.utility.isFocusOnInput()||TS.selection.isAnyTextSelected()||TS.ui.fs_modal.is_showing||TS.view.focusMessageInput()}o=bowser.mac&&t.which==i.ctrl&&t.altKey},onEscKey:function e(t){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&(t.shiftKey?TS.interop.console.action("CLIENT-UI","Escape handler with shift key modifier",JSON.stringify({fullscreenElement:document.fullscreenElement,isDefaultPrevented:t.isDefaultPrevented(),unread_view_is_showing:TS.model.unread_view_is_showing,archive_view_is_showing:TS.model.archive_view_is_showing,editing:TS.msg_edit.editing,react_emoji_menu_is_showing:TS.ui.react_emoji_menu.is_showing},null,"\t")):TS.interop.console.action("CLIENT-UI","Escape handler"));if(document.fullscreenElement instanceof HTMLVideoElement)return;if(TS.boot_data.feature_file_threads&&t.isDefaultPrevented())return;var i=t.shiftKey;try{t.stopPropagation()}catch(e){}try{t.preventDefault()}catch(e){}var n=$(t.target);n.hasClass("focus-ring")&&n.removeClass("focus-ring");if(!TS.client.ui.isUserAttentionOnChat())return;if(TS.model.unread_view_is_showing&&!i)return;if(TS.model.archive_view_is_showing){TS.client.archives.userWantsToCancel();return}if(!TS.client.activeChannelIsHidden()){var a=TS.redux.getState();var r=TS.interop.redux.features.messagePane.getMessagePaneStartTs(a);var s=TS.shared.legacyGetActiveModelOb().id;var o=TS.interop.redux.models.channelHistory.getTimestampsByChannelId(a,s,r);var l=!o.reachedEnd;if(l){TS.redux.dispatch(TS.interop.redux.features.messagePane.jumpToTimestamp({ts:null}));return}}if(TS.msg_edit.editing)return;if(TS.ui.react_emoji_menu.is_showing)return;if(i){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","onEscKey all_channels");var c=function e(){TS.model&&TS.model.user&&["U0GMK0KE1","U0618N1Q9","UDEFL0MM1"].indexOf(TS.model.user.id)>-1&&TS.interop.console.action("CLIENT-UI","onEscKey clearAll");TS.client.ui.forceMarkAllRead(TS.model.marked_reasons.esc_all,i);var t=TS.model.channels;var n=TS.model.groups;var a;var r=true;TS.redux.channels.clearAllShowInListEvenThoughUnreadsFlags();for(a=t.length-1;a>-1;a-=1)if(t[a].unread_cnt){TS.channels.legacyMarkMostRecentReadMsg(t[a],TS.model.marked_reasons.esc_all,r);TS.channels.unread_changed_sig.dispatch(t[a],true)}for(a=n.length-1;a>-1;a-=1)if(n[a].unread_cnt){TS.groups.legacyMarkMostRecentReadMsg(n[a],TS.model.marked_reasons.esc_all,r);TS.groups.unread_changed_sig.dispatch(n[a],true)}TS.replies.markAllThreads();TS.model.unread_view_is_showing&&TS.client.unread.reload()};if(false===TS.prefs.getPref("confirm_clear_all_unreads")||0===TS.model.all_unread_cnt)c();else{var d='<p class="no_bottom_margin float_right"><label class="checkbox overlay_pref block"><input id="confirm_clear_all_unreads_cb" type="checkbox" /> '+TS.interop.i18n.t("Don\u2019t ask me again, please","client")()+"</label><p>";TS.generic_dialog.start({title:TS.interop.i18n.t("Clear all unreads?","client")(),body:"<p>"+TS.interop.i18n.t("<b>Shift+esc</b> will clear all unread messages and notifications. Are you sure you want to do this? It\u2019s liberating\u2026 but there\u2019s no going back.","client","8eac21e6d31ebdbf0ae27c391aedf7f72aea5efb")()+"</p>"+d,show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Yes, clear all!","client")(),onGo:function e(){c();var t=!!$("#confirm_clear_all_unreads_cb").prop("checked");t&&TS.prefs.setPrefByAPI({name:"confirm_clear_all_unreads",value:false})}})}}else TS.client.activeChannelIsHidden()?TS.model.threads_view_is_showing&&TS.client.threads.markAllNewThreads():TS.client.ui.forceMarkAllRead(TS.model.marked_reasons.esc,i)},checkForEditing:function e(){var t=TS.shared.legacyGetActiveModelOb();if(!t)return false;var i=TS.interop.redux.features.messageEdit.attemptToStopEditingInChannel({channelId:t.id,scroll:true});TS.redux.dispatch(i).catch(function(){TS.sounds.play("beep")});var n=TS.redux.getState();var a=TS.interop.redux.features.messageEdit.getEditingWithUnsavedChangesTimestamps(n,{channelId:t.id});return!_.isEmpty(a)},teamSelectionChanged:function e(){if(TS.isPartiallyBooted()){TS.ensureFullyBooted().then(function(){TS.client.ui.teamSelectionChanged()});return}!TS.utility.isFocusOnInput()&&TS.client.ui.isUserAttentionOnChat()&&TS.view.focusMessageInput();if(TS.boot_data.page_needs_enterprise){TS.utility.msgs.countAllUnreads();TS.ui.growls.updateTotalUnreadDisplaysSSB()}},forceMarkAllRead:function e(t,i){TS.client.msg_pane.dont_check_unreads_til_switch=false;i?TS.interop.console.action("CLIENT-UI","Mark all channels read"):TS.interop.console.action("CLIENT-UI","Mark active channel read");TS.client.ui.legacyMarkMostRecentReadMsgInActive(t,true);if(i){var n=TS.model.channels;var a=TS.model.ims;var r=TS.model.groups;var s=TS.model.mpims;var o;var l=true;for(o=n.length-1;o>-1;o-=1)n[o].unread_cnt&&TS.channels.legacyMarkMostRecentReadMsg(n[o],t,l);for(o=a.length-1;o>-1;o-=1)a[o].unread_cnt&&TS.ims.legacyMarkMostRecentReadMsg(a[o],t,l);for(o=r.length-1;o>-1;o-=1)r[o].unread_cnt&&TS.groups.legacyMarkMostRecentReadMsg(r[o],t,l);for(o=s.length-1;o>-1;o-=1)s[o].unread_cnt&&TS.mpims.legacyMarkMostRecentReadMsg(s[o],t,l)}TS.client.markLastReadsWithAPI()},enhanceComponents:function e(){$("#flexpane_tabs li a").on("shown",function(){TS.view.resizeManually("TS.client.ui.enhanceComponents")})},shouldEventTriggerMaybeEditLast:function e(t,i){return TS.utility.contenteditable.isEmpty(i)&&(TS.interop.utility.isCmdKey(t)||TS.prefs.prefs_loaded&&!TS.prefs.getPref("arrow_history"))&&!t.altKey&&t.which==TS.utility.keymap.up},maybeEditLast:function e(t){t.preventDefault();t.stopPropagation();var i=TS.shared.legacyGetActiveModelOb();var n;var a;if(i){a=TS.redux.messages.getMessagesByChannelId(i.id);a=TS.utility.msgs.getDisplayedMsgs(a);n=TS.interop.rules.messages.getLastMessageByMember(a,TS.model.user.id);var r=TS.interop.messages.canEditMessage(TS.model.user.id,n,i,TS.prefs.getTeamPref("msg_edit_window_mins"));if(n&&r){TS.msg_edit.startEdit(n.ts,i,null,n);return true}}TS.sounds.play("beep");return false},bindCommentInput:function e(){$("#file_comment").on("focusin",function(){var e=$(this).closest(".flex_content_scroller")[0];e&&(e.scrollTop=e.scrollHeight)})},showRepliesFromHistory:function e(t){var i=false;var n=true;TS.client.flexDisplaySwitched("convo",t,i,n)},showAppsFromHistory:function e(t){if(!t)return TS.client.ui.flex.hideFlex();var i=false;var n=true;var a;var r=null;var s=null;var o=t.charAt(0);"B"===o?r=t:"A"===o&&(s=t);var l=TS.shared.legacyGetActiveModelOb().id;var c=TS.interop.channels.getPublicChannelById(l);if(TS.interop.rules.channels.isOrgShared(c))return TS.client.ui.flex.hideFlex();a=_.get(TS.model.team,"id");TS.apps.promiseToGetFullAppProfile(r,a,s,true).then(function(e){TS.client.ui.app_profile.openWithApp(e,r,a);TS.client.flexDisplaySwitched("apps",t,i,n)}).catch(function(){return TS.client.ui.flex.hideFlex()})},showSearchFromHistory:function e(t){if(!t){TS.client.ui.flex.openFlexTab("mentions");return}t=TS.search.truncateQuery(t);t=t.replace(/%23/g,"#");t=t.replace(/%252F/g,"/");var i=TS.search.input;TS.utility.contenteditable.value(i,t);i.data("textchange_lastvalue",t);TS.client.ui.flex.hideFlex()},showTeamFromHistory:function e(t,i){if(!t){TS.client.ui._displayTeamList();TS.client.flexDisplaySwitched("team",null,false,true);return}var n;if(TS.interop.utility.looksLikeMemberId(t)){n=TS.interop.members.getMemberById(t);if(!n&&!i){TS.interop.members.ensureMembersArePresent([t]).finally(function(){TS.client.ui.showTeamFromHistory(t,true)});return}}n||TS.boot_data.feature_deprecate_get_member_by_name||(n=TS.interop.members.getMemberByName(t));var a=TS.interop.userGroups.getUserGroupById(t);if(n)TS.client.ui._displayMember(n.id).then(function(e){TS.client.flexDisplaySwitched("team",e,false,true)},_.noop);else if(a&&!TS.interop.rules.user_groups.isUnknownOrNonExistent(a)){TS.client.ui._displayUserGroup(a.id);TS.client.flexDisplaySwitched("team",a.id,false,true)}else{TS.client.ui._displayTeamList();TS.client.flexDisplaySwitched("team",null,true)}},showView:function e(t){switch(t){case"Vall_unreads":TS.client.unread.showUnreadView();return true;case"Vall_threads":TS.client.threads.showThreadsView();return true;case"Vapp_space":TS.ui.apps_browser.start();return true;case"Vsearch":TS.client.ui.search_in_react.startPrimarySearch();return true;default:TS.warn('Unknown view "'+t+'" passed to TS.client.ui.showView()');return false}},onSubmit:function e(t){try{var i=$.trim(t);if(!i)return;var n="/unarchive"===i||"/leave"===i||"/part"===i||"/close"===i;var a=TS.shared.legacyGetActiveModelOb();if(!n&&a&&a.is_archived){TS.generic_dialog.alert(TS.interop.i18n.t("This channel has been archived; you cannot send messages to it.","client")());TS.client.msg_input.populate(i);return}TS.view.clearMessageInput();TS.utility.contenteditable.clearHistory(TS.client.msg_input.$input);TS.interop.slashCommand.looksLikeSlashCommand(t)?TS.client.ui.sendSlashCommand(a,t):TS.client.ui.sendMessage(a,t)}catch(e){TS.error(e)}},sendSlashCommand:function e(t,i,n){if(TS.boot_data.feature_modernize_slash_cmds){var a;n&&n.ts&&(a=n.ts);var r=TS.interop.slashCommand.parseArgs(i);TS.redux.dispatch(TS.interop.slashCommand.executeCommand({args:r,channelId:t.id,threadTs:a})).catch(function(e){if(e.message!==TS.interop.slashCommand.UNKNOWN_COMMAND)throw e;TS.client.ui._sendSlashCommand(t,i,n)})}else TS.client.ui._sendSlashCommand(t,i,n)},_sendSlashCommand:function e(t,i,n){"\uff0f"===i.substr(0,1)&&(i=i.replace("\uff0f","/"));TS.chat_history.add(i);var a=TS.cmd_handlers.parseArgs(i);var s=TS.interop.slashCommand.parseEditLastMessageCommand(i);if(TS.cmd_handlers[a.cmd]&&"client"===TS.cmd_handlers[a.cmd].type)setTimeout(function(){TS.cmd_handlers.runCommand(a,n,t)},10);else if(s){TS.utility.msgs.removeAllEphemeralMsgsByType("temp_slash_cmd_feedback",t.id);TS.redux.dispatch(TS.interop.redux.actions.editLastUserMessageText(r()({channelId:t.id},s))).catch(function(){TS.sounds.play("beep")})}else{if(n&&!TS.cmd_handlers.isCmdSupportedInThreads(a.cmd)){TS.cmd_handlers.sendCmdNotSupportedInThreadsMsg(a.cmd,a.original_txt,n,t);return}"/me"===a.cmd&&TS.prefs.getPref("convert_emoticons")&&!TS.interop.rules.emoji.shouldRenderEmojiAsText()&&(a.rest=TS.format.legacyDoEmoticonConversion(a.rest));var o=_.trim(a.original_txt.substr(a.cmd.length));var l=TS.interop.texty.convertContentsStringForEncodedMembers(o,{highlightWords:TS.interop.prefs.getHighlightWords(),shouldRenderEmojiAsText:TS.interop.rules.emoji.shouldRenderEmojiAsText(),emojiNames:TS.emoji.legacyGetEmojiNames(),useSonicEmoji:TS.boot_data.feature_sonic_emoji,locale:TS.interop.i18n.locale});l=TS.emoji.maybeGetCanonicalEmojiString(l);var c={command:a.cmd,text:l,channel:t.id,disp:a.disp,client_token:TS.interop.client_action_token.generateAndEnqueue()};n&&(c.thread_ts=n.ts);var d=function e(t,i,n){TS.client.ui.onAPICommand(t,i,n,a.original_txt)};TS.interop.api.call("chat.command",c).then(function(e){var i=e.data,n=e.args,a=e.request_id;var r=true;d(r,i,n,a);TS.boot_data.feature_degraded_send&&!TS.interop.redux.features.socket.isConnected(TS.redux.getState())&&TS.redux.dispatch(TS.interop.actions.requestOfflineHistory({channelId:t.id,threadTs:c.thread_ts}));return{data:i,args:n,request_id:a}}).catch(function(e){var t=e.data,i=e.args,n=e.request_id;var a=false;d(a,t,i,n);return{data:t,args:i,request_id:n}})}u(t)},sendMessage:function e(t,i,n,a){TS.chat_history.add(i);var r=TS.shared.legacySendMsg(t.id,i,n,a);if(!r)return;t.id===TS.model.active_cid&&TS.utility.msgs.removeAllEphemeralMsgsByType("temp_slash_cmd_feedback",TS.model.active_cid);u(t)},prefColorNamesInListChanged:function e(){TS.prefs.getPref("color_names_in_list")?$(".nuc").removeClass("nuc").addClass("user_colored"):$(".user_colored").removeClass("user_colored").addClass("nuc")},onAPICommand:function e(t,i,n,a){var r=TS.model.active_cid;var s;if(!t){n.channel&&n.thread_ts?TS.utility.populateThreadInputs(a,n.channel,n.thread_ts):TS.utility.contenteditable.isEmpty(TS.client.ui.$msg_input)&&TS.utility.populateInput(TS.client.ui.$msg_input,a);if(i.silence_error)return;var o;var l=TS.interop.i18n.safeString(_.escape(TS.interop.texty.convertContentsStringToDisplayString(a,TS.interop.prefs.getHighlightWords())));o=i.error&&"restricted_action"===i.error?TS.interop.i18n.t("*{cmd_txt}* failed because you are not allowed to perform that action. Talk to your Workspace Owner.","client")({cmd_txt:l}):i.error&&"Unknown command"!==i.error&&"unknown_command"!==i.error?TS.interop.i18n.t('*{cmd_txt}* failed with the error "{err_txt}"',"client")({cmd_txt:l,err_txt:i.error}):i.error?TS.interop.i18n.t('*{cmd_txt}* is not a valid command. In Slack, all messages that start with the "/" character are interpreted as commands.\n\n If you are trying to send a message and not run a command, try preceding the "/" with an empty space.',"client")({cmd_txt:l}):TS.interop.i18n.t("*{cmd_txt}* failed with an unknown error.","client")({cmd_txt:l});s={text:o,ephemeral_type:"temp_slash_cmd_feedback",channel:r,slackbot_feels:"sad_surprise"};if(n.channel&&n.thread_ts){s.channel=n.channel;s.thread_ts=n.thread_ts;s.ephemeral_type="threads_temp_slash_cmd_feedback"}TS.client.ui.addOrFlashEphemeralBotMsg(s)}if(i.response){if(i.open_url){var c="_"+Math.random();TS.info("gonna try to launch a new tab/window with target: "+c+" url: "+i.open_url);TS.utility.openInNewTab(i.open_url,c)}i.keep_input&&(n.channel&&n.thread_ts?TS.utility.populateThreadInputs(a,n.channel,n.thread_ts):TS.utility.contenteditable.isEmpty(TS.client.ui.$msg_input)&&TS.utility.populateInput(TS.client.ui.$msg_input,a));var d=r;n.channel&&n.channel!=d&&(TS.interop.channels.getPublicChannelById(n.channel)?d=n.channel:TS.interop.channels.getImById(n.channel)?d=n.channel:TS.interop.channels.getGroupById(n.channel)&&(d=n.channel));if(i.is_temp){s={text:i.response,ephemeral_type:"temp_slash_cmd_feedback",channel:d};if(n.thread_ts){s.thread_ts=n.thread_ts;s.ephemeral_type="threads_temp_slash_cmd_feedback"}TS.client.ui.addOrFlashEphemeralBotMsg(s)}else{TS.utility.msgs.removeAllEphemeralMsgsByType("temp_slash_cmd_feedback",TS.model.active_cid);n.channel&&n.thread_ts?TS.utility.msgs.removeAllEphemeralMsgsByType("threads_temp_slash_cmd_feedback",n.channel):TS.utility.msgs.removeAllEphemeralMsgsByType("temp_slash_cmd_feedback",TS.model.active_cid);var u="/"+TS.interop.i18n.t("active","cmd_handlers")();if(TS.boot_data.feature_degraded_send&&n.command===u){var m=TS.redux.presence.getPresenceByMemberId(TS.model.user.id);"away"===m&&TS.interop.members.updateCurrentMemberPresence({presence:"active"})}s={text:i.response,channel:d,thread_ts:n.thread_ts};TS.client.ui.addEphemeralBotMsg(s)}}else if(t){n.channel&&n.thread_ts?TS.utility.msgs.removeAllEphemeralMsgsByType("threads_temp_slash_cmd_feedback",n.channel):TS.utility.msgs.removeAllEphemeralMsgsByType("temp_slash_cmd_feedback",TS.model.active_cid);i.keep_input&&(n.channel&&n.thread_ts?TS.utility.populateThreadInputs(a,n.channel,n.thread_ts):TS.utility.contenteditable.isEmpty(TS.client.ui.$msg_input)&&TS.utility.populateInput(TS.client.ui.$msg_input,a))}},checkInlineImgsAndIframesEverywhere:function e(t){TS.client.ui.checkInlineImgsAndIframes("main",t);TS.client.ui.checkInlineImgsAndIframes("search",t);TS.client.ui.checkInlineImgsAndIframes("archives",t);TS.client.ui.checkInlineImgsAndIframes("file_preview",t);TS.client.ui.checkInlineImgsAndIframes("file_list",t);TS.client.ui.checkInlineImgsAndIframes("replies",t);TS.client.ui.checkInlineImgsAndIframes("threads",t);TS.client.ui.checkInlineImgsAndIframes("unread",t)},checkInlineImgsAndIframesMain:function e(){TS.client.ui.checkInlineImgsAndIframes("main")},getCachedDimensionsRect:function e(t,i){var n;if(TS.model.ui[t])return TS.model.ui[t];if(!i||!i[0])return{top:0,bottom:0,left:0,right:0,width:0,height:0};n=i.dimensions_rect();n.width&&0!==n.width&&(TS.model.ui[t]=n);return n},checkInlineImgsAndIframes:function e(t,i){var n;var a;if("main"===t){n=TS.client.ui.$msgs_div;a=TS.client.ui.getCachedDimensionsRect("cached_msgs_scroller_rect",TS.client.ui.$msgs_scroller_div)}else if("search"===t){n=$("#search_results");a=TS.client.ui.getCachedDimensionsRect("cached_search_scroller_rect",n)}else if("archives"===t){n=TS.client.archives.$scroller;a=TS.client.ui.getCachedDimensionsRect("cached_archives_scroller_rect",n)}else if("file_preview"===t){n=$("#file_preview_container");a=TS.client.ui.getCachedDimensionsRect("cached_file_preview_scroller_rect",n)}else if("file_list"===t){n=$("#file_list");a=TS.client.ui.getCachedDimensionsRect("cached_file_list_scroller_rect",n)}else if("replies"===t){n=$("#convo_scroller");a=TS.client.ui.getCachedDimensionsRect("cached_convo_scroller_rect",n)}else if("unread"===t){n=TS.client.ui.unread.$scroller;a=TS.client.ui.getCachedDimensionsRect("cached_unread_scroller_rect",n)}else{if("threads"!==t){TS.info("unknown which in checkInlineImgsAndIframes(which)");return}n=TS.client.ui.threads.$scroller;a=TS.client.ui.getCachedDimensionsRect("cached_threads_scroller_rect",n)}i&&TS.info("checkInlineImgsAndIframes which:"+t);var r=n.find(".msg_inline_holder:not(.hidden) .msg_inline_child.hidden, .msg_inline_file_preview_toggler:not(.collapsed) + .image_container .image_bg");var s;var o;var l;var c;var d="loaded_bg";r.each(function(){o=$(this);c=o.closest(".msg_inline_holder, .image_container");if(!c.length)return;if(c.data(d))return;s=c.dimensions_rect();i&&TS.dir(0,s);i&&TS.dir(0,a);if(TS.utility.doRectsOverlap(a,s)){i&&TS.info("yes");if(o.data("real-background-image")){o.removeClass("hidden");o.css("background-image",'url("'+o.data("real-background-image")+'")');l=o.find("img")}else{l=o;l.removeClass("hidden")}l.attr("src",l.data("real-src"));l.error(function(){$(this).closest(".msg_inline_holder, .image_body").addClass("broken_image")});c.data(d,true)}else i&&TS.warn("no");o=null;l=null;c=null})},logUnreads:function e(){var t=[];var i=TS.shared.legacyGetActiveModelOb();var n=i.unreads;if(!i)return;for(var a=0;a<n.length;a+=1)-1==TS.model.client.reads.indexOf(n[a])&&t.push(n[a]);TS.info(t)},legacyMarkMostRecentReadMsgInActive:function e(t,i){var n=TS.shared.legacyGetActiveModelOb();TS.has_pri[U]&&n.unread_cnt&&TS.log(U,"TS.client.ui.legacyMarkMostRecentReadMsgInActive, "+n.id+": reason = "+t+(i?", get_rid_of_line = "+i:""));var a=TS.shared.legacyGetControllerForModelOb(n);_.isFunction(a.legacyMarkMostRecentReadMsg)&&a.legacyMarkMostRecentReadMsg(n,t);if(i){TS.redux.dispatch(TS.interop.redux.features.messagePane.setGhostLastRead(null));TS.ui.pins.clearUnreadPinState(n)}},isMsgInView:function e(t){var i=TS.shared.legacyGetActiveModelOb();if(i){var n=TS.utility.msgs.getMsg(t,i.msgs);n&&n._jl_rolled_up_in&&(t=n._jl_rolled_up_in)}var a=TS.client.msg_pane.getCanonicalDivForMsg(t);if(!a.length)return false;if(a.hasClass("hidden"))return true;var r=TS.client.ui.getCachedDimensionsRect("cached_msgs_scroller_rect",TS.client.ui.$msgs_scroller_div);return TS.client.ui.isElInView(a,5,r)},isUnreadDividerInView:function e(t){t=t||5;var i=TS.client.ui.getCachedDimensionsRect("cached_msgs_scroller_rect",TS.client.ui.$msgs_scroller_div);return TS.client.ui.isElInView(TS.client.ui.$msgs_unread_divider,t,i)},isElInView:function e(t,i,n){if(!t||!t.length)return false;i=i||0;var a=t.dimensions_rect();if(a.height>n.height)return TS.utility.doesRectContainRect(a,n,i,true);if(TS.utility.doesRectContainRect(n,a,i,true))return true;return false},isMessageInputFocused:function e(){return TS.utility.contenteditable.isActiveElement(TS.client.ui.$msg_input)},areMsgsScrolledToBottom:function e(t,i){var n=TS.model.archive_view_is_showing?TS.model.ui.cached_archive_scroll_result:TS.model.ui.cached_msgs_scroll_result;if(null!==n&&!i)return n;t=isNaN(t)?50:t;var a=TS.model.archive_view_is_showing?TS.client.archives.$scroller:TS.client.ui.$msgs_scroller_div;var r=a[0];if(!r)return;var s=parseInt(a.css("height"),10)+r.scrollTop+t>=r.scrollHeight;TS.model.archive_view_is_showing?TS.model.ui.cached_archive_scroll_result=s:TS.model.ui.cached_msgs_scroll_result=s;return s},active_highlight_count:0,rebuildMemberListToggle:function e(){var t;var i;if(TS.model.active_channel_id||TS.model.active_group_id||TS.model.active_mpim_id){var n=TS.shared.legacyGetActiveModelOb();var a=TS.interop.memberCounts.getOrFetchMemberCounts(n.id);if(a.promise&&!l){l=true;TS.interop.utility.makeSafeForTimeout(a.promise).timeout(TS.interop.connectivity.getMaximumSocketWait()).then(function(e){if(TS.shared.legacyGetActiveModelOb().id!==n.id)return;i=true;var t=_.get(e,"counts.member_count");if(n.is_mpim&&TS.interop.rules.channels.isExternallySharedChannel(n)&&TS.teams.getTeamNameById(n.shared_team_ids[0])){B(i,t,n);return}E(i,t)}).catch(function(e){var t;var i=n.id;if(TS.redux.socket.isConnected()){var a=1e4;TS.warn("Fetching membership counts for "+i+" failed; trying again in "+a+" ms");TS.logError(e);t=Promise.delay(a)}else{TS.warn("Fetching membership counts for "+i+" failed; trying again after we are connected",e);t=TS.redux.socket.promiseToHaveOpenWebSocket()}t.then(function(){var e=TS.shared.legacyGetActiveModelOb();if(!e)return;if(e.id!==i)return;TS.client.ui.rebuildMemberListToggle()})}).finally(function(){l=false})}i=_.has(a,"counts.member_count");t=_.get(a,"counts.member_count");if(n.is_mpim&&TS.interop.rules.channels.isExternallySharedChannel(n)&&TS.teams.getTeamNameById(n.shared_team_ids[0])){B(i,t,n);return}E(i,t)}else $("#channel_members_toggle").addClass("hidden")},maybePromptForClosingGroup:function e(t){var i=TS.interop.channels.getGroupById(t);if(i.unread_cnt){var n=TS.model.group_prefix+i.name;TS.generic_dialog.start({title:TS.interop.i18n.t("You have unread messages","client")(),body:TS.interop.i18n.t("You have unread messages in the {group_name} private channel. Are you sure you want to close it?","client")({group_name:n}),show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Yes","client")(),cancel_button_text:TS.interop.i18n.t("No","client")(),onGo:function e(){TS.groups.legacyMarkMostRecentReadMsg(i,TS.model.marked_reasons.closed);TS.client.markLastReadsWithAPI();TS.shared.legacyCloseArchivedChannel(i.id)}})}else TS.shared.legacyCloseArchivedChannel(i.id)},maybePromptForClosingIm:function e(t){var i=TS.interop.channels.getImById(t);i.unread_cnt?TS.generic_dialog.start({title:TS.interop.i18n.t("You have unread messages","client")(),body:TS.interop.i18n.t("You have unread messages from {im_name}. Are you sure you want to close the DM?","client")({im_name:i.name}),show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Yes","client")(),cancel_button_text:TS.interop.i18n.t("No","client")(),onGo:function e(){TS.ims.legacyMarkMostRecentReadMsg(i,TS.model.marked_reasons.closed);TS.client.markLastReadsWithAPI();TS.redux.dispatch(TS.interop.channels.closeChannelApi({channelId:i.id}))}}):TS.redux.dispatch(TS.interop.channels.closeChannelApi({channelId:i.id}))},channelOrImOrGroupDisplaySwitched:function e(){TS.client.msg_pane.dont_check_unreads_til_switch=false;TS.model.client.reads.length=0;TS.client.ui.rebuildMemberListToggle();TS.interop.apps.isAppSpaceEnabled()&&TS.client.ui.app_space.resetUI();if("files"===TS.model.ui_state.flex_name||"convo"===TS.model.ui_state.flex_name){if(!TS.model.ui_state.flex_extra)return;var t;if("files"===TS.model.ui_state.flex_name){if(TS.boot_data.feature_file_threads)return;var i=$("#back_from_file_preview");t=i.data("origin");"channel_page"!==t&&"group_page"!==t&&"im_page"!==t||TS.client.ui.files._rebuildBackFromFilePreview("")}else if("convo"===TS.model.ui_state.flex_name){t=TS.ui.replies.activeConvoOrigin();if("channel_page"===t||"group_page"===t||"im_page"===t){var n=false;TS.ui.replies.toggleBackButton(n)}}}},isUserAttentionOnChat:function e(){return"message_pane"===TS.client.ui.currentUserAttention()},currentUserAttention:function e(){if(!TS.model.ui.is_window_focused)return"window_not_focused";if(TS.model.dialog_is_showing||TS.interop.utility.isDialogVisible()||TS.ui.snippet_dialog.showing)return"dialog_is_showing";if(TS.model.menu_is_showing||TS.interop.utility.isMenuVisible())return"menu_is_showing";if(TS.model.coachmark_is_showing)return"coachmark_is_showing";if(TS.model.overlay_is_showing)return"overlay_is_showing";if(TS.ui.jumper.is_showing)return"jumper_is_showing";if(TS.ui.fs_modal.is_showing||TS.interop.utility.isFSModalVisible())return"fs_modal_is_showing";if(TS.ui.react_emoji_menu.is_showing)return"emoji_menu_is_showing";if(TS.utility.isTabCompleteShowing())return"tab_complete_is_showing";if(TS.interop.searchUi.getVisible()&&!TS.interop.usePrimarySearch())return"universal_search_is_showing";if(document.hidden){TS.has_pri[U]&&TS.log(U,"isUserAttentionOnChat(): document.hidden = true. exiting.");return"document_is_hidden"}if("hidden"===document.visibilityState){TS.has_pri[U]&&TS.log(U,"isUserAttentionOnChat(): document.visibilityState = hidden. exiting.");return"visibility_state_is_hidden"}if(TS.model.is_our_app&&window.desktop&&desktop.reduxHelper&&_.isFunction(desktop.reduxHelper.isSelectedTeam)&&!desktop.reduxHelper.isSelectedTeam()){TS.has_pri[U]&&TS.log(U,"isUserAttentionOnChat(): App isSelectedTeam() returned false. exiting.");return"team_not_selected"}return"message_pane"},previewMember:function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};TS.interop.searchActions.close();return TS.client.ui._displayMember(t,i,n).then(function(e){TS.client.flexDisplaySwitched("team",e)},_.noop)},_displayMember:function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return new Promise(function(e,a){var r=TS.redux.members.getPotentiallyUnknownMemberById(t);if(!r)return void a(new Error("wtf: no member to display"));if(!TS.client.ui.flex._displayFlexTab("team"))return void a(new Error("wtf: failed to open team tab"));var s=function t(){TS.boot_data.feature_modern_profile_flexpane?C(r,i,n):k(r,i,n);e(r.id)};r.profile&&r.profile.fields?TS.team.ensureTeamProfileFields().then(s):s()})},showTeamList:function e(t){var i=true;if(!TS.client.ui._displayTeamList(i,t))return;TS.client.flexDisplaySwitched("team")},_displayTeamList:function e(t,i){if(!TS.client.ui.flex._displayFlexTab("team"))return false;TS.model.previewed_member_name="";TS.model.previewed_member_id="";TS.model.previewed_user_group_id="";$("#member_preview_container").hideWithRememberedScrollTop();$("#team_list_container").unhideWithRememberedScrollTop();$("#user_group_preview_container").hideWithRememberedScrollTop();if(TS.boot_data.feature_sonic_member_directory)return false;TS.view.resizeManually("TS.client.ui._displayTeamList");var n=TS.SearchableMemberList.get("team_directory");if(n)n.maybeRerenderLongListView();else{var a=new TS.SearchableMemberList({$container:$("#team_list_container"),id:"team_directory",triggered_by_user_action:t,memberType:i});a.showInitial()}return true},showGroupsList:function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!TS.client.ui._displayGroupsList())return;TS.client.flexDisplaySwitched("groups",t.userGroupId)},_displayGroupsList:function e(){if(!TS.client.ui.flex._displayFlexTab("groups"))return false;if(TS.boot_data.feature_sonic_user_groups)return true;$("#user_groups_container").unhideWithRememberedScrollTop();TS.boot_data.feature_lazy_user_groups&&TS.client.ui.user_groups.mountLazyUserGroupList();return true},showGroupsFromHistory:function e(t){if(!TS.boot_data.feature_lazy_user_groups)return;if(!t){TS.client.ui.showGroupsList();return}return TS.interop.userGroups.fetchUserGroupById(t).then(function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(!e||!e.id){TS.client.ui.showGroupsList();return}TS.client.ui.previewUserGroup(e.id)}).catch(function(){TS.client.ui.showGroupsList()})},previewUserGroup:function e(t,i){if(TS.boot_data.feature_sonic_user_groups)TS.client.ui.flex._displayFlexTab("groups");else{i||(i="groups");if(!TS.client.ui._displayUserGroup(t,i))return}TS.client.flexDisplaySwitched("groups",t)},_displayUserGroup:function e(t,i){if(TS.boot_data.feature_sonic_user_groups)return false;if(w)return;w=true;var n=TS.interop.userGroups.getUserGroupById(t);if(TS.boot_data.feature_lazy_user_groups){if(TS.interop.rules.user_groups.isUnknownOrNonExistent(n)||!TS.interop.userGroups.isUserGroupActive(n)){w=false;return false}}else if(!n||TS.interop.rules.user_groups.isUnknownOrNonExistent(n)){w=false;return false}if(!TS.client.ui.flex._displayFlexTab("groups")){w=false;return false}if(TS.boot_data.feature_lazy_user_groups){var a=$("#user_group_preview_scroller");a.length&&a.html(TS.templates.user_group_preview_loading)}if(TS.view.user_groups_members_list_lazyload){TS.view.user_groups_members_list_lazyload.detachEvents();TS.view.user_groups_members_list_lazyload=null}TS.model.previewed_user_group_id=n.id;TS.info("TS.model.previewed_user_group_id:"+TS.model.previewed_user_group_id);$("#user_groups_container").hideWithRememberedScrollTop();TS.boot_data.feature_lazy_user_groups&&TS.client.ui.user_groups.cleanupLazyUserGroupList();var s=function e(){$("#user_group_preview_container").unhideWithRememberedScrollTop();var t=n.users;var a=TS.interop.members.ensureMembersArePresent(t);var s=TS.shared.ensureModelObsArePresent(n.prefs.channels);Promise.join(a,s,function(){var e=_.map(t,function(e){return TS.interop.members.getMemberById(e)});e.sort(function(e,t){var i=e._real_name_lc||e._name_lc;var n=t._real_name_lc||t._name_lc;if(i>n)return 1;if(n>i)return-1;return 0});var a=n.prefs.channels;var s=false;var o=_.map(a,function(e){return TS.interop.channels.getPublicChannelById(e,s)});var l=n.prefs.groups;var c=_.map(l,function(e){return TS.interop.channels.getGroupById(e)});o=o.concat(c);o=_.reject(o,_.isNull);var d=-1===n.date_delete;var u=TS.permissions.members.canEditUserGroups()||TS.permissions.members.canCreateAndDeleteUserGroups();var m=o.map(function(e){var t=e.creator?TS.interop.members.getPrefCompliantMemberNameById(e.creator):"";var i=e.purpose?TS.utility.formatTopicOrPurpose(e.purpose.value):"";return r()({prefCompliantMemberName:t,purposeString:new Handlebars.SafeString(i)},e)});var f={user_group:n,members:e,channels:m,show_user_groups_edit:u,is_user_group_deleted:d};var h=TS.templates.user_group_preview(f);var p=$("#user_group_preview_scroller");p.html(h);TS.utility.makeSureAllLinksHaveTargets(p);$("#user_group_menu_toggle").on("click",function(e){TS.menu.startWithUserGroupMenu(e,n.id)});$("#edit_default_channels").on("click",function(){TS.ui.admin_user_groups.editInfo(n)});TS.ui.tabs.create($("#user_group_tabs"));TS.model.last_previewed_user_group_id!=TS.model.previewed_user_group_id&&p.length&&(p[0].scrollTop=0);TS.model.last_previewed_user_group_id=n.id;var g=$("#user_group_members");g.bind("click.view",TS.view.onMemberListClick);g.on("click.toggle_list_item",".team_list_item",TS.members.view.onTeamDirectoryItemClick);TS.utility.makeSureAllLinksHaveTargets(g);TS.environment.supports_custom_scrollbar||p.find(".user_group_member_list").monkeyScroll();TS.view.user_groups_members_list_lazyload=g.find(".lazy").lazyload({container:$(".user_group_member_list"),ignore_when_hidden_element:$("#user_group_members"),all_images_same_size:true});$(".user_group_member_list").trigger("resize-immediate");var T=$("#back_from_user_group_preview");v(i,T);TS.client.flex_pane.stopLocalTimeInterval();TS.view.resizeManually("TS.client.ui._displayUserGroup");w=false;return true})};TS.user_groups.legacyNeedsToFetchMembership(n)?TS.boot_data.feature_lazy_user_groups&&!TS.interop.userGroups.isUserGroupActive(n)?s():TS.interop.userGroups.getUserGroupMembers(t,function(e){if(e&&e.users){n=e;return s()}}):s();return true},tryToJump:function e(t,i,n){n&&(n=n.replace(/(\d{10})(\d{6})/,"$1.$2"));var a=TS.redux.channels.getEntityById(t);if(!a){TS.error("NO CHANNEL NO IM GROUP");return false}if(!i){TS.client.displayModelOb(a);return true}var r=TS.utility.msgs.findMsg(i,a.id);if(r&&TS.interop.messages.isReply(r)){TS.ui.replies.openConversation(a,r.thread_ts,r.ts);return true}if(!r&&n){TS.ui.replies.openConversation(a,n,i);return true}TS.view.displayMsgInModelOb(a,i);return true},sendChannelMsgThroughSlackBot:function e(t,i,n,a){var r=TS.interop.channels.getPublicChannelById(t);if(!r)return;var s=n.split(",");if(!s.length)return;var o=TS.utility.msgs.findMsg(i,r.id);if(!o){TS.client.ui.addEphemeralBotMsg({channel:r.id,text:TS.interop.i18n.t("Darn, it looks like that message no longer exists.","client")(),slackbot_feels:"sad_surprise"});return}var l=TS.interop.i18n.t("<p>Would you like to have slackbot send {names_text} your message?</p>","client")({names_text:A(s)});l+=TS.templates.builders.msgs.buildHTML({msg:o,model_ob:r,standalone:true});TS.generic_dialog.start({title:TS.interop.i18n.t("Send message to users not in #{channel_name}","client")({channel_name:r.name}),body:l,go_button_text:TS.interop.i18n.t("Yes, send it","client")(),onGo:function e(){for(var i=0;i<s.length;i+=1)TS.interop.api.call("chat.sendMention",{channel:t,user:s[i],ts:o.ts});if(a){var n=TS.utility.msgs.findMsg(a,r.id);"C"===t.charAt(0)?TS.channels.legacyRemoveMsg(t,n):"G"===t.charAt(0)&&TS.groups.legacyRemoveMsg(t,n)}}})},promptForGroupOrChannelInvite:function e(t,i,n){var a=TS.interop.channels.getGroupById(t)||TS.interop.channels.getPublicChannelById(t);if(!a)return;var r=i.split(",");if(!r.length)return;if(a.is_private||a.is_group){TS.ui.invite.showInviteMembersPreSelected(t,r,n);return}TS.generic_dialog.start({title:TS.interop.i18n.t("Invite new members to #{channel_name}","client")({channel_name:a.name}),body:TS.interop.i18n.t("<p>Would you like to invite {names_text} to #{channel_name}?</p>","client")({names_text:A(r),channel_name:a.name}),go_button_text:TS.interop.i18n.t("Yes, invite them","client")(),onGo:function e(){TS.interop.api.call("conversations.invite",{channel:t,users:i});if(n){var r=TS.utility.msgs.findMsg(n,a.id);TS.channels.legacyRemoveMsg(t,r)}}})},addEphemeralBotMsg:function e(t){var i=t.channel||TS.shared.legacyGetActiveModelOb().id;var n=t.text;if(!n)return;var a;a=t.username?{type:"message",subtype:"bot_message",icons:t.icons||null,is_ephemeral:true,username:t.username,ts:t.ts,text:n}:{type:"message",user:"USLACKBOT",is_ephemeral:true,ts:t.ts,text:n};t.slackbot_feels&&(a.slackbot_feels=t.slackbot_feels);t.thread_ts&&(a.thread_ts=t.thread_ts);t.ephemeral_type&&!t.thread_ts&&(a._ephemeral_type=t.ephemeral_type);var r=f(i,a,t.ephemeral_type);TS.info(r)},addOrFlashEphemeralBotMsg:function e(t){var i=t.channel||TS.shared.legacyGetActiveModelOb().id;var n=t.ephemeral_type;var a=n?TS.utility.msgs.getEphemeralMsgsByCidAndType(i,n):null;t.thread_ts&&(a=_.filter(a,function(e){return e.thread_ts===t.thread_ts}));if(a&&a.length){var r=TS.redux.channels.getEntityById(i);var s=a[0];s.thread_ts||(s=_.assign({},a[0]));s.text=TS.format.cleanInternalMsg(t.text);s.thread_ts?r.is_im?TS.ims.message_changed_sig.dispatch(r,s):r.is_mpim?TS.mpims.message_changed_sig.dispatch(r,s):r.is_channel?TS.channels.message_changed_sig.dispatch(r,s):r.is_group&&TS.groups.message_changed_sig.dispatch(r,s):TS.redux.messages.replaceMessage(s)}else TS.client.ui.addEphemeralBotMsg(t)},maybeHandleReactionCmd:function e(t,i,n){if(!t)return false;if(TS.boot_data.feature_sonic_emoji&&!t.thread_ts){var a=TS.redux.dispatch(TS.interop.reactions.maybeReactToLastMessageInChannel({messageText:i,channelId:t.channel}));a.didAddOrRemove&&n&&n();return a.didHandle}var r=i.match(/:/g)&&i.match(/:/g).length;if(r<2)return false;TS.interop.i18n.locale!==TS.interop.i18n.DEFAULT_LOCALE&&(i=TS.emoji.maybeGetCanonicalEmojiString(i));var s=_.get(TSF.getEmojiRx(),"r.source");var o=new RegExp("^(\\+|\uff0b|-|\uff0d) {0,1}("+s+")\\s*$");var l=i.match(o);if(!l)return false;var c=l[1];var d=l[2];if("+"!==c&&"\uff0b"!==c&&"-"!==c&&"\uff0d"!==c)return false;var u=TS.rxns.getRxnKeyByMsgType(t);if(!u){TS.sounds.play("beep");return true}var m="+"===c||"\uff0b"===c;var f=TS.rxns.doesRxnsHaveRxnFromUser(TS.rxns.getExistingRxnsByKey(u),d);if(!f&&!m)return false;if(!S(t)||!TS.emoji.isValidName(d)||f===m){TS.sounds.play("beep");return true}TS.rxns.changeRxnsFromUserAction(u,d,m);n&&n();return true},sendMsgFromUserFromSSB:function e(t,i,n){if(!t)return false;if(!i)return false;var a=TS.redux.channels.getEntityById(t);var r=TS.utility.msgs.findMsg(n,a.id);if(r&&TS.client.ui.maybeHandleReactionCmd(r,i))return true;r&&!r.thread_ts&&(r=null);var s=TS.shared.legacySendMsg(t,i,r);if(!s){TSSSB.warn("TSSSB.sendMsgFromUser failed, invalid c_id or possible permission failure");return false}return true},shouldIgnoreClick:function e(t){if(TS.isPartiallyBooted()){t.preventDefault();TS.incremental_boot.userDidInteractWithUI();return true}if(TS.onboarding.inOnboarding()&&!TS.prefs.getPref("lessons_enabled")&&!TS.prefs.getPref("tractor_enabled"))return true;return false},maintainMessagePanePosition:function e(t){var i;var n;if(TS.model.archive_view_is_showing){t();return}if(TS.model.unread_view_is_showing)n=TS.client.ui.unread.$scroller;else{if(!TS.model.threads_view_is_showing){t();return}n=TS.client.ui.threads.$scroller}i=n.find("ts-message");if(!TS.client.activeChannelIsHidden()&&TS.client.ui.areMsgsScrolledToBottom())t();else{var a=n.offset().top;var r=_.find(i.toArray(),function(e){var t=$(e).offset().top;return t-a>=0});TS.ui.utility.preventElementFromScrolling($(r),function(){t()})}},rebuildCustomStatusExpirationInTooltip:function e(){var t=$(this);var i=t.attr("data-member-id");var n=TS.templates.builders.buildMemberCustomStatusExpiration(TS.interop.members.getMemberById(i));$(".ts_tip_inner_current_status .current_status_expiration").replaceWith(n)}});var e;var t=false;var i=0;var n={};var a=false;var s=0;var o=false;var l=false;var c=function e(t){TS.metrics.mark("_rebuildAllButMsgsForReal");t=t||{};TS.client.msg_pane.rebuildChannelMembersList();t.channel_header||TS.client.msg_pane.displayTitle();t.user_current_status||TS.view.members.updateUserCurrentStatus();TS.client.ui.did_rebuild_all_but_msgs_sig.dispatch();(TS.boot_data.feature_tinyspeck||TS.utility.enableFeatureForUser(5))&&TS.metrics.measure("client_ui_rebuild_all_but_msgs","_rebuildAllButMsgsForReal")};var d=function e(){TS.utility.enableFeatureForUser(10)&&TS.statsd.count("client_rebuild");var t=false;var i=null;TS.metrics.mark("client_ui_rebuild_all");TS.client.ui.rebuildAllButMsgs(i,t);TS.client.ui.did_rebuild_all_sig.dispatch();(TS.boot_data.feature_tinyspeck||TS.utility.enableFeatureForUser(5))&&TS.metrics.measure("client_ui_rebuild_all","_rebuildAllButMsgsForReal")};var u=function e(t){if(t.id!==TS.model.active_cid)return;TS.model.overlay_is_showing&&TS.view.overlay.cancelFromSendingMessage()};var m=function e(t){var i=$(t).closest(".member_details");if(i.hasClass("cropped_preview")){i.removeClass("cropped_preview");TS.model.ui_state.expand_member_images_in_flexpane=true}else{i.addClass("cropped_preview");TS.model.ui_state.expand_member_images_in_flexpane=false}TS.storage.storeUIState(TS.model.ui_state);TS.view.resizeManually("TS.client.ui._displayMember")};var f=function e(t,i,n){i.text=TS.format.cleanInternalMsg(i.text);i.ts=i.ts||TS.interop.datetime.makeTsStamp();var a=TS.interop.messages.preprocessImsg(i,t);var r=TS.redux.channels.getEntityById(t);var s=TS.shared.legacyGetControllerForModelOb(r);_.isFunction(s.legacyAddMsg)&&s.legacyAddMsg(t,a);if(!i.thread_ts)return i.ts;var o={c_id:t,ephemeral_type:n};i.thread_ts&&(o.thread_ts=i.thread_ts);TS.utility.msgs.ephemeral_msgs_map[i.ts]=o;return i.ts};var h=function e(t){if(TS.useGlobalNav()&&TS.model.is_our_app)return;var i=TS.model.mac_ssb_version||TS.model.win_ssb_version&&TS.model.is_mac;var n=TS.model.win_ssb_version&&TS.model.is_win||TS.model.lin_ssb_version&&TS.model.is_lin;var a=TS.model.win_ssb_version&&TS.model.win_ssb_version>2||2===TS.model.win_ssb_version&&TS.model.win_ssb_version_minor>=4;var r=TS.model.lin_ssb_version&&TS.model.lin_ssb_version>2||2===TS.model.lin_ssb_version&&TS.model.lin_ssb_version_minor>=4;var s=TS.model.mac_ssb_version||a||r;var o=t.metaKey&&!t.shiftKey&&!t.altKey;var l=!t.metaKey&&!t.shiftKey&&t.altKey;var c=TS.utility.keymap;var d=t.which==c.left_square_bracket||t.which==c.right_square_bracket;var u=t.which==c.left||t.which==c.right;var _=o&&u;i&&!s&&o&&d?p(t.which,c.left_square_bracket,c.right_square_bracket,_,t):n&&!s&&l&&u?p(t.which,c.left,c.right,_,t):o&&u?p(t.which,c.left,c.right,_,t):o&&d&&TS.interop.clog.track("HISTORY_NAV_ACTION",{trigger:"keyboard_shortcut",action:"nav_prev_next"})};var p=function e(t,i,n,a,r){var s=TS.utility.contenteditable.isEmpty(document.activeElement);if(TS.utility.isFocusOnInput()&&(s||!a)||document.activeElement==document.body){TS.interop.clog.track("HISTORY_NAV_ACTION",{trigger:"keyboard_shortcut",action:"nav_prev_next"});t===i?window.history.go(-1):t===n&&window.history.go(1);r&&r.preventDefault()}};var g=function e(){TS.model.client.last_user_active_timestamp=new Date};var T=function e(t){if(t.id!=TS.model.active_cid)return;TS.client.msg_pane.displayTitle();TS.client.msg_pane.rebuildChannelMembersList()};var S=function e(t){return t&&!TS.interop.rules.messages.isTempMsg(t)&&!t.is_ephemeral};var v=function e(t,i){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};i.unbind();"file_list"===t||"file_preview"===t?i.html(TS.templates.builders.filePreviewBackIcon()+TS.interop.i18n.t("Files","client")()).bind("click.back",function(){TS.client.ui.flex.openFlexTab("files");TS.model.ui_state.flex_extra&&TS.client.ui.files.previewFile(TS.model.ui_state.flex_extra)}):"search_results"===t?i.html(TS.templates.builders.filePreviewBackIcon()+TS.interop.i18n.t("Search Results","client")()).bind("click.back",function(){TS.client.ui.flex.openFlexTab("search")}):"im_page"===t?i.html(TS.templates.builders.filePreviewBackIcon()+TS.interop.i18n.t("Conversation Details","client")()).bind("click.back",function(){TS.client.ui.flex.openFlexTab("details")}):"groups"===t?i.html(TS.templates.builders.filePreviewBackIcon()+TS.interop.i18n.t("User Groups","client")()).bind("click.back",function(){TS.client.ui.showGroupsList(n)}):i.html(TS.templates.builders.filePreviewBackIcon()+(TS.boot_data.page_needs_enterprise?TS.interop.i18n.t("Organization Directory","client")():TS.interop.i18n.t("Workspace Directory","client")())).bind("click.back",function(){TS.client.ui.showTeamList()})};var b=function e(){"team"===TS.model.ui.active_tab_id&&TS.model.previewed_member_id&&TS.client.ui._displayMember(TS.model.previewed_member_id)};var w;var y=function e(){TS.shared.onDisplayEmailAddressesPrefChanged()};var A=function e(t){var i=t.map(function(e){return TS.interop.members.getPrefCompliantMemberName(TS.redux.members.getPotentiallyUnknownMemberById(e),true)});return TS.interop.i18n.safeString(TS.interop.i18n.listify(i,{strong:true,noEscape:true}).join(""))};var k=function t(i,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};var r=$("#member_preview_container");var s=TS.model.previewed_member_id===i.id&&!r.find(".cropped_preview").length||"menu_member_header"===n||TS.model.ui_state.expand_member_images_in_flexpane;TS.model.previewed_member_name=i.name;TS.model.previewed_member_id=i.id;TS.info("TS.model.previewed_member_id:"+TS.model.previewed_member_id);var o;var l=i.is_bot&&TS.model.user.is_admin;var c;l&&(c=TS.interop.bots.getBotConfigureUrl(i));var d=TS.interop.members.getMemberCurrentStatus(TS.redux.getState(),i.id).text;var u={member:i,status_text:d,show_bot_configuration:l,hide_more_menu:false,bot_configure_url:c,show_call_action:TS.utility.calls.isEnabled()&&!i.is_bot&&"USLACKBOT"!==i.id&&"UTEAMSBOT"!==i.id,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team),show_admin_info:i.is_admin&&i.team_id===TS.model.user.team_id,lazy_load_profile_fields:true,lazy_load_shared_teams:true};e.clear();e.add(i.id);if(TS.boot_data.page_needs_enterprise&&!i.is_self){var _="TS.client.ui._renderMember";u.shared_teams=TS.teams.getSharedTeamsForMember(i);TS.teams.ensureSharedTeamsForMember(i,_).then(function(){M(i)})}o=TS.templates.team_member_preview(u);$("#user_group_preview_container").hideWithRememberedScrollTop();$("#team_list_container").hideWithRememberedScrollTop();r.unhideWithRememberedScrollTop();var f=$("#member_preview_scroller");f.html(o);TS.utility.makeSureAllLinksHaveTargets(f);i.deleted&&$("#member_deleted_view_archives_btn").removeClass("hidden");if(TS.model.last_previewed_member_id!=TS.model.previewed_member_id){var h=$("#member_preview_scroller");h.length&&(h.get(0).scrollTop=0)}TS.model.last_previewed_member_id=i.id;var p=$("#back_from_member_preview");v(n,p,a);TS.view.resizeManually("TS.client.ui._displayMember");f.find(".member_details .member_image").click(function(){m(this);TS.interop.clog.track("USER_PROFILE_CLICK");return false});f.find(".member_preview_menu_target").click(function(e){TS.menu.member.startWithMemberPreview(e,i.id,false,true)});s&&m(r.find(".member_image"));i.is_self&&TS.client.ui.flex.registerCurrentStatusInput();TS.members.legacyEnsureMemberObjectsForUserProfileFields(i).then(function(){if(i.is_restricted||i.is_external&&!i.is_stranger){var e=i.is_restricted?["channels"]:["shared_channels"];return TS.interop.members.fetchMemberProfileExtras(i.id,e)}return Promise.resolve()}).then(function(e){var t=e&&e.shared_channels;var n=e&&e.channels;x(i,t,n)})};var C=function t(i,n){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};TS.model.previewed_member_name=i.name;TS.model.previewed_member_id=i.id;TS.info("TS.model.previewed_member_id:"+TS.model.previewed_member_id);e.clear();e.add(i.id);var r=$("#member_preview_container");$("#user_group_preview_container").hideWithRememberedScrollTop();$("#team_list_container").hideWithRememberedScrollTop();r.unhideWithRememberedScrollTop();var s=$("#profile_flexpane_mount_point");TS.interop.mountProfileFlexpane(TS.boot_data.team_id,s[0],{userId:i.id});TS.model.last_previewed_member_id=i.id;var o=$("#back_from_member_preview");v(n,o,a)};var x=function e(t,i,n){if(TS.model.previewed_member_id===t.id){var a=TS.team.getVisibleTeamProfileFieldsForMember(t);$("#member_data_table_team_fields").html(TS.templates.team_profile_fields({fields:a}));t.is_restricted&&$("#member_data_table_guest_fields").html(TS.templates.guest_profile_fields({member:t,guest_channels:n}));t.is_external&&!t.is_stranger&&$("#member_data_table_shared_channels").html(TS.templates.shared_channels_profile_field({shared_channels:i}))}};var I=function e(t){return{shared_teams:TS.teams.getSharedTeamsForMember(t)}};var M=function e(t){if(TS.model.previewed_member_id!==t.id)return;$("#member_data_table_shared_teams").html(TS.templates.member_shared_teams(I(t)))};var E=function e(t,i){var n="\u2013";var a=t&&isFinite(i)?TS.interop.i18n.number(i):n;$("#channel_members_toggle_count_count").text(a);$("#channel_members_toggle_count").removeClass("hidden")};var B=function e(t,i,n){i=t?TS.interop.i18n.number(i):"\u2013";var a=_(n.members).map(function(e){return TS.interop.members.getMemberById(e)}).compact().filter(TS.interop.members.isExternal).value().length;var r=TS.teams.getTeamNameById(n.shared_team_ids[0]);var s=i+" ("+TS.interop.i18n.number(a)+TS.interop.i18n.t(" from ","client")()+r+")";$("#channel_members_toggle_count_count").text(s);$("#channel_members_toggle_count").removeClass("hidden")};var P=82;var U=142;var D=function e(){var t=$("#presence");1==t.css("opacity")?t.css("opacity",.98):t.css("opacity",1)};var F="set_active_prompt";var O=function e(t){if(t.is_self&&TS.generic_dialog.is_showing&&TS.generic_dialog.current_setting.unique===F){var i=TS.redux.presence.getPresenceByMemberId(t.id);"away"!==i&&TS.generic_dialog.cancel()}};var R=function e(){var t=TS.model.user;if("away"!==t.manual_presence)return;TS.model.ui.is_window_focused?N():TS.ui.window_focus_changed_sig.addOnce(N)};var N=function e(){if(!TS.prefs.getPref("confirm_user_marked_away"))return;var t=TS.model.user;var i='<p class="no_bottom_margin float_right"><label class="checkbox overlay_pref block"><input id="confirm_user_marked_away" type="checkbox" /> '+TS.interop.i18n.t("Don\u2019t ask me again, please","client")()+"</label><p>";setTimeout(function(){if("away"!==TS.redux.presence.getPresenceByMemberId(t.id))return;TS.members.presence_changed_sig.add(O);TS.generic_dialog.start({unique:F,title:TS.interop.i18n.t('You are marked as "away"',"client")(),body:"<p>"+TS.interop.i18n.t("Would you like to switch to appear active?","client")()+"</p>"+i,show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Yes, set me to active","client")(),go_button_class:"btn_success",cancel_button_text:TS.interop.i18n.t("No, still away","client")(),onGo:function e(){var i=TS.redux.presence.getPresenceByMemberId(t.id);"away"===i&&TS.redux.presence.toggleUserPresence();var n=!!$("#confirm_user_marked_away").prop("checked");n&&TS.prefs.setPrefByAPI({name:"confirm_user_marked_away",value:false})},onCancel:function e(){var t=!!$("#confirm_user_marked_away").prop("checked");t&&TS.prefs.setPrefByAPI({name:"confirm_user_marked_away",value:false});TS.members.presence_changed_sig.remove(O)}})},2e3)};var L=function e(){var t=3e5;var i=void 0;TS.redux.socket.disconnectedSig.add(function(){i=Date.now()});TS.redux.socket.connectedSig.add(function(e){if(e)return;if(i){var n=Date.now()-i;if(n<t)return}R()})};var G=function e(){if(!TS.client||!TS.model.team)return;var t=0;var i=0;var n=0;var a=.5;TS.model.members&&_.each(TS.model.members,function(e){e.is_bot&&(i+=1);if(!e||!e.profile||!e.profile.email)return;if(e.id===TS.model.user.id)return;t+=1});n=TS.model.members.length-i;if(TS.prefs.getTeamPref("display_email_addresses"))if(t){if(t/n<a){TS.warn("Email display allowed for this team, but < "+100*a+"% of non-bot members ("+t+"/"+n+") in model have email fields. Dumping LS cache to correct inconsistency.");TS.shared.onDisplayEmailAddressesPrefChanged()}}else{TS.log(550,"Email display allowed for this team, but no email fields found in TS.model.members.");TS.shared.onDisplayEmailAddressesPrefChanged()}else if(t){TS.log(550,"Email display hidden for this team, but found "+t+" email fields in TS.model.members.");TS.shared.onDisplayEmailAddressesPrefChanged()}else TS.log(550,"Email display hidden for this team. Client model OK. \u2713")};var H=function e(t){if(t)return;if(!TS||!TS.client||!TS.view)return;var i=TS.interop.utility.addJitter(4e3,0,.5);setTimeout(function(){TS.view.rebuildStars();TS.view.rebuildMentions();TS.view.rebuildPreviewedMember();TS.view.files.throttledRebuildList();TS.client.msg_pane.displayTitle();TS.client.msg_pane.rebuildChannelMembersList();TS.model.previewed_file_id&&TS.client.ui.files.rebuildFilePreview(TS.files.getFileById(TS.model.previewed_file_id))},i)};var Q=function e(t){var i=TS.interop.userGroups.getUserGroupById(t);var n=TS.model.ui_state.flex_name;if(!i||TS.interop.rules.user_groups.isUnknownOrNonExistent(i)||!TS.model.ui_state.flex_visible||!_.isEqual(n,"groups"))return;var a=_.map(i.prefs.channels,function(e){return TS.interop.channels.getPublicChannelById(e,false)});var r=_.get("user_group.prefs",s);var s=_.map(r,function(e){return TS.interop.channels.getGroupById(e)});a=_(a).concat(s).compact().value();var o="";_.each(a,function(e){o+=TS.templates.user_group_channel_list_item(e)});$('[data-js="user_group_channel_list"]').html(o)}})();var T=i(3040);var S=i(3041);var v=i(3042);var b=i(3043);var w=i(3044);var y=i(3045);var A=i(3046);var k=i(3047);var C=i(3048);var x=i(3049);var I=i(3050);var M=i(3051);var E=i(3052);var B=i(3053);var P=i(40);var U=i.n(P);(function(){TS.registerModule("client.traces",{onStart:function e(){},canTrace:function e(){return!!(_.get(window,"desktop.stats.startTraceRecord")&&_.get(window,"desktop.stats.stopTraceRecord"))},startTrace:function e(t,i){if(!TS.client.traces.canTrace())return p();if(m())return p(s);s=f(t,i);r=s.delay(u(t)).finally(function(){h()}).catch(_.noop);return p(s)},stopTrace:function e(){if(!TS.client.traces.canTrace())return;if(!m())return;s.finally(function(){r.cancel()}).catch(_.noop)},test:function e(){var e={};Object.defineProperty(e,"_getTraceIdentifier",{get:function e(){return o},set:function e(t){o=t}});Object.defineProperty(e,"_getTraceEndpoint",{get:function e(){return l},set:function e(t){l=t}});Object.defineProperty(e,"_getTraceToken",{get:function e(){return c},set:function e(t){c=t}});Object.defineProperty(e,"_getSafeTraceMetadata",{get:function e(){return d},set:function e(t){d=t}});Object.defineProperty(e,"_getSafeTracePeriod",{get:function e(){return u},set:function e(t){u=t}});Object.defineProperty(e,"_traceInFlight",{get:function e(){return m},set:function e(t){m=t}});Object.defineProperty(e,"_promiseToStartTrace",{get:function e(){return f},set:function e(t){f=t}});Object.defineProperty(e,"_promiseToStopTrace",{get:function e(){return h},set:function e(t){h=t}});Object.defineProperty(e,"_getExternalPromise",{get:function e(){return p},set:function e(t){p=t}});Object.defineProperty(e,"_trace_p",{get:function e(){return r},set:function e(t){r=t}});Object.defineProperty(e,"_start_trace_p",{get:function e(){return s},set:function e(t){s=t}});return e}});var e=1e3;var t=1*e;var i=60*e;var n=20*e;var a=0;var r;var s;var o=function e(){a+=1;return[_.get(TS.model,"user.team_id")||_.get(TS.boot_data,"team_id"),_.get(TS.model,"user.id")||_.get(TS.boot_data,"user_id"),Date.now(),a].join("_")};var l=function e(){return _.get(TS.model,"async_api_url")+"profiling.addTrace"};var c=function e(){return _.get(TS.model,"api_token")};var d=function e(t){function i(e,t){_.each(e,function(n,a){a===t?delete e[a]:n===t?e[a]="(redacted)":"object"===("undefined"===typeof n?"undefined":U()(n))&&i(n,t)})}i(t,c());return t};var u=function a(r){r=parseInt(r,10);return _.isNaN(r)?n:_.clamp(r*e,t,i)};var m=function e(){return!!r&&r.isPending()};var f=function e(t,i){var n=o();return Promise.resolve(window.desktop.stats.startTraceRecord({identifier:n,endpoint:l(),token:c(),metadata:_.assign({},d(i),{identifier:n,duration:u(t)})}))};var h=function e(){return Promise.resolve(window.desktop.stats.stopTraceRecord())};var p=function e(t){if(!t)return Promise.resolve();return new Promise(function(e){t.then(function(t){return e(t)})})}})();var D=i(3054);var F=i(1981);var O=i(3056);var R=i(2003);var N=i(2574);var L=i(3057);var G=i(3058);var H=i(3059);var Q=i(3060);var j=i(3061);var K=i(3062);var W=i(1987);var V=i(3063);var z=i(3064);var Y=i(3065);var q=i(3066);var J=i(3067);var Z=i(3068);var X=i(1364);var ee=i(2024);var te=i(3069);var ie=i(3070);var ne=i(3071);var ae=i(3072);var re=i(3536);var se=i(1984);var oe=i(2023);var le=i(3073);var ce=i(3074);var de=i(1051);var ue=i(3075);var _e=i(3076);var me=i(3077);var fe=i(3078);var he=i(24);var pe=i.n(he);var ge=i(67);var Te=i.n(ge);(function(){TS.registerModule("ui.channel_browser",{onStart:function e(){TS.channels.list_fetched_sig.add(M);TS.view.members.unknown_resolution_rebuild_sig.add(E);TS.channels.unshared_sig.add(P);TS.channels.joined_sig.add(B);TS.channels.left_sig.add(B)},start:function n(a){a=a||{};u=a.onBack||null;if(i)return;if(TS.model.user.is_ultra_restricted)return;if(TS.client.ui.checkForEditing())return;if(TS.isPartiallyBooted()){TS.incremental_boot.userDidInteractWithUI();return}i=true;var r="channel_browser_show";var s="start_channel_browser_show";TS.metrics.mark(s);var o=TS.permissions.members.canCreateChannels()||TS.permissions.members.canCreateGroups();var m=TS.permissions.members.canCreateSharedChannel();var f=TS.interop.i18n.t("Browse channels","channel_browser")();c=e;d=t;if(TS.model.ui_state){c=TS.model.ui_state.channel_browser_show_which_channels;d=TS.model.ui_state.sort_channel_browser_by}if(a.show_which_channels&&TS.model.ui_state){TS.model.ui_state.channel_browser_show_which_channels=a.show_which_channels;TS.storage.storeUIState(TS.model.ui_state)}Q().then(function(){var e=TS.teams.getAllExternalTeams();var t=e.length;TS.model.user.is_admin&&(t=_.chain(l).filter(function(e){return e.channels.length>0}).size().value());var i=TS.templates.channel_browser({show_which_channels_selected:c,sort_by_selected:d,can_create:o,can_create_shared_channel:m,title:f,external_teams:e,external_teams_count:t});TS.ui.fs_modal.start({body_template_html:i,onShow:y,onEnd:k,modal_class:"fs_modal_internal_scroll"});if(u){TS.ui.fs_modal.bindBackButton(function(){u();TS.ui.fs_modal.close()});TS.ui.fs_modal.showBackButton()}TS.metrics.measureAndClear(r,s);TS.interop.clog.track("CHANNEL_BROWSER_OPEN",{is_admin:TS.model.user.is_admin,enable_shared_channels_pref:TS.prefs.getTeamPref("enable_shared_channels")})})},endAndStartSharedChannelDialog:function e(){k();TS.ui.share_channel_dialog.start({element:"shared_channels_channel_browser_create_btn"})},openConnectedWorkspacesModal:function e(){TS.interop.mountConnectedWorkspaces(TS.boot_data.team_id,{referringUiElement:"SHARED_CHANNELS_CHANNEL_BROWSER_BACK_TO_MANAGE_MODAL_BTN",onBack:function e(){TS.ui.channel_browser.start({onBack:TS.ui.channel_browser.openConnectedWorkspacesModal})}});TS.ui.fs_modal.close()},highlightPendingInvitationsOnNextOpen:function e(){s=true},test:function e(){var t={onShow:y,onEnd:k,channelsListFetched:M,filterList:G,sortChannels:X};Object.defineProperty(t,"_openChannel",{get:function e(){return re},set:function e(t){re=t}});Object.defineProperty(t,"_confirmIntentToDisconnectSharedChannel",{get:function e(){return se},set:function e(t){se=t}});return t}});var e="all";var t="name";var i=false;var n=false;var a=null;var r;var s=false;var o=null;var l=null;var c=e;var d=t;var u;var m;var f;var h;var p;var g;var T;var S;var v;var b;var w;var y=function e(){m=$("#channel_browser");f=m.find("#channel_list_container");h=m.find("#channel_browser_filter");p=m.find("#channel_browser_sort");S=m.find("#show_which_channels");T=$("#new_channel_container");v=$(".view_connected_workspaces");te();C();if(A()){r=false;TS.channels.fetchList();I()}else M()};var A=function e(){if(!r)return true;var t=_.some(TS.model.channels,function(e){return e.is_ext_shared&&void 0===e.shares});if(t)return true;var i=TS.model.ui_state&&-1===["members_high","members_low"].indexOf(TS.model.ui_state.sort_channel_browser_by);if(i)return false;var n=_.some(TS.model.channels,function(e){return void 0===e.num_members});if(n)return true;return false};var k=function r(){i=false;n=false;a=null;u=null;o=null;l=null;TS.kb_nav.end();m&&m.remove();m=null;f=null;h=null;p=null;S=null;T&&T.remove();T=null;c=e;d=t;ie();TS.ui.new_channel_modal.end()};var C=function e(){var t=!!A();var r={classes:"show_which_channels_selector",disabled:t,onItemAdded:function e(t){if(!i||!n)return;var a;if(TS.useReactLFS())c=t.value;else{a=$(t);c=a.val()}if(TS.model.ui_state){TS.model.ui_state.channel_browser_show_which_channels=c;TS.storage.storeUIState(TS.model.ui_state)}if("archived"===c)if(TS.useReactLFS())T();else{p.lazyFilterSelect("update",_.toArray(p.children()).filter(function(e){return"members_low"!==e.value&&"members_high"!==e.value}));"members_low"!==d&&"members_high"!==d||p.lazyFilterSelect("setValue","name")}else TS.useReactLFS()?T():p.lazyFilterSelect("update");G({show_which_channels:c})},template:function e(t){if(TS.useReactLFS())return t.label;var i=$(t);return new Handlebars.SafeString(i.text())},tokenTemplateSingle:function e(t){if(TS.useReactLFS())return TS.interop.lazyFilterSelect.channelBrowserShowWhichChannelsToken(t);var i=$(t);var n;n=TS.boot_data.feature_channel_browser_dropdown?TS.interop.i18n.t('<span class="bold">Show:</span> {value}',"channel_browser")({value:i.text()}):TS.interop.i18n.t('<span class="greigh">Show:</span> {value}',"channel_browser")({value:i.text()});return new Handlebars.SafeString(n)},listItemClass:function e(){return"capitalize"}};if(TS.useReactLFS()){var s=document.getElementById("show_which_channels_react");var o=TS.ui.lazy_filter_select.convertHTMLDataToRLFSData(S);r=_.assign({},r,{items:_.concat([],o),tokenTemplate:r.tokenTemplateSingle,single:true,styling:"small",disabled:t,onListShown:function e(){TS.ui.lazy_filter_select.is_list_open=true;TS.kb_nav.pause(true)},onListHidden:function e(){TS.ui.lazy_filter_select.is_list_open=false;TS.kb_nav.pause(false)}});TS.interop.mountLazyFilterSelect(TS.boot_data.team_id,s,r);S.hide()}else S.hide().lazyFilterSelect(r);var l={classes:"channel_browser_sort",disabled:t,onItemAdded:function e(t){if(!i||!n)return;var r;if(TS.useReactLFS())d=t.value;else{r=$(t);d=r.val()}if(TS.model.ui_state){TS.model.ui_state.sort_channel_browser_by=d;TS.storage.storeUIState(TS.model.ui_state)}return new Promise(function(e){if(!A())return e();TS.channels.list_fetched_sig.addOnce(e);TS.channels.fetchList()}).then(function(){D(function(){return true});X(a,d);G({show_which_channels:c})})},template:function e(t){if(TS.useReactLFS())return t.label;var i=$(t);return new Handlebars.SafeString(i.text())},tokenTemplateSingle:function e(t){if(TS.useReactLFS())return TS.interop.lazyFilterSelect.channelBrowserSortByToken(t);var i=$(t);var n;n=TS.boot_data.feature_channel_browser_dropdown?TS.interop.i18n.t('<span class="bold">Sort:</span> {value}',"channel_browser")({value:i.text()}):TS.interop.i18n.t('<span class="greigh">Sort:</span> {value}',"channel_browser")({value:i.text()});return new Handlebars.SafeString(n)}};function T(e){if(!e){e=TS.ui.lazy_filter_select.convertHTMLDataToRLFSData(p);if("archived"===c){e=e.filter(function(e){return"members_low"!==e.value&&"members_high"!==e.value});"members_low"!==d&&"members_high"!==d||(e=e.map(function(e){e.preselected="name"===e.value;return e}))}}var i=document.getElementById("channel_browser_sort_react");$(i).html("");l=_.assign({},l,{items:_.concat([],e),tokenTemplate:l.tokenTemplateSingle,single:true,styling:"small",disabled:t});TS.interop.mountLazyFilterSelect(TS.boot_data.team_id,i,l)}if(TS.useReactLFS()){T();p.hide()}else p.hide().lazyFilterSelect(l);b=$(".show_which_channels_selector");w=$(".channel_browser_sort");if(TS.boot_data.feature_channel_browser_dropdown){b.find(".lfs_input").attr("size","auto");w.find(".lfs_input").attr("size","auto");_e();me();S.on("change",function(){_e()});p.on("change",function(){me()})}f.on("click",".channel_browser_row",function(e){re($(this),e)});h.on("textchange",function(){if(!i||!n)return;G({show_which_channels:c})}).on("keydown",function(e){e.which===TS.utility.keymap.esc&&TS.ui.fs_modal.close()});g.on("click",".about_channels",function(e){e.preventDefault();TS.ui.fs_modal.close();setTimeout(function(){TS.coachmark.start($.extend({},TS.coachmarks.coachmarks.channels,{ui_click:true}))},500)});g.toggleClass("hidden",!!u);m.on("click",".new_channel",ne);m.on("click",".clear_filter_icon",function(){h.val("").trigger("textchange").focus()});v.on("click",function(){TS.interop.mountConnectedWorkspaces(TS.boot_data.team_id,{referringUiElement:"SHARED_CHANNELS_CHANNEL_BROWSER_MANAGE_SHARED_CHANNELS_BTN",onBack:function e(){TS.ui.channel_browser.start({onBack:u})}});TS.ui.fs_modal.close()})};var x=function t(){if(!i)return;if(TS.model.ui_state&&TS.model.ui_state.sort_channel_browser_by){d=TS.model.ui_state.sort_channel_browser_by;p.lazyFilterSelect("setValue",d)}if(TS.model.ui_state&&!_.isUndefined(TS.model.ui_state.channel_browser_show_which_channels)){c=TS.model.ui_state.channel_browser_show_which_channels;if(L({},TS.model.ui_state.channel_browser_show_which_channels)){c=e;TS.model.ui_state.channel_browser_show_which_channels=c;TS.storage.storeUIState(TS.model.ui_state)}S.lazyFilterSelect("setValue",c)}p.lazyFilterSelect("enable");S.lazyFilterSelect("enable")};var I=function e(){if(!i)return;G({show_which_channels:c,force_render:true})};var M=function e(){if(!i)return;r=true;x();TS.utility.rAF(I)};var E=function e(t){D(function(e){return e.creator===t.id})};var B=function e(t){D(function(e){return e.id===t.id},{should_reapply_filters:true})};var P=function e(t){if(!t.unlinked)return;D(function(e){return e.id===t.id},{should_reapply_filters:true})};var U=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n)return;var a=f.longListView("getCurrentVisibleItemsInView");i.should_reapply_filters&&a.some(t)?G({show_which_channels:c}):a.filter(t).forEach(function(e){f.longListView("itemUpdatedById",e.id)})};var D=function e(t){var i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};if(!n)return;f.longListView("isScrolling")?f.longListView("getCurrentVisibleItemsInViewSignal").addOnce(U.bind(void 0,t,i)):U(t,i)};var F=function e(t,i){var n=$(".channel_modal_list").find('[data-channel-id="'+t.id+'"]');var a=n.find(".channel_browser_teams");a.html(TS.templates.shared_channel_list_team_icon({canceled:true,target_team:i}))};var O=function e(t,i){var n=$(".channel_modal_list").find('[data-invite-id="'+t+'"]');var a=n.find(".channel_browser_invite_actions");n.find(".channel_browser_invite_status").addClass("hidden");a.html(TS.templates.shared_channel_invite_info({declined:true,inviting_team:i}))};var R=function e(t){var i=t.pending_shared_channels,n=t.member_channels,a=t.public_nonmember_channels,r=t.private_shared_nonmember_rollup;var s=[];var o=TS.model.user.is_admin;var l=""!==TS.model.team.plan;if(o&&i.length>0&&(l||"treatment"===TS.interop.experiments.getGroupForUser("shared_channels_trial_flow"))){s.push({is_divider:true,first_divider:true,name:TS.interop.i18n.t("Pending invitations","channel_browser")()});s=s.concat(i)}if(a.length>0){s.push({is_divider:true,first_divider:!o||o&&0===i.length,name:TS.interop.i18n.t("Channels you can join","channel_browser")()});s=s.concat(a)}if(n.length>0){s.push({is_divider:true,name:TS.interop.i18n.t("Channels you belong to","channel_browser")()});s=s.concat(n)}if(o&&r.length>0){s.push({is_divider:true,name:TS.interop.i18n.t("Channels you can\u2019t access","channel_browser")()});s=s.concat(r)}return s};var N=function e(){f.longListView({items:a,approx_item_height:60,preserve_dom_order:true,calcDividerHeight:function e(t,i){if(i.first_divider)return 32;return 61},makeElement:function e(t){var i=$(TS.templates.channel_browser_row());t.$icon=i.find(".channel_browser_type_icon");t.$created_info=i.find(".channel_browser_channel_created_info");t.$name=i.find(".channel_browser_channel_name");t.$purpose=i.find(".channel_browser_channel_purpose");t.$external_shared_channels_icon=i.find(".shared_channels_icon");t.$external_shared_channels_pending_icon=i.find(".shared_channels_pending_icon");t.$external_shared_channels_invite_info=i.find(".channel_browser_channel_invite_info");t.$external_shared_channels_shared_info=i.find(".channel_browser_channel_shared_info");t.$esc_private_shared_nonmember_rollup_info=i.find(".channel_browser_private_channel_rollup_info");t.$view_invitation_btn=i.find(".channel_browser_view_invitation_btn");t.$decline_invitation_btn=i.find(".channel_browser_decline_invitation_btn");t.$member_count=i.find(".channel_browser_member_count");t.$member_count_container=i.find(".channel_browser_member_count_container");t.$open=i.find(".channel_browser_open");t.$preview=i.find(".channel_browser_preview");t.$joined=i.find(".channel_browser_joined");t.$shared_channel_icon=i.find(".shared_channel_icon");t.$teams=i.find(".channel_browser_teams");return i},makeDivider:function e(){return $("<div>").addClass("channel_browser_divider")},renderItem:function e(t,i,n){if(TS.interop.rules.channels.isOrgShared(i)){n.$shared_channel_icon.removeClass("hidden");n.$external_shared_channels_icon.addClass("hidden");n.$external_shared_channels_pending_icon.addClass("hidden")}else if(TS.interop.rules.channels.isPendingExternallySharedChannel(i)){var a=n.$external_shared_channels_pending_icon.find(".ts_icon_shared_channels");a.removeClass("ts_icon_shared_channels");a.addClass("ts_icon_shared_channels_pending");n.$external_shared_channels_pending_icon.removeClass("hidden");n.$external_shared_channels_icon.addClass("hidden");n.$shared_channel_icon.addClass("hidden")}else if(TS.interop.rules.channels.isExternallySharedChannel(i)&&!i.is_nonmember_private_shared_channel_rollup){n.$external_shared_channels_icon.removeClass("hidden");n.$shared_channel_icon.addClass("hidden");n.$external_shared_channels_pending_icon.addClass("hidden")}else{n.$external_shared_channels_icon.addClass("hidden");n.$shared_channel_icon.addClass("hidden");n.$external_shared_channels_pending_icon.addClass("hidden")}i.is_group||i.is_private?n.$icon.removeClass("ts_icon_channel_pane_hash ts_icon_archived_channel").addClass("ts_icon_lock"):i.is_archived?n.$icon.removeClass("ts_icon_lock ts_icon_channel_pane_hash").addClass("ts_icon_archived_channel"):n.$icon.removeClass("ts_icon_lock ts_icon_archived_channel").addClass("ts_icon_channel_pane_hash");n.$icon.toggleClass("hidden",!!i.is_nonmember_private_shared_channel_rollup);n.$esc_private_shared_nonmember_rollup_info.toggleClass("hidden",!i.is_nonmember_private_shared_channel_rollup);t.toggleClass("esc_nonmember_private_channel_rollup",!!i.is_nonmember_private_shared_channel_rollup);n.$name.text(i.name);if(i.invite_id){var r;r=i.receiving_user_id===TS.model.user.id?TS.interop.i18n.t("<strong>{team_name}</strong> sent this invitation to you on {date}.","channel_browser")({team_name:_.escape(i.inviting_team),date:TS.interop.datetime.toCalendarDate(i.created)}):TS.interop.i18n.t('<strong>{team_name}</strong> sent this invitation to <strong data-label="receiving_user_name">another admin</strong> on {date}.',"channel_browser")({team_name:_.escape(i.inviting_team),date:TS.interop.datetime.toCalendarDate(i.created)});n.$external_shared_channels_invite_info.find(".channel_browser_invite_text").html(r);n.$external_shared_channels_invite_info.removeClass("hidden");n.$created_info.addClass("hidden");n.$external_shared_channels_shared_info.addClass("hidden");i.receiving_user_id!==TS.model.user.id&&TS.interop.members.ensureMembersArePresent([i.receiving_user_id]).then(function(){var e=_.escape(TS.interop.members.getPrefCompliantMemberNameById(i.receiving_user_id));n.$external_shared_channels_invite_info.find('[data-label="receiving_user_name"]').text(e)})}else if(i.shares&&i.shares.length){n.$created_info.addClass("hidden");n.$external_shared_channels_invite_info.addClass("hidden");n.$external_shared_channels_shared_info.removeClass("hidden");TS.interop.members.ensureMembersArePresent([i.creator,i.shares[0].user]).then(function(){var e=de(i);n.$external_shared_channels_shared_info.html(e)})}else if(i.is_nonmember_private_shared_channel_rollup){n.$created_info.addClass("hidden");n.$external_shared_channels_shared_info.addClass("hidden");n.$external_shared_channels_invite_info.addClass("hidden")}else{n.$created_info.removeClass("hidden");n.$external_shared_channels_shared_info.addClass("hidden");n.$external_shared_channels_invite_info.addClass("hidden");var s=f.longListView("isScrolling");var o=TS.interop.members.getMemberById(i.creator,s);o?n.$created_info.html(TS.interop.i18n.t("Created by {user} on {date}","channel_browser")({user:TS.interop.i18n.safeString("<strong>"+_.escape(TS.interop.members.getPrefCompliantMemberName(o))+"</strong>"),date:TS.interop.datetime.toCalendarDate(i.created)})):n.$created_info.html(TS.interop.i18n.t("Created on {date}","channel_browser")({date:TS.interop.datetime.toCalendarDate(i.created)}))}if(TS.model.ui_state&&-1===["members_high","members_low"].indexOf(TS.model.ui_state.sort_channel_browser_by))n.$member_count_container.addClass("hidden");else{var l=ee(i);n.$member_count.text(l);n.$member_count_container.removeClass("hidden")}if(i.purpose&&i.purpose.value){var c=TS.utility.formatTopicOrPurpose(i.purpose.value);c=c.replace(/<a .*?>(.*?)<\/a>/g,"$1");n.$purpose.removeClass("hidden").html(c)}else n.$purpose.text("").addClass("hidden");var d=i.is_member||i.is_group;if(d){n.$open.removeClass("hidden");n.$preview.addClass("hidden");n.$joined.removeClass("hidden")}else{n.$open.addClass("hidden");n.$preview.removeClass("hidden");n.$joined.addClass("hidden")}if(i.is_group){t.removeClass("channel_link").removeAttr("data-channel-id");t.addClass("group_link").attr("data-group-id",i.id)}else if(i.invite_id){t.removeClass("channel_link").removeAttr("data-channel-id");t.removeClass("group_link").removeAttr("data-group-id");t.addClass("invite_link").attr("data-invite-id",i.invite_id)}else if(i.is_nonmember_private_shared_channel_rollup){t.removeClass("channel_link").removeAttr("data-channel-id");t.removeClass("group_link").removeAttr("data-group-id");t.attr("data-target-team-id",i.shared_team_ids[0]);t.attr("data-num-private-channels",i.private_nonmember_channel_count)}else{t.removeClass("group_link").removeAttr("data-group-id");t.addClass("channel_link").attr("data-channel-id",i.id)}if(!TS.interop.rules.channels.isExternallySharedChannel(i)&&!TS.interop.rules.channels.isPendingExternallySharedChannel(i)||i.invite_id)n.$teams.remove();else{var u=_.map(TS.utility.teams.getTeamsForModelOb(i),"id");var m=_.map(TS.utility.teams.getTeamsForModelOb(i,{only_pending:true}),"id");var h={shared_team_ids:u,pending_shared_team_ids:m};if(i.is_nonmember_private_shared_channel_rollup){h.is_nonmember_private_shared_channel_rollup=true;h.num_private_channels=i.private_nonmember_channel_count}var p=TS.templates.shared_channel_list_team_icon(h);n.$teams.html(p);n.$teams.parent().length||t.append(n.$teams)}},renderDivider:function e(t,i){t.text(i.name)},calcItemHeight:function e(t){return t.outerHeight()}});TS.environment.supports_custom_scrollbar||f.monkeyScroll();n=true;if(s){setTimeout(V,200);s=false}TS.kb_nav.start(f.find(".list_items"),".channel_browser_row",f,{use_data_ordering:true,px_offset:35,scrollToStartImmediately:function e(){f.longListView("scrollToTop",true)},scrollToEndImmediately:function e(){f.longListView("scrollToEnd",true)}});TS.kb_nav.setAllowHighlightWithoutBlurringInput(true);TS.kb_nav.setSubmitItemHandler(function(e){re($(this),e)})};var L=function e(t,i){if("all"===i)return!t.is_archived;if("local"===i)return!TS.interop.rules.channels.isExternallySharedChannel(t)&&!TS.interop.rules.channels.isOrgShared(t)&&!t.is_archived;if("org_shared"===i)return TS.interop.rules.channels.isOrgShared(t)&&!t.is_archived;if("ext_shared"===i)return TS.interop.rules.channels.isExternallySharedChannel(t);if(i.indexOf("ext_shared_team")>-1){if(TS.interop.rules.channels.isExternallySharedChannel(t)||TS.interop.rules.channels.isPendingExternallySharedChannel(t)){if(t.shared_team_ids&&t.shared_team_ids.some(function(e){return i.indexOf(e)>-1}))return true;return t.pending_shared&&t.pending_shared.some(function(e){return i.indexOf(e)>-1})}return false}if("archived"===i)return t.is_archived;if("private"===i)return(t.is_group||t.is_private)&&!t.is_archived;return true};var G=function e(t){t=t||{};t.show_which_channels||(t.show_which_channels="all");var i="channel_browser_search";var r="start_channel_browser_search";TS.metrics.mark(r);var s=$.trim(h.val());if(""!==s&&-1!==s.indexOf("#")){s=s.replace("#","","g");s=$.trim(s)}s?h.closest(".channel_browser_filter_container").addClass("active"):h.closest(".channel_browser_filter_container").removeClass("active");var o=$(".p-connected_workspaces_alert");var c=$(".channel_browser_filter_sort");var u=t.show_which_channels.indexOf("ext_shared")>-1;var m=_.chain(l).filter(function(e){return e.channels.length>0}).size().value();if(TS.permissions.members.canCreateSharedChannel()&&u&&m){o.removeClass("hidden");if(TS.boot_data.feature_channel_browser_dropdown)c.removeClass("margin_bottom_100");else{c.addClass("margin_bottom_100");c.removeClass("margin_bottom_200")}}else{o.addClass("hidden");if(TS.boot_data.feature_channel_browser_dropdown)c.addClass("margin_bottom_100");else{c.addClass("margin_bottom_200");c.removeClass("margin_bottom_100")}}Promise.join(TS.searcher.search(s,Y({show_which_channels:t.show_which_channels})),H(t.show_which_channels),function(e,o){var l=Te()(o,2),c=l[0],u=l[1];a=e;if(u.length){var m=_.filter(u,function(e){return L(e,t.show_which_channels)});m.length&&(a=a.concat(m))}var h=t.show_which_channels.indexOf("ext_shared_team")>-1;if(TS.permissions.members.canManageExternalSharedChannels()&&h&&c.length){var p=t.show_which_channels.split("ext_shared_team_")[1];var g=c[p].private_nonmember_channel_count;g&&a.push({is_nonmember_private_shared_channel_rollup:true,id:"nonmember_private_channel_rollup_"+p,name:TS.interop.i18n.t("{channel_count, plural, =1 {# private shared channel} other {# private shared channels}}","channel_browser")({channel_count:g}),shared_team_ids:[p],is_ext_shared:true,private_nonmember_channel_count:g})}X(a,d);Z(d);if("archived"!==t.show_which_channels&&"private"!==t.show_which_channels){var T=z(a);a=R({pending_shared_channels:T.pending_shared_channels,member_channels:T.member_channels,public_nonmember_channels:T.public_nonmember_channels,private_shared_nonmember_rollup:T.private_shared_nonmember_channel_rollup})}if(n)n&&f.longListView("setItems",a,t.force_render);else{f.empty();N()}0===a.length?q(s):J();f.scrollTop(0);TS.utility.rAF(function(){TS.ui.utility.updateClosestMonkeyScroller(f)});s?TS.kb_nav.highlightFirstItem():TS.kb_nav.clearHighlightedItem();TS.metrics.measureAndClear(i,r)})};var H=function e(t){var i=Promise.resolve({});var n=Promise.resolve([]);var a=t.indexOf("ext_shared_team")>-1;TS.model.user.is_admin&&a&&(i=Q());var r="all"===t||"ext_shared"===t||a;TS.permissions.members.canManageExternalSharedChannels()&&r&&(n=j());return Promise.all([i,n])};var Q=function e(){if(!TS.permissions.members.canManageExternalSharedChannels())return Promise.resolve({});if(l)return Promise.resolve(l);return TS.interop.api.call("team.listExternal").then(function(e){l={};var t;_.map(e.data.teams,function(e){l[e.id]=e;t=0;_.map(e.channels,function(e){TS.interop.channels.getPublicChannelById(e)||(t+=1)});l[e.id].private_nonmember_channel_count=t});return l})};var j=function e(){if(o)return Promise.resolve(o);return TS.interop.api.call("conversations.listSharedInvites").then(function(e){o=_.map(e.data.inbound,function(e){return{invite_id:e.id,created:e.date_create,id:e.channel,receiving_user_id:e.receiving_user_id,name:e.channel_name,inviting_team:TS.interop.rules.teams.getTeamDisplayName(e.inviting_team),pending_shared:[e.inviting_team.id],is_pending_ext_shared:true}});return o})};var K=function e(t){if(!t)return;k();TS.ui.share_channel_dialog.showApproveRequestDialog(t,{onBack:TS.ui.channel_browser.start})};var W=function e(t){if(!t)return;ce(t)};var V=function e(){var t=$(".invite_link");if(t.length){var i=$(".channel_browser_divider").first();i.nextUntil(".channel_browser_divider").highlight(null,"channel_browser_pending_invitations_highlighter")}};var z=function e(t){var i=[];var n;var a;var r=[];TS.model.user.is_admin&&(r=_.remove(t,"is_nonmember_private_shared_channel_rollup"));var s=_.partition(t,function e(t){return t.is_member||t.is_group});if(TS.model.user.is_admin){var o=_.partition(s[0],TS.interop.rules.channels.isPendingExternallySharedChannel);var l=_.partition(s[1],TS.interop.rules.channels.isPendingExternallySharedChannel);i=_.concat(o[0],l[0]);n=o[1];a=l[1]}else{a=s[1];n=s[0]}return{pending_shared_channels:i,member_channels:n,public_nonmember_channels:a,private_shared_nonmember_channel_rollup:r}};var Y=function e(t){t=t||{};return{channels:true,groups:true,filter:function e(i){i.channels=_.filter(i.channels,function(e){return L(e,t.show_which_channels)});i.groups=_.filter(i.groups,function(e){return L(e,t.show_which_channels)});return i},sort:{allow_empty_query:true,frecency:false},limit:Infinity}};var q=function e(t){var i="ext_shared"===c||"pending_ext_shared"===c;var n=$("#channel_browser_empty");var a=n.find(".channel_browser_empty_message");t?a.html(TS.interop.i18n.t("No matches found for <strong>{query}</strong>","channel_browser")({query:TS.utility.truncateAndEscape(t,50)})):i&&TS.permissions.members.canRequestSharedChannel()?a.html(TS.templates.shared_channels_empty_state_for_channel_browser({can_create_shared_channel:TS.permissions.members.canCreateSharedChannel(),show_pending_shared_channels:"pending_ext_shared"===c})):a.text(TS.interop.i18n.t("No channels","channel_browser")());n.removeClass("hidden")};var J=function e(){var t=$("#channel_browser_empty");t.addClass("hidden")};var Z=function e(t){TS.interop.clog.track("CHANNEL_BROWSE_SORT",{sort_type:t})};var X=function e(t,i){var n=["name","creator","created","members_high","members_low"];var a="name";-1!==n.indexOf(i)&&(a=i);"creator"===a?t.sort(function(e,t){var i=TS.interop.members.getMemberById(e.creator);var n=TS.interop.members.getMemberById(t.creator);return TS.interop.i18n.sorter(TS.interop.members.getPrefCompliantMemberNameLowerCase(i),TS.interop.members.getPrefCompliantMemberNameLowerCase(n))}):"created"===a?t.sort(function(e,t){if(e.created<t.created)return 1;if(t.created<e.created)return-1;return 0}):"members_high"===a?t.sort(function(e,t){var i=ee(e);var n=ee(t);if(i<n)return 1;if(n<i)return-1;return 0}):"members_low"===a&&t.sort(function(e,t){var i=ee(e);var n=ee(t);if(i>n)return 1;if(n>i)return-1;return 0})};var ee=function e(t){return t.num_members||_.get(t,"active_members.length")||0};var te=function e(){g=$(TS.templates.channel_browser_footer()).appendTo("#fs_modal")};var ie=function e(){g&&g.remove();g=null};var ne=function e(){var t=$.trim(h.val());TS.ui.new_channel_modal.startInContainer(T,t);m.addClass("hidden");$("#fs_modal").removeClass("fs_modal_internal_scroll");T.removeClass("no_opacity");g.addClass("hidden");TS.ui.fs_modal.bindBackButton(ae);TS.ui.fs_modal.showBackButton()};var ae=function e(){TS.ui.fs_modal.unbindBackButton();TS.ui.fs_modal.hideBackButton();T.addClass("no_opacity");$("#fs_modal").addClass("fs_modal_internal_scroll");m.removeClass("hidden");g.removeClass("hidden");TS.ui.new_channel_modal.end();h.focus();n&&f.longListView("resizeImmediately");TS.ui.utility.updateClosestMonkeyScroller(f)};var re=function e(t,i){var n;var a;var r;var s;var o;if($(i.target).closest(".channel_browser_teams_disconnect_shared_channel").length){a=t.data("channel-id");r=t.data("group-id");se(a||r);return}if(t.hasClass("esc_nonmember_private_channel_rollup")){if($(i.target).closest(".channel_browser_teams_disconnect_private_non_member_shared_channels").length){o=t.data("target-team-id");var l=t.data("num-private-channels");oe(o,l)}return}if($(i.target).closest(".channel_browser_revoke_share_invite").length){a=t.data("channel-id")||t.data("group-id");n=TS.interop.channels.getPublicChannelById(a);o=n.pending_shared[0];var c="TS.ui.channel_browser._openChannel";TS.teams.ensureTeamsArePresent([o],c).then(function(){le(a,o)});return}if(t.hasClass("invite_link")){s=t.data("invite-id");$(i.target).closest(".channel_browser_view_invitation_btn").length&&K(s);$(i.target).closest(".channel_browser_decline_invitation_btn").length&&W(s);return}if(t.hasClass("channel_link")){a=t.data("channel-id");n=TS.interop.channels.getPublicChannelById(a);n&&TS.interop.clog.track("CHANNELBROWSER_SELECT",{item_id:a,item_type:a.charAt(0),is_member:n.is_member});TS.view.onChannelReferenceClick(i,a)}else{r=t.data("group-id");TS.interop.clog.track("CHANNELBROWSER_SELECT",{item_id:r,item_type:r.charAt(0)});TS.view.onGroupReferenceClick(i,r)}TS.ui.fs_modal.close()};var se=function e(t){var i;var n=TS.redux.channels.getEntityById(t);var a=_.map(TS.utility.teams.getTeamsForModelOb(n,{include_pending:true}),"id");var r=[TS.model.team.id].concat(pe()(a));var s=TS.templates.channel_stop_sharing_dialog({model_ob:n,team_ids:r});TS.generic_dialog.start({title:TS.interop.i18n.t("Stop sharing {channel_name}","shared")({channel_name:TS.interop.i18n.safeString(TS.templates.builders.makeModelObNameForDisplay(n,{inherit_font_size:true}))}),body:s,go_button_text:TS.interop.i18n.t("Stop Sharing","shared")(),go_button_class:"btn_danger",onGo:function e(){TS.interop.clog.track("SHARED_CHANNELS_STOP_SHARING_ACTION",{is_last_channel_with_team:i,contexts:{ui_context:{action:"click",ui_element:"SHARED_CHANNELS_STOP_SHARING_CONFIRM_SUBMIT_BTN",ui_component:"CHANNEL_BROWSER"}}});TS.redux.dispatch(TS.interop.channels.disconnectChannel({channelId:t}))},onCancel:function e(){TS.interop.clog.track("SHARED_CHANNELS_STOP_SHARING_ACTION",{is_last_channel_with_team:i,contexts:{ui_context:{action:"click",ui_element:"SHARED_CHANNELS_STOP_SHARING_CONFIRM_CANCEL_BTN",ui_component:"CHANNEL_BROWSER"}}})}});var o=$("#generic_dialog .dialog_go");o.toggleClass("disabled",true);var l="TS.ui.channel_browser._confirmIntentToDisconnectSharedChannel";TS.teams.getTeamIdsConnectedOnlyByModelOb(n,l).then(function(e){i=!!e.length;if(i){var t=TS.interop.i18n.listify(_.map(e,TS.teams.getTeamNameById)).join("");$(".p-stop_sharing_channel_dialog__last_channel_team_names").text(t);$(".p-stop_sharing_channel_dialog__last_channel_alert").removeClass("hidden")}TS.interop.clog.track("SHARED_CHANNELS_STOP_SHARING_ACTION",{is_last_channel_with_team:i,contexts:{ui_context:{action:"click",ui_element:"SHARED_CHANNELS_CHANNEL_BROWSER_STOP_SHARING_BTN",ui_component:"CHANNEL_BROWSER"}}});o.toggleClass("disabled",false)})};var oe=function e(t,i){var n=TS.teams.getTeamNameById(t);var a=TS.templates.channel_stop_sharing_private_channels_dialog({num_private_channels:i,target_team_name:n,current_team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team)});TS.interop.clog.trackClickWithContext({event:"SHARED_CHANNELS_STOP_SHARING_ACTION",element:"SHARED_CHANNELS_CHANNEL_BROWSER_STOP_SHARING_PRIVATE_NONMEMBER_CHANNELS_BTN"});TS.generic_dialog.start({title:TS.interop.i18n.t("Stop sharing {num_private_channels, plural, =1 {# channel} other {# channels}} with {target_team_name}?","shared_channels")({num_private_channels:i,target_team_name:n}),body:a,enter_always_gos:false,go_button_text:TS.interop.i18n.t("Stop Sharing","shared_channels")(),go_button_class:"btn_danger",onGo:function e(){var i={target_team:t,private_non_member_only:true};TS.interop.api.call("conversations.disconnectSharedTeam",i);TS.interop.clog.trackClickWithContext({event:"SHARED_CHANNELS_STOP_SHARING_ACTION",element:"SHARED_CHANNELS_CHANNEL_BROWSER_STOP_SHARING_PRIVATE_NONMEMBER_CHANNELS_CONFIRM_BTN"})},onCancel:function e(){TS.interop.clog.trackClickWithContext({event:"SHARED_CHANNELS_STOP_SHARING_ACTION",element:"SHARED_CHANNELS_CHANNEL_BROWSER_STOP_SHARING_PRIVATE_NONMEMBER_CHANNELS_CANCEL_BTN"})}});var r=$("#generic_dialog .dialog_go");r.toggleClass("disabled",true);$("#confirm_stop_sharing_private_non_member_channels").on("click",function(){r.toggleClass("disabled",!this.checked)})};var le=function e(t,i){var n=TS.redux.channels.getEntityById(t);TS.interop.api.callExpedited("conversations.sharedInviteInfo",{channel:t,target_team:i}).then(function(e){var t=e.data;var a=t.invite.inviting_user;var r=TS.teams.getTeamById(i);if(a.id===TS.model.user.id){F(n,r);ue(n,r)}else{var s=TS.templates.channel_cancel_share_invite_dialog({action:"revoke",target_team:r,inviter_name:a.profile.real_name});TS.generic_dialog.start({dialog_class:"p-channel_cancel_share_invite_dialog",title:TS.interop.i18n.t("Cancel invitation?","shared")(),body:s,go_button_text:TS.interop.i18n.t("Cancel Invitation","shared")(),cancel_button_text:TS.interop.i18n.t("Never Mind","shared")(),go_button_class:"btn_danger",onGo:function e(){F(n,r);ue(n,r)}})}})};var ce=function e(t){TS.interop.api.callExpedited("conversations.sharedInviteInfo",{invite:t}).then(function(e){var i=e.data;var n=TS.interop.rules.teams.getTeamDisplayName(i.invite.inviting_team);var a=i.invite.receiving_user_id;if(a===TS.model.user.id){O(t,n);TS.interop.channels.submitDeclineSharedChannelInvite(t)}else TS.interop.members.ensureMembersArePresent([a]).then(function(){var e=TS.templates.channel_cancel_share_invite_dialog({action:"decline",inviting_team_name:n,receiving_user_name:TS.interop.members.getPrefCompliantMemberNameById(a)});TS.generic_dialog.start({dialog_class:"p-channel_cancel_share_invite_dialog",title:TS.interop.i18n.t("Decline invitation?","shared")(),body:e,go_button_text:TS.interop.i18n.t("Decline Invitation","shared")(),cancel_button_text:TS.interop.i18n.t("Never Mind","shared")(),go_button_class:"btn_danger",onGo:function e(){O(t,n);TS.interop.channels.submitDeclineSharedChannelInvite(t)}})})})};var de=function e(t){var i=TS.interop.members.getMemberById(t.creator);var n=TS.interop.members.getMemberById(t.shares[0].user);var a;a=i.team_id===TS.model.team.id?n.id===i.id?TS.interop.i18n.t("Created and shared by <strong>{creating_user_name}</strong>","channel_browser")({creating_user_name:_.escape(TS.interop.members.getPrefCompliantMemberName(i))}):TS.interop.i18n.t("Created by <strong>{creating_user_name}</strong>. Shared by <strong>{sharing_user_name}</strong>","channel_browser")({creating_user_name:_.escape(TS.interop.members.getPrefCompliantMemberName(i)),sharing_user_name:_.escape(TS.interop.members.getPrefCompliantMemberName(n))}):TS.interop.i18n.t("Added by <strong>{accepting_user_name}</strong>","channel_browser")({accepting_user_name:_.escape(TS.interop.members.getPrefCompliantMemberName(n))});return a};var ue=function e(t,i){return TS.interop.api.call("conversations.revokeSharedInvite",{channel:t.id,target_team:i.id})};var _e=function e(){if(TS.boot_data.feature_channel_browser_dropdown){var t=TS.interop.i18n.t("Show:","channel_browser")();$("#temp_option_width").text(t+" "+$("#show_which_channels option:selected").text());var i=Math.min($("#temp_select_width").outerWidth(),300);b.css("width",i)}};var me=function e(){if(TS.boot_data.feature_channel_browser_dropdown){var t=TS.interop.i18n.t("Sort:","channel_browser")();$("#temp_option_width").text(t+" "+$("#channel_browser_sort option:selected").text());var i=Math.min($("#temp_select_width").outerWidth(),300);w.css("width",i)}}})();(function(){TS.registerModule("ui.im_browser",{onStart:function e(){c=new TS.PresenceList;TS.redux.socket.connectedSig.add(I)},start:function e(t){t=t||{};if(TS.client.ui.checkForEditing())return;if(TS.isPartiallyBooted()){TS.incremental_boot.userDidInteractWithUI();return}x();t.preselected_ids?TS.interop.members.ensureMembersArePresent(t.preselected_ids).catch(_.noop).then(function(){return b(t)}):b(t);TS.interop.clog.track("IM_BROWSER_OPEN",{})},startWithMpim:function e(t,i){if(!t)return;var n=i?[].concat(pe()(t.members),pe()(i)):[].concat(pe()(t.members));TS.ui.im_browser.start({preselected_ids:n})},test:function e(){return{onShow:w,onEnd:y,getLastMsg:M}},getRecentDMList:function e(){return A()},showRequestToDisconnectSharedChannelModal:function e(t){if(!t)return;var i=TS.interop.i18n.t("Only admins can share and unshare channels. If you\u2019d like to stop sharing <strong>{channel_name}</strong> with <strong>{team_name}</strong>, you\u2019ll need to ask one of the admins below.","shared_channels")({channel_name:TS.interop.rules.channels.getDisplayNameForChannel(t),team_name:TS.interop.i18n.safeString(_.escape(TS.teams.getTeamNameById(t.shared_team_ids[0])))});var n={is_admin_only_mode:true,title:TS.interop.i18n.t("Find an admin","shared_channels")(),subtitle:new Handlebars.SafeString(i),submit_callback:function e(){var i=TS.interop.i18n.t("Be sure to let your admin know the name of the channel (*{channel_name}*) you\u2019d like to stop sharing.","shared_channels")({channel_name:TS.interop.rules.channels.getDisplayNameForChannel(t)});TS.client.ui.addEphemeralBotMsg({text:i})}};TS.ui.im_browser.start(n)}});var e;var t;var i;var n;var a;var r;var s;var o;var l={};var c;var d=false;var u;var m;var f=false;var h=null;var p=null;var g=null;var T=64;var S=24;var v=8;var b=function e(t){d=!!t.is_admin_only_mode;h=t.submit_callback;s=[];l={};t.preselected_ids&&t.preselected_ids.forEach(function(e){var t=TS.interop.members.getMemberById(e);if(!t)return;if(t.is_self)return;if(t.deleted)return;if(TS.interop.rules.members.isSlackbotOrTeambot(t,TS.boot_data.feature_teambot))return;if(-1!==s.indexOf(t))return;s.push(t);l[t.id]=true});var i=TS.templates.im_browser({is_admin_only_mode:d,title:t.title,subtitle:t.subtitle,team_name:TS.interop.rules.teams.getTeamDisplayName(TS.model.team),preselected:s,reached_maximum:s.length===v,quickswitcher_shortcut:TS.model.is_mac?"\u2318K":"Ctrl+K"});TS.ui.fs_modal.start({body_template_html:i,onShow:w,onEnd:y,modal_class:"fs_modal_internal_scroll"})};var w=function e(){t=$("#im_browser");i=$("#im_list_container");s||(s=[]);ae();x().then(function(){TS.boot_data.feature_ms_latest&&i.empty();C()});var n=t.find(".im_browser_go")[0];n&&(m=Ladda.create(n));i.on("click",".im_browser_row",function(e){if(0!==$(e.target).closest("a").length)return;K($(this))});t.on("input","#im_browser_filter",function(){B()});t.on("keydown","#im_browser_filter",function(e){var t=$("#im_browser_filter").val();if(e.which===TS.utility.keymap.del&&""===t){V();return}if(e.which===TS.utility.keymap.enter&&""===t){e.preventDefault();TS.kb_nav.getHighlightedItem()||H();return}if(e.which===TS.utility.keymap.esc){TS.ui.fs_modal.close();return}s.length>=v&&e.preventDefault()});t.on("focus","#im_browser_filter",function(){$("#im_browser_tokens").addClass("active")}).on("blur","#im_browser_filter",function(){$("#im_browser_tokens").removeClass("active")});t.on("click","#im_browser_tokens",function(e){var t=$(e.target).closest(".member_token");if(t.length)W(t);else{if($(e.target).closest("#im_browser_filter").length)return;$("#im_browser_filter").focus()}});t.on("click",".im_browser_go:not(.disabled)",function(){H()});t.on("click",".create_private_channel",function(e){e.preventDefault();re()});setTimeout(function(){$("#im_browser_filter").focus()},0)};var y=function e(){TS.interop.clog.track("IM_BROWSER_END",{});t&&t.remove();t=null;i=null;n=null;a=null;d=false;r=null;s=null;l={};m=null;f=false;h=null;p&&p.cancel();g=null;TS.kb_nav.end();TS.ui.new_channel_modal.end();c.clear()};var A=function e(){var t=TS.members.getActiveMembersWithSelfAndSlackbot();var i=TS.redux.channels.dangerouslyGetMpims().filter(TS.interop.rules.channels.isVisibleMpim);var n=t.map(function(e){return{id:e.id,model_ob:TS.redux.channels.getImByMemberId(e.id),member:e}});var a=n;if(i&&i.length>0){var s=i.map(function(e){return{id:e.id,model_ob:e,members:TS.mpims.legacyGetMembersInDisplayOrder(e)}});a=n.concat(s)}a.sort(ee);r=a;return r};var k=function e(){p=TS.searcher.search("",ue({initial:true}));p.then(function(e){var n=_.map(e.members,function(e){return{id:e.id,model_ob:TS.redux.channels.getImByMemberId(e.id),member:e,disabled_dm:null}});var a=_.map(e.all_mpims,function(e){return{id:e.id,model_ob:e,members:TS.mpims.legacyGetMembersInDisplayOrder(e)}});var s=_.concat(n,a);s.sort(ee);r=s;i.longListView("setItems",r);t.addClass("showing_recent");t.removeClass("filter_active no_filter_matches");X();i.scrollTop(0);TS.utility.rAF(function(){TS.ui.utility.updateClosestMonkeyScroller(i)})});return p};var C=function e(){var t;k();t=[];i.longListView({items:t,approx_item_height:T,preserve_dom_order:true,makeElement:function e(){return $('<div class="im_browser_row" data-qa="im_browser_row"></div>')},renderItem:function e(t,i){t.data("row_id",i.id);if(!i.members&&!i.member){TS.console.warn("IM browser row for "+i.id+" has no members");t.html("");return}var n=i.model_ob;t.toggleClass("multiparty",!!(n&&n.is_mpim));t.toggleClass("disabled",!!l[i.id]);i.member&&t.toggleClass("disabled_dm",!!i.disabled_dm);var a={item:i,model_ob:n,slackbot_msg:u};if(i.members){i.members.length>0&&(a.member_one=i.members[0]);i.members.length>1&&(a.member_two=i.members[1])}else i.member&&i.member.is_self&&(a.is_self=true);a.secondary_name=null;if(n&&n.is_mpim)a.display_name=TS.mpims.legacyGetDisplayName(n);else{a.display_name=TS.interop.members.getPrefCompliantMemberName(i.member);a.secondary_name=TS.interop.members.getMemberSecondaryName(i.member);i.member.profile.title&&(a.title=i.member.profile.title)}var r="";var s="";var o=n&&M(n);var c;var d=false;if(o){var m=o.comment?TS.interop.members.getMemberById(o.comment.user):TS.interop.members.getMemberById(o.user);if(m){if(m.id===TS.model.user.id){r=TS.interop.i18n.t("You","im_browser")()+": ";d=true}else{r=_.escape(E(m));r+=": "}if(!o.file||"file_share"!==o.subtype&&"file_mention"!==o.subtype&&"file_reaction"!==o.subtype){c=TS.format.formatNoHighlightsNoSpecialsNoInlineImgs(o.text,o);c=c.replace(/<a .*?>(.*?)<\/a>/g,"$1")}else c=de(o);r+=c;d&&!TS.interop.rules.channels.isSlackbot(n)&&(s+='<i class="ts_icon ts_icon_angle_arrow_up_left ts_icon_inherit"></i>');s+=TS.interop.datetime.toTimeAgo(o.ts)}}else if(n){var f=TS.interop.rules.channels.getLatestMsgTs(n);f&&(s+=TS.interop.datetime.toTimeAgo(f))}r&&(a.last_msg=new Handlebars.SafeString(r));s&&(a.last_msg_time=new Handlebars.SafeString(s));if(n&&n.unread_cnt>0){var h=i.model_ob.unread_cnt;i.model_ob.is_mpim&&TS.notifs.isCorGMuted(i.model_ob.id)&&(h=i.model_ob.unread_highlight_cnt);h>10&&(h="9+");a.unread_cnt=h}t.html(TS.templates.im_browser_row(a))}});if(i.longListView("getCurrentItemsInView")){TS.utility.rAF(function(){var e=i.longListView("getCurrentItemsInView");c.clear();c.add(_.map(e,"id"))});i.longListView("getCurrentItemsInViewSignal").add(function(e){c.clear();c.add(_.map(e,"id"))})}TS.environment.supports_custom_scrollbar||i.monkeyScroll();TS.kb_nav.start(i.find(".list_items"),".im_browser_row",i,{use_data_ordering:true,no_blur:true,scrollToStartImmediately:function e(){i.longListView("scrollToTop",true)},scrollToEndImmediately:function e(){i.longListView("scrollToEnd",true)}});TS.kb_nav.setAllowHighlightWithoutBlurringInput(true);TS.kb_nav.setSubmitItemHandler(function(e){K($(this));e.preventDefault()});s.length&&TS.boot_data.page_needs_enterprise?B():Z()};var x=function t(){TS.boot_data.feature_ms_latest||Promise.resolve();e||(e=TS.boot_data.feature_ms_latest?Promise.join(TS.interop.api.callExpedited("im.list",{get_latest:true}),TS.interop.api.callExpedited("mpim.list",{get_latest:true}),function(e,t){return TS.redux.channels.bulkAddEntities(_.concat(_.get(e,"data.ims",[]),_.get(t,"data.groups",[])))}):Promise.resolve());return e};var I=function t(i){i||(e=null)};var M=function e(t){return TS.redux.messages.getLastMessageInChannel(t.id)};var E=function e(t){if(TS.interop.members.shouldDisplayRealNames()&&t.profile&&t.profile.first_name)return t.profile.first_name;return t.name};var B=function e(){var t=$("#im_browser_filter").val();TS.interop.clog.track("IM_BROWSER_QUERY",{});return N(t)};var P=function e(){D();O()};var U=function e(){F();R()};var D=function e(){var t=document.getElementById("im_browser_spinner");t&&t.classList&&t.classList.remove("hidden")};var F=function e(){var t=document.getElementById("im_browser_spinner");t&&t.classList&&t.classList.add("hidden")};var O=function e(){if(!a){a=$("#monkey_scroll_wrapper_for_im_list_container");n=$("<div>",{class:"monkey_scroll_mask"});a.append(n);return}n.removeClass("hidden")};var R=function e(){n&&n.addClass("hidden")};var N=function e(n){TS.metrics.mark("im_browser_search_start");g=n;P();p&&p.cancel();var a=!!s.length;n||TS.kb_nav.clearHighlightedItem();if(!n&&!a){var o=r;t.addClass("showing_recent");t.removeClass("filter_active no_filter_matches");i.longListView("setItems",o);i.scrollTop(0);0===o.length?Z(n):X();U();return}p=TS.searcher.search(n,ue());p.then(function(e){e=e.map(function(e){var t=e.model_ob;e.id=t.id;t.is_mpim?e.members=TS.mpims.legacyGetMembersInDisplayOrder(t):e.member=t;e.member&&true===G(e.member)?e.disabled_dm=true:e.disabled_dm=null;return e});e=_(e).partition("model_ob.deleted").reverse().flatten().value();t.toggleClass("filter_active",!!n).removeClass("showing_recent");i.longListView("setItems",e);i.scrollTop(0);TS.utility.rAF(function(){TS.ui.utility.updateClosestMonkeyScroller(i)});if(0===e.length){Z(n);t.addClass("no_filter_matches");TS.kb_nav.clearHighlightedItem()}else{X();t.removeClass("no_filter_matches");n&&TS.kb_nav.highlightFirstItem()}U();TS.metrics.measureAndClear("im_browser_search_searcher","im_browser_search_start")}).catch(function(e){U();"T03NP21JQ"!==TS.model.team.id&&"T027K4HQ2"!==TS.model.team.id&&"T0H21LA58"!==TS.model.team.id||TS.logError(e,"Error occured when searching in the IM browser.");TS.console&&TS.console.logStackTrace()})};var L=function e(t){var i=s.every(function(e){return-1!==t.members.indexOf(e.id)});if(!i)return false;if(s.length===t.members.length-1)return false;var n=TS.mpims.legacyGetMembersInDisplayOrder(t);var a=n.some(function(e){if(-1!==s.indexOf(e))return false;return!e.is_self});if(!a)return false;return true};var G=function e(t){if(!t.is_external)return false;if(!o)return false;if(t.is_external&&t.team_id!==o)return true;return false};var H=function e(){if(!s.length)return;TS.interop.clog.track("IM_BROWSER_GO",{});if(1===s.length){m&&m.start();TS.ims.promiseToStartImByMemberId(s[0].id).then(function(){h&&h.call();TS.ui.fs_modal.close();return null}).finally(function(){m&&m.stop();return null});return}if(!TS.permissions.members.canCreateMpims())return;m.start();Q(s,function(e){m&&m.stop();if(!e.ok){e.error&&TS.error("Could not open MPIM: "+e.error);return}h&&h.call();TS.ui.fs_modal.close()})};var Q=function e(t,i){var n=t.map(function(e){return e.id});return TS.interop.channels.openConversationByMembers({memberIds:n}).then(function(e){var t;e.data.channel?t=e.data.channel:e.data.group&&(t=e.data.group);if(t.is_channel){t=TS.interop.channels.upsertChannel(t);t.is_mpim?TS.channels.legacyDisplayChannel({id:t.id}):TS.error("no mpim?!?")}else if(t.is_group){t=TS.interop.channels.upsertChannel(t);t?TS.mpims.legacyDisplayMpim({id:t.id}):TS.error("no mpim?!?")}i&&i(e.data);return null}).catch(function(){TS.error("failed to open the mpim");return null})};var j=function e(t){var i=t.data("row_id");TS.interop.utility.looksLikeMemberId(i)?TS.ims.legacyStartImByMemberId(i):TS.mpims.legacyDisplayMpim({id:i});TS.ui.fs_modal.close()};var K=function e(t){if(t.hasClass("disabled_dm"))return;if(s.length===v)return;TS.interop.clog.track("IM_BROWSER_SELECT_ROW",{});if(!TS.permissions.members.canCreateMpims())return j(t);var i=t.data("row_id");g&&TS.ui.frecency.record({id:i},g);if(i===TS.model.user.id||"USLACKBOT"===i||"UTEAMSBOT"===i)return j(t);var n=[];if(TS.interop.utility.looksLikeMemberId(i)){var a=TS.interop.members.getMemberById(i);if(!a)return;if(a.deleted||a.is_app_user)return j(t);if(-1!==s.indexOf(a))return;s.push(a);l[a.id]=true;n.push(a)}else{var r=TS.redux.channels.getEntityById(i);if(!r.is_mpim)return;var o=TS.mpims.legacyGetMembersInDisplayOrder(r);if(_.some(o,"deleted")){j(t);return}o.forEach(function(e){if(-1!==s.indexOf(e))return;s.push(e);l[e.id]=true;n.push(e)})}Y();z(n)};var W=function e(t){var i=t.data("member-id");var n=[];s=s.filter(function(e){i===e.id&&n.push(e);return e.id!==i});delete l[i];z(n)};var V=function e(){if(!s.length)return;var t=s.pop();delete l[t.id];z([t])};var z=function e(n){q();s.length?t.find(".im_browser_go").removeClass("disabled"):t.find(".im_browser_go").addClass("disabled");s.length>=v?t.addClass("reached_maximum"):t.removeClass("reached_maximum");n&&n.forEach(function(e){i.longListView("itemUpdatedById",e.id);var t=i.longListView("getCurrentItemsInView");t.forEach(function(e){i.longListView("itemUpdatedById",e.id)})});J();ce();TS.kb_nav.clearHighlightedItem();i.longListView("resizeImmediately")};var Y=function e(){s.forEach(function(e){e.is_external&&(o=e.team_id)})};var q=function e(){var i=v;var n=Math.max(0,i-s.length);var a=t.find(".remaining_participant_hint");n?a.text(TS.interop.i18n.t("You can add {num_remaining, plural, =1 {# more person} other {# more people}}","im_browser")({num_remaining:n})):a.text(TS.interop.i18n.t("You have reached the maximum number of participants","im_browser")())};var J=function e(){var i=$("#im_browser_filter").val();$("#im_browser_tokens").replaceWith(TS.templates.im_browser_tokens({members:s}));var n=$("#im_browser_filter");!i&&TS.boot_data.page_needs_enterprise?n.focus():n.val("").trigger("input").focus();t.removeClass("filter_active")};var Z=function e(t){var i=$("#im_browser_empty");var n=i.find(".im_browser_empty_message");t?n.html(TS.interop.i18n.t("No one found matching <strong>{query}</strong>","im_browser")({query:TS.utility.truncateAndEscape(t,50)})):n.empty();i.removeClass("hidden");$("#monkey_scroll_wrapper_for_im_list_container").addClass("hidden")};var X=function e(){var t=$("#im_browser_empty");t.addClass("hidden");$("#monkey_scroll_wrapper_for_im_list_container").removeClass("hidden")};var ee=function e(t,i){var n=ne(t.model_ob,i.model_ob);if(0!==n)return n;return te(t,i)};var te=function e(t,i){var n;var a;n=t.member?[t.member]:t.members||[];a=i.member?[i.member]:i.members||[];if(n.length!==a.length){if(1===n.length)return-1;if(1===a.length)return 1}return ie(n,a,0)};var ie=function e(t,i,n){var a=t[n];var r=i[n];if(a&&r){var s=TS.interop.members.memberSorterByName(a,r);if(0!==s)return s;return e(t,i,n+1)}if(r)return-1;if(a)return 1;return 0};var ne=function e(t,i){var n=t&&M(t);var a=i&&M(i);var r;var s;if(n)r=parseFloat(n.ts);else if(t){r=TS.interop.rules.channels.getLatestMsgTs(t);r&&(r=parseFloat(r))}if(a)s=parseFloat(a.ts);else if(i){s=TS.interop.rules.channels.getLatestMsgTs(i);s&&(s=parseFloat(s))}if(r&&s){if(r>s)return-1;if(s>r)return 1}else{if(r)return-1;if(s)return 1}return 0};var ae=function e(){var t=[TS.interop.i18n.t("Yay! You\u2019re here. What can I do for you?","im_browser")(),TS.interop.i18n.t("Hello, What\u2019s up?","im_browser")(),TS.interop.i18n.t("How can I help today?","im_browser")(),TS.interop.i18n.t("Hi hi! How can I help?","im_browser")(),TS.interop.i18n.t("You\u2019re here! What can I do to help?","im_browser")(),TS.interop.i18n.t("You rang?","im_browser")()];u=t[Math.round(Math.random()*(t.length-1))]};var re=function e(){if(!TS.permissions.members.canCreateGroups())return;var i=$("#new_channel_container");var n=Object.keys(l);TS.ui.new_channel_modal.startInContainer(i,"",false,n);t.addClass("hidden");$("#fs_modal").removeClass("fs_modal_internal_scroll");i.removeClass("hidden");TS.ui.fs_modal.bindBackButton(se);TS.ui.fs_modal.showBackButton()};var se=function e(){TS.ui.fs_modal.unbindBackButton();TS.ui.fs_modal.hideBackButton();var n=$("#new_channel_container");n.addClass("hidden");$("#fs_modal").addClass("fs_modal_internal_scroll");t.removeClass("hidden");TS.ui.new_channel_modal.end();i.longListView("resizeImmediately");TS.ui.utility.updateClosestMonkeyScroller(i)};var oe=function e(i){le();t.prepend(i);t.addClass("showing_alert")};var le=function e(){$("#im_browser_alert").remove();t.removeClass("showing_alert")};var ce=function e(){if(f){le();f=false}var t=s.filter(function(e){return e.is_external});var i;if(t.length>0)i=TS.templates.im_browser_guest_alert({team:TS.teams.getTeamNameByMember(t[0])});else{if(TS.model.user.is_restricted)return;if(s.length<2)return;var n=s.filter(function(e){return e.is_restricted});if(0===n.length)return;var a=1===n.length&&n[0];var r=a&&a.is_ultra_restricted;i=TS.templates.im_browser_guest_alert({ra_alert:true,members:n,member:a,is_ura:r})}oe(i);f=true};var de=function e(t){if(!t||!t.file)return"";var i=true;var n=TS.templates.builders.msgs.buildFileShareMetaText(t,i);var a=t.file;var r=a.title?a.title:a.name;return n+": "+r};var ue=function e(t){t=t||{};if(d){var i={members:{include_self:false,only_admins:true},limit:S,sort:false};t.initial||(i.sort={frecency:true,allow_empty_query:true});return i}if(t.initial)return{members:{include_slackbot:true,include_self:true},all_mpims:true,sort:false};var n=!!s.length;o=null;Y();return{members:{include_slackbot:!n,include_self:!n,include_deleted:!n},all_mpims:true,limit:S,filter:function e(t){t.mpims=_.filter(t.all_mpims,L);n&&TS.apps.permissions.areXoxaAppsInstalled()&&(t.members=_.filter(t.members,{is_app_user:false}));return t},sort:{allow_empty_query:true}}}})();var Se=i(3079);(function(){TS.registerModule("ui.prefs_dialog",{onStart:function e(){V();TS.client.login_sig.add(y);TS.prefs.sidebar_theme_changed_sig.add(he);TS.prefs.dtop_notif_changed_sig.add(re);TS.prefs.read_changed_sig.add(_e);TS.prefs.display_real_names_override_changed_sig.add(ce);TS.prefs.team_display_real_names_changed_sig.add(ce);TS.prefs.tz_changed_sig.add(ve);TS.prefs.locale_changed_sig.add(be);TS.members.changed_tz_sig.add(Se);r=TS.qs_args.prefs_last_section||r;TS.prefs.email_alerts_changed_sig.add(re);TS.prefs.push_changed_sig.add(re);TS.prefs.all_notifications_prefs_changed_sig.add(re);re=_.throttle(re,1e3);TS.prefs.time24_changed_sig.add(ie)},start:function e(t,i){A(t,i)},isOpen:function t(){return e}});var e=false;var t=null;var i=null;var n=null;var a=null;var r="notifications";var s=null;var o=0;var l=false;var c=false;var d=false;var u=false;var m=false;var f=false;var h=[];var p="validation_error";var g;var T;var S;var v;var b=false;var w=false;var y=function e(){c=TS.model.mac_ssb_version&&TS.model.mac_ssb_version>=.32||TS.model.win_ssb_version&&TS.model.is_mac;d=TS.model.win_ssb_version&&TS.model.is_win;u=TS.model.lin_ssb_version&&TS.model.is_lin;l=TS.prefs.getPref("sidebar_theme")&&("custom_theme"===TS.prefs.getPref("sidebar_theme")||"cotton_theme"===TS.prefs.getPref("sidebar_theme")||"eco_theme"===TS.prefs.getPref("sidebar_theme"));TS.interop.environment.isSSBAndAtLeastVersion("2.8.0")&&(m=true);b=TS.boot_data.feature_email_forwarding&&!TS.model.user.is_restricted&&!TS.model.user.is_ultra_restricted&&"disable_all"!==TS.prefs.getTeamPref("disable_file_uploads")&&"disable_all_except_images"!==TS.prefs.getTeamPref("disable_file_uploads")&&!TS.prefs.getTeamPref("disable_email_ingestion")};var A=function o(l,_){l=l||r;if(!TS.model.ms_logged_in_once||!TS.prefs.prefs_loaded||$("body").hasClass("loading")||TS.ui.fs_modal.is_showing)return;s||(s=TS.templates.prefs_nav({show_mac_ssb_prefs:c,show_win_ssb_prefs:d,show_lin_ssb_prefs:u,show_labs_prefs:TS.boot_data.feature_tinyspeck}));e=true;var m={title:k(),body_template_html:"",sidebar_html:s,onShow:C,onCancel:x,modal_class:"fs_modal_header fs_modal_sidebar prefs_modal"};m.onGo=Re;TS.ui.fs_modal.start(m);t=$("#fs_modal");i=$("#fs_modal_bg");n=t.find(".contents");t.add(i).addClass("starting");a=$("#fs_modal_sidebar");a.find(".sidebar_menu_list_item").on("click",function(){I($(this).data("section"))});TS.environment.supports_custom_scrollbar||t.find(".contents_container").monkeyScroll();g=Ae();S={};I(l,true);_&&setTimeout(function(){t.find(_).scrollintoview({offset:"bottom",px_offset:-100}).highlight()},1e3);B();setTimeout(function(){t.add(i).removeClass("starting")},150);$("#col_channels").addClass("prefs_open")};var k=function e(){return TS.interop.i18n.t("Your preferences for {team_name}","prefs")({team_name:TS.interop.i18n.safeString(TS.interop.rules.teams.getTeamDisplayName(TS.model.team))})};var C=function e(){};var x=function i(){w&&TS.boot_data.feature_channel_notif_dialog_update&&TS.interop.unmountChannelNotificationSettings($("#channel_prefs_container")[0]);$("#col_channels").removeClass("prefs_open");h=[];e=false;t=null;n=null;a.find(".sidebar_menu_list_item").off("click");a=null;w=false};var I=function e(i,s){f&&fe();var o=M(i);r=i;a.find(".sidebar_menu_list_item").removeClass("is_active").end().find('.sidebar_menu_list_item[data-section="'+i+'"]').addClass("is_active");n.html(o);E(i);s&&t.find(".sidebar_menu_list_item").length?t.find(".sidebar_menu_list_item").first().focus():!s&&t.find("input").length?t.find("input").first().focus():document.activeElement&&document.activeElement!==document.body&&document.activeElement.blur();setTimeout(function(){TS.environment.supports_custom_scrollbar||TS.ui.utility.updateClosestMonkeyScroller(n);t.find(".contents_container").scrollTop(0)},0);f="sidebar"===i;"notifications"===i&&_.each(h,function(e){ae(e)})};var M=function e(t){var i;var n={};switch(t){case"notifications":var a=TS.notifs.getGlobalHighlightWords()||"";a=a.replace(/,/g,", ").replace(/ {2}/g," ");n={notification_sounds:TS.boot_data.notification_sounds,member:TS.model.user,highlight_words:a,time24:TS.prefs.getPref("time24"),show_mac_ssb_prefs:c,show_win_ssb_prefs:d,has_tz:!!TS.prefs.getPref("tz"),tz_guess:!TS.prefs.getPref("tz")&&F()};n.new_msg_snd_label=we(TS.notifs.getDesktopNotificationSoundPref());i=TS.templates.prefs_notifications_new(n);break;case"win_ssb":case"lin_ssb":i=TS.templates.prefs_win_lin_ssb({show_lin_ssb_prefs:u,show_auto_launch_pref:TS.interop.environment.isSSBAndAtLeastVersion("3.0.0")||!TS.interop.desktop.isAppStoreBuild()});break;case"language_region":n={show_keyboard:!TS.interop.desktop.canAutoGetKeyboard(),user_locale:TS.interop.i18n.locale,languages:TS.prefs.getPref("locales_enabled"),user_keyboard:TS.i18n.keyboard(),supported_keyboards:TS.interop.i18n.supportedKeyboards({featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR}),timezones:window.timezones_list(TS.interop.i18n.locale),user_tz:TS.prefs.getPref("tz")||F()};i=TS.templates.prefs_language_region(n);break;case"messages_media":var r="";TS.prefs.getPref("preferred_skin_tone")&&"1"!==TS.prefs.getPref("preferred_skin_tone")&&(r=":skin-tone-"+TS.prefs.getPref("preferred_skin_tone")+":");var s=TS.emoji.graphicReplace(":wave:");n={inline_img_byte_limit:TS.model.inline_img_byte_limit,clean_theme:"light_with_avatars"===TS.prefs.getPref("messages_theme"),compact_theme:"dense"===TS.prefs.getPref("messages_theme"),thumbs_up_name_with_skin_tone_modifier:":thumbsup:"+r,messages_theme:TS.prefs.getPref("messages_theme"),show_time24_pref:"en-US"===TS.interop.i18n.locale,enable_email_forwarding:b,slackbot_message:TS.interop.i18n.t("Feeling great!","prefs")(),name_preview_avatar:cdn_url+"/2b909/img/name_pref/avatar_meg@2x.png",name_preview_full_name:TS.interop.i18n.t("Megan Mary Anne","prefs")(),name_preview_display_name:TS.interop.i18n.t("Meg","prefs")(),name_preview_message:new Handlebars.SafeString(TS.interop.i18n.t('{wave_emoji} Hi, I\u2019m <a class="internal_member_link">@Meg</a>.',"prefs")({wave_emoji:TS.interop.i18n.safeString(s)})),zdLocale:TS.interop.i18n.zdLocale()};i=TS.templates.prefs_messages_media(n);break;case"sidebar":if(TS.prefs.getPref("sidebar_theme_custom_values")&&"undefined"!==TS.prefs.getPref("sidebar_theme_custom_values")){n.theme=JSON.parse(TS.prefs.getPref("sidebar_theme_custom_values"));n.show_customization_ui=l;n.show_customization_ui=l}n.show_separate_shared_channels_pref=TS.permissions.members.canRequestSharedChannel();n.show_separate_organization_channels_pref=TS.boot_data.page_needs_enterprise;n.cmd_key=TS.model.is_mac?TS.interop.i18n.t("Cmd","keys")():TS.interop.i18n.t("Ctrl","keys")();n.cmd_key_label=TS.model.is_mac?TS.interop.i18n.t("Command","keys")():TS.interop.i18n.t("Control","keys")();n.is_app_space_enabled=TS.interop.apps.isAppSpaceEnabled();n.show_sidebar_sort_pref=""!==TS.model.team.plan;n.use_global_nav=TS.useGlobalNav();i=TS.templates.prefs_sidebar(n);break;case"search":i=TS.templates.prefs_search();break;case"read_state_tracking":i=TS.templates.prefs_read_state_tracking({short_key_name:TS.model.is_mac?"Option":"Alt"});break;case"a11y":i=function(){return TS.templates.prefs_a11y({zoom_pref_enabled:TS.model.is_electron,zoom_pref_70_supported:TS.model.is_electron})}();break;case"advanced":var o=false;var f="";var h=[];if(TS.model.is_our_app){o=TS.interop.desktop.hasPreference("PrefSSBFileDownloadPath");TS.interop.environment.mac_ssb_version&&TS.interop.environment.mac_ssb_version<2&&(o=false);o&&(f=TS.interop.desktop.getPreference("PrefSSBFileDownloadPath"));m&&(h=window.desktop.spellCheckingHelper.getDictionaries())}n.show_app_download_path=o;n.app_download_path=f;n.show_language_select=m;n.available_dictionaries=h;n.show_console_whitelist=true;var p=TS.prefs.getPref("client_logs_pri")||"";n.user_facing_pris=_(Object.keys(TS.boot_data.client_logs)).filter(function(e){var t=TS.boot_data.client_logs[e];var i=true;if(!_.isUndefined(t.features)){var n=t.features;_.isArray(t.features)||(n=n.split(","));var a=0;n.forEach(function(e){0!==e.indexOf("feature_")&&(e="feature_"+e);TS.boot_data[e]&&(a+=1)});i=a===n.length}return!_.isUndefined(t.user_facing)&&t.user_facing&&i}).map(function(e){var t=_.merge({},TS.boot_data.client_logs[e]);t.selected=p.indexOf(e)>-1;t.name&&(t.name=t.name.replace(/[_-]/g," "));return t}).value();n.client_logs_pri_all_selected=p.indexOf("all")>-1;i=TS.templates.prefs_advanced(n);break;case"labs":n={show_electron_prefs:TS.model.is_electron};i=TS.templates.prefs_labs(n);break;default:TS.error("This isn't the Prefs HTML builder you're looking for: "+t);return}return i};var E=function e(t){switch(t){case"notifications":P();re();if(c){J();ge()}d&&Z();ne();break;case"win_ssb":case"lin_ssb":ee();te();break;case"language_region":R();break;case"messages_media":N();ce();$("#dont_obey_inline_img_limit_cb").prop("disabled",!TS.prefs.getPref("expand_inline_imgs"));break;case"sidebar":Y();he();me();break;case"search":H();break;case"read_state_tracking":Q();_e();break;case"a11y":j();break;case"advanced":z();break;case"labs":q();break;default:TS.error("This isn't the Prefs UI binding you're looking for: "+t)}};var B=function e(){n.on("change",'input[type="checkbox"][data-inline-saver], input[type="radio"][data-inline-saver], input[type="file"], select[data-inline-saver]',function(){TS.ui.inline_saver.show({target:$(this).data("inline-saver")})});var t=1e3;n.on("input",'input[type="text"][data-inline-saver], textarea[data-inline-saver]',TS.utility.debounce(function(){var e=$(this);if(e.hasClass(p))return;TS.ui.inline_saver.show({target:e.data("inline-saver")})},t))};var P=function e(){$(".growls_stuff").addClass("hidden");$("#growls_permission_link").on("click",le);$("#growls_test").on("click",function(){TS.ui.growls.showTestNotification(TS.interop.i18n.t("A Notification from Slack","prefs")(),TS.interop.i18n.t("What do you know? It works.","prefs")())}).addClass("hidden");if(TS.ui.growls.shouldShowPermissionButton())$("#growls_permission_div").removeClass("hidden");else if(TS.ui.growls.checkPermission()){$("#growls_allowed_div").removeClass("hidden");$("#growls_test").removeClass("hidden")}else TS.ui.growls.no_notifications?$("#growls_impossible_div").removeClass("hidden"):"denied"===TS.ui.growls.getPermissionLevel()&&$("#growls_disallowed_div").removeClass("hidden");$('input:radio[name="notifications_rd"]').on("change",function(){var e=$(this).val();TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{desktop_notifications:e.toString()}});"all"===e?e="everything":"mentions"===e?e="mentions":"never"===e&&(e="nothing");if(TS.boot_data.feature_turn_mpdm_notifs_on){var t=!g;TS.notifs.setDesktopGlobalNotifySetting(e,t);return}var i={};if("everything"===e){i.all_channels_loud=true;i.growls_enabled=true}else if("mentions"===e){i.all_channels_loud=false;i.growls_enabled=true}else{i.all_channels_loud=false;i.growls_enabled=false}g||_.assign(i,Ce(e));TS.prefs.setMultiplePrefs(i);TS.prefs.setMultiPrefsByAPI(i);TS.prefs.dtop_notif_changed_sig.dispatch()});TS.interop.environment.isSSBAndAtLeastVersion("3.3")?TS.interop.desktop.getParsedNotificationWarnings(TS.redux.getState()).then(function(e){if(e.length<1)$("#notification_warnings").hide();else if(1===e.length)$("#notification_warnings_message").append("<p.small>"+e[0]+"</p.small>");else{var t=$("<ul.compact></ul.compact>");_.each(e,function(e){t.append("<li>"+e+"</li>")});t.find("a#notification-warnings-ac-disabled").attr("href","https://get.slack.help/hc/articles/201355156#windows-1");t.find("a#notification-warnings-contact-us").attr("href","http://my.slack.com/help.requests/new");t.find("a#notification-warnings-aero-glass").attr("href","https://get.slack.help/hc/articles/201355156#windows-1");$("#notification_warnings_message").append(t)}}):$("#notification_warnings").hide();$("#no_text_in_notifications_cb").on("change",function(){var e=!$(this).prop("checked");TS.notifs.setNoTextInNotificationsPref(e);TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{no_text_in_notifications:e.toString()}})});var i;$('input:radio[name="sound_option_rd"]').on("change",function(){i=$(this).val();TS.sounds.play(i,{ignore_mute:true});TS.notifs.setDesktopNotificationSoundPref(i)});$(".sound_option").find("ts-icon").on("click",function(e){i=$(this).siblings("input").val();TS.sounds.play(i,{ignore_mute:true});e.preventDefault();e.stopPropagation()});$("#mute_sounds_cb").prop("checked",true===TS.prefs.getPref("mute_sounds"));$("#mute_sounds_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefLocal("mute_sounds",e);TS.prefs.setPrefByAPI({name:"mute_sounds",value:e});re();TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{mute_sounds:e.toString()}})});$("#threads_everything_cb").prop("checked",true===TS.notifs.getThreadsEverythingNotificationPref());$("#threads_everything_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefLocal("threads_everything",e);TS.notifs.setThreadsEverythingNotificationPref(e);TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{threads_everything:e.toString()}})});var n=1e3;t.find("#highlight_words_input").on("input",TS.utility.debounce(ue,n));if(TS.model.win_ssb_version||TS.model.lin_ssb_version){var a=$("#highlight_words_input").attr("placeholder");var r=true;$("#highlight_words_input").on("textchange",function(){if($(this).val()&&r){$(this).attr("placeholder","");r=false}else if(!$(this).val()&&!r){$(this).attr("placeholder",a);r=true}})}$("#dnd_enabled").prop("checked",!!TS.prefs.getPref("dnd_enabled"));$("#dnd_start_hour, #dnd_end_hour").prop("disabled",!TS.prefs.getPref("dnd_enabled")).closest("label").toggleClass("disabled",!TS.prefs.getPref("dnd_enabled"));var s=U();$("#dnd_enabled").on("change",function(){var e=$(this).is(":checked");e?$("#dnd_start_hour, #dnd_end_hour").prop("disabled",false).closest("label").removeClass("disabled"):$("#dnd_start_hour, #dnd_end_hour").prop("disabled",true).closest("label").addClass("disabled");s.dnd_enabled=e;TS.prefs.setMultiPrefsByAPI(s);TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{dnd_enabled:e.toString()}})});var o=D($("#dnd_start_hour"),s.dnd_start_hour);o.prop("selected",true);var l=D($("#dnd_end_hour"),s.dnd_end_hour);l.prop("selected",true);$("#dnd_start_hour").on("change",function(){s.dnd_start_hour=$(this).val();TS.prefs.setMultiPrefsByAPI(s);$("#dnd_end_hour option").each(function(){return $(this).prop("disabled",false)});var e=D($("#dnd_end_hour"),s.dnd_start_hour);e.prop("disabled",true)});$("#dnd_end_hour").on("change",function(){s.dnd_end_hour=$(this).val();TS.prefs.setMultiPrefsByAPI(s);$("#dnd_start_hour option").each(function(){return $(this).prop("disabled",false)});var e=D($("#dnd_start_hour"),s.dnd_end_hour);e.prop("disabled",true)});o=D($("#dnd_start_hour"),s.dnd_end_hour);o.prop("disabled",true);l=D($("#dnd_end_hour"),s.dnd_start_hour);l.prop("disabled",true);$("#confirm_dnd_tz_guess").click(function(){if($(this).hasClass("disabled"))return;if(!window.timezones_guess)return;var e=window.timezones_guess();TS.prefs.setPrefByAPI({name:"tz",value:e,_x_reason:"tz_confirm_dnd_tz_guess"});$(this).addClass("disabled")});$('#global_prefs_container [data-action="your_keywords_jump"]').click(function(e){e.preventDefault();$("#prefs_highlight_words").scrollintoview({offset:"bottom",px_offset:-100}).highlight()});$("#change_notification_sound").click(function(e){TS.menu.startWithSoundsMenu(e,function(e){TS.sounds.play(e,{ignore_mute:true});var t=TS.notifs.setDesktopNotificationSoundPref(e);TS.ui.inline_saver.show({target:"#prefs_sounds_and_appearance",promise:t});var i=we(e);$("#selected_new_msg_snd").text(i);TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{new_msg_snd:e}})})});$("#new_msg_snd_none_cb").on("change",function(){var e=$(this).is(":checked");var t;if(e){t=S.new_msg_snd||"knock_brush.mp3";$("#selected_new_msg_snd").text(we(t));$("#select_new_msg_snd").removeClass("hidden")}else{S.new_msg_snd=TS.notifs.getDesktopNotificationSoundPref();t="none";$("#select_new_msg_snd").addClass("hidden")}TS.notifs.setDesktopNotificationSoundPref(t);TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{new_msg_snd:t}})});$("#email_alerts_cb").on("change",function(){var e=$(this).is(":checked");if(e)TS.prefs.setPrefLocal("email_alerts",S.email_alerts||"instant");else{S.email_alerts=TS.prefs.getPref("email_alerts");TS.prefs.setPrefLocal("email_alerts","none")}TS.prefs.setPrefByAPI({name:"email_alerts",value:TS.prefs.getPref("email_alerts")});re();TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{email_alerts:TS.prefs.getPref("email_alerts")}})});$("#change_email_alerts").on("click",function(e){TS.menu.startWithGeneric(e,[{value:"instant",label:TS.interop.i18n.t("Once every 15 minutes","prefs")()},{value:"hourly",label:TS.interop.i18n.t("Once an hour","prefs")()}],function(e){var t=TS.prefs.setPrefByAPI({name:"email_alerts",value:e});TS.ui.inline_saver.show({target:"#prefs_notifs_delay",promise:t});TS.prefs.setPrefLocal("email_alerts",e);re();TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{email_alerts:TS.prefs.getPref("email_alerts")}})})});$("#mobile_specific_settings select").on("change",function(){var e=$(this).val();ke(e);TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{mobile_notifications:e}})});$("#mobile_different_settings_cb").on("change",function(){g=$(this).is(":checked");$("#mobile_specific_settings").toggleClass("hidden",!g);if(!g&&Ae()){var e=TS.notifs.getGlobalNotificationSetting();ke(e)}TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{use_different_mobile_settings:g.toString()}})});$("#push_idle_wait_select").on("change",function(){var e=$(this).val();var t=TS.notifs.setNotificationPushIdleWaitTimeInMinutes(e);TS.ui.inline_saver.show({target:"#prefs_notifs_delay",promise:t});TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",{updated_user_client_prefs:{push_idle_wait:e.toString()}})});$(".global_notification_block").on("click",function(e){if(e.isDefaultPrevented())return;if($(e.target).closest("label, input").length)return;$(this).find("input").prop("checked",true).trigger("change")});$("#channel_specific_overrides").on("click",'[data-action="reset_channel_to_defaults"]',function(e){var t=$(this).closest(".channel_overrides_row");var i=t.attr("data-cid");if(!i)return;e.preventDefault();Ue(i);Ie()});$("#channel_specific_overrides").on("click",'[data-action="open_channel_overrides"]',function(e){if(e.isDefaultPrevented())return;var t=$(this).attr("data-cid");if(!t)return;De();Fe(t)});$('#global_prefs_container [data-action="add_channel_override"]').on("click",function(){De();$e()});$("#channel_prefs_container").on("click",'[data-action="proceed_to_channel_options"]',function(){var e=$("#channel_override_picker").lazyFilterSelect("value")[0];var t=_.get(e,"model_ob.id");if(!t)return;Fe(t)});$("#global_prefs_container").on("click",'[data-action="highlight_channel_overrides"]',function(e){e.preventDefault();$("#prefs_channel_overrides").scrollintoview({offset:"top",px_offset:50}).highlight()});$('#global_prefs_container [data-action="show_time_zone"]').on("click",function(e){e.preventDefault();var t=$(this).closest(".contents_container");var i=function e(){I("language_region");setTimeout(function(){$(".prefs_tz").highlight()},500)};0===t.scrollTop()?i():$(this).closest(".contents_container").animate({scrollTop:0}).queue(function(e){setTimeout(i,250);e()})})};var U=function e(){return{dnd_enabled:TS.prefs.getPref("dnd_enabled"),dnd_start_hour:TS.prefs.getPref("dnd_start_hour")||TS.prefs.getTeamPref("dnd_start_hour")||"22:00",dnd_end_hour:TS.prefs.getPref("dnd_end_hour")||TS.prefs.getTeamPref("dnd_end_hour")||"08:00"}};var D=function e(t,i){var n=t.find("option").filter(function(){var e=$(this).attr("value");var t=e===i;t||(t=e==="0"+i);return t});if(!n.length){n=$('<option data-custom-time="true">');n.val(i);if(TS.utility.date.do24hrTime())n.text(i);else{var a=oe(i);n.text(a)}var r=t.find("option").filter(function(){var e=$(this).attr("value");return e>i});r.length?r.filter(":first").before(n):t.append(n)}return n};var F=function e(){if(!window.timezones_guess||!window.timezones_list)return null;var t=window.timezones_guess();var i=window.timezones_list();var n=_.find(i,function(e){if(2===e.length)return e[1]===t;return false});if(n)return n[0];return null};var O=function e(t){TS.utility.disableElement($("#jumbomoji_cb"),t);$("#jumbomoji_cb_label").toggleClass("jumbomoji_pref_disabled",t)};var R=function e(){n.find('[name="lang"]').on("change",function(){var e=$(this).val();var t=TS.interop.i18n.locale;var i=TS.interop.i18n.localesEnabled({featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR,featureLocaleEsLa:TS.boot_data.feature_locale_es_LA,featureLocalizationPhaseTwo:TS.boot_data.feature_localization_phase_two})[e];if(e===t)return;TS.generic_dialog.start({title:TS.interop.i18n.t("Change language to {lang}?","prefs")({lang:i}),body:"<p>"+TS.interop.i18n.t("Are you sure you want to change the language you use with Slack?","prefs")()+"</p>",show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Change to {lang}","prefs")({lang:i}),onGo:function i(){if(e!==t){window.createCookie("i18n_locale",e,365,"slack.com");v=true;TS.prefs.setPrefByAPI({name:"locale",value:e},function(){TS.reload(null,"prefs dialog change: locale -> "+e)})}},onCancel:function i(){e!==t&&n.find('[name="lang"]').val(t)}})});TS.interop.desktop.canAutoGetKeyboard()||n.find('[name="keyboard"]').on("change",function(){var e=$(this).val();var t=TS.model.user.keyboard;e!==t&&TS.prefs.setPrefByAPI({name:"keyboard",value:e})});n.find('[name="tz"]').on("change",function(){var e=$(this).val();var t=TS.model.user.tz;e!==t&&TS.prefs.setPrefByAPI({name:"tz",value:e,_x_reason:"tz_bind_language_reason_prefs"})})};var N=function e(){$('input:radio[name="messages_theme_select"]').filter('[value="'+TS.prefs.getPref("messages_theme")+'"]').prop("checked",true);$('input:radio[name="messages_theme_select"]').on("change",function(){$(".prefs_messages_theme_preview").toggleClass("hidden");var e=$(this).val();O("dense"===e);TS.prefs.setPrefByAPI({name:"messages_theme",value:e})});$("#show_typing_cb").prop("checked",true===TS.prefs.getPref("show_typing")).removeClass("hidden");$("#show_typing_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"show_typing",value:!!$(this).prop("checked")})});$('#display_real_names_override_cb,input:radio[name="display_real_names_override_cb"]').on("change",function(){var e="real_names"===$(this).val();var t;t=TS.prefs.getTeamPref("display_real_names")?e?0:-1:e?1:0;TS.prefs.setPrefLocal("display_real_names_override",t);TS.prefs.setPrefByAPI({name:"display_real_names_override",value:t});ce()});$(".global_notification_block").on("click",function(e){if(e.isDefaultPrevented())return;if($(e.target).closest("label, input").length)return;$(this).find("input").prop("checked",true).trigger("change")});$("#time24_cb").prop("checked",true===TS.prefs.getPref("time24"));$("#time24_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"time24",value:!!$(this).prop("checked")});ie()});$("#hide_hex_swatch_cb").prop("checked",false===TS.prefs.getPref("hide_hex_swatch"));$("#hide_hex_swatch_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"hide_hex_swatch",value:!e})});$("#plaintext_emoji_cb").prop("checked",TS.interop.rules.emoji.shouldRenderEmojiAsText());$("#plaintext_emoji_cb").on("change",function(){var e=!!$(this).prop("checked");var t=e?"as_text":"default";TS.prefs.setPrefByAPI({name:"emoji_mode",value:t});$("#jumbomoji_cb").prop("disabled",e||"dense"===TS.prefs.getPref("messages_theme"));$("#convert_emoticons_cb").prop("disabled",e);$("#jumbomoji_cb_label, #convert_emoticons_label").toggleClass("subtle_silver",e)});$("#jumbomoji_cb").prop("checked",true===TS.prefs.getPref("jumbomoji"));$("#jumbomoji_cb").prop("disabled",TS.interop.rules.emoji.shouldRenderEmojiAsText()||"dense"===TS.prefs.getPref("messages_theme"));$("#jumbomoji_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"jumbomoji",value:e});TS.prefs.legacyOnPrefChanged({name:"jumbomoji",value:e})});$("#convert_emoticons_cb").prop("checked",true===TS.prefs.getPref("convert_emoticons"));$("#convert_emoticons_cb").prop("disabled",TS.interop.rules.emoji.shouldRenderEmojiAsText());$("#convert_emoticons_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"convert_emoticons",value:e})});$("#jumbomoji_cb_label, #convert_emoticons_label").toggleClass("subtle_silver",TS.interop.rules.emoji.shouldRenderEmojiAsText());$("#expand_internal_inline_imgs_cb").prop("checked",true===TS.prefs.getPref("expand_internal_inline_imgs"));$("#expand_internal_inline_imgs_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"expand_internal_inline_imgs",value:!!$(this).prop("checked")})});$("#expand_inline_imgs_cb").prop("checked",true===TS.prefs.getPref("expand_inline_imgs"));$("#expand_inline_imgs_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"expand_inline_imgs",value:e});TS.prefs.setPrefLocal("expand_inline_imgs",e);$("#dont_obey_inline_img_limit_cb").prop("disabled",!TS.prefs.getPref("expand_inline_imgs"))});$("#dont_obey_inline_img_limit_cb").prop("checked",false===TS.prefs.getPref("obey_inline_img_limit"));$("#dont_obey_inline_img_limit_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefLocal("obey_inline_img_limit",!e);TS.prefs.setPrefByAPI({name:"obey_inline_img_limit",value:!e})});$("#expand_non_media_attachments_cb").prop("checked",true===TS.prefs.getPref("expand_non_media_attachments"));$("#expand_non_media_attachments_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"expand_non_media_attachments",value:!!$(this).prop("checked")})});if(b){var t=$(".prefs_modal");var i=$("#forwarding_address");Ladda.bind("#get_forwarding_email_cb");TS.interop.api.call("users.emailtoken.get").then(function(e){return Promise.resolve(e.data.email_address)}).catch(function(){return Promise.resolve(false)}).then(function(e){$(".prefs_email_forwarding").replaceWith(TS.templates.prefs_email_forwarding({existing_forwarding_email:e}));i=$("#forwarding_address");e&&i.select()});t.on("click","#get_forwarding_email_cb",function(){$("#get_forwarding_email_cb").removeClass("btn_outline");TS.interop.api.call("users.emailtoken.create").then(function(e){Ladda.stopAll();$(".prefs_email_forwarding").replaceWith(TS.templates.prefs_email_forwarding({existing_forwarding_email:e.data.email_address}));i=$("#forwarding_address");i.select()})});t.on("focus, click","#forwarding_address",function(e){e.target.select()});t.on("click","#copy_forwarding_email_cb",function(e){TS.clipboard.writeText(TS.interop.i18n.t("Send to Slack <{address}>","prefs")({address:i.val()}));TS.tips.updateTipTitle($(e.target),TS.interop.i18n.t("Copied!","prefs"));$(e.target).mouseleave(function(){setTimeout(function(){TS.tips.updateTipTitle($(e.target),TS.interop.i18n.t("Copy email address","prefs"))},500)});i.select()});t.on("click","#disable_forwarding_email_cb",function(e){e.preventDefault();TS.generic_dialog.start({title:TS.interop.i18n.t("This address will be permanently deleted","prefs")(),body:TS.interop.i18n.t("<p>The address <strong>{existing_forwarding_email}</strong> will no longer work. If you\u2019d like, you can always request a new forwarding address.","prefs")({existing_forwarding_email:i.val()}),show_cancel_button:true,show_go_button:true,go_button_text:TS.interop.i18n.t("Disable Address","prefs")(),go_button_class:"btn_danger",onGo:function e(){TS.interop.api.call("users.emailtoken.delete").then(function(){$(".prefs_email_forwarding").replaceWith(TS.templates.prefs_email_forwarding({existing_forwarding_email:false}));Ladda.bind("#get_forwarding_email_cb")})}})})}};var L=function e(t){var i=t&&t.id;return i&&_.includes(TS.model.search_exclude_channels,i)};var G=function e(t){var i=TS.model.search_exclude_channels;var n=TS.shared.ensureModelObsArePresent(i);var a={prefer_exact_match:false,frecency:false,allow_empty_query:true,prefer_channels_user_belongs_to:true,flat:true};var r={channels:{include_archived:true},sort:!!t&&a};return n.then(function(){return TS.searcher.search(t,r)}).then(function(e){return t?e:TS.sorter.search(t,e,a)}).then(function(e){return _.partition(e,TS.interop.rules.channels.isArchived)})};var H=function e(){var t=function e(t){return G(t).then(function(e){var t=Te()(e,2),i=t[0],n=t[1];var a=[];if(n.length){var r=_.map(n,function(e){var t="0."+e.id;var i=L(e);return{model_ob:e,lfs_id:t,preselected:i}});a.push({label:TS.interop.i18n.t("Active Channels","dialogs_prefs_search")(),lfs_group:true,children:r})}if(i.length){var s=!!n.length;var o=_.map(i,function(e){var t=(s?1:0)+"."+e.id;var i=L(e);return{model_ob:e,lfs_id:t,preselected:i}});a.push({label:TS.interop.i18n.t("Archived Channels","dialogs_prefs_search")(),lfs_group:true,children:o})}return{replace_all_items:true,all_items_fetched:true,items:a}})};var i=$("#search_channel_exclusion");i.lazyFilterSelect({placeholder_text:TS.interop.i18n.t("Pick channels to exclude...","prefs")(),data_promise:t,template:function e(t){return new Handlebars.SafeString(TS.templates.admin_invite_channel_picker_option(t))}}).on("change",function(){var e=_($(this).lazyFilterSelect("value")).map("model_ob.id").join(",");TS.prefs.setPrefByAPI({name:"search_exclude_channels",value:e})});setTimeout(function(){i.lazyFilterSelect("focus")},0)};var Q=function e(){$('input:radio[name="read_rd"]').on("change",function(){var e=$(this).val();TS.prefs.setReadStateTrackingPref(e);_e()})};var j=function e(){var t=$("#a11y_animations");t.prop("checked",true===TS.prefs.getPref("a11y_animations"));t.on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"a11y_animations",value:e})});K=TS.interop.desktop.getZoom();var i=TS.ui.a11y.zoomLevelToPercent(K);W(i);$('input:radio[name="a11y_font_size_select"]').on("change",function(){var e=$(this).val();K=TS.ui.a11y.zoomPercentToLevel(e);TS.interop.desktop.setZoom(K)})};var K;var W=function e(t){$('input:radio[name="a11y_font_size_select"]').filter('[value="'+t+'"]').prop("checked",true)};var V=function e(){if(!TS.client)return;if(!TS.interop.desktop.isDesktop)return;TS.ui.a11y.zoom_level_changed_sig.add(function(e){var t=e.zoom_level;var i=K==t;if(!i){K=t;W(TS.ui.a11y.zoomLevelToPercent(K))}var n=TS.ui.a11y.zoomLevelToPercent(t);var a="normal"===n?"100":n;var r=i?"PREF":"OTHER";var s={a11y_zoom_level:a,a11y_zoom_set_origin:r};TS.interop.clog.track("PREF_USER_CLIENT_UPDATE",s)})};var z=function e(){$("#webapp_spellcheck_cb").prop("checked",true===TS.prefs.getPref("webapp_spellcheck")).removeClass("hidden");$("#webapp_spellcheck_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"webapp_spellcheck",value:!!$(this).prop("checked")})});if(m){$("select#spellchecker_languages").prop("disabled",true!==TS.prefs.getPref("webapp_spellcheck"));$("#webapp_spellcheck_cb").on("change",function(){$("select#spellchecker_languages").prop("disabled",!$(this).prop("checked"))});$("select#spellchecker_languages").on("change",function(){var e=null;"automatic"!==$(this).val()&&(e=$(this).val());TS.interop.desktop.setPreference({name:"spellcheckerLanguage",value:e})})}$("#enter_is_special_in_tbt_cb").prop("checked",true===TS.prefs.getPref("enter_is_special_in_tbt"));$("#enter_is_special_in_tbt_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"enter_is_special_in_tbt",value:!!$(this).prop("checked")})});$("#arrow_history_cb").prop("checked",true===TS.prefs.getPref("arrow_history"));$("#arrow_history_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"arrow_history",value:e})});$("#msg_input_send_btn_cb").prop("checked",true===TS.prefs.getPref("msg_input_send_btn"));$("#msg_input_send_btn_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"msg_input_send_btn",value:!!$(this).prop("checked")})});t.find('[data-action="select_ssb_download_path"]').on("click",function(){var e=TS.interop.desktop.getPreference("PrefSSBFileDownloadPath")||"";var i={type:"openDirectory",title:TS.interop.i18n.t("Select a download location","prefs")(),defaultPath:e};TS.interop.desktop.showOpenDialog(i,function(e){if(!e)return;var i=e[0];TS.interop.desktop.setPreference({name:"PrefSSBFileDownloadPath",value:i});t.find("#app_download_path_input").val(i);TS.ui.inline_saver.show({target:t.find("#prefs_download_location")})})});$("#pagekeys_handled_cb").prop("checked",true===TS.prefs.getPref("pagekeys_handled")).removeClass("hidden");$("#pagekeys_handled_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"pagekeys_handled",value:!!$(this).prop("checked")})});$("#f_key_search_cb").prop("checked",true===TS.prefs.getPref("f_key_search")).removeClass("hidden");$("#f_key_search_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"f_key_search",value:!!$(this).prop("checked")})});$("#k_key_omnibox_cb").prop("checked",true===TS.prefs.getPref("k_key_omnibox")).removeClass("hidden");$("#k_key_omnibox_cb").on("change",function(){TS.prefs.setPrefByAPI({name:"k_key_omnibox",value:!!$(this).prop("checked")})});$("#ask_after_away_cb").prop("checked",true===TS.prefs.getPref("confirm_user_marked_away"));$("#ask_after_away_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefLocal("confirm_user_marked_away",e);TS.prefs.setPrefByAPI({name:"confirm_user_marked_away",value:e})});$("#enable_chan_suggestions").prop("checked",true===TS.prefs.getPref("overloaded_message_enabled"));$("#enable_chan_suggestions").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"overloaded_message_enabled",value:e})});$("#allow_calls_to_set_current_status").prop("checked",true===TS.prefs.getPref("allow_calls_to_set_current_status"));$("#allow_calls_to_set_current_status").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"allow_calls_to_set_current_status",value:e})});if(TS.boot_data.feature_macos_disable_hw&&c&&TS.interop.desktop.hasPreference("useHwAcceleration")){$("#winssb_disable_hw_acceleration_cb").prop("checked",!TS.interop.desktop.getPreference("useHwAcceleration"));$("#winssb_disable_hw_acceleration_cb").on("change",function(){var e=!$(this).prop("checked");TS.interop.desktop.setPreference({name:"useHwAcceleration",value:e})})}else if(TS.boot_data.feature_macos_disable_hw&&TS.model.is_our_app){$("#winssb_disable_hw_acceleration_pref").addClass("hidden");$("#winssb_disable_hw_acceleration_note").addClass("hidden")}$("#ss_emojis_cb").prop("checked",true!==TS.prefs.getPref("ss_emojis"));$("#ss_emojis_cb").bind("change",function(){var e=!$(this).prop("checked");TS.prefs.setPrefLocal("ss_emojis",e);TS.prefs.setPrefByAPI({name:"ss_emojis",value:e},function(){TS.reload(null,"prefs dialog change: ss_emojis -> "+e)})});$("#flannel_server_pool").val(TS.prefs.getPref("flannel_server_pool"));$("#flannel_server_pool").on("change",function(){var e=$(this).val();var t=TS.prefs.getPref("flannel_server_pool");if(!_.includes(["production","canary","random"],e)){TS.error("Tried to set an invalid value ('"+e+"') for `flannel_server_pool` pref");return}TS.prefs.setPrefByAPI({name:"flannel_server_pool",value:e},function(){TS.log(1989,"Flannel: canary pref changed from "+t+" to "+e);TS.interop.SocketManager.disconnect()})});$("#client_logs_pri").hide().lazyFilterSelect({placeholder_text:TS.interop.i18n.t("Select logs to enable...","prefs")(),tokenClass:function e(){return"capitalize"},listItemClass:function e(){return"capitalize"}}).on("change",function(){var e=$(this).val();TS.prefs.setPrefByAPI({name:"client_logs_pri",value:e?e.join(","):""})});var i=Math.random();"U024BE7LV"===TS.model.user.id?$("#emo_bear").attr("src","/img/emo_bear2.gif?"+i):$("#emo_bear").attr("src","/img/emo_bear.gif?"+i);$("#surprise_me").on("change",function(){$("#surprise").fadeIn(150,function(){setTimeout(function(){$("#surprise").fadeOut(500,function(){i=Math.random();"U024BE7LV"===TS.model.user.id?$("#emo_bear").attr("src","/img/emo_bear2.gif?"+i):$("#emo_bear").attr("src","/img/emo_bear.gif?"+i);$("#surprise_me").prop("checked",false)})},2400)})});$("#show_jumper_scores").prop("checked",true===TS.prefs.getPref("show_jumper_scores"));$("#show_jumper_scores").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"show_jumper_scores",value:e})})};var Y=function e(){$('input:radio[name="pr_sidebar"]').filter('[value="'+TS.prefs.getPref("sidebar_behavior")+'"]').prop("checked",true);$('input:radio[name="pr_sidebar"]').on("change",function(){var e=$(this).val();TS.prefs.setPrefByAPI({name:"sidebar_behavior",value:e});TS.prefs.legacyOnPrefChanged({name:"sidebar_behavior",value:e})});var i=$("#channel_sort_select");var n={default:TS.interop.i18n.t("Sort channels alphabetically (default)","prefs")(),priority:TS.interop.i18n.t("Sort channels scientifically (based on how you use Slack)","prefs")()};_.each(n,function(e,t){i.append('<option value="'+t+'">'+e+"</option>")});var a=_.get(n,TS.prefs.getPref("channel_sort"))?TS.prefs.getPref("channel_sort"):"default";i.val(a);i.on("change",function(){var e=$(this).val();TS.prefs.setPrefByAPI({name:"channel_sort",value:e});TS.prefs.legacyOnPrefChanged({name:"channel_sort",value:e})});$("#separate_private_channels_cb").prop("checked",true===TS.prefs.getPref("separate_private_channels"));$("#separate_private_channels_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"separate_private_channels",value:e})});$("#separate_shared_channels_cb").prop("checked",true===TS.prefs.getPref("separate_shared_channels"));$("#separate_shared_channels_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"separate_shared_channels",value:e})});$("#separate_organization_channels_cb").prop("checked",true===TS.prefs.getPref("ent_org_wide_channels_sidebar"));$("#separate_organization_channels_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"ent_org_wide_channels_sidebar",value:e},function(){TS.reload(null,"prefs dialog change: ent_org_wide_channels_sidebar -> "+e)})});$("#enable_unread_view").prop("checked",true===TS.prefs.getPref("enable_unread_view"));$("#enable_unread_view").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefLocal("seen_unread_view_coachmark",true);TS.prefs.setMultiPrefsByAPI({enable_unread_view:e,seen_unread_view_coachmark:true});TS.prefs.legacyOnPrefChanged({name:"enable_unread_view",value:e})});$("#show_sidebar_quickswitcher_button_cb").prop("checked",true===TS.prefs.getPref("show_sidebar_quickswitcher_button")).removeClass("hidden");$("#show_sidebar_quickswitcher_button_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"show_sidebar_quickswitcher_button",value:e});TS.prefs.setPrefByAPI({name:"k_key_omnibox_auto_hide_count",value:5})});t.find('input:radio[name="sidebar_theme_rd"]').on("change",function(){var e=$(this).val();var t=TS.sidebar_themes.default_themes[e];pe(e,t)});t.find("input.color_hex").on("textchange",function(){var e=$.trim($(this).val());if(!e.match(TS.prefs.hex_regex)){clearTimeout(o);return}0!==e.indexOf("#")&&(e="#"+e);$(this).prev(".color_swatch").css("background-color",e).data("hex",e);clearTimeout(o);o=setTimeout(function(){var e="custom_theme";var i={column_bg:t.find('input[name="color_column_bg_hex"]').val(),menu_bg:t.find('input[name="color_menu_bg_hex"]').val()||t.find('input[name="color_nav_bar_bg_hex"]').val(),nav_bar_bg:t.find('input[name="color_nav_bar_bg_hex"]').val(),nav_bar_text:t.find('input[name="color_nav_bar_text_hex"]').val(),active_item:t.find('input[name="color_active_item_hex"]').val(),active_item_text:t.find('input[name="color_active_item_text_hex"]').val(),hover_item:t.find('input[name="color_hover_item_hex"]').val(),text_color:t.find('input[name="color_text_color_hex"]').val(),active_presence:t.find('input[name="color_active_presence_hex"]').val(),badge:t.find('input[name="color_badge_hex"]').val()};$.each(i,function(e,t){t&&"#"!==t[0]&&(i[e]="#"+t)});pe(e,i)},250)});t.find("#sidebar_theme_custom").on("textchange",function(){var e=$(this);setTimeout(function(){var t=$.trim(e.val());var i=t.replace(/ /g,"").split(",");var n=TS.interop.utility.formatThemeColorsArray(i);if(!n){clearTimeout(o);return}$.each(n,function(e,t){"#"!==t[0]&&(n[e]="#"+t)});clearTimeout(o);o=setTimeout(function(){pe("custom_theme",n)},250)},0)});t.find(".color_swatch").on("click.show_picker",function(e){e.stopPropagation();var i=$(this);var n=i.next("input");t.find(".color_swatch.selected").removeClass("selected").find(".colpick").addClass("hidden");var a=i.data("hex").replace("#","");i.colpick({flat:true,layout:"hex",color:a,submit:0,onChange:function e(a,r){i.css("background-color","#"+r).data("hex","#"+r);n.val("#"+r);clearTimeout(o);o=setTimeout(function(){var e="custom_theme";var i={column_bg:t.find('input[name="color_column_bg_hex"]').val(),menu_bg:t.find('input[name="color_menu_bg_hex"]').val()||t.find('input[name="color_nav_bar_bg_hex"]').val(),nav_bar_bg:t.find('input[name="color_nav_bar_bg_hex"]').val(),nav_bar_text:t.find('input[name="color_nav_bar_text_hex"]').val(),active_item:t.find('input[name="color_active_item_hex"]').val(),active_item_text:t.find('input[name="color_active_item_text_hex"]').val(),hover_item:t.find('input[name="color_hover_item_hex"]').val(),text_color:t.find('input[name="color_text_color_hex"]').val(),active_presence:t.find('input[name="color_active_presence_hex"]').val(),badge:t.find('input[name="color_badge_hex"]').val()};pe(e,i)},500)}}).colpickSetColor(a);t.on("click.hide_colpick",function(){t&&t.find(".color_swatch.selected").removeClass("selected").find(".colpick").addClass("hidden")});i.addClass("selected").find(".colpick").removeClass("hidden")});$("#customize_theme_toggle").on("click",function(){$("#customize_theme_info").addClass("hidden");$("#prefs_themes_customize").removeClass("hidden");l=true})};var q=function e(){$("#full_text_extracts_cb").prop("checked",true===TS.prefs.getPref("full_text_extracts"));$("#full_text_extracts_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefLocal("full_text_extracts",e);TS.prefs.setPrefByAPI({name:"full_text_extracts",value:e})});$("#folders_cb").prop("checked",true===TS.prefs.getPref("folders_enabled"));$("#folders_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefLocal("folders_enabled",e);TS.prefs.setPrefByAPI({name:"folders_enabled",value:e})});if(TS.model.is_electron){$("#show_memory_instrument_cb").prop("checked",true===TS.prefs.getPref("show_memory_instrument"));$("#show_memory_instrument_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"show_memory_instrument",value:e});TS.prefs.legacyOnPrefChanged({name:"show_memory_instrument",value:e})})}};var J=function e(){$("#mac_ssb_bounce_cb").prop("checked",!!TS.prefs.getPref("mac_ssb_bounce"));$("#mac_ssb_bounce_short_cb").prop("checked","long"!==TS.prefs.getPref("mac_ssb_bounce"));$("#mac_ssb_bounce_cb").on("change",function(){var e=!!$(this).prop("checked");var t=!!$("#mac_ssb_bounce_short_cb").prop("checked");TS.prefs.setPrefLocal("mac_ssb_bounce","");e&&TS.prefs.setPrefLocal("mac_ssb_bounce",t?"short":"long");TS.prefs.setPrefByAPI({name:"mac_ssb_bounce",value:TS.prefs.getPref("mac_ssb_bounce")});ge()});$("#mac_ssb_bounce_short_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"mac_ssb_bounce",value:e?"short":"long"})});$("#mac_ssb_bullet_cb").prop("checked",true===TS.prefs.getPref("mac_ssb_bullet"));$("#mac_ssb_bullet_cb").on("change",function(){var e=!!$(this).prop("checked");TS.prefs.setPrefByAPI({name:"mac_ssb_bullet",value:e})})};var Z=function e(){if(TS.interop.desktop.hasPreference("windowFlashBehavior")){X();$("#winssb_flash_window_cb").on("change",function(){var e=$(this).is(":checked");var t=e?"always":"never";TS.interop.desktop.setPreference({name:"windowFlashBehavior",value:t});X()});$("#winssb_flash_window_only_inactive_cb").on("change",function(){var e=$(this).is(":checked");var t=e?"idle":"always";TS.interop.desktop.setPreference({name:"windowFlashBehavior",value:t});X()})}else{$("#winssb_flash_window_heading").addClass("hidden");$("#winssb_flash_window_choices").addClass("hidden")}var t=TS.interop.environment.isSSBAndAtLeastVersion("2.7.0")&&!TS.interop.environment.isSSBAndAtLeastVersion("2.8.0");var i=function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{show:true};if(t&&t.show){$("#winssb_notify_prefs_heading").removeClass("hidden");$("#winssb_notify_position").removeClass("hidden")}else{$("#winssb_notify_prefs_heading").addClass("hidden");$("#winssb_notify_position").addClass("hidden")}};if(TS.model.is_win&&!t&&TS.interop.desktop.hasPreference("notifyPosition")){var n=TS.interop.desktop.getPreference("notifyPosition");$("#winssb_notify_corner").val(n.corner);$("#winssb_notify_corner").on("change",function(){var e=$(this).val();var t=$("#winssb_notify_display").val();TS.interop.desktop.setPreference({name:"notifyPosition",value:{corner:e,display:t}})});$("#winssb_notify_display").val(n.display);$("#winssb_notify_display").on("change",function(){var e=$("#winssb_notify_corner").val();var t=$(this).val();TS.interop.desktop.setPreference({name:"notifyPosition",value:{corner:e,display:t}})})}else i({show:false});var a=TS.interop.environment.isSSBAndAtLeastVersion("2.7.0")&&TS.interop.desktop.hasPreference("notificationMethod");var r=TS.interop.environment.isSSBAndAtLeastVersion("2.8.0");if(TS.model.is_win&&a){var s=!!(navigator.userAgent.indexOf("Windows NT 10")>=0);var o=!!(navigator.userAgent.indexOf("Windows NT 6.3")>=0);var l=!!(navigator.userAgent.indexOf("Windows NT 6.2")>=0);var c=null;var d=TS.interop.desktop.getPreference("isGpuCompositionAvailable");var u=false===d;$("#please_restart").addClass("hidden");if(s){c="winrt";$("#method_window_win7").remove();$("#method_window_win8").remove();u&&$("#method_html").remove()}else{if(l||o){c="html";$("#method_winrt").remove();$("#method_window_win10").remove();$("#method_window_win7").remove()}else{c="html";$("#method_winrt").remove();$("#method_window_win10").remove();$("#method_window_win8").remove()}if(!TS.interop.desktop.getPreference("isAeroGlassEnabled")||u){$("#winssb_notification_method_container").addClass("hidden");r=false}}var _=TS.interop.desktop.getPreference("notificationMethod")||c;i({show:r&&"html"===_});$("#winssb_notification_method").val(_);$("#winssb_notification_method").on("change",function(){var e=$(this).val();e!==_?$("#please_restart").removeClass("hidden"):$("#please_restart").addClass("hidden");i({show:r&&"html"===e});TS.interop.desktop.setPreference({name:"notificationMethod",value:e})})}else $("#winssb_notification_method_container").addClass("hidden")};var X=function e(){var t=TS.interop.desktop.getPreference("windowFlashBehavior");if("never"===t){$("#winssb_flash_window_cb").prop("checked",false);$("#winssb_flash_window_only_inactive_cb").prop("checked",false).prop("disabled",true)}else if("idle"===t){$("#winssb_flash_window_cb").prop("checked",true);$("#winssb_flash_window_only_inactive_cb").prop("checked",true).prop("disabled",false)}else{$("#winssb_flash_window_cb").prop("checked",true);$("#winssb_flash_window_only_inactive_cb").prop("checked",false).prop("disabled",false)}};var ee=function e(){$("#winssb_launch_on_start_cb").prop("checked",TS.interop.desktop.getPreference("launchOnStartup"));$("#winssb_launch_on_start_cb").on("change",function(){var e=!!$(this).prop("checked");TS.interop.desktop.setPreference({name:"launchOnStartup",value:e})});$("#winssb_run_from_tray_cb").prop("checked",TS.interop.desktop.getPreference("runFromTray"));$("#winssb_run_from_tray_cb").on("change",function(){var e=!!$(this).prop("checked");TS.interop.desktop.setPreference({name:"runFromTray",value:e});te()});if(TS.interop.desktop.hasPreference("useHwAcceleration")){$("#winssb_disable_hw_acceleration_cb").prop("checked",!TS.interop.desktop.getPreference("useHwAcceleration"));$("#winssb_disable_hw_acceleration_cb").on("change",function(){var e=!$(this).prop("checked");TS.interop.desktop.setPreference({name:"useHwAcceleration",value:e})})}else{$("#winssb_disable_hw_acceleration_pref").addClass("hidden");$("#winssb_disable_hw_acceleration_note").addClass("hidden")}};var te=function e(){var t=true;if(TS.interop.desktop.hasPreference("windowFlashBehavior")){var i=TS.interop.desktop.getPreference("windowFlashBehavior");"never"!==i&&"idle"!==i&&TS.interop.desktop.getPreference("runFromTray")&&(t=false)}$("#winssb_flash_warning").toggleClass("hidden",t)};var ie=function e(){$(".message_theme_preview .timestamp").text(TS.interop.datetime.toTime(window.moment().unix(),{do24hrTime:TS.utility.date.do24hrTime(),includeMeridiem:!TS.utility.date.do24hrTime()}));$(".message_content_header_left .timestamp").text(TS.interop.datetime.toTime(window.moment().unix(),{do24hrTime:TS.utility.date.do24hrTime(),includeMeridiem:!TS.utility.date.do24hrTime()}))};var ne=function e(){t.find(".section_rollup").on("click",function(e){var t=$(e.target);var i=$(this);var a=i.attr("id");if(t.closest(".section_rollup_header").length){i.toggleClass("is_active");TS.environment.supports_custom_scrollbar||TS.ui.utility.updateClosestMonkeyScroller(n)}else if(!i.hasClass("is_active")){i.toggleClass("is_active");TS.environment.supports_custom_scrollbar||TS.ui.utility.updateClosestMonkeyScroller(n)}if(i.hasClass("is_active")){h.push(a);h=_.uniq(h)}else _.remove(h,function(e){return e===a})})};var ae=function e(t){var i=$("#"+t);i.length&&i.addClass("is_active")};var re=function i(){if(!e)return;var n=se();"never"!==n&&(TS.ui.growls.checkPermission()||(n="never"));$("#growls_test").css("visibility","");var a=$('input:radio[name="notifications_rd"]').filter('[value="'+n+'"]').prop("checked",true);$(".global_notification_block.selected").removeClass("selected");a.closest(".global_notification_block").addClass("selected");if(!TS.boot_data.feature_turn_mpdm_notifs_on){var r=TS.templates.builders.buildNonDefaultNotificationBlock("margin-left");if(r){$(".non_default").removeClass("hidden");$("#non_default_html").html(r);$("#no_non_default").addClass("hidden")}else{$(".non_default").addClass("hidden");$("#no_non_default").removeClass("hidden")}$("#non_default_tip_link").tooltip("destroy").attr("title",TS.templates.builders.buildNonDefaultNotificationBlock("align_left")).tooltip({html:true})}$('input:radio[name="sound_option_rd"]').each(function(){$(this).val()==TS.notifs.getDesktopNotificationSoundPref()&&$(this).attr("checked",true)});if(TS.prefs.getPref("mute_sounds")){t.find('input:radio[name="sound_option_rd"]').attr("disabled","disabled");t.find("label.sound_option").addClass("disabled")}else{t.find('input:radio[name="sound_option_rd"]').removeAttr("disabled");t.find("label.sound_option").removeClass("disabled")}var s="never"===n;var o="nothing"===ye();var l=s&&o;$("#new_msg_snd_settings").toggleClass("disabled",!!TS.prefs.getPref("mute_sounds"));$("#new_msg_snd_none_cb").prop("checked","none"!==TS.notifs.getDesktopNotificationSoundPref());$("#select_new_msg_snd").toggleClass("hidden","none"===TS.notifs.getDesktopNotificationSoundPref()||s);$("#email_alerts_cb").prop("checked","none"!==TS.prefs.getPref("email_alerts"));$("#select_email_alerts, #email_alerts_info").toggleClass("hidden","none"===TS.prefs.getPref("email_alerts"));"instant"===TS.prefs.getPref("email_alerts")?$("#email_alerts_current").html(TS.interop.i18n.t("once every 15 minutes","prefs")()):"hourly"===TS.prefs.getPref("email_alerts")&&$("#email_alerts_current").html(TS.interop.i18n.t("once an hour","prefs")());$("#mobile_different_settings_cb").prop("checked",g);$("#mobile_specific_settings").toggleClass("hidden",!g);$("#mobile_specific_settings").find('option[value="'+ye()+'"]').prop("selected",true);$("#push_idle_wait_select").find('option[value="'+TS.notifs.getNotificationPushIdleWaitTimeInMinutes()+'"]').prop("selected",true);$("#no_text_in_notifications_cb").prop("checked",true!==TS.notifs.getNoTextInNotificationsPref());$("#threads_everything_cb").prop("checked",!!TS.notifs.getThreadsEverythingNotificationPref()&&!l);$("#no_notifications_warning").toggleClass("hidden","never"!==n);var c=["#threads_everything_cb","#no_text_in_notifications_cb","#dnd_enabled","#dnd_start_hour","#dnd_end_hour","#push_idle_wait_select"].join(", ");$(c).prop("disabled",l).closest("label").toggleClass("disabled",l);var d=["#new_msg_snd_none_cb","#mac_ssb_bounce_cb","#mac_ssb_bounce_short_cb","#winssb_flash_window_cb","#winssb_flash_window_only_inactive_cb","#winssb_notify_corner","#winssb_notify_display"].join(", ");$(d).prop("disabled",s).closest("label").toggleClass("disabled",s);var u=Ee();_.size(u)>0?$("#channel_overrides_callout").removeClass("hidden").html(TS.templates.prefs_channel_overrides_callout({count:_.size(u)})):$("#channel_overrides_callout").addClass("hidden");xe()};var se=function e(){if(TS.boot_data.feature_turn_mpdm_notifs_on){var t=TS.notifs.getGlobalNotificationSetting();if("everything"==t)return"all";if("nothing"==t)return"never";return"mentions"}var i="all";TS.prefs.getPref("growls_enabled")?TS.prefs.getPref("all_channels_loud")||(i="mentions"):i="never";return i};var oe=function e(t){var i=/(\d?\d):(\d\d)/.exec(t);if(!i)return t;var n=parseInt(i[1],10);var a=i[2];var r="AM";if(n>12){r="PM";n-=12}else 0==n?n=12:12==n&&(r="PM");return n+":"+a+" "+r};var le=function e(){$("#growls_permission_div").addClass("hidden");$("#growls_instructions_div").removeClass("hidden");TS.ui.growls.promptForPermission(function(e,t){TS.info("callback called allowed:"+e+" permission_level:"+t);$("#growls_instructions_div").addClass("hidden");if("granted"===t&&e){$("#growls_allowed_div").removeClass("hidden").find(".desktop_notifications_title").addClass("kelly_green").text(TS.interop.i18n.t("Desktop Notifications enabled!","prefs")());$("#growls_test").removeClass("hidden");if(!TS.prefs.getPref("growls_enabled")){TS.prefs.setPrefByAPI({name:"growls_enabled",value:true});TS.prefs.setPrefLocal("growls_enabled",true)}re()}else"default"===t?$("#growls_permission_div").removeClass("hidden"):"denied"===t?$("#growls_disallowed_div").removeClass("hidden"):alert("huh allowed:"+e+" permission_level:"+t)})};var ce=function t(){if(!e)return;var i=TS.interop.members.shouldDisplayRealNames()?"real_names":"display_names";var n=$('input:radio[name="display_real_names_override_cb"]').filter('[value="'+i+'"]').prop("checked",true);$(".global_notification_block.selected").removeClass("selected");n.closest(".global_notification_block").addClass("selected");if(TS.prefs.getTeamPref("display_real_names")){$(".display_real_names_default").removeClass("hidden");$(".display_usernames_default").addClass("hidden");$("#display_real_names_default").removeClass("hidden");$("#display_usernames_default").addClass("hidden")}else{$(".display_real_names_default").addClass("hidden");$(".display_usernames_default").removeClass("hidden");$("#display_real_names_default").addClass("hidden");$("#display_usernames_default").removeClass("hidden")}};var de=null;var ue=function e(){de&&de.cancel();var t=$("#highlight_words_input");var i=t.parents("label");var n=TS.ui.validation.validate(t);i.toggleClass(p,!n);t.toggleClass(p,!n);if(!n)return;var a=$("#highlight_words_input").val();de=TS.prefs.saveHighlightWords(a);de.finally(function(){de=null})};var _e=function t(){if(!e)return;var i=TS.prefs.getReadStateTrackingPref();$('input:radio[name="read_rd"]').filter('[value="'+i+'"]').prop("checked",true)};var me=function e(){$("#fs_modal, #fs_modal_bg").addClass("show_sidebar");$("#fs_modal_bg").append('<div id="sidebar_overlay"></div>')};var fe=function e(){$("#fs_modal, #fs_modal_bg").removeClass("show_sidebar");$("#sidebar_overlay").remove();setTimeout(function(){TS.view.resizeManually()},TS.ui.fs_modal.transition_duration)};var he=function i(n){if(!e)return;n=false!==n;if(TS.prefs.last_theme_selected_in_UI&&TS.prefs.getPref("sidebar_theme")!==TS.prefs.last_theme_selected_in_UI)return;TS.prefs.last_theme_selected_in_UI&&n&&TS.sidebar_themes.setLastThemeSelectedInUI(null);"default"===TS.prefs.getPref("sidebar_theme")&&TS.prefs.setPrefLocal("sidebar_theme","default_theme");var a=TS.prefs.getPref("sidebar_theme");$('input:radio[name="sidebar_theme_rd"]').filter('[value="'+a+'"]').prop("checked",true);if(TS.prefs.getPref("sidebar_theme_custom_values")&&"undefined"!==TS.prefs.getPref("sidebar_theme_custom_values")){var r=JSON.parse(TS.prefs.getPref("sidebar_theme_custom_values"));var s=$.map(r,function(e){return e});TS.useGlobalNav()&&(r=_.assign(r,TS.interop.utility.getGlobalNavTheme(r)));if(t){t.find('input[name="color_column_bg_hex"]').val(r.column_bg);t.find('input[name="color_menu_bg_hex"]').val(r.menu_bg);t.find('input[name="color_nav_bar_bg_hex"]').val(r.nav_bar_bg);t.find('input[name="color_nav_bar_text_hex"]').val(r.nav_bar_text);t.find('input[name="color_active_item_hex"]').val(r.active_item);t.find('input[name="color_active_item_text_hex"]').val(r.active_item_text);t.find('input[name="color_hover_item_hex"]').val(r.hover_item);t.find('input[name="color_text_color_hex"]').val(r.text_color);t.find('input[name="color_active_presence_hex"]').val(r.active_presence);t.find('input[name="color_badge_hex"]').val(r.badge);t.find('.color_swatch[data-theme-element="column_bg"]').css("background-color",r.column_bg).data("hex",r.column_bg);t.find('.color_swatch[data-theme-element="menu_bg"]').css("background-color",r.menu_bg).data("hex",r.menu_bg);t.find('.color_swatch[data-theme-element="nav_bar_bg"]').css("background-color",r.nav_bar_bg).data("hex",r.nav_bar_bg);t.find('.color_swatch[data-theme-element="nav_bar_text"]').css("background-color",r.nav_bar_text).data("hex",r.nav_bar_text);t.find('.color_swatch[data-theme-element="active_item"]').css("background-color",r.active_item).data("hex",r.active_item);t.find('.color_swatch[data-theme-element="active_item_text"]').css("background-color",r.active_item_text).data("hex",r.active_item_text);t.find('.color_swatch[data-theme-element="hover_item"]').css("background-color",r.hover_item).data("hex",r.hover_item);t.find('.color_swatch[data-theme-element="text_color"]').css("background-color",r.text_color).data("hex",r.text_color);t.find('.color_swatch[data-theme-element="active_presence"]').css("background-color",r.active_presence).data("hex",r.active_presence);t.find('.color_swatch[data-theme-element="badge"]').css("background-color",r.badge).data("hex",r.badge);$("#sidebar_theme_custom").val(s.join(","))}}};var pe=function e(t,i){var n=false;TS.sidebar_themes.setLastThemeSelectedInUI(t);var a={sidebar_theme:t,sidebar_theme_custom_values:JSON.stringify(i)};TS.prefs.setMultiPrefsByAPI(a);TS.prefs.setMultiplePrefs(a);he(n);TS.prefs.sidebar_theme_changed_sig.dispatch(n)};var ge=function e(){TS.prefs.getPref("mac_ssb_bounce")?$("#mac_ssb_bounce_short_cb").prop("disabled",false):$("#mac_ssb_bounce_short_cb").prop("disabled",true)};var Se=function t(i){if(!i.is_self)return;if(!e)return;$(".dnd_tz_label").text(TS.model.user.tz_label)};var ve=function t(){if(!e)return;TS.prefs.getPref("tz")&&$("#prefs_dnd").removeClass("tz_not_set")};var be=function e(t){if(v){v=false;return}if(TS.interop.i18n.locale===TS.prefs.getPref("locale")){TS.generic_dialog.is_showing&&TS.generic_dialog.cancel();return}var i=TS.interop.i18n.localesEnabled({featureLocaleEnGb:TS.boot_data.feature_locale_en_GB,featureLocalePtBr:TS.boot_data.feature_locale_pt_BR,featureLocaleEsLa:TS.boot_data.feature_locale_es_LA,featureLocalizationPhaseTwo:TS.boot_data.feature_localization_phase_two})[t];window.desktop&&desktop.teams&&desktop.teams.setTeamLocale&&desktop.teams.setTeamLocale(t);TS.generic_dialog.is_showing&&TS.generic_dialog.end();TS.generic_dialog.start({title:TS.interop.i18n.t("Switching to {lang}","prefs")({lang:i}),body:"<p>"+TS.interop.i18n.t("Changing your language will take just a moment.","prefs")()+"</p>",show_cancel_button:false,onGo:function e(){window.createCookie("i18n_locale",t,365,"slack.com");TS.reload(null,"prefs dialog change: locale -> "+i)}})};var we=function e(t){var i=TS.boot_data.notification_sounds;var n=_.find(i,{value:t});return n?n.label:""};var ye=function e(){var t=TS.notifs.getGlobalPushNotificationSetting();"mentions"!==t&&"dm_and_mentions"!==t&&"dms"!==t||(t="mentions");return t};var Ae=function e(){var t=TS.notifs.getGlobalNotificationSetting();var i=ye();return t!==i};var ke=function e(t){var i;if(TS.boot_data.feature_turn_mpdm_notifs_on)i=TS.notifs.setMobileGlobalNotifySetting(t);else{var n=Ce(t);if(!n)return;i=TS.prefs.setMultiPrefsByAPI(n)}i&&TS.ui.inline_saver.show({target:"#prefs_send_notifications_for",promise:i})};var Ce=function e(t){var i={};switch(t){case"nothing":i.push_dm_alert=0;i.push_mention_alert=0;i.push_everything=0;break;case"mentions":i.push_dm_alert=1;i.push_mention_alert=1;i.push_everything=0;break;case"everything":i.push_dm_alert=1;i.push_mention_alert=1;i.push_everything=1;break;default:i=null;break}return i};var xe=function e(){var t=$("#channel_specific_overrides");t.longListView({items:[],approx_item_height:61,makeElement:function e(){return $('<div class="channel_overrides_row" data-action="open_channel_overrides"></div>')},renderItem:function e(t,i){t.attr("data-cid",i.id);t.html(TS.templates.prefs_channel_overrides({override:i}))},calcItemHeight:function e(t){return t.outerHeight()},preserve_dom_order:true,scrollable:t.closest(".contents_container")});Ie()};var Ie=function e(){var t=Ee();t=_.values(t);var i=_.reject(t,"channel.is_mpim");var n=_.filter(t,"channel.is_mpim");i=_.sortBy(i,"channel.name");n=_.sortBy(n,"channel.name");var a=i.concat(n);var r=$("#channel_specific_overrides");var s=true;r.longListView("setItems",a,s)};var Me=function e(t,i){if(t.muted)return false;if(t.suppress_at_channel)return false;var n=TS.redux.notifications.getDefaultDesktopNotifySetting(i);var a=TS.redux.notifications.getDefaultMobileNotifySetting(i);if(t.desktop!==n)return false;if(t.mobile!==a)return false;return true};var Ee=function e(){var t={};if(TS.boot_data.feature_turn_mpdm_notifs_on){var i=TS.redux.notifications.getAllNotificationOverrides();for(var n in i)if(Object.prototype.hasOwnProperty.call(i,n)){var a=i[n];if(Me(a,n))continue;var r=false;var s=TS.redux.channels.getEntityById(n,r);if(s){if(TS.interop.rules.channels.isNonExistent(s))continue;if(TS.interop.rules.channels.isFromAnotherTeam(s))continue;if(s.is_channel&&!s.is_member)continue;if(s.is_archived)continue;t[n]=Be(s,a)}}return t}var o=TS.notifs.getCorGsNotUsingGlobalNotificationSetting();var l=TS.notifs.getCorGsNotUsingGlobalPushNotificationSetting();var c=function e(i,n,a){i.forEach(function(e){var i=t[e.id];if(!i){i=Pe(e);t[e.id]=i}i[n]=a})};c(o.everything,"desktop","everything");c(o.mentions,"desktop","mentions");c(o.nothing,"desktop","nothing");c(o.muted,"is_muted",true);c(o.suppressed,"is_suppressed",true);c(l.everything,"mobile","everything");c(l.mentions,"mobile","mentions");c(l.nothing,"mobile","nothing");return t};var Be=function e(t,i){if(!TS.boot_data.feature_turn_mpdm_notifs_on)return;if(!t||!t.id)return;var n=TS.redux.notifications.getDefaultDesktopNotifySetting(t.id);var a=TS.redux.notifications.getDefaultMobileNotifySetting(t.id);var r={is_muted:!!i.muted,is_suppressed:!!i.suppress_at_channel,channel:t,id:t.id};i.desktop!==n&&(r.desktop=i.desktop);if(i.mobile!==a){r.mobile=i.mobile;"dms"==r.mobile&&(r.mobile="mentions_dms")}return r};var Pe=function e(t){var i={channel:t,id:t.id};return i};var Ue=function e(t){var i=TS.notifs.getGlobalNotificationSetting();"everything"===i?TS.notifs.makeCorGDTopEverything(t):"mentions"===i?TS.notifs.makeCorGDTopMentions(t):TS.notifs.makeCorGDTopNothing(t);var n=ye();"everything"===n?TS.notifs.makeCorGPushEverything(t):"mentions"===n?TS.notifs.makeCorGPushMentions(t):TS.notifs.makeCorGPushNothing(t);TS.notifs.makeCorGNOTPushSuppressed(t);TS.notifs.makeCorGNOTSuppressed(t);TS.notifs.makeCorGNOTMuted(t);TS.prefs.setMultiPrefsByAPI({loud_channels:TS.model.loud_channels.join(","),never_channels:TS.model.never_channels.join(","),loud_channels_set:TS.model.loud_channels_set.join(","),push_loud_channels:TS.model.push_loud_channels.join(","),push_mention_channels:TS.model.push_mention_channels.join(","),push_loud_channels_set:TS.model.push_loud_channels_set.join(","),at_channel_suppressed_channels:TS.model.at_channel_suppressed_channels.join(","),push_at_channel_suppressed_channels:TS.model.push_at_channel_suppressed_channels.join(","),muted_channels:TS.redux.channels.getMutedChannelsAsArray().join(",")}).catch(function(){TS.error("Failed to reset to channel defaults: "+t)})};var De=function e(){var t=$("#global_prefs_container");var i=$("#channel_prefs_container");T||(T=t.closest(".contents_container").scrollTop());a.addClass("hidden");t.addClass("hidden");i.removeClass("hidden");$("#channel_specific_overrides").longListView("setHidden",true);TS.ui.fs_modal.bindBackButton(Oe);TS.ui.fs_modal.showBackButton()};var $e=function e(){var t=$("#channel_prefs_container");TS.ui.fs_modal.setHeaderTitle(TS.interop.i18n.t("Add a channel-specific notification setting","prefs","5cfbdd11382cf83e3ffdd242a740fd0b8698cedf")());t.html(TS.templates.prefs_channel_picker());var i=function e(t){return TS.searcher.search(t,{channels:{include_archived:false,only_if_member:true},groups:{include_archived:false},mpims:true,sort:{allow_empty_query:true}}).then(function(e){e.all_items_fetched=true;_.forEach(e,function(e){e.lfs_id=e.model_ob.id});return e})};$("#channel_override_picker").lazyFilterSelect({single:true,placeholder_text:TS.interop.i18n.t("Select or search","prefs")(),approx_item_height:30,tab_to_nav:true,no_default_selection:true,template:function e(t){return new Handlebars.SafeString(TS.templates.file_sharing_channel_row({item:t.model_ob}))},data_promise:i}).one("remove",function(){$(this).lazyFilterSelect("destroy")})};var Fe=function e(t){var i=$("#channel_prefs_container");var n=TS.redux.channels.getEntityById(t);if(!n)return;var a=_.escape(TS.interop.rules.channels.getDisplayNameForChannel(n));a.length>30&&(a=a.substring(0,30)+"...");a+=TS.templates.builders.maybeMakeSharedIcon(n);TS.ui.fs_modal.setHeaderTitle(new Handlebars.SafeString(TS.interop.i18n.t("Notification Preferences: {channel_name}","prefs")({channel_name:TS.interop.i18n.safeString(a)})));if(TS.boot_data.feature_channel_notif_dialog_update)TS.interop.mountChannelNotificationSettings(TS.boot_data.team_id,i[0],{channelId:t,onClose:function e(){return Oe(true)},onReset:function e(){Ue(t)}});else{var r=true;TS.ui.channel_prefs_dialog.renderOptions(i,t,r)}i.find('[data-action="done"]').on("click",Oe);i.find('[data-action="reset_channel_to_defaults"]').on("click",function(){Ue(t)});w=true};var Oe=function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];var i=$("#global_prefs_container");var n=$("#channel_prefs_container");TS.ui.fs_modal.unbindBackButton();TS.ui.fs_modal.hideBackButton();TS.ui.fs_modal.setHeaderTitle(k());TS.boot_data.feature_channel_notif_dialog_update&&TS.interop.unmountChannelNotificationSettings(n[0]);a.removeClass("hidden");i.removeClass("hidden");n.addClass("hidden").empty();$("#channel_specific_overrides").longListView("setHidden",false);t&&(T=0);i.closest(".contents_container").scrollTop(T);T=0;w=false};var Re=function e(){var t=$("#channel_prefs_container");if(!t.length||t.hasClass("hidden"))return true;var i=$("#channel_override_picker");if(i.length){var n=i.lazyFilterSelect("value")[0];var a=_.get(n,"model_ob.id");if(!a)return false;Fe(a);return false}Oe();return false}})();var ve=i(3080);var be=i(1360);(function(){TS.registerModule("ui.fs_modal_file_viewer",{start:function e(t){k=t;if(!k||!k.current_file_id&&!k.current_external_link){TS.error("Full screen file viewer modal requires something to show.");return}if(TS.ui.fs_modal_file_viewer.is_showing){TS.error("Full screen file viewer modal is already showing.");return}TS.files.team_file_comment_added_sig.add(ye);TS.files.team_file_comment_deleted_sig.add(ye);TS.files.team_file_deleted_sig.add(Be);TS.files.team_file_changed_sig.add(j);TS.channels.message_received_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.ims.message_received_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.groups.message_received_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.mpims.message_received_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.channels.message_removed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.ims.message_removed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.groups.message_removed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.mpims.message_removed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.channels.message_changed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.ims.message_changed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.groups.message_changed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.mpims.message_changed_sig.add(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.members.changed_current_status_sig.add(TS.ui.fs_modal_file_viewer.updateCurrentStatusForMember,TS.ui.fs_modal_file_viewer);ne();v=!A.is_pdf&&TS.boot_data.feature_modern_image_viewer&&!TS.model.is_IE;var i=v?me():de();TS.ui.fs_modal.start(i);TS.ui.fs_modal_file_viewer.is_showing=true;X();be();we();ve();Ae();xe();Se("both");setTimeout(function(){fe()},0)},getCurrentFileId:function e(){if(!TS.ui.fs_modal_file_viewer.is_showing)return false;if(k.current_file_id)return k.current_file_id;if(k.current_external_link)return k.current_external_link.getAttribute("data-src");return false},previous:function e(){t.find(".previous_btn:not([disabled])").length&&ge(-1)},next:function e(){t.find(".next_btn:not([disabled])").length&&ge(1)},updateGallery:function e(){if(TS.client.activeChannelIsHidden())return;setTimeout(function(){y=ee();be();we();ve()},500)},updateCurrentStatusForMember:function e(t){if(!TS.ui.fs_modal_file_viewer.is_showing)return;var i={member:t,for_message:true};$(".aside_panel .message_current_status.color_"+t.id).replaceWith(TS.templates.current_status(i))},storeLastCommentInput:function e(){if(!t)return;if(!A||!A.file||!A.file.id)return;TS.storage.storeLastCommentInput(A.file.id,TS.utility.contenteditable.value(t.find("#file_comment")))},test:function e(){var e={_generateTemplateArguments:re,_shouldDisplayLargestThumb:ae};Object.defineProperty(e,"_settings",{get:function e(){return k},set:function e(t){k=t}});Object.defineProperty(e,"_current_file",{get:function e(){return A},set:function e(t){A=t}});Object.defineProperty(e,"_canComment",{get:function e(){return K},set:function e(t){K=t}});return e},canClose:function e(){return R()}});var e=$("body");var t;var i;var n;var a;var s;var o;var l;var c;var d;var u;var m;var f;var h;var p;var g;var T;var S;var v=false;var b=false;var w=false;var y;var A={index:0,aside_panel_showing:false};var k={};var C;var x=function e(){t=$(".fs_modal_file_viewer");i=t.find(".fs_modal_file_viewer_content");n=t.find(".viewer");I();o=n.find(".images, .p-image_viewer_container");M();E()};var I=function e(){a=t.find(".fs_modal_file_viewer_header");s=a.find(".file_header_detailed")};var M=function e(){l=o.find(".scaled_image");c=o.find(".actual_pixel_image")};var E=function e(){d=t.find(".comment_btn");u=t.find(".aside_panel");m=t.find(".details_container");f=t.find(".comments_container");h=t.find(".shared_to_conversations");p=t.find(".file_comment_form_container")};var B=function e(){t=null;i=null;n=null;l=null;o=null;d=null;u=null;m=null;f=null;h=null;p=null;c=null;a=null;s=null;y=null;k.$el=null};var P=function e(){te();Ee();Q();TS.ui.inline_edit.end();ie();B();TS.ui.fs_modal_file_viewer.is_showing=false};var U=function e(){x();D();A.is_pdf&&(C=new TS.ui.PdfViewer(o.find("#pdf_display"),A.file))};var D=function n(){t.on("click",".comment_btn, .aside_close_btn",W);t.on("click","#fs_modal_close_btn, .channel_link, .group_link, .file_preview_link",TS.ui.fs_modal.close);t.on("mousedown",".viewer",L);t.on("click",".viewer",G);t.on("click",".scaled_image",function(e){e.stopPropagation();q(e)});t.on("click",".actual_pixel_image",function(e){e.stopPropagation();J()});t.on("click",".previous_btn",function(e){e.stopPropagation();TS.ui.fs_modal_file_viewer.previous()});t.on("click",".next_btn",function(e){e.stopPropagation();TS.ui.fs_modal_file_viewer.next()});t.on("click",".file_comment_btn",function(e){var t=$(e.target);var i=t.closest("[data-model-ob-id]").attr("data-model-ob-id");Ae(i)});t.on("click",".aside_back_btn",function(){Ae(null)});e.on("keydown",O);TS.view.resize_sig.add(fe);i.on("click.view",TS.view.onFilePreviewClick);F()};var F=function e(){t.find(".scaled_image").on("error",function(){if(!o)return;o.addClass("broken_image")})};var O=function e(t){switch(t.which){case TS.utility.keymap.up:if(v)return;if(TS.utility.isFocusOnInput())return;if(!A.is_actual_pixel_image_shown)return;t.preventDefault();t.stopPropagation();Z("up");break;case TS.utility.keymap.down:if(v)return;if(TS.utility.isFocusOnInput())return;if(!A.is_actual_pixel_image_shown)return;t.preventDefault();t.stopPropagation();Z("down");break;case TS.utility.keymap.left:if(TS.utility.isFocusOnInput())return;if(v){b||TS.ui.fs_modal_file_viewer.previous();return}t.preventDefault();t.stopPropagation();A.is_actual_pixel_image_shown?Z("left"):TS.ui.fs_modal_file_viewer.previous();break;case TS.utility.keymap.right:if(TS.utility.isFocusOnInput())return;if(v){b||TS.ui.fs_modal_file_viewer.next();return}t.preventDefault();t.stopPropagation();A.is_actual_pixel_image_shown?Z("right"):TS.ui.fs_modal_file_viewer.next();break;case TS.utility.keymap.space:if(v)return;if(TS.utility.isFocusOnInput())return;t.preventDefault();t.stopPropagation();Y(t);break;case TS.utility.keymap.esc:H(t);break;default:break}};var R=function e(){if(TS.ui.react_emoji_menu.is_showing)return false;if(TS.model.menu_is_showing)return false;if(TS.model.dialog_is_showing)return false;if(TS.utility.isTabCompleteShowing())return false;if(TS.ui.inline_edit.containsActiveElement(t))return false;return true};var N=true;var L=function e(){N=R()};var G=function e(t){if(!N)return;if($(t.target).closest(".control_btns").length)return;if($(t.target).closest(".p-image_viewer__zoom_control").length)return;TS.ui.fs_modal.close()};var H=function e(t){if(TS.utility.isFocusOnInput())return;if(!R())return;t.stopPropagation();t.preventDefault();A.is_actual_pixel_image_shown?J():TS.ui.fs_modal.close()};var Q=function i(){t.off("click");e.off("keydown",O);TS.view.resize_sig.remove(fe)};var j=function e(i){if(t.length&&A.file.id===i.id){A.file=TS.files.getFileById(A.file.id)||A.file;var n=!TS.interop.files.isObjectFresh(i.id);if(n){TS.files.getFileById(i.id);return}var a=re();var r=false;TS.ui.inline_edit.containsActiveElement(s)&&(r=true);if(!r){s.replaceWith(TS.templates.file_header_detailed(a));I()}}};var K=function e(){if(TS.boot_data.feature_file_threads)return false;if(TS.files.isFileAuthorExternal(A.file))return false;if(!k.current_file_id)return false;return true};var W=function e(){A.aside_panel_showing?z():V()};var V=function e(){d.addClass("active");i.addClass("aside_panel_active");A.aside_panel_showing=true;window.setTimeout(function(){T.focus()},250)};var z=function e(){d.removeClass("active");i.removeClass("aside_panel_active");A.aside_panel_showing=false;window.setTimeout(function(){d.blur()},250)};var Y=function e(t){A.is_actual_pixel_image_shown?J():q(t)};var q=function e(t){if(A.is_image_within_viewer)return false;var i=he(t);n.addClass("show_actual_pixel");A.is_actual_pixel_image_shown=true;pe(i)};var J=function e(){n.removeClass("show_actual_pixel");A.is_actual_pixel_image_shown=false;n.scrollLeft(0);n.scrollTop(0)};var Z=function e(t){var i=n[0];if(!i)return;var a="up"===t||"down"===t;var r=a?"scrollTop":"scrollLeft";var s=25;"up"!==t&&"left"!==t||(s*=-1);i[r]+=s};var X=function e(){if(TS.client.activeChannelIsHidden()){y=[];return}y=ee()};var ee=function e(){var t=A.file&&A.file.timestamp&&A.file.timestamp+".000000"||A.msg&&A.msg.ts;var i=TS.redux.messages.getMessagesInChannel(TS.shared.legacyGetActiveModelOb().id,t,false);var n=[];_.forEach(i,function(e){var t=TS.utility.msgs.getFilesOnMsg(e);t&&_.forEach(t,function(e){TS.files.fileIsImage(e)&&n.push({file:e.id})});e.attachments&&_.forEach(e.attachments,function(t){t.image_url&&n.push({src:t.image_url,width:t.image_width,height:t.image_height,rotation:t.rotation,ts:e.ts,channel:e.channel});t.files&&_.forEach(t.files,function(e){TS.files.fileIsImage(e)&&n.push({file:e.id})})})});return n};var te=function e(){TS.files.team_file_comment_added_sig.remove(ye);TS.files.team_file_comment_deleted_sig.remove(ye);TS.files.team_file_deleted_sig.remove(Be);TS.files.team_file_changed_sig.remove(j);TS.channels.message_received_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.ims.message_received_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.groups.message_received_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.mpims.message_received_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.channels.message_removed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.ims.message_removed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.groups.message_removed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.mpims.message_removed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.channels.message_changed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.ims.message_changed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.groups.message_changed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer);TS.mpims.message_changed_sig.remove(TS.ui.fs_modal_file_viewer.updateGallery,TS.ui.fs_modal_file_viewer)};var ie=function e(){k.current_file_id=null;k.current_external_link=null;A.external_file_src=null;A.link_url=null;A.is_image_within_viewer=null;if(C){C.destroy();C=null}};var ne=function e(){if(k.current_file_id){A.file=TS.files.getFileById(k.current_file_id);A.member=TS.interop.members.getMemberById(A.file.user);A.original_w=A.file.original_w;A.original_h=A.file.original_h;A.is_pdf=TS.model.pdf_viewer_enabled&&TS.files.fileIsPDF(A.file);TS.files.fetchFileInfo(A.file.id,function(){A.file=TS.files.getFileById(A.file.id)||A.file;if(A.file&&A.file.comments&&A.file.comments.length&&!TS.boot_data.feature_share_mention_comment_cleanup){var e=u||$();e.find(".comments").html(TS.templates.builders.buildComments(A.file))}})}else if(k.current_external_link){A.file={};A.model_ob=oe();A.msg=le();A.member=ce(A.msg);if(k.current_external_link.src){A.link_url=k.current_external_link.src;A.external_file_src=k.current_external_link.src;A.original_w=k.current_external_link.width;A.original_h=k.current_external_link.height;A.rotation=k.current_external_link.rotation;A.content_type=k.current_external_link.contentType}else{A.link_url=k.current_external_link.getAttribute("data-link-url");A.external_file_src=k.current_external_link.getAttribute("data-src");A.original_w=k.current_external_link.getAttribute("data-width");A.original_h=k.current_external_link.getAttribute("data-height");A.rotation=k.current_external_link.getAttribute("data-rotation");A.content_type=k.current_external_link.getAttribute("data-content-type")}A.is_pdf=false}else A.file={}};var ae=function e(t){var i=false===TS.prefs.getPref("a11y_animations")&&"gif"===t.filetype&&!t.deanimate_gif;var n="external"===t.mode;var a=t.image_exif_rotation>4;var r="tiff"===_.toLower(t.pretty_type);return i||n||a||r};var re=function e(){var t=A.file.comments_count?A.file.comments_count:"";var i=!A.external_file_src||k.current_file_id;var n;TS.boot_data.feature_file_threads||(n=i?TS.templates.builders.makeFileShareLabel(A.file):TS.templates.builders.makeMessageShareLabelSafe(A.model_ob));var a=i?A.file.timestamp:A.msg&&A.msg.ts;var r=i?"file":"message";var s="message"===r?A.msg:A.file;var o="message"===r?A.model_ob:null;var l=A.file.id?TS.files.getFileActions(A.file):{};l.more=i;l.comment=K();TS.boot_data.feature_share_mention_comment_cleanup&&TS.files.createFileCommentsGroup(A.file);var c={file:A.file,member:A.member,share_label:n,timestamp:a,star_type:r,star_ob:s,star_parent_ob:o,msg:A.msg,model_ob:A.model_ob,comments_count:t,is_aside_panel_active:!!A.aside_panel_showing,show_open_public_link:i&&!TS.prefs.getTeamPref("disallow_public_file_urls"),show_revoke_public_link:i&&!TS.prefs.getTeamPref("disallow_public_file_urls")&&TS.files.getFileActions(A.file).revoke_public_link,control_btns:k.show_control_btns,actions:l,link_url:A.link_url,use_react_image_viewer:v};if(TS.model.pdf_viewer_enabled&&A.is_pdf){c.file_is_pdf=true;c.control_btns=false;c.pdf_viewer_url=TS.boot_data.abs_root_url+"pdf-viewer?feature_pdf_viewer=1"}else{var d=se(A);var u=d.scaled;var _=d.actual_pixel;c.scaled_src=u;c.scaled_rotation=u===A.file.url_private&&A.file.image_exif_rotation;c.actual_pixel_src=_;c.actual_pixel_rotation=_===A.file.url_private&&A.file.image_exif_rotation}return c};var se=function e(t){var i=t.file.url_private;ae(t.file)?i=TS.files.getThumbSrcForFile(t.file,{maxSize:1024}):false===TS.prefs.getPref("a11y_animations")&&"gif"===t.file.filetype&&t.file.deanimate_gif&&(i=t.file.deanimate_gif);if(t.external_file_src){var n={};n.rotate=!!parseInt(t.rotation,10);if("image/svg+xml"===t.content_type){n.render_svg=true;n.width=t.original_w;n.height=t.original_h}i=TS.utility.getImgProxyURLWithOptions(t.external_file_src,n)}var a=i;if(t.file.thumb_1024&&!t.file.thumb_360_gif){var r=$(window).width()<t.file.thumb_1024_w||$(window).height()<t.file.thumb_1024_h;r&&(i=t.file.thumb_1024)}return{scaled:i,actual_pixel:a}};var oe=function e(){var t=false;if(k.current_external_link.channel)return TS.redux.channels.getEntityById(k.current_external_link.channel,t);var i=$(k.current_external_link);var n;if(i.closest(".search_message_result").length){var a=i.closest(".search_message_result").data("channel");n=TS.interop.channels.getImById(a,t)||TS.interop.channels.getPublicChannelById(a,t)||TS.interop.channels.getGroupById(a,t)||TS.interop.channels.getMpimById(a,t)}else i.closest("#messages_container").length&&(n=TS.shared.legacyGetActiveModelOb());return n||{}};var le=function e(){if(k.current_external_link.ts)return TS.utility.msgs.findMsg(k.current_external_link.ts,k.current_external_link.channel);var t=$(k.current_external_link).closest("ts-message").data("ts");var i=TS.utility.msgs.findMsg(t,A.model_ob.id);return i||{ts:t}};var ce=function e(t){if(!t)return false;return TS.interop.members.getMemberById(t.user)};var de=function e(){A.aside_panel_showing=false;var t="fs_modal_file_viewer";TS.boot_data.feature_share_mention_comment_cleanup&&(t+=" with_conversations");return $.extend({},{modal_class:t,modal_contents_container_class:"fs_modal_file_viewer_content",disable_default_controls:true,body_template_html:TS.templates.fs_modal_file_viewer(re()),onShow:U,onEnd:P})};var ue=function e(){var t=$(".viewer .p-image_viewer_container")[0];var i=se(A),n=i.actual_pixel;w=true;var a=function e(t){var i=0!==t;if(i!=b){$(".control_btns").toggle(!i);b=i}};var r=new Image;var s=function e(){if(!r.naturalHeight)return;clearInterval(o);r.onload=null;if(!w)return;w=false;TS.interop.mountImageViewer(TS.boot_data.team_id,t,{image:{height:r.naturalHeight,width:r.naturalWidth,url:n},onDidZoomLevelChange:a})};r.onload=s;r.src=n;var o=setInterval(s,10)};var _e=function e(){w=false;var t=$(".viewer .p-image_viewer_container")[0];TS.interop.unmountImageViewer(t)};var me=function e(){var t=de();return r()({},t,{onShowComplete:function e(){return ue()},onEnd:function e(){t.onEnd&&t.onEnd();_e()}})};var fe=function e(){A.is_image_within_viewer=null;if(!n)return;if(A.is_pdf)return;var t=n.width();var i=n.height();var a;var r;if(ae(A.file)){var s=TS.files.getThumbSrcForFile(A.file,{maxSize:1024});var o=_.invert(A.file)[s];if(o&&A.file){a=A.file[o+"_w"];r=A.file[o+"_h"]}}else{a=A.original_w;r=A.original_h}a||(a=c.width());r||(r=c.height());var d=a-t;var u=r-i;d<1&&u<1&&(A.is_image_within_viewer=true);A.is_image_within_viewer?l.addClass("no_zoom"):l.removeClass("no_zoom")};var he=function e(t){if(t.pageX){var i={width:l.width(),height:l.height()};var n={x:t.pageX-l.offset().left,y:t.pageY-l.offset().top};return{x:n.x/i.width,y:n.y/i.height}}return{x:.5,y:.5}};var pe=function e(t){var i={x:(c.width()-n.width())*t.x,y:(c.height()-n.height())*t.y};n.scrollLeft(i.x);n.scrollTop(i.y)};var ge=function e(t){TS.ui.inline_edit.end();ie();A.index+=t;if(y){var i=y[A.index];i&&i.file&&(k.current_file_id=i.file);i&&i.src&&(k.current_external_link=i);Te();K()||z();F();Se(t)}};var Te=function e(){ne();var t=re();var i=$(TS.templates.fs_modal_file_viewer_header(t));a.replaceWith(i);a=i;if(A.is_pdf){var n=$(TS.templates.fs_modal_file_viewer_content_pdf(t));o.replaceWith(n);o=n;C=new TS.ui.PdfViewer(o.find("#pdf_display"),A.file)}else if(v){_e();ue()}else{var r=$(TS.templates.fs_modal_file_viewer_content_image(t));o.replaceWith(r);o=r}M();Ie();if(TS.boot_data.feature_share_mention_comment_cleanup)Ae();else{var s=$(TS.templates.fs_modal_file_viewer_aside(t));u.replaceWith(s);u=s}E();Me();ve();fe()};var Se=function e(t){if("both"===t){e(1);t=-1}var i=A.index+t;if(!y||i<0||y.length<=i)return;var n;var a=y[i];n={file:TS.files.getFileById(a.file)||{},external_file_src:a.src};if(TS.model.pdf_viewer_enabled&&TS.files.fileIsPDF(n.file))return;var r=se(n);var s=new Image;s.src=r.scaled};var ve=function e(){if(!t)return;var i=t.find(".control_btns");var n=t.find(".previous_btn");var a=t.find(".next_btn");1===y.length||0===y.length?i.addClass("hidden"):i.removeClass("hidden");n.attr("disabled",A.index<=0);a.attr("disabled",A.index>=y.length-1)};var be=function e(){y=_.uniqBy(y,function(e){return e.file||e.src})};var we=function e(){_.forEach(y,function(e,t){if(e.file&&e.file===k.current_file_id){A.index=t;return false}if(e.src&&e.src===A.external_file_src){A.index=t;return false}})};var ye=function e(){if(!t)return;var i=A.file.comments&&A.file.comments.length;t.find(".comment_count").text(i||"")};var Ae=function e(t){if(TS.boot_data.feature_share_mention_comment_cleanup){t=null!==t&&(t||k.$el.closest("[data-model-ob-id").attr("data-model-ob-id"));t?Ce(t):ke()}};var ke=function e(){TS.files.createFileCommentsGroup(A.file);h.replaceWith(TS.templates.shared_to_conversations(A.file));u.attr("data-model-ob-id","");p.addClass("hidden");m.unhideWithRememberedScrollTop();f.hideWithRememberedScrollTop()};var Ce=function e(t){TS.files.createFileCommentsGroup(A.file);var i=jQuery.extend(true,{},A.file);var n=i._comments_grouped[t];i.comments=n.comments;var a=TS.redux.channels.getEntityById(t);var r=a&&TS.interop.rules.channels.getDisplayNameForChannel(a);var s=i.id?TS.files.getFileActions(i):{};s.comment=K();var o={file:i,name:r,actions:s};f.html(TS.templates.fs_modal_file_viewer_comments(o));u.attr("data-model-ob-id",t);s.comment?p.removeClass("hidden"):p.addClass("hidden");f.unhideWithRememberedScrollTop();m.hideWithRememberedScrollTop()};var xe=function e(){Ie();Me()};var Ie=function e(){T=$("#file_comment");g=$("#file_comment_form").detach();S=$("#file_edit_comment_form").detach()};var Me=function e(){p.append(g);p.append(S);TS.files.isFileAuthorExternal(A.file)||$("#file_comment_form").removeClass("hidden");var t=TS.storage.fetchLastCommentInput(A.file.id);t?TS.utility.contenteditable.value(T,t):TS.utility.contenteditable.clear(T);TS.utility.contenteditable.clearHistory(T)};var Ee=function e(){TS.ui.comments.onEndEdit();var t;t=TS.boot_data.feature_share_mention_comment_cleanup?$(".file_comments_scroller"):$("#file_preview_scroller");var i=$("#file_comment_form").detach();var n=$("#file_edit_comment_form").detach();t.append(i);t.append(n);if(A.file.id!==TS.model.last_previewed_file_id){TS.files.isFileAuthorExternal(TS.files.getFileById(TS.model.last_previewed_file_id))&&$("#file_comment_form").addClass("hidden");var a=TS.storage.fetchLastCommentInput(TS.model.last_previewed_file_id);a?TS.utility.contenteditable.value($("#file_comment_form #file_comment"),a):TS.utility.contenteditable.clear($("#file_comment_form #file_comment"));TS.utility.contenteditable.clearHistory($("#file_comment_form #file_comment"))}};var Be=function e(){TS.ui.fs_modal.close(true)}})();var we=i(3081);var ye=i(3082);var Ae=i(3083);var ke=i(1989);var Ce=i(2504);(function(){TS.registerModule("ui.inline_edit",{onStart:function t(){var i="."+e+"_inner";var n=".ui_"+e+"_start";$(i).attr("tabindex",0);$(document).on("keydown"+n,i,function(e){if(u)return;if(!$(e.target).is(i))return;var t=13==e.keyCode||32==e.keyCode;if(!t)return;e.preventDefault();var n=f(e);TS.ui.inline_edit.start(n);m=true});$(document).on("focus",".inline_edit_inner",function(e){$(e.target).closest(".inline_edit").addClass("has_focus")});$(document).on("blur",".inline_edit_inner",function(e){$(e.target).closest(".inline_edit").removeClass("has_focus")});$(document).on("click"+n,i,function(e){var t=f(e);e.stopPropagation();TS.ui.inline_edit.start(t)})},start:function t(c,d){if(!c)return;if(TS.isPartiallyBooted()){TS.incremental_boot.userDidInteractWithUI();return}var u=c.find("."+e+"_input");if(!u)return;n&&!c.is(n)&&TS.ui.inline_edit.end();var m=d||_.find(i,function(e){var t=c.data(e.data_attribute)||u.data(e.data_attribute);if(!t)return false;e.arguments={};e.arguments[e.argument_name_for_data_attribute]=t;return true});if("object"!==("undefined"===typeof m?"undefined":U()(m)))return;r=m.method_name;s=m.value_name;o=m.arguments;if(!r||!s||"object"!==("undefined"===typeof o?"undefined":U()(o)))return;var f="topic"===s?TS.utility.formatTopicOrPurpose:TS.format.formatNoSpecials;l=function e(t){return f(TS.utility.removeLinksFromTabFlow(t))};n=c;a=u;h()},end:function e(){p();S()},containsActiveElement:function e(t){if(!TS.ui.inline_edit.is_showing||!a||!a.length)return false;var i=document.activeElement;var n=$(i);if(!n.is(a))return false;t instanceof jQuery&&t[0]&&(t=t[0]);if(t.nodeType!==Node.ELEMENT_NODE)return false;return $.contains(t,i)},focus:function t(){n.find("."+e+"_inner").focus()}});var e="inline_edit";var t=["animationend","webkitAnimationEnd","MSAnimationEnd","oAnimationEnd"].join(".ui_"+e+" ")+".ui_"+e;var i=[{data_attribute:"file-id",method_name:"files.edit",value_name:"title",argument_name_for_data_attribute:"file"},{data_attribute:"group-id",method_name:"conversations.setTopic",value_name:"topic",argument_name_for_data_attribute:"channel"},{data_attribute:"channel-id",method_name:"conversations.setTopic",value_name:"topic",argument_name_for_data_attribute:"channel"}];var n;var a;var r;var s;var o;var l;var c;var d=true;var u=false;var m=false;var f=function t(i){var n=$(i.target);var a=n.closest("."+e);if(!a||!a.length)return;var r=n.closest("a[href]");if(r&&r.length)return;return a};var h=function i(){if(u)return;$(document).off(".ui_"+e).on("keydown.ui_"+e,y).on("mousedown.ui_"+e,A);n.off(".ui_"+e).on("blur.ui_"+e,"."+e+"_input",k).on(t,w);a.off(".ui_"+e).on("paste.ui_"+e,C);c=a.data("inline-edit-unformatted")||a.text();c=TS.format.unFormatMsg(c);a.text(c);n.addClass(e+"_editing");a.attr("contenteditable",true);a.focus();TS.ui.inline_edit.is_showing=true;u=true;x(a)};var p=function t(){if(!u)return;a&&a.removeAttr("contenteditable");n&&n.removeClass(e+"_editing");u=false;if(m){TS.ui.inline_edit.focus();m=false}};var g=function t(){d=false;p();n.addClass(e+"_updating").removeClass(e+"_done");var i=function t(){n.removeClass(e+"_updating")};var l=_.clone(o);var c=a[0].innerText;c||(c=$("<textarea/>").html(a.html().replace(/<br[^>]*>/,"\n")).text());l[s]=c;TS.interop.api.call(r,l).then(function(){i();b.apply(null,arguments)}).catch(function(){i();v.apply(null,arguments)})};var T=function e(){if(!u)return;a&&a.html(l(c));p();TS.ui.inline_edit.is_showing=false};var S=function t(){$(document).off(".ui_"+e);n&&n.off(".ui_"+e);a&&a.off(".ui_"+e);TS.ui.inline_edit.is_showing=false;u=false;d=true;c=null;o=null;s=null;r=null;a=null;n=null};var v=function t(){a.html(l(c));n.addClass(e+"_done "+e+"_error")};var b=function t(i){var r=i.data||{};if(!r.ok){v(i);return}var s=a.text();r.topic&&(s=r.topic);r.file&&r.file.title&&(s=r.file.title);a.data("inline-edit-unformatted",s);a.html(l(s));n.addClass(e+"_done "+e+"_success")};var w=function t(i){var a=i.originalEvent.animationName;if(a!==e+"_hide_done")return;n.removeClass(e+"_done "+e+"_error "+e+"_success");d=true;if(!u){p();TS.ui.inline_edit.is_showing=false}};var y=function t(i){var n="."+e+"_inner";if(!u)return;if($(i.target).is(n))return;switch(i.which){case TS.utility.keymap.esc:T(i);break;case TS.utility.keymap.enter:if(i.shiftKey||i.altKey)return;i.preventDefault();g();break;default:break}};var A=function e(t){d=!n[0]||!$.contains(n[0],t.target)};var k=function e(t){if(!u)return;if(d)T(t);else{a.focus();_.delay(x,0,a)}};var C=function e(t){if(!u)return;t=t.originalEvent||t;var i=window.clipboardData||t.clipboardData;var n=document.queryCommandSupported("insertText")||document.queryCommandSupported("insertHTML");if(document.queryCommandSupported("ms-pasteTextOnly")){t.preventDefault();window.document.execCommand("ms-pasteTextOnly",false)}else if(i&&n){var a=i.getData("text");""==a&&(a=i.getData("text/plain"));if(""!==a){t.preventDefault();document.queryCommandSupported("insertText")?document.execCommand("insertText",false,a):document.execCommand("insertHTML",false,_.escape(a))}}};var x=function e(t){t.length&&(t=t[0]);var i=document.createRange();i.selectNodeContents(t);var n=window.getSelection();n.removeAllRanges();n.addRange(i)}})();var xe=i(1356);var Ie=i(3084);var Me=i(3085);var Ee=i(3086);var Be=i(3087);var Pe=i(3088);var Ue=i(3089);var De=i(1982);var $e=i(1986);var Fe=i(3090);var Oe=i(3091);(function(){TS.registerModule("client.threads",{switched_sig:new signals.Signal,reply_count_changed:new signals.Signal,new_thread_reply_count_changed:new signals.Signal,threads_unread_changed:new signals.Signal,onStart:function e(){TS.redux.socket.connectedSig.add(m);TS.channels.message_received_sig.add(k);TS.groups.message_received_sig.add(k);TS.ims.message_received_sig.add(k);TS.mpims.message_received_sig.add(k);TS.channels.message_removed_sig.add(A);TS.groups.message_removed_sig.add(A);TS.ims.message_removed_sig.add(A);TS.mpims.message_removed_sig.add(A);TS.channels.message_changed_sig.add(y);TS.groups.message_changed_sig.add(y);TS.ims.message_changed_sig.add(y);TS.mpims.message_changed_sig.add(y);TS.replies.sanity_check_failed_sig.add(R);TS.replies.thread_subscription_changed_sig.add(B);TS.channels.joined_sig.add(G);TS.channels.left_sig.add(L);TS.boot_data.feature_file_threads&&TS.files.team_file_changed_sig.add(Q);TS.boot_data.feature_degraded_send&&TS.replies.thread_synced_sig.add(N);l=TS.boot_data.feature_tinyspeck||TS.utility.enableFeatureForUser(1);TS.client.threads.initQueue()},initQueue:function t(){e=new TS.PromiseQueue},showThreadsView:function t(s,o){s=!!s;o=!!o;var l=!o&&s;var c=TS.client.threadsViewActivated(o,l);if(!c)return false;TS.client.threads.switched_sig.dispatch();TS.msg_edit.editing_in_msg_pane&&TS.msg_edit.resetEditUI();TS.client.ui.threads.showThreadsView();if(i){TS.console.logError("Starting All Threads with potentially stale data, force clearing cache",null,"threads");f()}if(i){TS.interop.console.info("ALL THREADS","Starting threads view with local threads data");r=H();b();TS.client.ui.threads.startWithData(i,n);D(a);h(r)}else{TS.interop.console.info("ALL THREADS","Starting threads view from the api");e.addToQ(p)}return true},destroyThreadsView:function e(){if(!$("#client-ui").hasClass("threads_view_is_showing"))return;TS.client.ui.threads.destroyThreadsView();t&&t.isPending()&&t.cancel();t=null;a=0;r=null;clearTimeout(d);if(c||!i||!i.length){c=false;f()}TS.interop.console.info("ALL THREADS","destroying threads view, clearing threads data");f()},maybeReloadThreadsView:function t(){if(!TS.model.threads_view_is_showing)return;TS.boot_data.feature_degraded_send&&f();TS.client.ui.threads.resetUI();e.addToQ(p)},getMessage:function e(t,n){if(!i)return null;var a=null;_.find(i,function(e){if(e.model_ob.id!=t.id)return false;if(n==e.root_msg.ts){a=e.root_msg;return true}a=_.find(e.replies,{ts:n.toString()});return!!a});return a},getThread:function e(t,n){if(!i)return;return _.find(i,function(e){return e.model_ob.id===t.id&&e.root_msg.ts===n})},getCurrentReplyCount:function e(){return a||0},getNewThreadReplyCount:function e(){var t=_.takeWhile(i,function(e){return O(e)});if(!t||!t.length)return 0;var n=_.reduce(t,function(e,t){var i=_.reduce(t.replies,function(e,t){return t.ts>=r?e+1:e},0);return e+i},0);return n},updateThreadState:function e(t,i,n,a){TS.client.threads.setThreadsUnreadData(t,i,n,a);TS.client.threads.logThreadState("update_thread_state: "+!!t+" "+i+" "+n)},setThreadsUnreadData:function e(t,i,n,a){TS.model.threads_mention_counts=_.isEmpty(a)?{}:a;TS.model.threads_mention_count=_.sum(_.values(TS.model.threads_mention_counts));TS.model.threads_has_unreads=t;if(!TS.model.threads_has_unreads&&TS.model.threads_mention_count){TS.warn("Ignoring positive threads_mention_count because threads_has_unreads == false");TS.model.threads_mention_count=0}TS.utility.msgs.countAllUnreads();!TS.client.threads.hasUnreadThreads()&&TS.model.threads_view_is_showing&&TS.client.ui.threads.maybeRemoveNewRepliesBanner();TS.client.threads.threads_unread_changed.dispatch()},setThreadsUnreadDataFromUsersCounts:function e(t,i,n){TS.client.threads.setThreadsUnreadData(t,i,null,n);TS.client.threads.logThreadState("users.counts: "+!!t+" "+i)},markAllNewThreads:function e(){_.forEach(i,function(e){var t=TS.replies.getSubscriptionState(e.model_ob.id,e.root_msg.thread_ts);if(!t||!t.subscribed)return;var i=t.last_read;(!i||i<e.ts)&&TS.replies.markThread(e.model_ob.id,e.root_msg.thread_ts,e.ts)});!TS.client.threads.hasUnreadThreads()&&TS.model.threads_view_is_showing&&TS.client.ui.threads.maybeRemoveNewRepliesBanner()},hasUnreadThreads:function e(){return _.some(i,function(e){var t=TS.replies.getSubscriptionState(e.model_ob.id,e.root_msg.thread_ts);if(!t||!t.subscribed)return;var i=t.last_read;if(!i||i<e.ts)return true})},showNewRepliesAndMarkThread:function t(n,a){if(!i)return;var r=TS.redux.channels.getEntityById(n);if(!r)return;var s=TS.client.threads.getThread(r,a);if(!s)return;e.addToQ(function(){if(!TS.model.threads_view_is_showing)return;s.max_visible_ts=_.last(s.replies).ts;TS.client.ui.threads.revealNewReplies(s);var e=_.maxBy(s.replies,"ts").ts;TS.replies.markThread(n,a,e);return null})},showPreviousReplies:function t(n,a){if(!i)return;var r=TS.redux.channels.getEntityById(n);if(!r)return;var s=TS.client.threads.getThread(r,a);if(!s)return;var o;var l=_.get(s,"replies.length")&&_.first(s.replies).ts;var c=_.get(s,"root_msg.reply_count",0);if(l&&c>TS.replies.DEFAULT_HISTORY_API_LIMIT)o=TS.replies.getThreadBefore(n,a,l);else{var d=true;o=TS.replies.getThreadLazy(n,a,d)}return e.addToQ(function(){if(!TS.model.threads_view_is_showing)return;o.then(function(e){if(!TS.model.threads_view_is_showing)return;var t=e.messages;var i=Infinity;s.replies&&s.replies.length&&(i=_.first(s.replies).ts);s.min_visible_ts=i;s.replies=s.replies.concat(_.reject(t,{ts:s.root_msg.ts}));s.replies=_.uniqBy(s.replies,"ts");s.replies=_.sortBy(s.replies,"ts")});TS.client.ui.threads.revealPreviousReplies(s,o);return o})},loadMoreThreads:function t(){return e.addToQ(g)},threadCompare:function e(t,i){if("new"===t.grouping&&"old"===i.grouping)return-1;if("old"===t.grouping&&"new"===i.grouping)return 1;if(t.ts<i.ts)return 1;if(t.ts>i.ts)return-1;return 0},maybeRerenderMessage:function t(i,n){if(!TS.model.threads_view_is_showing)return;if(!i||!n.thread_ts)return;e.addToQ(function(){var e=TS.client.threads.getThread(i,n.thread_ts);if(!e)return;M(e,n)})},debugUnthreads:function e(){var t="\n"+u.join("\n");TS.info(t)},logThreadState:function e(t){TS.has_pri[j]&&TS.log(j,"unread thread state change: "+t);var i=TS.interop.datetime.toTime(Date.now()/1e3,{includeMeridiem:false,includeSeconds:true});u.unshift(i+" "+t);u=_.take(u,15)},getThreadsLoadedCount:function e(){return i?i.length:0},test:function e(){return{threadSynced:N}}});var e;var t;var i;var n=false;var a=0;var r;var s;var o=8;var l;var c=false;var d;var u=[];var m=function e(t){if(t)return;f();TS.client.threads.maybeReloadThreadsView()};var f=function t(){e.clear();i=null};var h=function e(t){if(TS.client.threads.hasUnreadThreads()){TS.replies.markAllThreads(t);TS.model.threads_has_unreads||TS.metrics.count("threads_unread_inconsistency_no_local_unreads")}else if(TS.model.threads_has_unreads){TS.metrics.count("threads_unread_inconsistency_has_local_unreads");TS.warn("Correcting threads_has_unreads: was true but threads view has no new replies");TS.client.threads.setThreadsUnreadData(false,0);TS.client.threads.logThreadState("_markAllThreadsAfterLoading: false 0")}};var p=function e(){l&&TS.metrics.mark("threads_view_time_to_fetch_and_display");r=H();clearTimeout(d);d=setTimeout(function(){TS.client.ui.threads.displaySlowLoadingMessage()},5e3);t=TS.interop.api.call("subscriptions.thread.getView",{current_ts:r,limit:o});return t.then(T).then(function(e){var t=e.total_unread_replies;var n=e.has_more;TS.model.threads_view_is_showing&&TS.client.ui.threads.startWithData(i,n);D(t);TS.model.threads_view_is_showing&&h(r);l&&TS.metrics.measureAndClear("threads_view_time_to_fetch_and_display","threads_view_time_to_fetch_and_display");return e}).catch(S)};var g=function e(){t&&t.isPending()&&t.cancel();var n=_.last(i).ts;clearTimeout(d);d=setTimeout(function(){TS.client.ui.threads.displaySlowLoadingMessage()},5e3);t=TS.interop.api.call("subscriptions.thread.getView",{current_ts:n,limit:o});return t.then(T).catch(S)};var T=function e(t){TS.interop.console.info("ALL THREADS","Processing subscriptions.thread.getView response");clearTimeout(d);var a=t.data;var r=a.threads;var s=a.total_unread_replies||0;var l=a.has_more;n=l;l&&r.length<o&&TS.error("subscriptions.thread.getView returned fewer threads than the limit but has_more is true");r=_.filter(r,function(e){if(!e.root_msg){TS.error("Missing root_msg in subscriptions.thread.getView response");return false}if(!e.root_msg.thread_ts){TS.error("root_msg has no thread_ts in subscriptions.thread.getView response");return false}var t=e.root_msg.channel;if(!t){TS.error("No c_id in subscriptions.thread.getView response");return false}e.model_ob=TS.redux.channels.getEntityById(t);if(!e.model_ob){TS.error("No channel with c_id "+t+" in subscriptions.thread.getView response");return false}e.root_msg=TS.interop.messages.preprocessImsg(e.root_msg,t);if(false===e.root_msg._subscribed){TS.error("Got a thread that is not subscribed to in subscriptions.thread.getView response: "+e.root_msg.thread_ts);return false}e.replies=[];if(e.latest_replies){e.latest_replies=TS.interop.messages.preprocessImsgs(e.latest_replies,t);e.latest_replies=_.sortBy(e.latest_replies,"ts");e.replies=e.replies.concat(e.latest_replies)}if(e.unread_replies){e.unread_replies=TS.interop.messages.preprocessImsgs(e.unread_replies,t);e.unread_replies=_.sortBy(e.unread_replies,"ts");e.replies=e.replies.concat(e.unread_replies)}if(e.replies.length){e.ts=_.last(e.replies).ts;if(e.unread_replies)e.grouping="new";else{e.ts=e.ts;e.grouping="old"}var i=_.uniqBy(e.replies,"ts");if(i.length!==e.replies.length){TS.error("Removing duplicate replies in subscriptions.thread.getView response for "+e.ts);e.replies=i}var n=_.last(e.latest_replies);var a=_.first(e.unread_replies);if(n&&a&&n.ts>a.ts){e.replies=_.sortBy(e.replies,"ts");TS.logError({latest_replies_max:n.ts,unread_replies_min:a.ts,last_read:e.root_msg._last_read},"thread_view_replies_out_of_order")}}else{e.ts=e.root_msg.ts;e.grouping="old"}e.initial_last_read=e.root_msg._last_read||0;TS.replies.maybeSlurpSubscriptionState(e.model_ob.id,[e.root_msg]);return true});i||(i=[]);i=i.concat(r);var c=_.uniqBy(i,function(e){return e.model_ob.id+e.root_msg.ts});if(c.length!==i.length){TS.error("Removing duplicate threads in subscriptions.thread.getView response");i=c}w(i);return{total_unread_replies:s,has_more:l,threads:i}};var S=function e(t){TS.error("Threads view error during loading:");TS.error(t);var i=_.get(t,"data.error");i||(i=_.get(t,"message"));i||(i=t);_.isString(i)||(i=JSON.stringify(i));TS.error(i);var n=_.get(t,"stack");n&&TS.error(JSON.stringify(n));TS.console.logError(t,"threads_view_fatal_error");clearTimeout(d);f();TS.client.ui.threads.displayFatalError()};var v=function e(t,i,n){var a=TS.replies.getSubscriptionState(t.id,i.ts);var r=_.filter(n,function(e){return!a.last_read||e.ts>a.last_read});var s=_.filter(n,function(e){return a.last_read&&e.ts<=a.last_read});var o={model_ob:t,root_msg:i,replies:[]};if(s.length&&!r.length){o.replies=_.takeRight(s,2);s=_.dropRight(s,2)}else if(s.length){o.replies.push(_.last(s));s=_.dropRight(s,1)}if(s.length){var l=i.reply_count-o.replies.length;l>0&&l<3&&s.length===l&&(o.replies=s.concat(o.replies))}r.length&&(o.replies=o.replies.concat(r));if(o.replies.length){o.ts=_.last(o.replies).ts;r.length?o.grouping="new":o.grouping="old"}else{o.ts=i.ts;o.grouping="old"}o.initial_last_read=a.last_read||0;return o};var b=function e(){if(!i)return;i=_(i).map(function(e){var t=TS.replies.getSubscriptionState(e.model_ob.id,e.root_msg.thread_ts);if(!t||!t.subscribed)return null;if(e.model_ob.is_channel&&!e.model_ob.is_member)return null;var i=v(e.model_ob,e.root_msg,e.replies);return i}).compact().value();i.sort(TS.client.threads.threadCompare);var t=i.length;i=_.take(i,o);t>i.length&&(n=true);U()};var w=function e(t){var i=_.map(t,"ts");t.sort(TS.client.threads.threadCompare);_.isEqual(i,_.map(t,"ts"))||TS.warn("Threads out of order; fixed in client")};var y=function t(n,a){if(!i||!n||!a)return;if(!a.thread_ts)return;e.addToQ(function(){var e=TS.client.threads.getThread(n,a.thread_ts);if(!e)return;return M(e,a)})};var A=function t(n,a){if(!i||!n||!a)return;if(!a.thread_ts)return;e.addToQ(function(){var e=C(n,a);TS.model.threads_view_is_showing&&e&&TS.client.ui.threads.maybeRemoveMessageFromThread(n,a)})};var k=function t(i,n){if(!i||!n)return;n.is_ephemeral||TS.interop.rules.messages.isTempMsg(n)||(!s||n.ts>s)&&(s=n.ts);if(!TS.model.threads_view_is_showing)return;if(!n.thread_ts)return;if(!TS.interop.messages.isReply(n))return;e.addToQ(function(){return TS.replies.promiseToGetSubscriptionState(i.id,n.thread_ts).then(function(e){if(!e||!e.subscribed)return;var t=TS.client.threads.getThread(i,n.thread_ts);if(t)return I(t,n);return E(i,n.thread_ts)})})};var C=function e(t,n){if(!i||!t||!n)return;var s=TS.client.threads.getThread(t,n.thread_ts);if(!s)return false;if(n.ts===n.thread_ts){TS.error("Attempting to remove remove root msg from thread instead of converting it to tombstone");return false}var o=false;var l=_.findIndex(s.replies,{ts:n.ts});if(-1!==l){s.replies.splice(l,1);o=true}var c=_.findIndex(s.root_msg.replies,{ts:n.ts});if(-1!==c){s.root_msg.replies.splice(l,1);o=true}if(parseFloat(n.ts)>r){D(a-1);F()}if(!s.replies.length&&!_.get(s.root_msg,"replies.length")){x(t,s);return o}var d=_.findIndex(s.unread_replies,{ts:n.ts});-1!==d&&s.unread_replies.splice(d,1);var u=_.findIndex(s.latest_replies,{ts:n.ts});-1!==u&&s.latest_replies.splice(u,1);return o};var x=function e(t,n){if(!i||!n)return;i=_.without(i,n);TS.model.threads_view_is_showing&&TS.client.ui.threads.maybeRemoveThread(t,n)};var I=function e(t,n){if(!i||!t||!n)return;var r=_.findIndex(t.replies,{ts:n.ts});if(-1!==r)return;!t.max_visible_ts&&P(n)&&(t.max_visible_ts=t.replies.length?_.last(t.replies).ts:t.root_msg.ts);t.replies.push(n);t.replies=_.sortBy(t.replies,"ts");var s=false;if(!P(n)){s=true;t.max_visible_ts=_.last(t.replies).ts}TS.model.threads_view_is_showing&&TS.client.ui.threads.maybeUpdateThreadWithMessage(t,n,s);"old"===t.grouping&&TS.client.ui.threads.hideCaughtUpDivider();D(a+1);F();return null};var M=function e(t,n){if(!i||!t||!n)return;var a=false;if(n.ts===n.thread_ts){t.root_msg=n;a=true}var r=_.findIndex(t.replies,{ts:n.ts});if(-1!==r){t.replies.splice(r,1,n);a=true}TS.model.threads_view_is_showing&&a&&TS.client.ui.threads.maybeUpdateThreadWithMessage(t,n)};var E=function e(t,n){if(!i||!t||!n)return;var r=TS.client.threads.getThread(t,n);if(r)return;var s=true;var o=TS.replies.getThreadLazy(t.id,n,s);return o.then(function(e){var n=e.root_msg;var r=_.filter(e.messages,TS.interop.messages.isReply);var s=v(t,n,r);var o=TS.replies.getSubscriptionState(t.id,n.ts);var l=s.replies.filter(function(e){return!o.last_read||e.ts>o.last_read}).length;i.unshift(s);i.sort(TS.client.threads.threadCompare);TS.model.threads_view_is_showing&&TS.client.ui.threads.insertNewThread(s);D(a+l);F();return null})};var B=function t(n,a,r){if(!i||!n||!a)return;if(!r.subscribed)return;var s=TS.redux.channels.getEntityById(n);if(!s)return;e.addToQ(function(){var e=TS.client.threads.getThread(s,a);if(e)return;E(s,a)})};var P=function e(t){return!(t.user===TS.model.user.id||t.is_ephemeral)};var U=function e(){a=0;_.each(i,function(e){var t=TS.replies.getSubscriptionState(e.model_ob.id,e.root_msg.ts);var i=_.filter(e.replies,function(e){return!t.last_read||e.ts>t.last_read});a+=i.length});D(a)};var D=function e(t){a=t;TS.client.threads.reply_count_changed.dispatch(a)};var F=function e(){if(!TS.model.threads_view_is_showing)return;var t=TS.client.threads.getNewThreadReplyCount();t&&TS.client.threads.new_thread_reply_count_changed.dispatch(t)};var O=function e(t){var i=TS.replies.getSubscriptionState(t.model_ob.id,t.root_msg.thread_ts);if(!i)return true;return!i.last_read||t.ts>i.last_read};var R=function t(i,n,a,r,s){if(s)return;e.addToQ(function(){var e=TS.client.threads.getThread(i,n.ts);if(!e)return;e.replies=_.reject(a,{ts:e.root_msg.ts});TS.model.threads_view_is_showing&&TS.client.ui.threads.maybeRedrawThread(e)})};var N=function t(i,n,a,r,s){if(!TS.model.threads_view_is_showing)return;if(!n)return;if(s)return;e.addToQ(function(){var e=TS.client.threads.getThread(i,n.ts);if(!e)return;var t=_.first(e.replies);if(!t)return;e.replies=_.filter(a,function(e){return e.ts>=t.ts});if(TS.model.threads_view_is_showing){var r=true;TS.client.ui.threads.maybeUpdateThreadWithMessages(e,e.replies,r)}})};var L=function e(t){if(!i)return;if(!t.is_group)return;var n=_.filter(i,function(e){return e.model_ob.id===t.id});_.forEach(n,function(e){x(t,e)})};var G=function e(){if(!i)return;TS.model.threads_view_is_showing?c=true:f()};var H=function e(){var t;s&&(t=parseFloat(s));var i=Math.floor(Date.now()/1e3);if(!t){TS.has_pri[j]&&TS.log(j,"Starting threads view with current time because !_max_ts");return i}if(i>s){TS.has_pri[j]&&TS.log(j,"Starting threads view with current time because it is greater than _max_ts");return i}t+=1;TS.has_pri[j]&&TS.log(j,"Starting threads view with "+t+" because it is greater than the current time");return t};var Q=function t(n){if(!i)return;e.addToQ(function(){i.forEach(function(e){var t=[e.root_msg].concat(pe()(e.replies));t.forEach(function(t){var i=TS.utility.msgs.getFilesOnMsg(t);if(!i)return;i.forEach(function(i){if(i.id!==n.id)return;if(!TS.interop.files.isObjectFresh(n.id)){TS.files.getFileById(n.id);return}M(e,t)})})})})};var j=2004})();(function(){TS.registerModule("client.ui.threads",{$scroller:$("#threads_msgs_scroller_div"),$container:null,started_sig:new signals.Signal,ended_sig:new signals.Signal,onStart:function e(){TS.prefs.team_perms_pref_changed_sig.add(w);TS.prefs.emoji_mode_changed_sig.add(T);TS.channels.joined_sig.add(b);TS.channels.left_sig.add(b);TS.channels.archived_sig.add(b);TS.channels.unarchived_sig.add(b);TS.client.threads.new_thread_reply_count_changed.add(p);TS.channels.read_only.list_updated_sig.add(u);TS.view.channel.unknown_resolution_rebuild_sig.add(k);TS.boot_data.feature_lazy_user_groups&&TS.user_groups.unknown_resolution_rebuild_sig.add(C);TS.client.ui.threads.initQueue()},initQueue:function e(){i=new TS.PromiseQueue},showThreadsView:function e(){$("#client-ui").addClass("threads_view_is_showing");TS.client.ui.threads.$scroller.addClass("loading");TS.client.ui.threads.$scroller.addClass("emojimode_"+TS.interop.rules.emoji.getEmojiMode());$("#footer").addClass("hidden");TS.client.archives.cancel(true);TS.client.ui.threads.$scroller.attr("tabindex","-1");TS.client.ui.rebuildAllButMsgs();TS.redux.dispatch(TS.interop.redux.features.workspace.setPrimaryView({id:"Vall_threads",fromLegacy:true}));"details"===TS.model.ui_state.flex_name&&TS.client.ui.flex.hideFlex(true);TS.client.ui.threads.$container=$('<div id="threads_msgs" data-qa="threads_msgs_container"></div>');TS.client.ui.threads.$container.appendTo(TS.client.ui.threads.$scroller);if(TS.boot_data.feature_file_threads){var t=$('<div id="thread_upload_banner_root" class="p-threads_view__top_banners"></div>');t.prependTo(TS.client.ui.threads.$scroller);TS.interop.mountFileUploadBanner(TS.boot_data.team_id,t[0])}TS.generic_notification_banner.mountModernBannerInLegacy();TS.utility.msgs.removeAllEphemeralMsgsByType("threads_temp_slash_cmd_feedback");TS.environment.supports_custom_scrollbar||TS.client.ui.threads.$scroller.monkeyScroll();$("#threads_view_banner").removeClass("hidden");TS.utility.msgs.startUpdatingRelativeTimestamps("#threads_msgs");I();TS.interop.clog.track("THREADS_VIEW_OPEN",{view_session_index:a});TS.client.ui.threads.incrementTrackingSeqId();TS.client.ui.threads.started_sig.dispatch()},isThreadsViewDOMShowing:function e(){return $("#client-ui").hasClass("threads_view_is_showing")},destroyThreadsView:function e(){if(TS.boot_data.feature_file_threads){var t=$("#thread_upload_banner_root");TS.interop.unmountFileUploadBanner(t[0])}TS.client.ui.threads.resetUI();TS.client.ui.threads.$scroller.off("scroll.threads_view_scroll");TS.client.ui.threads.$scroller.empty();$("#client-ui").removeClass("threads_view_is_showing");S();$("#footer").removeClass("hidden");TS.client.ui.threads.$container=null;TS.utility.msgs.stopUpdatingRelativeTimestamps("#threads_msgs");TS.generic_notification_banner.unmountModernBannerInLegacy();r||TS.client.ui.threads.trackThreadsViewClosed("OTHER");$(window).off("keydown.threads");TS.client.ui.threads.ended_sig.dispatch()},resetUI:function t(){i.clear();g();if(e){TS.ui.message_container.cleanup(e);e=null}TS.client.ui.threads.$container.empty();$(".threads_alternative_view_wrapper").remove();TS.client.ui.threads.$scroller.addClass("loading")},displayEmptyState:function e(){if(!TS.model.threads_view_is_showing)return;var t={default:cdn_url+"/37d58/img/emoji_2017_12_06/apple/1f331.png",as_text:cdn_url+"/37d58/img/emoji_2017_12_06/apple/1f331.png",google:cdn_url+"/37d58/img/emoji_2017_12_06/google/1f331.png"};var i={emoji:t[TS.interop.rules.emoji.getEmojiMode({forceDisplay:true})],is_empty:true};TS.client.ui.threads.displayAlternativeThreadsView(i)},displayFatalError:function e(){if(!TS.model.threads_view_is_showing)return;var t={default:cdn_url+"/37d58/img/emoji_2017_12_06/apple/1f420.png",as_text:cdn_url+"/37d58/img/emoji_2017_12_06/apple/1f420.png",google:cdn_url+"/37d58/img/emoji_2017_12_06/google/1f420.png"};var i={emoji:t[TS.interop.rules.emoji.getEmojiMode({forceDisplay:true})],is_error:true};TS.client.ui.threads.displayAlternativeThreadsView(i)},displayAlternativeThreadsView:function e(t){TS.client.ui.threads.$scroller.find(".threads_alternative_view_wrapper").remove();TS.client.ui.threads.$scroller.removeClass("loading");TS.client.ui.threads.$scroller.removeClass("slow_loading");TS.client.ui.threads.$scroller.find("#threads_msgs").empty();TS.client.ui.threads.$scroller.append(TS.templates.threads_alternative_view(t))},isAlternativeThreadsViewShowing:function e(){return TS.client.ui.threads.$scroller.find(".threads_alternative_view_wrapper").length>0},displaySlowLoadingMessage:function e(){TS.client.ui.threads.$scroller.hasClass("loading")&&TS.client.ui.threads.$scroller.addClass("slow_loading");var t=$("#threads_msgs .and_more_end, #threads_msgs .and_more_beginning");if(t.length){var i=TS.interop.i18n.t("Still loading... sorry for the long wait!","threads")();t.text(i)}},startWithData:function t(i,n){TS.client.ui.threads.$scroller.removeClass("loading");TS.client.ui.threads.$scroller.removeClass("slow_loading");if(i.length<1){TS.client.ui.threads.displayEmptyState();return}TS.client.ui.threads.$scroller.scrollTop(0);e={name:"threads",container:TS.client.ui.threads.$container,scroller:TS.client.ui.threads.$scroller,page_size:8,msg_order:"desc",skip_day_groupings:true,has_more_beginning:false,has_more_end:!!n,buildSection:function e(t){return TS.templates.thread_view_section({is_old_section:"old_threads"===t.id,show_threads_notification_banner:A(t,i)})},buildMsgHTML:function e(t,i){return c(t,i)},updateCallback:function e(){d()},promiseToLoadMoreAtEnd:function e(){return TS.client.threads.loadMoreThreads().then(l)}};e.sections=[];var a=_.filter(i,{grouping:"new"});var r=_.filter(i,{grouping:"old"});if(a.length){var u=s();u.msgs=a}if(r.length){var m=o();m.msgs=r}if(!TS.environment.supports_custom_scrollbar){var f=TS.client.ui.threads.$scroller.data("monkeyScroll");f&&f.updateFunc()}TS.ui.message_container.register(e);d();h();$(document).on("keydown.threads",y)},buildThreadMsgHTML:function e(t,i,n){return TS.templates.builders.buildThreadMsgHTML(t,i,n)},maybeUpdateThreadWithMessage:function e(t,n,a){i.addToQ(function(){var e=TS.client.ui.threads.$container.find('ts-thread[data-thread-ts="'+(n.thread_ts||n.ts)+'"]');if(!e.length)return;TS.ui.thread.updateThreadWithMessage(e,t,n,a)})},maybeUpdateThreadWithMessages:function e(t,n,a){i.addToQ(function(){var e=v(t);if(!e.length)return;n.forEach(function(i){TS.ui.thread.updateThreadWithMessage(e,t,i,a)})})},maybeRemoveNewRepliesBanner:function e(){i.addToQ(function(){t&&g()})},maybeRemoveMessageFromThread:function e(t,n){if(!t||!n)return;if(n.ts===n.thread_ts){TS.error("Attempting to remove remove root msg from DOM instead of converting it to tombstone or deleting entire <ts-thread>");return}var a=TS.client.threads.getThread(t,n.thread_ts);if(!a)return;i.addToQ(function(){var e=TS.client.ui.threads.$container.find('ts-thread[data-thread-ts="'+(n.thread_ts||n.ts)+'"]');if(!e.length)return;var t=TS.ui.thread.removeMessageFromThread(e,a,n);return t})},maybeRemoveThread:function t(n,a){if(!n||!a)return;i.addToQ(function(){_.forEach(e.sections,function(e){e.msgs=_.without(e.msgs,_.find(e.msgs,function(e){return n.id===e.model_ob.id&&a.root_msg.thread_ts===e.root_msg.thread_ts}))});TS.ui.message_container.update(e)})},insertNewThread:function t(n){i.addToQ(function(){TS.client.ui.threads.$scroller.removeClass("loading");TS.client.ui.threads.$scroller.removeClass("slow_loading");var t=_.get(e,"sections");if(!t)return;var i;i="new"===n.grouping?s():o();i.msgs.push(n);i.msgs.sort(TS.client.threads.threadCompare);var a=TS.client.ui.threads.$container.find("ts-thread:first");TS.ui.message_container.updateWithFocus(e,a)})},jumpToTop:function t(){if(!TS.model.threads_view_is_showing)return;TS.ui.message_container.jumpToTop(e)},revealNewReplies:function e(t){i.addToQ(function(){var e=v(t);if(!e.length)return;return TS.ui.thread.revealNewReplies(e,t)})},revealPreviousReplies:function e(t,n){var a=v(t);n.isPending()&&TS.ui.thread.showThreadLoadingSpinner(a);return i.addToQ(function(){if(!a.length)return;return TS.ui.thread.revealPreviousReplies(a,t,n)})},maybeRedrawThread:function t(n){i.addToQ(function(){n.edited=Date.now();TS.ui.message_container.update(e)})},hideCaughtUpDivider:function e(){if(!TS.model.threads_view_is_showing)return;$("#threads_msgs .threads_caught_up_divider").addClass("hide_divider")},getThreadFromEl:function e(t){if(!t||!t.length)return;var i=t.closest("ts-thread");var n=i.attr("data-model-ob-id");var a=i.attr("data-thread-ts");if(!n||!a)return;var r=TS.redux.channels.getEntityById(n);return TS.client.threads.getThread(r,a)},incrementTrackingSeqId:function e(){a+=1},trackThreadsViewClosed:function e(t){var i=_.merge(TS.client.ui.threads.getTrackingData(),{num_threads_loaded:TS.client.threads.getThreadsLoadedCount(),view_exit_event:t});TS.interop.clog.track("THREADS_VIEW_CLOSE",i);r=true},getTrackingData:function e(){return{view_session_elapsed_time:Date.now()-n,view_session_index:a}},rebuildMsgsIncludingMember:function t(i){if(!TS.model.threads_view_is_showing)return;var n=_.get(e,"sections");if(!n)return;_.each(n,function(e){_.each(e.msgs,function(e){TS.utility.msgs.messageIncludesMember(i,e.root_msg)&&TS.client.ui.threads.maybeUpdateThreadWithMessage(e,e.root_msg);_.each(e.replies,function(t){TS.utility.msgs.messageIncludesMember(i,t)&&TS.client.ui.threads.maybeUpdateThreadWithMessage(e,t)})})})},rebuildMsgCurrentStatusIncludingMember:function t(i){if(!TS.model.threads_view_is_showing)return;var n=_.get(e,"sections");if(!n)return;var a={member:i,for_message:true};_.each(n,function(e){if(!e)return;_.each(e.msgs,function(e){if(TS.utility.msgs.memberSentMessage(i,e.root_msg)){var t=TS.client.ui.threads.$container.find('ts-message[data-ts="'+e.root_msg.ts+'"] .message_current_status');t.replaceWith(TS.templates.current_status(a))}_.each(e.replies,function(e){if(TS.utility.msgs.memberSentMessage(i,e)){var t=TS.client.ui.threads.$container.find('ts-message[data-ts="'+e.ts+'"] .message_current_status');t.replaceWith(TS.templates.current_status(a))}})})})},getDivForMsg:function e(t){return TS.client.ui.threads.$container?TS.client.ui.threads.$container.find("#"+TS.templates.makeMsgDomIdInThreadsView(t)):[]},threadWithFocusedInput:function e(){if(!TS.model.threads_view_is_showing)return null;var t=TS.client.ui.threads.$container.find(".reply_input_container .message_input");t=t.filter(function(){return TS.utility.contenteditable.isActiveElement($(this))});if(!t.length)return null;var i=TS.client.ui.threads.getThreadFromEl(t);return i},test:function t(){var i={_config:e,rebuildMsgsIncludingUserGroups:C,maybeRebuildThreadIncludingUserGroups:x};Object.defineProperty(i,"_config",{get:function t(){return e},set:function t(i){e=i}});Object.defineProperty(i,"maybeRebuildThreadIncludingUserGroups",{get:function e(){return x},set:function e(t){x=t}});return i}});var e;var t=false;var i;var n;var a;var r;var s=function t(){if(!e||!e.sections)return;var i=_.find(e.sections,{id:"new_threads"});if(!i){i={id:"new_threads",order:0,msgs:[]};e.sections.unshift(i)}return i};var o=function t(){if(!e||!e.sections)return;var i=_.find(e.sections,{id:"old_threads"});if(!i){i={id:"old_threads",order:1,msgs:[]};e.sections.push(i)}return i};var l=function t(i){var n=i.has_more;var a=i.threads;var r=_.get(e,"sections");if(!r)return;var l=_.filter(a,{grouping:"new"});var c=_.filter(a,{grouping:"old"});if(l.length){var d=s();d.msgs=l}if(c.length){var u=o();u.msgs=c}e.has_more_end=!!n};var c=function e(t){return TS.ui.thread.buildThreadHTML(t)};var d=function e(t){var i=TS.client.ui.threads.$container;if(!i)return;var n=i.find("ts-thread");_.forEach(n,function(e){t&&$(e).data("input_rendered",false);f($(e))})};var u=function e(){var t=true;d(t)};var m=function e(t){var i=TS.client.ui.threads.$container.find("ts-thread[data-model-ob-id="+t.id+"]");i.data("input_rendered",false);_.forEach(i,function(e){f($(e))})};var f=function e(t){if(!t||!t.length)return;if(t.data("input_rendered"))return;var i=t.attr("data-model-ob-id");var n=t.attr("data-thread-ts");if(!i||!n)return;var a=TS.redux.channels.getEntityById(i);if(!a)return;var r=TS.client.threads.getThread(a,n);if(!r){TS.error("Thread not found in TS.client.threads _thread_data");return}TS.ui.thread.renderReplyInput(t,r);t.data("input_rendered",true)};var h=function i(){var n=TS.client.ui.threads.$scroller;n.on("scroll.threads_view_scroll",_.debounce(function(){if(!TS.model.threads_view_is_showing)return;if(t&&0===n.scrollTop()){var i=TS.ui.message_container.getRange(e);var a=_.get(i,"start");if(!a)return;if(-1===a.msg_ts){TS.client.threads.markAllNewThreads();return}var r=e.sections[0].msgs[0];r&&a.msg_ts!==r.ts||TS.client.threads.markAllNewThreads()}},150))};var p=function e(i){var n=$("#threads_view_banner");var a=TS.interop.i18n.t("{new_thread_reply_count,plural,=1{{new_thread_reply_count} new reply}other{{new_thread_reply_count} new replies}}","threads")({new_thread_reply_count:i});n.find("#new_replies_info").text(a);n.removeClass("no_opacity");TS.client.ui.threads.$container.addClass("new_banner_is_showing");t=true};var g=function e(i){t=false;i&&$("#threads_view_banner").addClass("hidden");$("#threads_view_banner").addClass("no_opacity");TS.client.ui.threads.$container.removeClass("new_banner_is_showing")};var T=function e(){if(!TS.model.threads_view_is_showing)return;S();TS.client.ui.threads.$scroller.addClass("emojimode_"+TS.interop.rules.emoji.getEmojiMode())};var S=function e(){TS.client.ui.threads.$scroller.removeClass(function(e,t){return(t.match(/(^|\s)emojimode_\S+/g)||[]).join(" ")})};var v=function e(t){var i=t.root_msg.ts;var n=t.model_ob.id;var a=TS.client.ui.threads.$container.find('ts-thread[data-thread-ts="'+i+'"][data-model-ob-id="'+n+'"]');return a};var b=function e(t){if(!TS.model.threads_view_is_showing)return;i.addToQ(function(){m(t)})};var w=function e(t){if(!TS.model.threads_view_is_showing)return;if(!t)return;"who_can_post_general"===t&&i.addToQ(function(){var e=TS.interop.channels.getGeneralChannel();m(e)})};var y=function e(t){if(TS.ui.react_emoji_menu.is_showing)return;var i=[TS.utility.keymap.space,TS.utility.keymap.pageup,TS.utility.keymap.pagedown,TS.utility.keymap.end,TS.utility.keymap.home];var n=t.target;var a=$("#col_flex")[0].contains(n);var r=$(".client_channels_list_container")[0].contains(n);var s=TS.client.ui.threads.$scroller[0];var o=TS.client.ui.isUserAttentionOnChat()&&!TS.utility.isFocusOnInput()&&!a&&!r&&!s.contains(n);-1!==i.indexOf(t.keyCode)&&o&&s.focus()};var A=function e(t,i){return!TS.prefs.getPref("seen_threads_notification_banner")&&"mentions"===TS.notifs.getGlobalNotificationSetting()&&!TS.prefs.getPref("threads_everything")&&"new_threads"===t.id&&i.length>3};var k=function t(i){if(!TS.model.threads_view_is_showing)return;var n=_.get(e,"sections");if(!n)return;if(_.isEmpty(i))return;var a=_.map(i,"id");_.each(n,function(e){_.each(e.msgs,function(e){_.each([e.root_msg].concat(pe()(e.replies)),function(t){var i=TS.format.extractIds(t.text).c_ids;var n=[];t.attachments&&t.attachments.length&&(n=_(t.attachments).map(function(e){return TS.format.extractIds(e.text||"").c_ids}).flatten().value());i=_(i).concat(n).uniq().value();_.intersection(a,i).length&&TS.client.ui.threads.maybeUpdateThreadWithMessage(e,t)})})})};var C=function t(i){if(!TS.boot_data.feature_lazy_user_groups)return;if(!TS.model.threads_view_is_showing)return;var n=_.get(e,"sections");if(!n)return;_.each(n,function(e){_.each(e.msgs,function(e){return x(i,e)})})};var x=function e(t,i){if(!TS.boot_data.feature_lazy_user_groups)return;var n=_.map(t,function(e){return e.id});_.each([i.root_msg].concat(pe()(i.replies)),function(e){var t=TS.utility.msgs.extractUserGroupIdsFromMessage(e);_.isEmpty(_.intersection(n,t))||TS.client.ui.threads.maybeUpdateThreadWithMessage(i,e)})};var I=function e(){n=Date.now();a=0;r=false}})();var Re=i(3092);var Ne=i(3093);var Le=i(3094);var Ge=i(3095);var He=i(3096);var Qe=i(3097);var je=i(3098);var Ke=i(3099);var We=i(9);var Ve=i.n(We);(function(){TS.registerModule("client.highlights",{updated_sig:new signals.Signal,feedback_submitted_sig:new signals.Signal,last_request_id:null,sli_recaps_debug_group:null,onStart:function e(){},msgIsHighlight:function e(t,i){var n=TS.interop.redux.models.messagesMeta.getHighlightByChannelAndTs(TS.redux.getState(),{channelId:t,ts:i});return n&&n.isHighlight&&"dismiss"!==n.feedback&&"default_negative"!==n.feedback&&"negative"!==n.feedback&&!n.leftFeedback},msgIsHighlightUnfurl:function t(i,n){return!!(e[i]&&e[i][n]&&e[i][n].is_unfurl)},msgIsLeavingFeedback:function e(t,i){var n=TS.interop.redux.models.messagesMeta.getHighlightByChannelAndTs(TS.redux.getState(),{channelId:t,ts:i});return n&&n.feedback&&"default_negative"===n.feedback&&false===n.leftFeedback},canShowRecapDebug:function t(i,n){return"sli_debug_info"===TS.client.highlights.sli_recaps_debug_group&&e[i]&&e[i][n]},shouldRenderHighlightsUI:function e(t,i){return TS.client.highlights.msgIsHighlight(t,i)||TS.client.highlights.msgIsLeavingFeedback(t,i)},isMsgBeingRequested:function e(i,n){return t[i]&&t[i][n]},getHighlight:function e(t,i){return TS.interop.redux.models.messagesMeta.getHighlightByChannelAndTs(TS.redux.getState(),{channelId:t,ts:i})},getHighlightsForChannel:function t(i){return e[i]},addHighlights:function t(i){var n={};e=_.reduce(i,function(e,t,i){e[i]=e[i]||{};_.each(t,function(t,a){if(e[i][a]&&(e[i][a].show_recap||e[i][a].is_leaving_feedback||e[i][a].left_feedback)){e[i][a].request_id=t.request_id;e[i][a].cached_request_id=t.cached_request_id}else{e[i][a]=t;e[i][a].justification=TS.format.formatWithOptions(t.justification||"",void 0,{no_linking:true});n[i]=n[i]||{};n[i][a]=e[i][a]}});return e},e);_.isEmpty(n)||TS.client.highlights.updated_sig.dispatch(n)},setDefaultFeedbackForHighlight:function t(n,a,r,s){var o=TS.interop.redux.models.messagesMeta.getHighlightByChannelAndTs(TS.redux.getState(),{channelId:n,ts:a});var l="dismiss"===r.feedback?"dismiss":"default_"+r.feedback;var c=o.feedbackOptions[l].args;c.source=s;c.request_id=o.request_id||o.requestId;TS.redux.dispatch(TS.interop.redux.models.messagesMeta.setFeedbackForHighlight({channelId:n,ts:a.toString(),feedback:l,leftFeedback:false,isLeavingFeedback:"default_negative"===l,args:c}));var d=TS.client.highlights.getHighlight(n,a);TS.client.highlights.feedback_submitted_sig.dispatch(Ve()({},n,Ve()({},a,d)));if(e[n]&&e[n][a]){e[n][a]=_.assign({},e[n][a],r);if("negative"===r.feedback){e[n][a].show_recap=false;e[n][a].is_leaving_feedback=true}var u={};u[n]={};u[n][a]=e[n][a];TS.client.highlights.feedback_submitted_sig.dispatch(u);i(e[n][a],_.get(e[n][a],["feedback_options",l,"args"]),s)}},setNegativeFeedbackForHighlight:function t(n,a,r,s){var o=TS.interop.redux.models.messagesMeta.getHighlightByChannelAndTs(TS.redux.getState(),{channelId:n,ts:a});var l=_.get(o,["feedbackOptions","negative",r,"args"]);l.source=s;l.request_id=o.requestId||o.request_id;TS.redux.dispatch(TS.interop.redux.models.messagesMeta.setFeedbackForHighlight({channelId:n,ts:a.toString(),source:s,feedback:"negative",leftFeedback:true,isLeavingFeedback:false,args:l}));var c=TS.client.highlights.getHighlight(n,a);TS.client.highlights.feedback_submitted_sig.dispatch(Ve()({},n,Ve()({},a,c)));if(e[n]&&e[n][a]){e[n][a].is_leaving_feedback=false;e[n][a].left_feedback=true;var d={};d[n]={};d[n][a]=e[n][a];TS.client.highlights.feedback_submitted_sig.dispatch(d);i(e[n][a],_.get(e[n][a],["feedback_options","negative",r,"args"]),s)}},getHighlightsForMessages:function e(t){if(!t.timestamps.length)return;return TS.redux.dispatch(TS.interop.redux.models.messagesMeta.fetchSliHighlights({channelId:t.channel.id,timestamps:t.timestamps,lastReadTs:t.channel.last_read,prevChannelSwitchTs:t.channel_open_ts||TS.interop.datetime.makeTsStamp(t.channel.last_made_active,{padder:"0"})}))},test:function t(){var i={};Object.defineProperty(i,"_cache",{get:function t(){return e},set:function t(i){e=i}});return i}});var e={};var t={};var i=function e(t,i,n){if(i){var a=_.assign({},i,{request_id:t.request_id||TS.client.highlights.last_request_id,source:n});t.cached_request_id&&(a.cached_request_id=t.cached_request_id);TS.interop.api.call("highlights.feedback",a).catch(function(e){TS.error(e)})}}})();var ze=i(3100);var Ye=i(3101);var qe=i(3102);var Je=i(3103);var Ze=i(3104);var Xe=i(3105);var et=i(3106);var tt=i(3107);var it=i(3108);var nt=i(3109);var at=i(3110);var rt=i(3111);var st=i(3112);var ot=i(3113)},329:function(e,t,i){var n=i(192);var a=i(43)("iterator");var r=i(80);e.exports=i(52).isIterable=function(e){var t=Object(e);return void 0!==t[a]||"@@iterator"in t||r.hasOwnProperty(n(t))}},330:function(e,t,i){i(148);i(125);e.exports=i(331)},331:function(e,t,i){var n=i(71);var a=i(215);e.exports=i(52).getIterator=function(e){var t=a(e);if("function"!=typeof t)throw TypeError(e+" is not iterable!");return n(t.call(e))}},3536:function(e,t){(function(){TS.registerModule("team_creation_setup",{inOnboarding:function e(){if(!TS.boot_data.feature_tractor_onboarding||!TS.prefs.getPref("tractor_enabled"))return false;return a},startOnboarding:function t(){if(!TS.boot_data.feature_tractor_onboarding||!TS.prefs.getPref("tractor_enabled"))return;a=true;TS.interop.onboarding.fetchTeamCreationWorkflow().then(function(t){if(t&&"completed"!==t.state)e();else{a=false;TS.onboarding.no_longer_in_onboarding_sig.dispatch()}})},cancelOnboarding:function e(){a=false;TS.onboarding.no_longer_in_onboarding_sig.dispatch();i();"extreme_invites"===TS.prefs.getPref("tractor_experiment_group")?$("body").removeClass("p-team_creator_onboarding--in_progress-extreme-invites-experiment"):$("body").removeClass("p-team_creator_onboarding--in_progress")}});var e=function e(){"extreme_invites"===TS.prefs.getPref("tractor_experiment_group")?$("body").addClass("p-team_creator_onboarding--in_progress-extreme-invites-experiment"):$("body").addClass("p-team_creator_onboarding--in_progress");t()};var t=function e(){TS.channels.switched_sig.add(n);TS.groups.switched_sig.add(n);TS.ims.switched_sig.add(n)};var i=function e(){TS.channels.switched_sig.remove(n);TS.groups.switched_sig.remove(n);TS.ims.switched_sig.remove(n)};var n=function e(){i();TS.interop.onboarding.showSecondAccountSetupBanner()};var a=false})()},40:function(e,t,i){"use strict";t.__esModule=true;var n=i(275);var a=l(n);var r=i(288);var s=l(r);var o="function"===typeof s.default&&"symbol"===typeof a.default?function(e){return typeof e}:function(e){return e&&"function"===typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":typeof e};function l(e){return e&&e.__esModule?e:{default:e}}t.default="function"===typeof s.default&&"symbol"===o(a.default)?function(e){return"undefined"===typeof e?"undefined":o(e)}:function(e){return e&&"function"===typeof s.default&&e.constructor===s.default&&e!==s.default.prototype?"symbol":"undefined"===typeof e?"undefined":o(e)}},410:function(e,t,i){i(411);var n=i(52).Object;e.exports=function e(t,i,a){return n.defineProperty(t,i,a)}},411:function(e,t,i){var n=i(86);n(n.S+n.F*!i(56),"Object",{defineProperty:i(58).f})},412:function(e,t,i){e.exports={default:i(434),__esModule:true}},43:function(e,t,i){var n=i(109)("wks");var a=i(91);var r=i(46).Symbol;var s="function"==typeof r;var o=e.exports=function(e){return n[e]||(n[e]=s&&r[e]||(s?r:a)("Symbol."+e))};o.store=n},434:function(e,t,i){i(125);i(435);e.exports=i(52).Array.from},435:function(e,t,i){"use strict";var n=i(146);var a=i(86);var r=i(120);var s=i(436);var o=i(437);var l=i(154);var c=i(438);var d=i(215);a(a.S+a.F*!i(439)(function(e){Array.from(e)}),"Array",{from:function e(t){var i=r(t);var a="function"==typeof this?this:Array;var u=arguments.length;var _=u>1?arguments[1]:void 0;var m=void 0!==_;var f=0;var h=d(i);var p,g,T,S;m&&(_=n(_,u>2?arguments[2]:void 0,2));if(void 0==h||a==Array&&o(h)){p=l(i.length);for(g=new a(p);p>f;f++)c(g,f,m?_(i[f],f):i[f])}else for(S=h.call(i),g=new a;!(T=S.next()).done;f++)c(g,f,m?s(S,_,[T.value,f],true):T.value);g.length=f;return g}})},436:function(e,t,i){var n=i(71);e.exports=function(e,t,i,a){try{return a?t(n(i)[0],i[1]):t(i)}catch(t){var r=e["return"];void 0!==r&&n(r.call(e));throw t}}},437:function(e,t,i){var n=i(80);var a=i(43)("iterator");var r=Array.prototype;e.exports=function(e){return void 0!==e&&(n.Array===e||r[a]===e)}},438:function(e,t,i){"use strict";var n=i(58);var a=i(83);e.exports=function(e,t,i){t in e?n.f(e,t,a(0,i)):e[t]=i}},439:function(e,t,i){var n=i(43)("iterator");var a=false;try{var r=[7][n]();r["return"]=function(){a=true};Array.from(r,function(){throw 2})}catch(e){}e.exports=function(e,t){if(!t&&!a)return false;var i=false;try{var r=[7];var s=r[n]();s.next=function(){return{done:i=true}};r[n]=function(){return s};e(r)}catch(e){}return i}},46:function(e,t){var i=e.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=i)},49:function(e,t){var i;i=function(){return this}();try{i=i||Function("return this")()||(1,eval)("this")}catch(e){"object"===typeof window&&(i=window)}e.exports=i},52:function(e,t){var i=e.exports={version:"2.5.3"};"number"==typeof __e&&(__e=i)},56:function(e,t,i){e.exports=!i(73)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},58:function(e,t,i){var n=i(71);var a=i(136);var r=i(115);var s=Object.defineProperty;t.f=i(56)?Object.defineProperty:function e(t,i,o){n(t);i=r(i,true);n(o);if(a)try{return s(t,i,o)}catch(e){}if("get"in o||"set"in o)throw TypeError("Accessors not supported!");"value"in o&&(t[i]=o.value);return t}},60:function(e,t){var i={}.hasOwnProperty;e.exports=function(e,t){return i.call(e,t)}},64:function(e,t,i){var n=i(58);var a=i(83);e.exports=i(56)?function(e,t,i){return n.f(e,t,a(1,i))}:function(e,t,i){e[t]=i;return e}},66:function(e,t,i){var n=i(133);var a=i(96);e.exports=function(e){return n(a(e))}},67:function(e,t,i){"use strict";t.__esModule=true;var n=i(327);var a=o(n);var r=i(296);var s=o(r);function o(e){return e&&e.__esModule?e:{default:e}}t.default=function(){function e(e,t){var i=[];var n=true;var a=false;var r=void 0;try{for(var o=(0,s.default)(e),l;!(n=(l=o.next()).done);n=true){i.push(l.value);if(t&&i.length===t)break}}catch(e){a=true;r=e}finally{try{!n&&o["return"]&&o["return"]()}finally{if(a)throw r}}return i}return function(t,i){if(Array.isArray(t))return t;if((0,a.default)(Object(t)))return e(t,i);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}()},68:function(e,t){e.exports=function(e){return"object"===typeof e?null!==e:"function"===typeof e}},71:function(e,t,i){var n=i(68);e.exports=function(e){if(!n(e))throw TypeError(e+" is not an object!");return e}},73:function(e,t){e.exports=function(e){try{return!!e()}catch(e){return true}}},80:function(e,t){e.exports={}},83:function(e,t){e.exports=function(e,t){return{enumerable:!(1&e),configurable:!(2&e),writable:!(4&e),value:t}}},86:function(e,t,i){var n=i(46);var a=i(52);var r=i(146);var s=i(64);var o="prototype";var l=function(e,t,i){var c=e&l.F;var d=e&l.G;var u=e&l.S;var _=e&l.P;var m=e&l.B;var f=e&l.W;var h=d?a:a[t]||(a[t]={});var p=h[o];var g=d?n:u?n[t]:(n[t]||{})[o];var T,S,v;d&&(i=t);for(T in i){S=!c&&g&&void 0!==g[T];if(S&&T in h)continue;v=S?g[T]:i[T];h[T]=d&&"function"!=typeof g[T]?i[T]:m&&S?r(v,n):f&&g[T]==v?function(e){var t=function(t,i,n){if(this instanceof e){switch(arguments.length){case 0:return new e;case 1:return new e(t);case 2:return new e(t,i)}return new e(t,i,n)}return e.apply(this,arguments)};t[o]=e[o];return t}(v):_&&"function"==typeof v?r(Function.call,v):v;if(_){(h.virtual||(h.virtual={}))[T]=v;e&l.R&&p&&!p[T]&&s(p,T,v)}}};l.F=1;l.G=2;l.S=4;l.P=8;l.B=16;l.W=32;l.U=64;l.R=128;e.exports=l},9:function(e,t,i){"use strict";t.__esModule=true;var n=i(318);var a=r(n);function r(e){return e&&e.__esModule?e:{default:e}}t.default=function(e,t,i){t in e?(0,a.default)(e,t,{value:i,enumerable:true,configurable:true,writable:true}):e[t]=i;return e}},91:function(e,t){var i=0;var n=Math.random();e.exports=function(e){return"Symbol(".concat(void 0===e?"":e,")_",(++i+n).toString(36))}},95:function(e,t){var i=Math.ceil;var n=Math.floor;e.exports=function(e){return isNaN(e=+e)?0:(e>0?n:i)(e)}},96:function(e,t){e.exports=function(e){if(void 0==e)throw TypeError("Can't call method on  "+e);return e}},98:function(e,t,i){var n=i(137);var a=i(110);e.exports=Object.keys||function e(t){return n(t,a)}}},[[3284,0]]]);